(function(p,l){var m=l().jquery?l().jquery.split("."):"";if(1<parseInt(m[0],10)||1===parseInt(m[0],10)&&9<=parseInt(m[1],10)){l.event.handle=l.event.dispatch;var k;l.uaMatch=function(a){a=a.toLowerCase();a=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||0>a.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:a[1]||"",version:a[2]||"0"}};l.browser||(m=l.uaMatch(navigator.userAgent),
k={},m.browser&&(k[m.browser]=!0,k.version=m.version),k.chrome?k.webkit=!0:k.webkit&&(k.safari=!0),l.browser=k);var g=l.fn.toggle;l.fn.toggle=function(a,e){if(!l.isFunction(a)||!l.isFunction(e))return g.apply(this,arguments);var b=arguments,f=a.guid||l.guid++,k=0,q=function(e){var f=(l._data(this,"lastToggle"+a.guid)||0)%k;l._data(this,"lastToggle"+a.guid,f+1);e.preventDefault();return b[f].apply(this,arguments)||!1};for(q.guid=f;k<b.length;)b[k++].guid=f;return this.click(q)};var a=l.fn.andSelf||
l.fn.addBack;l.fn.andSelf=function(){return a.apply(this,arguments)}}m=l.ui.dialog.version?l.ui.dialog.version.split("."):"";if(1<parseInt(m[0],10)||1===parseInt(m[0],10)&&10<=parseInt(m[1],10))l.extend(l.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");a||(a=this.uuid+=1);return"ui-dialog-title-"+a},overlay:function(a){this.$el=l.ui.dialog.overlay.create(a)}}),l.extend(l.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:l.map("focus mousedown mouseup keydown keypress click".split(" "),
function(a){return a+".dialog-overlay"}).join(" "),create:function(a){0===this.instances.length&&(setTimeout(function(){l.ui.dialog.overlay.instances.length&&l(document).bind(l.ui.dialog.overlay.events,function(a){if(l(a.target).zIndex()<l.ui.dialog.overlay.maxZ)return!1})},1),l(p).bind("resize.dialog-overlay",l.ui.dialog.overlay.resize));var e=this.oldInstances.pop()||l("<div>").addClass("ui-widget-overlay");l(document).bind("keydown.dialog-overlay",function(b){var f=l.ui.dialog.overlay.instances;
0!==f.length&&f[f.length-1]===e&&a.options.closeOnEscape&&!b.isDefaultPrevented()&&b.keyCode&&b.keyCode===l.ui.keyCode.ESCAPE&&(a.close(b),b.preventDefault())});e.appendTo(document.body).css({width:this.width(),height:this.height()});l.fn.bgiframe&&e.bgiframe();this.instances.push(e);return e},destroy:function(a){var e=l.inArray(a,this.instances),b=0;-1!==e&&this.oldInstances.push(this.instances.splice(e,1)[0]);0===this.instances.length&&l([document,p]).unbind(".dialog-overlay");a.height(0).width(0).remove();
l.each(this.instances,function(){b=Math.max(b,this.css("z-index"))});this.maxZ=b},height:function(){var a,e;return l.ui.ie?(a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),e=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),a<e?l(p).height()+"px":a+"px"):l(document).height()+"px"},width:function(){var a,e;return l.ui.ie?(a=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),e=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),
a<e?l(p).width()+"px":a+"px"):l(document).width()+"px"},resize:function(){var a=l([]);l.each(l.ui.dialog.overlay.instances,function(){a=a.add(this)});a.css({width:0,height:0}).css({width:l.ui.dialog.overlay.width(),height:l.ui.dialog.overlay.height()})}}),l.extend(l.ui.dialog.overlay.prototype,{destroy:function(){l.ui.dialog.overlay.destroy(this.$el)}}),!1!==l.uiBackCompat&&function(a){var e=a.fn.position;a.fn.position=function(b){if(!b||!b.offset)return e.call(this,b);var f=b.offset.split(" "),g=
b.at.split(" ");1===f.length&&(f[1]=f[0]);/^\d/.test(f[0])&&(f[0]="+"+f[0]);/^\d/.test(f[1])&&(f[1]="+"+f[1]);1===g.length&&(/left|center|right/.test(g[0])?g[1]="center":(g[1]=g[0],g[0]="center"));return e.call(this,a.extend(b,{at:g[0]+f[0]+" "+g[1]+f[1],offset:void 0}))}}(jQuery)})(window,jQuery);
(function(p,l){function m(a){if(l.browser.safari)return a.font;var d=a.fontStyle,d=d+(" "+a.fontVariant),d=d+(" "+a.fontWeight),d=d+(" "+a.fontSize),d=d+("/"+a.lineHeight);return d+=" "+a.fontFamily}function k(a){var d=e.createElement("span");d.style.visibility="hidden";d.style.top="-10000px";d.style.left="-10000px";d.style.position="absolute";d.className="gcFontDetectSpanStyle";d.setAttribute(b,"gcFontDetectSpan");e.body.insertBefore(d,null);return{span:d,dispose:function(){e.body.removeChild(d);
delete this.span}}}function g(a){return a&&a instanceof d.LineBorder?new d.LineBorder(a.color,a.style):a}var a=p.GrapeCity;"undefined"===typeof a&&(a=p.GrapeCity={Version:"1.0.0"});var d=a.UI;"undefined"===typeof d&&(d=a.UI={});var e=p.document;"undefined"===typeof l.event.special.gcmousewheel&&function(a){function d(h){var b=[].slice.call(arguments,1),e=0;h=a.event.fix(h||p.event);h.type="gc"+n;void 0!==h.wheelDelta&&null!==h.wheelDelta||void 0!==h.detail&&null!==h.detail||(h.wheelDelta=h.originalEvent.wheelDelta,
h.detail=h.originalEvent.detail);h.wheelDelta&&(e=h.wheelDelta/120);h.detail&&(e=-h.detail/3);b.unshift(h,e);return a.event.handle.apply(h.target||h.srcElement,b)}var n="mousewheel",h=["DOMMouseScroll",n];a.event.special.gcmousewheel={setup:function(){if(this.addEventListener)for(var a=h.length;a;){var b=h[--a];b===n&&this.addEventListener("DOMMouseScroll",d,!1);this.addEventListener(b,d,!1)}else this.attachEvent("on"+n,d)},teardown:function(){if(this.removeEventListener)for(var a=h.length;a;){var b=
h[--a];b===n&&this.removeEventListener("DOMMouseScroll",d,!1);this.removeEventListener(b,d,!1)}else this.detachEvent("on"+n,d)}};a.fn.extend({handlegcmousewheel:function(h){return h?this.bind(n,h):this.trigger(n)},unhandlegcmousewheel:function(h){return this.unbind(n,h)}})}(jQuery);var b="gcUIElement";d.Global=function(){"undefined"===typeof p.gcGlobal&&this._init()};d.Global.prototype={activeElement:null,_eventSuspended:0,keyDown:function(a){var b=p.gcGlobal;if(!(0<b._eventSuspended||(b=b.activeElement,
b&&b._validationSelect&&l(b._validationSelect).is(":visible")))){if(b&&b.getCellType&&b.getActiveRowIndex&&b.getActiveColumnIndex){var n=b.getCellType(b.getActiveRowIndex(),b.getActiveColumnIndex());if(n&&n.isReservedKey(a))return}b&&b.doKeyDown&&(b.doKeyDown(a),a.keyCode!==d.Key.z&&a.keyCode!==d.Key.y||!a.ctrlKey||a.altKey||d.cancelDefault(a))}},keyUp:function(a){var d=p.gcGlobal;if(!(0<d._eventSuspended)){if((d=d.activeElement)&&d.getCellType&&d.getActiveRowIndex&&d.getActiveColumnIndex){var n=
d.getCellType(d.getActiveRowIndex(),d.getActiveColumnIndex());if(n&&n.isReservedKey(a))return}d&&d.doKeyUp&&d.doKeyUp(a)}},docSelectStart:function(a){!e.all&&p.gcGlobal&&p.gcGlobal.activeElement&&d.cancelDefault(a);return!1},getUIElement:function(a){for(;a&&"BODY"!==a.tagName&&"function"===typeof a.getAttribute;){var d=a.getAttribute(b);d||(d=a.gcUIElement);if(d)return a;a=a.parentNode}return null},_init:function(){p.gcGlobal=this;this._eventSuspended=0;var b=d.Global;l.browser.msie&&void 0!==e.documentMode&&
null!==e.documentMode&&9>e.documentMode?(p.attachEvent("keydown",b.prototype.keyDown),p.attachEvent("keyup",b.prototype.keyUp),e.attachEvent("selectstart",b.prototype.docSelectStart)):(p.addEventListener("keydown",b.prototype.keyDown,!0),p.addEventListener("keyup",b.prototype.keyUp,!0),e.addEventListener("selectstart",b.prototype.docSelectStart,!0));l(e).mousedown(function(a){var n=p.gcGlobal.activeElement;n&&(a=b.prototype.getUIElement(a.target),!a&&n.endEdit&&(n.endEdit(),n.repaint()),!a&&n._disposeValidationUI&&
n._disposeValidationUI(),a||(p.gcGlobal.activeElement=null))});l(e).ready(function(){a.UI.Global.prototype._createDummyObjects()})},_createDummyObjects:function(){var d=a.UI.Global;if(!d.prototype._dummyContent){var b=function(n){var h=e.createElement("span");h.className=n;h.style.display="none";e.body.insertBefore(h,null);return h};d.prototype._dummyHeader=b("ui-widget-header ui-state-default");d.prototype._dummyContent=b("ui-widget-content");d.prototype._dummyHover=b("ui-state-hover");d.prototype._dummyHighlight=
b("ui-state-highlight")}},getWijmoThemeStyle:function(a){var b=d.Global,n=d.VisualState,h=b.prototype._dummyHeader;a===n.Highlight||a===n.Selected?h=b.prototype._dummyHighlight:a===n.Hover&&(h=b.prototype._dummyHover);a=h.currentStyle;e.defaultView&&e.defaultView.getComputedStyle&&(a=e.defaultView.getComputedStyle(h,""));return a},suspendEvent:function(){p.gcGlobal._eventSuspended++},resumeEvent:function(){var a=p.gcGlobal;a._eventSuspended--;0>a._eventSuspended&&(a._eventSuspended=0)}};p.gcGlobal=
new d.Global;d.Key={left:37,right:39,up:38,down:40,tab:9,enter:13,shift:16,ctrl:17,space:32,altkey:18,home:36,end:35,pup:33,pdn:34,backspace:8,del:46,esc:27,c:67,v:86,x:88,z:90,y:89};d.KeyMap=function(a,d,n,h,I){this.key=a;this.ctrl=d;this.shift=n;this.alt=h;this.action=I};Array.prototype.remove=function(a){for(var d=0;d<this.length;d++)if(this[d]===a){this.splice(d,1);break}};Array.prototype.contains=function(a){for(var d=0;d<this.length;d++)if(this[d]===a)return!0;return!1};Array.prototype.indexOf=
function(a,d){if(void 0===d||null===d||isNaN(d))d=0;for(var n=d;n<this.length;n++)if(this[n]===a)return n;return-1};Array.prototype.map||(Array.prototype.map=function(a,d){var n,h,I,b=p.Object(this),e=b.length>>>0;if("function"!==typeof a)throw new TypeError(a+" is not a function");d&&(n=d);h=Array(e);for(I=0;I<e;){var f;I in b&&(f=b[I],f=a.call(n,f,I,b),h[I]=f);I++}return h});d.Point=function(a,b){this.x=a;this.y=b;this.clone=function(){return new d.Point(this.x,this.y)}};d.Rect=function(a,d,n,h){this.x=
a;this.y=d;this.width=n;this.height=h};d.Rect.prototype.intersect=function(a,d,n,h){return a<this.x+this.width&&this.x<a+n&&d<this.y+this.height&&this.y<d+h};d.Rect.prototype.intersectRect=function(a){return a.x<this.x+this.width&&this.x<a.x+a.width&&a.y<this.y+this.height&&this.y<a.y+a.height};d.Rect.prototype.contains=function(a,d){return a<this.x+this.width&&this.x<a&&d<this.y+this.height&&this.y<d};d.Rect.prototype.getIntersectRect=function(a){if(this.intersectRect(a)){var b=this.y,n=this.x+this.width,
h=this.y+this.height,I=a.y,E=a.x+a.width,e=a.y+a.height;a=Math.max(this.x,a.x);b=Math.max(b,I);n=Math.min(n,E);h=Math.min(h,e);e=n-a;h-=b;if(0<e&&0<h)return new d.Rect(a,b,e,h)}return null};d.Direction={up:1,down:2,left:3,right:4};d.HorizontalAlign={left:0,center:1,right:2,general:3};d.VerticalAlign={top:0,center:1,bottom:2};d.HorizontalPosition={left:0,center:1,right:2,nearest:3};d.VerticalPosition={top:0,center:1,bottom:2,nearest:3};d.HeaderAutoText={blank:0,numbers:1,letters:2};d.ClipboardPasteOptions=
{All:0,Values:1,Formatting:2,Formulas:3};d.TextFileOpenFlags={None:0,IncludeRowHeader:1,IncludeColumnHeader:2,UnFormatted:8,ImportFormula:16};d.VisualState={Normal:0,Highlight:1,Selected:2,Active:3,Hover:4};d.ReferenceStyle={A1:0,R1C1:1};d.LineStyle={empty:0,thin:1,medium:2,dashed:3,dotted:4,thick:5,"double":6,hair:7,mediumDashed:8,dashDot:9,mediumDashDot:10,dashDotDot:11,mediumDashDotDot:12,slantedDashDot:13};d.LineBorder=function(a,d){this.color=a;this.style=d};d.LineBorder.prototype={color:"black",
style:d.LineStyle.empty,width:function(a){if(a&&a.style){var b=d.LineStyle;switch(a.style){case b.dashDot:case b.thin:case b.dashed:case b.dotted:case b.hair:case b.dashDotDot:return 1;case b.medium:case b.mediumDashDot:case b.mediumDashDotDot:case b.mediumDashed:case b.slantedDashDot:return 2;case b.thick:case b["double"]:return 3}}return 0},_weight:function(a){if(a&&a.style){var b=d.LineStyle;switch(a.style){case b.dashDot:case b.dashed:case b.dotted:case b.dashDotDot:case b.hair:return 100;case b.thin:return 101;
case b.slantedDashDot:case b.mediumDashed:case b.mediumDashDot:case b.mediumDashDotDot:return 198;case b.medium:return 199;case b.thick:return 300;case b["double"]:return 90;case b.empty:return 0}}return-2}};var f=function(){return{"font-style":function(a,d){a&&(d.style.fontStyle=a)},"font-variant":function(a,d){a&&(d.style.fontVariant=a)},"font-weight":function(a,d){a&&(d.style.fontWeight=a)},"font-size":function(a,d){a&&(d.style.fontSize=a)},"line-height":function(a,d){a&&(d.style.lineHeight=a)},
"font-family":function(a,d){a&&(d.style.fontFamily=a)}}}();d.FontFactory=function(a){this._sheet=a};d.FontFactory.prototype={buildFont:function(a,d){var n="";if(a){var h=k(this.sheet);try{d&&(h.span.style.font=d),l.each(f,function(n,d){d(a.hasOwnProperty(n)?a[n]:null,h.span)})}finally{n=h.span.currentStyle,e.defaultView&&e.defaultView.getComputedStyle&&(n=e.defaultView.getComputedStyle(h.span,"")),n=m(n),h.dispose()}}return n}};d.Style=function(a,d,n,h,I,b,e,f,g,k,s,l,q,t,m,J,p){this.backgroundImage=
J;this.backColor=a;this.foreColor=d;this.hAlign=n;this.vAlign=h;this.font=I;this.themeFont=b;this.formatter=e;this.borderLeft=f;this.borderTop=g;this.borderRight=k;this.borderBottom=s;this.locked=l;this.textIndent=q;this.wordWrap=t;this.shrinkToFit=m;this.validator=void 0;this.cellType=p};d.Style.prototype._initDefault=function(){this.cellType=this.shrinkToFit=this.wordWrap=this.textIndent=this.locked=this.borderBottom=this.borderRight=this.borderTop=this.borderLeft=this.validator=this.formatter=
this.themeFont=this.font=this.vAlign=this.hAlign=this.foreColor=this.backColor=this.backgroundImage=void 0};d.Style.prototype.copyFrom=function(a){this.backgroundImage=a.backgroundImage;this.backColor=a.backColor;this.foreColor=a.foreColor;this.hAlign=a.hAlign;this.vAlign=a.vAlign;this.font=a.font;this.themeFont=a.themeFont;this.formatter=a.formatter;this._autoFormatter=a._autoFormatter;this.validator=a.validator;this.borderLeft=a.borderLeft;this.borderTop=a.borderTop;this.borderRight=a.borderRight;
this.borderBottom=a.borderBottom;this.locked=a.locked;this.textIndent=a.textIndent;this.wordWrap=a.wordWrap;this.shrinkToFit=a.shrinkToFit;this.cellType=a.cellType};d.Style.prototype.compose=function(a,d){if(d||"undefined"===typeof this.backgroundImage)this.backgroundImage=a.backgroundImage;if(d||"undefined"===typeof this.backColor)this.backColor=a.backColor;if(d||"undefined"===typeof this.foreColor)this.foreColor=a.foreColor;if(d||"undefined"===typeof this.hAlign)this.hAlign=a.hAlign;if(d||"undefined"===
typeof this.vAlign)this.vAlign=a.vAlign;if(d||"undefined"===typeof this.font)this.font=a.font;if(d||"undefined"===typeof this.themeFont)this.themeFont=a.themeFont;if(d||"undefined"===typeof this.formatter)this.formatter=a.formatter;if(d||"undefined"===typeof this.validator)this.validator=a.validator;if(d||"undefined"===typeof this._autoFormatter)this._autoFormatter=a._autoFormatter;if(d||"undefined"===typeof this.borderLeft)this.borderLeft=g(a.borderLeft);if(d||"undefined"===typeof this.borderTop)this.borderTop=
g(a.borderTop);if(d||"undefined"===typeof this.borderRight)this.borderRight=g(a.borderRight);if(d||"undefined"===typeof this.borderBottom)this.borderBottom=g(a.borderBottom);if(d||"undefined"===typeof this.locked)this.locked=a.locked;if(d||"undefined"===typeof this.textIndent)this.textIndent=a.textIndent;if(d||"undefined"===typeof this.wordWrap)this.wordWrap=a.wordWrap;if(d||"undefined"===typeof this.shrinkToFit)this.shrinkToFit=a.shrinkToFit;if(d||"undefined"===typeof this.cellType)this.cellType=
a.cellType};d.Style.prototype.clear=function(a){0===arguments.length?this._initDefault():("dataValidator"===a&&(a="validator"),this[a]=void 0)};var s;d.Style.prototype._normalize=function(a){var d,n;for(n in this)!a||"foreColor"!==n&&"backColor"!==n?a&&("borderLeft"===n||"borderTop"===n||"borderRight"===n||"borderBottom"===n)&&(d=this[n])&&(d=d.color)&&a.getColor&&(d=a.getColor(d))&&(this[n].color=d):(d=this[n])&&a.getColor&&(d=a.getColor(d))&&(this[n]=d);this.themeFont&&a&&a.getFont&&(n=this.font,
(a=a.getFont(this.themeFont))?(s||(d=e.createElement("span"),d.style.visibility="hidden",d.style.top="-10000px",d.style.left="-10000px",e.body.insertBefore(d,null),s=d),n?s.style.font=n:s.style.fontSize="10pt",s.style.fontFamily=a,a=s.currentStyle,e.defaultView&&e.defaultView.getComputedStyle&&(a=e.defaultView.getComputedStyle(s,"")),a=m(a)):a=n,this.font=a);return this};d.NameInfo=function(a,d,n,h){this._name=a;this._baseRow=n;this._baseColumn=h;this._expr=d};d.NameInfo.prototype={getName:function(){return this._name},
getRow:function(){return this._baseRow},getColumn:function(){return this._baseColumn},getExpression:function(){return this._expr}};d.createEventHandler=function(a,d){return function(){return d.apply(a,arguments)}};d.cancelDefault=function(a){a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!1,a.returnValue=!1);return!1};var q,t;d._isStandardCanvas=function(){"undefined"===typeof q&&(q="undefined"!==typeof e.createElement("canvas").getContext);return q};d._isSilverlightCanvas=
function(){if(d._isStandardCanvas())return!0;"undefined"===typeof t&&(t="undefined"!==typeof p.slcanvas);return t};d._useDoubleBuffer=function(){return d._isStandardCanvas()||d._isSilverlightCanvas()};d.GcUIElement=function(a,d,n,h,I){this._init(a,d,n,h,I)};d.GcUIElement.prototype={_init:function(a,b,n,h,I){this._bounds=new d.Rect(a,b,n,h);this._name=I},getBounds:function(){return this._bounds},setBounds:function(a){this._bounds.x=a.x;this._bounds.y=a.y;this._bounds.width=a.width;this._bounds.height=
a.height},_draw:function(a){if(a){a.save();var d=a.createLinearGradient(this._bounds.x,this._bounds.y,this._bounds.x,this._bounds.y+40);d.addColorStop(0,"#00ABEB");d.addColorStop(1,"#fff");a.fillStyle=d;a.fillRect(this._bounds.x,this._bounds.y,this._bounds.width,this._bounds.height);(d=this._name)&&0<d.length&&(a.fillStyle="darkblue",a.font="20pt Arial",a.fillText(d,this._bounds.x+36,this._bounds.y+28));a.strokeStyle="black";a.strokeRect(this._bounds.x,this._bounds.y,this._bounds.width,this._bounds.height);
a.restore()}},size:function(a,d){this._bounds.width=a;this._bounds.height=d},move:function(a,d){this._bounds.x=a;this._bounds.y=d}};d._ThemeContext=function(a){if(this._owner=a)this._currentTheme=a.currentTheme()};d._ThemeContext.prototype={owner:function(a){if(0===arguments.length)return this._owner;if(this._owner=a)this._currentTheme=this._owner.currentTheme();return this},getColor:function(a){if(this._currentTheme){var d=this._currentTheme.colors();if(d)return d.getColor(a)}return a},getFont:function(a){if(a){if(this._currentTheme){if("Body"===
a)return this._currentTheme.bodyFont();if("Headings"===a)return this._currentTheme.headerFont()}return a}return null}};d.Timer=function(a){this.host=a;this.result=this.intervalId=this.action=this.interval=null;this.working=!1};d.Timer.prototype={setAction:function(a){"function"===typeof a&&(this.action=a)},setInterval:function(a){if(!isNaN(a)&&0<a){var d=this.interval;this.interval=a;d!==a&&this.start()}else this.stop()},start:function(){this.clear();if(!isNaN(this.interval)){var a=this;this.intervalId=
p.setInterval(function(){a.run()},this.interval)}},run:function(){this.working=!0;"function"===typeof this.action&&(this.result=this.action.call(this.host))},stop:function(){this.clear();this.result=this.intervalId=this.action=this.interval=null;this.working=!1},clear:function(){this.intervalId&&p.clearInterval(this.intervalId)},_dispose:function(){this.stop();this.host=null}}})(window,jQuery);
(function(p,l){function m(n,h,a,d){throw Error("Invalid "+n+": "+h+" (must be between "+a+" and "+d+").");}function k(n,h,a){for(var d in q)q[d]&&(n=n.replace(q[d],q[d].source));!0===h?(n=n.replace(/~\?/g,t.source),n=n.replace(/~\*/g,r.source),n=n.replace(/\?/g,"."),n=a?n.replace(/\*/g,"((.|\\n)+)"):n.replace(/\*/g,"((.|\\n)*)"),n=n.replace(t,"\\?"),n=n.replace(r,"\\*")):(n=n.replace(/\?/g,"\\?"),n=n.replace(/\*/g,"\\*"));return n}var g="function",a=p.GrapeCity;"undefined"===typeof a&&(a=p.GrapeCity=
{});"undefined"===typeof a.UI&&(a.UI={});var d=a.UI,e=p.document,b=p.ko,f=function(n){var h=d.TextFileOpenFlags,a=h.IncludeRowHeader,b=h.IncludeColumnHeader,e=h.UnFormatted,h=h.ImportFormula;this.rowHeader=(n&a)===a;this.columnHeader=(n&b)===b;this.unFormatted=(n&e)===e;this.formula=(n&h)===h;this.expandColumns=this.expandRows=!0};f.prototype={fixOptions:function(n){var h=d.SheetArea;n&&(0>=n.getColumnCount(h.rowHeader)&&(this.rowHeader=!1),0>=n.getRowCount(h.colHeader)&&(this.columnHeader=!1))}};
var s={copyTo:function(n,h,a,b,e,f,g,k,l){s.checkArguments(n,h,a,b,e,f,g,k);var q=d.CopyToOption;n.suspendCalcService();b.suspendCalcService();var t=null;0<(l&q.BindingPath)&&(t=s.copyBindingPath(n,h,a,b,e,f,g,k));try{if(0<(l&q.Value)&&(s.copyValue(n,h,a,b,e,f,g,k),0===(l&q.Formula)&&s.clearFormula(b,e,f,g,k),0<(l&q.BindingPath)))for(var m=t.length,r=0>e?0:e,u=0>f?0:f,p=0;p<m;p++){var A=t[p];b.setValue(r+A.row,u+A.col,A.value)}0<(l&q.Formula)&&s.copyFormula(n,h,a,b,e,f,g,k)}finally{n.resumeCalcService(),
b.resumeCalcService()}0<(l&q.Style)&&s.copyStyle(n,h,a,b,e,f,g,k);0<(l&q.Sparkline)&&s.copySparkline(n,h,a,b,e,f,g,k);0<(l&q.RangeGroup)&&(0>h&&s.copyColumnRangeGroup(n,a,b,f,k),0>a&&s.copyRowRangeGroup(n,h,b,e,g));0<(l&q.Span)&&s.copySpan(n,h,a,b,e,f,g,k);0>h&&s.copyColumnAxis(n,a,b,f,k,l);0>a&&s.copyRowAxis(n,h,b,e,g,l);0>h&&0>e&&0>a&&0>f&&s.copySheetInfo(n,b,l);b._raisePropertyChanged("[CopyTo]")},checkArguments:function(n,h,a,d,b,e,f,g){if(!n)throw Error("src");if(!d)throw Error("dest");(-1>h||
h>=n.getRowCount())&&m("from row index",h,"-1",n.getRowCount()-1);(-1>a||a>=n.getColumnCount())&&m("from column index",a,"-1",n.getColumnCount()-1);(-1>b||b>=d.getRowCount())&&m("to row index",b,"-1",d.getRowCount()-1);(-1>e||e>=d.getColumnCount())&&m("to column index",e,"-1",d.getColumnCount()-1);var k=a;0>a&&(k=0,g=n.getColumnCount());a=0>e?0:e;(1>g||k+g>n.getColumnCount()||a+g>d.getColumnCount())&&m("column count",g,"1",Math.min(n.getColumnCount()-k,d.getColumnCount()-a));g=h;0>h&&(g=0,f=n.getRowCount());
h=0>b?0:b;(1>f||g+f>n.getRowCount()||h+f>d.getRowCount())&&m("row count",f,"1",Math.min(n.getRowCount()-g,d.getRowCount()-h))},copyValue:function(n,h,a,b,e,f,g,k){var l=!(n===b&&n._name===b._name),q=d.SheetArea,t,m,r,u,p;if(0>h){var A=a,L=f;t=Math.min(n.getRowCount(q.colHeader),b.getRowCount(q.colHeader));m=k;0>a&&(A=0,m=n.getColumnCount());0>f&&(L=0);if(l)for(r=0;r<t;r++)for(u=0;u<m;u++)p=n.getValue(r,A+u,q.colHeader),(void 0===p||null===p)&&n.isColumnBound(A+u)&&(r===n.colHeaderAutoTextIndex||r===
t-1&&-1===n.colHeaderAutoTextIndex)&&(p=n.getDataColumnName(A+u)),void 0===p||null===p?b._setValueInternal(r,L+u,q.colHeader,null,!0):b._setValueInternal(r,L+u,q.colHeader,s.cloneObject(p),!0);else{var D=new d._GcSheetModel(t,m,null);for(r=0;r<t;r++)for(u=0;u<m;u++)p=n._getModel(q.colHeader).getValue(r,A+u),(void 0===p||null===p)&&n.isColumnBound(A+u)&&(r===n.colHeaderAutoTextIndex||r===t-1&&-1===n.colHeaderAutoTextIndex)&&(p=n.getDataColumnName(A+u)),void 0!==p&&null!==p&&D.setValue(r,u,s.cloneObject(p));
for(r=0;r<t;r++)for(u=0;u<m;u++)b._setValueInternal(r,L+u,q.colHeader,D.getValue(r,u),!0)}}if(0>a)if(A=h,L=e,t=g,m=Math.min(n.getColumnCount(q.rowHeader),b.getColumnCount(q.rowHeader)),0>h&&(A=0,t=n.getRowCount()),0>e&&(L=0),l)for(r=0;r<t;r++)for(u=0;u<m;u++)p=n.getValue(A+r,u,q.rowHeader),void 0===p||null===p?b._setValueInternal(L+r,u,q.rowHeader,null,!0):b._setValueInternal(L+r,u,q.rowHeader,s.cloneObject(p),!0);else{D=new d._GcSheetModel(t,m,null);for(r=0;r<t;r++)for(u=0;u<m;u++)p=n._getModel(q.rowHeader).getValue(A+
r,u),void 0!==p&&null!==p&&D.setValue(r,u,s.cloneObject(p));for(r=0;r<t;r++)for(u=0;u<m;u++)b._setValueInternal(L+r,u,q.rowHeader,D.getValue(r,u),!0)}t=h;m=a;A=e;L=f;0>h&&(t=0,g=Math.min(n.getRowCount(),b.getRowCount()));0>a&&(m=0,k=Math.min(n.getColumnCount(),b.getColumnCount()));0>e&&(A=0);0>f&&(L=0);if(l)for(r=0;r<g;r++)for(u=0;u<k;u++)p=n.getValue(t+r,m+u,q.viewport),void 0===p||null===p?b._setValueInternal(A+r,L+u,q.viewport,null,!0):b._setValueInternal(A+r,L+u,q.viewport,s.cloneObject(p),!0);
else{h=new d._GcSheetModel(g,k,null);for(r=0;r<g;r++)for(u=0;u<k;u++)p=n.getValue(t+r,m+u,q.viewport),void 0!==p&&null!==p&&h.setValue(r,u,s.cloneObject(p));for(r=0;r<g;r++)for(u=0;u<k;u++)b._setValueInternal(A+r,L+u,q.viewport,h.getValue(r,u),!0)}},copyBindingPath:function(n,h,a,b,e,f,g,k){var s=h,l=a,q=e,t=f;0>h&&(s=0,g=Math.min(n.getRowCount(),b.getRowCount()));0>a&&(l=0,k=Math.min(n.getColumnCount(),b.getColumnCount()));0>e&&(q=0);0>f&&(t=0);h=[];if(n!==b||n._name!==b._name)for(e=0;e<g;e++)for(f=
0;f<k;f++)a=n.getBindingPath(s+e,l+f),b.setBindingPath(q+e,t+f,a),a&&h.push({row:e,col:f,value:n.getValue(s+e,l+f)});else{var m=new d._GcSheetModel(g,k,null);for(e=0;e<g;e++)for(f=0;f<k;f++)a=n.getBindingPath(s+e,l+f),m.setBindingPath(e,f,a),a&&h.push({row:e,col:f,value:n.getValue(s+e,l+f)});for(e=0;e<g;e++)for(f=0;f<k;f++)b.setBindingPath(q+e,t+f,m.getBindingPath(e,f))}return h},cloneObject:function(n){var h;if("number"===typeof n||"string"===typeof n||"boolean"===typeof n||"undefined"===typeof n)return n;
if(n instanceof Date)return h=new Date(n);h=n instanceof Object?new n.constructor:new n.constructor(n.valueOf());for(var a in n)n.hasOwnProperty(a)&&h[a]!==n[a]&&(h[a]="object"===typeof this[a]?s.cloneObject(n[a]):n[a]);h.toString=n.toString;h.valueOf=n.valueOf;return h},clearFormula:function(n,h,a,d,b){0>h&&(h=0,d=n.getRowCount());0>a&&(a=0,b=n.getColumnCount());for(;h<d;h++)for(var e=a;e<b;e++)n.setFormula(h,e,null)},_copyExpression:function(n,h,d){var b=n,e=a.Calc,f=e.Expressions,g=e.Functions,
k=e.Parser,e=e.Errors.Reference,q=f.ErrorExpression,t=f.ExternalErrorExpression;if(n instanceof f.ParenthesesExpression)b=l.extend(!0,new f.ParenthesesExpression,n),b.argument=s._copyExpression(n.argument,h,d);else if(n instanceof f.CellExpression){if(b=l.extend(!0,new f.CellExpression,n),n.rowRelative&&(0>n.row+h||n.row+h>k.maxRowCount)||n.columnRelative&&(0>n.column+d||n.column+d>k.maxColumnCount))return new q(e)}else if(n instanceof f.ExternalCellExpression){if(b=l.extend(!0,new f.ExternalCellExpression,
n),n.rowRelative&&(0>n.row+h||n.row+h>k.maxRowCount)||n.columnRelative&&(0>n.column+d||n.column+d>k.maxColumnCount))return new t(n.source,e)}else if(n instanceof f.RangeExpression){if(b=l.extend(!0,new f.RangeExpression,n),n.startRowRelative&&(0>n.startRow+h||n.startRow+h>k.maxRowCount)||n.startColumnRelative&&(0>n.startColumn+d||n.startColumn+d>k.maxColumnCount)||n.endRowRelative&&(0>n.endRow+h||n.endRow+h>k.maxRowCount)||n.endColumnRelative&&(0>n.endColumn+d||n.endColumn+d>k.maxColumnCount))return new q(e)}else if(n instanceof
f.ExternalRangeExpression){if(b=l.extend(!0,new f.ExternalRangeExpression,n),n.startRowRelative&&(0>n.startRow+h||n.startRow+h>k.maxRowCount)||n.startColumnRelative&&(0>n.startColumn+d||n.startColumn+d>k.maxColumnCount)||n.endRowRelative&&(0>n.endRow+h||n.endRow+h>k.maxRowCount)||n.endColumnRelative&&(0>n.endColumn+d||n.endColumn+d>k.maxColumnCount))return new t(n.source,e)}else if(n instanceof f.UnaryOperatorExpression)b=l.extend(!0,new f.UnaryOperatorExpression,n),b.operand=s._copyExpression(n.operand,
h,d);else if(n instanceof f.BinaryOperatorExpression)b=l.extend(!0,new f.BinaryOperatorExpression,n),b.left=s._copyExpression(n.left,h,d),b.right=s._copyExpression(n.right,h,d);else if(n instanceof f.FunctionExpression&&(b=l.extend(!0,new f.FunctionExpression(new g.Function),n),n.args&&0<n.args.length))for(f=0;f<n.args.length;f++)b.args[f]=s._copyExpression(n.args[f],h,d);return b},copyFormula:function(n,h,a,b,e,f,g,k){var l=h,q=a,t=e,m=f;0>h&&(l=0,g=Math.min(n.getRowCount(),b.getRowCount()));0>a&&
(q=0,k=Math.min(n.getColumnCount(),b.getColumnCount()));0>e&&(t=0);0>f&&(m=0);(h=b._getSheetSource())&&h.unlinkCellExpression(t,m,g,k);new d._GcSheetModel(g,k,null);a=new d._GcSheetModel(g,k,null);for(e=0;e<g;e++)for(f=0;f<k;f++)a.setFormula(e,f,n._calcDataModel.getFormula(e+l,f+q));for(e=0;e<g;e++)for(f=0;f<k;f++)n=s._copyExpression(a.getFormula(e,f),e+t,f+m),b._dataModel.setFormula(e+t,f+m,b.getCalcService().unparse(n,e+t,f+m)),b._calcDataModel.setFormula(e+t,f+m,n);h&&(h.linkCellExpression(t,m,
g,k),h._addCellsToDirty(t,m,g,k))},copyStyle:function(n,h,a,b,e,f,g,k){var l=!(n===b&&n._name===b._name),q=d.SheetArea,t,m,r,u,p;if(0>h){var A=a,L=f;t=Math.min(n.getRowCount(q.colHeader),b.getRowCount(q.colHeader));m=k;0>a&&(A=0,m=n.getColumnCount());0>f&&(L=0);if(l)for(r=0;r<t;r++)for(u=0;u<m;u++)(p=n.getActualStyle(r,A+u,q.colHeader))?b.setStyle(r,L+u,s.cloneObject(p),q.colHeader):b.setStyle(r,L+u,null,q.colHeader);else{var D=new d._GcSheetModel(t,m,null);for(r=0;r<t;r++)for(u=0;u<m;u++)(p=n.getActualStyle(r,
A+u,q.colHeader))&&D.setValue(r,u,s.cloneObject(p));for(r=0;r<t;r++)for(u=0;u<m;u++)b.setStyle(r,L+u,D.getValue(r,u),q.colHeader)}}if(0>a)if(A=h,L=e,t=g,m=Math.min(n.getColumnCount(q.rowHeader),b.getColumnCount(q.rowHeader)),0>h&&(A=0,t=n.getRowCount()),0>e&&(L=0),l)for(r=0;r<t;r++)for(u=0;u<m;u++)(p=n.getActualStyle(A+r,u,q.rowHeader))?b.setStyle(L+r,u,s.cloneObject(p),q.rowHeader):b.setStyle(L+r,u,null,q.rowHeader);else{D=new d._GcSheetModel(t,m,null);for(r=0;r<t;r++)for(u=0;u<m;u++)(p=n.getActualStyle(A+
r,u,q.rowHeader))&&D.setValue(r,u,s.cloneObject(p));for(r=0;r<t;r++)for(u=0;u<m;u++)b.setStyle(L+r,u,D.getValue(r,u),q.rowHeader)}t=h;m=a;A=e;L=f;0>h&&(t=0,g=Math.min(n.getRowCount(),b.getRowCount()));0>a&&(m=0,k=Math.min(n.getColumnCount(),b.getColumnCount()));0>e&&(A=0);0>f&&(L=0);if(l)for(r=0;r<g;r++)for(u=0;u<k;u++)(p=n.getActualStyle(t+r,m+u,q.viewport))?b.setStyle(A+r,L+u,s.cloneObject(p),q.viewport):b.setStyle(A+r,L+u,null,q.viewport);else{h=new d._GcSheetModel(g,k,null);for(r=0;r<g;r++)for(u=
0;u<k;u++)(p=n.getActualStyle(t+r,m+u,q.viewport))&&h.setValue(r,u,s.cloneObject(p));for(r=0;r<g;r++)for(u=0;u<k;u++)b.setStyle(A+r,L+u,h.getValue(r,u),q.viewport)}},copyColumnRangeGroup:function(n,h,a,d,b){var e=d;0>h&&(h=0,b=Math.min(n.getColumnCount(),a.getColumnCount()));0>d&&(e=0);n!==a||n._name!==a._name?s.crossSheetCopyRangeGroup(n.colRangeGroup,h,a.colRangeGroup,e,b):(n=n.colRangeGroup)&&n._copy(h,e,b)},crossSheetCopyRangeGroup:function(n,h,a,b,e){0>h&&(h=0);0>b&&(b=0);var f={};if(n)for(var g=
n.items.nextNonEmptyIndex(h-1);0<=g&&g<h+e;)f[g-h]=new d.RangeGroupItemInfo(n.items[g]),g=n.items.nextNonEmptyIndex(g);if(a&&(a.items.clear(b,e),0<f.length))for(var k in f)f.hasOwnProperty(k)&&(a.items[b+k]=f[k])},copySparkline:function(n,h,a,d,b,e,f,g){var k=h,s=a,l=b,q=e;0>h&&(k=0,f=Math.min(n.getRowCount(),d.getRowCount()));0>a&&(s=0,g=Math.min(n.getColumnCount(),d.getColumnCount()));0>b&&(l=0);0>e&&(q=0);n!==d||n._name!==d._name?(h=d._sparklineGroupManager)&&h._exCopy(n,k,s,l,q,f,g):(h=n._sparklineGroupManager)&&
h._copy(k,s,l,q,f,g)},copyRowRangeGroup:function(n,h,a,d,b){var e=h,f=d;0>h&&(e=0,b=Math.min(n.getRowCount(),a.getRowCount()));0>d&&(f=0);n!==a||n._name!==a._name?s.crossSheetCopyRangeGroup(n.rowRangeGroup,e,a.rowRangeGroup,f,b):(n=n.rowRangeGroup)&&n._copy(e,f,b)},copySpan:function(n,h,a,b,e,f,g,k){var l=d.SheetArea,q=h,t=a,m=e,r=f;0>h&&(q=0,g=Math.min(n.getRowCount(),b.getRowCount()));0>t&&(t=0,k=Math.min(n.getColumnCount(),b.getColumnCount()));0>e&&(m=0);0>f&&(r=0);e=!(n===b&&n._name===b._name);
0>h&&(e?s.crossSheetCopySpans(n._colHeaderSpanModel,-1,t,b._colHeaderSpanModel,-1,r,-1,k):(h=n._getSpanModel(l.colHeader))&&h.copy(-1,t,-1,r,-1,k));0>a&&(e?s.crossSheetCopySpans(n._rowHeaderSpanModel,q,-1,b._rowHeaderSpanModel,m,-1,g,-1):(a=n._getSpanModel(l.rowHeader))&&a.copy(q,-1,m,-1,g,-1));e?s.crossSheetCopySpans(n._spanModel,q,t,b._spanModel,m,r,g,k):(n=n._getSpanModel(l.viewport))&&n.copy(q,t,m,r,g,k)},crossSheetCopySpans:function(n,h,a,b,e,f,g,k){var l=s.getSpans(n);n=s.getSpans(b);var q=
[],t,m;if(-1===h){if(l&&0<l.length)for(t=0;t<l.length;t++)m=l[t],m.col>=a&&m.col+m.colCount<=a+k&&q.push(new d.Range(m.row,f+m.col-a,m.rowCount,m.colCount));if(n&&0<n.length)for(t=0;t<n.length;t++)if(m=n[t],m.col>=f&&m.col<f+k)for(h=0;h<b.length;h++)if(a=b[h],a.row===m.row&&a.col===m.col){b.splice(h,1);break}}else if(-1===a){if(l&&0<l.length)for(t=0;t<l.length;t++)m=l[t],h<=m.row&&m.row+m.rowCount<=h+g&&q.push(new d.Range(e+m.row-h,m.col,m.rowCount,m.colCount));if(n&&0<n.length)for(t=0;t<n.length;t++)if(m=
n[t],m.row>=e&&m.row<e+g)for(h=0;h<b.length;h++)if(a=b[h],a.row===m.row&&a.col===m.col){b.splice(h,1);break}}else{if(l&&0<l.length)for(t=0;t<l.length;t++)m=l[t],h<=m.row&&m.row<h+g&&a<=m.col&&m.col<a+k&&q.push(new d.Range(e+m.row-h,f+m.col-a,m.rowCount,m.colCount));if(n&&0<n.length)for(t=0;t<n.length;t++)if(m=n[t],m.row>=e&&m.row<e+g&&m.col>=f&&m.col<f+k)for(h=0;h<b.length;h++)if(a=b[h],a.row===m.row&&a.col===m.col){b.splice(h,1);break}}if(0<q.length&&b)for(t=0;t<q.length;t++)b.push(q[t])},getSpans:function(n){return n&&
0<n.length?n.slice(0):null},copyColumnAxis:function(n,h,a,b,e,f){var g=h,k=b;0>h&&(g=0,e=Math.min(n.getColumnCount(),a.getColumnCount()));0>b&&(k=0);h=d.SheetArea.colHeader;for(b=0;b<e;b++){var l=n._getActualColumnWidth(b+g);void 0!==l&&null!==l&&a.setColumnWidth(b+k,l);l=n.getColumnVisible(b+g);void 0!==l&&null!==l&&a.setColumnVisible(b+k,l);0<(f&d.CopyToOption.Style)&&((l=n.getActualStyle(-1,b+g))?a.setStyle(-1,b+k,s.cloneObject(l)):a.setStyle(-1,b+k,null),(l=n.getActualStyle(-1,b+g,h))?a.setStyle(-1,
b+k,s.cloneObject(l),h):a.setStyle(-1,b+k,null,h))}f=Math.min(n.getRowCount(h),a.getRowCount(h));for(g=0;g<f;g++)k=n._getActualRowHeight(g,h),void 0!==k&&null!==k&&a.setRowHeight(g,k,h)},cloneAxisInfo:function(n,h,a){for(var d=[],b=0;b<a;b++){var e=n[h+b];if(e){var f={},g;for(g in e)e.hasOwnProperty(g)&&(f[g]=e[g]);d.push(f)}else d.push(null)}return d},getAxisInfo:function(n,h,a){for(var d=[],b=0;b<a;b++)d.push(n[h+b]);return d},setAxisInfo:function(n,h,a){if(h)for(var d=0;d<n.length;d++)h[a+d]=n[d]},
copyRowAxis:function(n,h,a,b,e,f){var g=h,k=b;0>h&&(g=0,e=Math.min(n.getRowCount(),a.getRowCount()));0>b&&(k=0);h=d.SheetArea.rowHeader;for(b=0;b<e;b++){var l=n._getActualRowHeight(b+g);void 0!==l&&null!==l&&a.setRowHeight(b+k,l);l=n.getRowVisible(b+g);void 0!==l&&null!==l&&a.setRowVisible(b+k,l);0<(f&d.CopyToOption.Style)&&((l=n.getActualStyle(b+g,-1))?a.setStyle(b+k,-1,s.cloneObject(l)):a.setStyle(b+k,-1,null),(l=n.getActualStyle(b+g,-1,h))?a.setStyle(b+k,-1,s.cloneObject(l),h):a.setStyle(b+k,-1,
null,h))}f=Math.min(n.getColumnCount(h),a.getColumnCount(h));for(g=0;g<f;g++)k=n._getActualColumnWidth(g,h),void 0!==k&&null!==k&&a.setColumnWidth(g,k,h)},copySheetInfo:function(n,h,a){if(n!==h||n._name!==h._name){if(0<(a&d.CopyToOption.Style)){var b=d.SheetArea;a=b.colHeader;b=b.rowHeader;h.setDefaultStyle(s.cloneObject(n.getDefaultStyle()));h.setDefaultStyle(s.cloneObject(n.getDefaultStyle(a)),a);h.setDefaultStyle(s.cloneObject(n.getDefaultStyle(b)),b)}h.defaults.colWidth=n.defaults.colWidth;h.defaults.rowHeight=
n.defaults.rowHeight;h.defaults.rowHeaderColWidth=n.defaults.rowHeaderColWidth}},moveTo:function(n,h,a,b,e,f,g,k,l){s.checkArguments(n,h,a,b,e,f,g,k);var q=d.CopyToOption;n.suspendCalcService();b.suspendCalcService();var t=null;0<(l&q.BindingPath)&&(t=s.moveBindingPath(n,h,a,b,e,f,g,k));try{if(0<(l&q.Value)&&(s.moveValue(n,h,a,b,e,f,g,k),0===(l&q.Formula)&&s.clearFormula(b,e,f,g,k),0<(l&q.BindingPath)))for(var m=t.length,r=0>e?0:e,u=0>f?0:f,p=0;p<m;p++){var A=t[p];b.setValue(r+A.row,u+A.col,A.value)}0<
(l&q.Formula)&&s.moveFormula(n,h,a,b,e,f,g,k)}finally{n.resumeCalcService(),b.resumeCalcService()}0<(l&q.Style)&&s.moveStyle(n,h,a,b,e,f,g,k);0<(l&q.Sparkline)&&s.moveSparkline(n,h,a,b,e,f,g,k);0<(l&q.RangeGroup)&&(0>h&&s.moveColumnRangeGroup(n,a,b,f,k),0>a&&s.moveRowRangeGroup(n,h,b,e,g));0<(l&q.Span)&&s.moveSpan(n,h,a,b,e,f,g,k);0>h&&s.moveColumnAxis(n,a,b,f,k,l);0>a&&s.moveRowAxis(n,h,b,e,g,l);0>h&&0>e&&0>a&&0>f&&s.moveSheetInfo(n,b,l);if(0>h)for(h=a,0>a&&(h=0,k=Math.min(n.getColumnCount(),b.getColumnCount())),
a=0;a<k;a++)n.isColumnBound(h+a)&&(n._colInfos[h+a]=null);n._raisePropertyChanged("[MoveTo]");b._raisePropertyChanged("[MoveTo]")},moveValue:function(n,h,a,b,e,f,g,k){var s=!(n===b&&n._name===b._name),l=d.SheetArea.colHeader,q,t,m,r,u;if(0>h){var p=a,L=f;q=Math.min(n.getRowCount(l),b.getRowCount(l));t=k;0>a&&(p=0,t=n.getColumnCount());0>f&&(L=0);if(s)for(m=0;m<q;m++)for(r=0;r<t;r++)u=n._getModel(l).getValue(m,p+r),(void 0===u||null===u)&&n.isColumnBound(p+r)&&(m===n.colHeaderAutoTextIndex||m===q-
1&&-1===n.colHeaderAutoTextIndex)&&(u=n.getDataColumnName(p+r)),void 0===u||null===u?b._setValueInternal(m,L+r,l,null,!0):(b._setValueInternal(m,L+r,l,u,!0),n._setValueInternal(m,p+r,l,null,!0));else{var D=new d._GcSheetModel(q,t,null);for(m=0;m<q;m++)for(r=0;r<t;r++)u=n._getModel(l).getValue(m,p+r),(void 0===u||null===u)&&n.isColumnBound(p+r)&&(m===n.colHeaderAutoTextIndex||m===q-1&&-1===n.colHeaderAutoTextIndex)&&(u=n.getDataColumnName(p+r)),void 0!==u&&null!==u&&D.setValue(m,r,u),n._setValueInternal(m,
p+r,l,null,!0);for(m=0;m<q;m++)for(r=0;r<t;r++)b._setValueInternal(m,L+r,l,D.getValue(m,r),!0)}}l=d.SheetArea.rowHeader;if(0>a)if(p=h,L=e,q=g,t=Math.min(n.getColumnCount(l),b.getColumnCount(l)),0>h&&(p=0,q=n.getRowCount()),0>e&&(L=0),s)for(m=0;m<q;m++)for(r=0;r<t;r++)u=n.getValue(p+m,r,l),void 0===u||null===u?b._setValueInternal(L+m,r,l,null,!0):(b._setValueInternal(L+m,r,l,u,!0),n._setValueInternal(p+m,r,l,null,!0));else{D=new d._GcSheetModel(q,t,null);for(m=0;m<q;m++)for(r=0;r<t;r++)u=n._getModel(l).getValue(p+
m,r),void 0!==u&&null!==u&&D.setValue(m,r,u),n._setValueInternal(p+m,r,l,null,!0);for(m=0;m<q;m++)for(r=0;r<t;r++)b._setValueInternal(L+m,r,l,D.getValue(m,r),!0)}q=h;t=a;l=e;p=f;0>h&&(q=0,g=Math.min(n.getRowCount(),b.getRowCount()));0>a&&(t=0,k=Math.min(n.getColumnCount(),b.getColumnCount()));0>e&&(l=0);0>f&&(p=0);if(s)for(m=0;m<g;m++)for(r=0;r<k;r++)u=n.getValue(q+m,t+r),void 0===u||null===u?b._setValueInternal(l+m,p+r,null,null,!0):(b._setValueInternal(l+m,p+r,null,u,!0),n._setValueInternal(q+m,
t+r,null,null,!0));else{h=new d._GcSheetModel(g,k,null);for(m=0;m<g;m++)for(r=0;r<k;r++)u=n.getValue(q+m,t+r),void 0!==u&&null!==u&&h.setValue(m,r,u);for(m=0;m<g;m++)for(r=0;r<k;r++)n._setValueInternal(q+m,t+r,null,null,!0);for(m=0;m<g;m++)for(r=0;r<k;r++)b._setValueInternal(l+m,p+r,null,h.getValue(m,r),!0)}},moveFormula:function(n,h,a,d,b,e,f,g){var k=h,s=a,l=b,q=e;0>h&&(k=0,f=Math.min(n.getRowCount(),d.getRowCount()));0>a&&(s=0,g=Math.min(n.getColumnCount(),d.getColumnCount()));0>b&&(l=0);0>e&&
(q=0);h=!(n===d&&n._name===d._name);a=n._getSheetSource();b=d._getSheetSource();a&&(a.unlinkCellExpression(k,s,f,g),a._addDependentsToAdjust(k,s,f,g));b&&(b.unlinkCellExpression(l,q,f,g),b._addDependentsToAdjust(l,q,f,g));var t=n._getModel(),m=n._getCalcModel();n=d._getModel();e=d._getCalcModel();var r=[],u,p;for(u=0;u<f;u++)for(p=0;p<g;p++)r.push(m.getFormula(u+k,p+s)),t.setFormula(u+k,p+s,null),m.setFormula(u+k,p+s,null);d=d.getCalcService();for(u=0;u<f;u++)for(p=0;p<g;p++)t=r.shift(),n.setFormula(u+
l,p+q,d.unparse(t,u+l,p+q)),e.setFormula(u+l,p+q,t);a&&a._addCellsToAdjust(k,s,f,g);b&&b._addCellsToAdjust(l,q,f,g);a&&a._controller&&a._controller.adjustFormulasOnMove(a,k,s,b,l,q,f,g);!0===h&&b&&b._controller&&b._controller.adjustFormulasOnMove(a,k,s,b,l,q,f,g)},moveStyle:function(n,h,a,b,e,f,g,k){var l=!(n===b&&n._name===b._name),q=d.SheetArea.colHeader,t,m,r,u,p;if(0>h){var A=a,L=f;t=Math.min(n.getRowCount(q),b.getRowCount(q));m=k;0>a&&(A=0,m=n.getColumnCount());0>f&&(L=0);if(l)for(r=0;r<t;r++)for(u=
0;u<m;u++)(p=n.getActualStyle(r,A+u,q))?(b.setStyle(r,L+u,s.cloneObject(p),q),n.setStyle(r,A+u,null,q)):b.setStyle(r,L+u,null,q);else{var D=new d._GcSheetModel(t,m,null);for(r=0;r<t;r++)for(u=0;u<m;u++)(p=n.getActualStyle(r,A+u,q))&&D.setValue(r,u,s.cloneObject(p)),n.setStyle(r,A+u,null,q);for(r=0;r<t;r++)for(u=0;u<m;u++)b.setStyle(r,L+u,D.getValue(r,u),q)}}q=d.SheetArea.rowHeader;if(0>a)if(A=h,L=e,t=g,m=Math.min(n.getColumnCount(q),b.getColumnCount(q)),0>h&&(A=0,t=n.getRowCount()),0>e&&(L=0),l)for(r=
0;r<t;r++)for(u=0;u<m;u++)(p=n.getActualStyle(A+r,u,q))?(b.setStyle(L+r,u,s.cloneObject(p),q),n.setStyle(A+r,u,null,q)):b.setStyle(L+r,u,null,q);else{D=new d._GcSheetModel(t,m,null);for(r=0;r<t;r++)for(u=0;u<m;u++)(p=n.getActualStyle(A+r,u,q))&&D.setValue(r,u,s.cloneObject(p)),n.setStyle(A+r,u,null,q);for(r=0;r<t;r++)for(u=0;u<m;u++)b.setStyle(L+r,u,D.getValue(r,u),q)}t=h;m=a;q=e;A=f;0>h&&(t=0,g=Math.min(n.getRowCount(),b.getRowCount()));0>a&&(m=0,k=Math.min(n.getColumnCount(),b.getColumnCount()));
0>e&&(q=0);0>f&&(A=0);if(l)for(r=0;r<g;r++)for(u=0;u<k;u++)(p=n.getActualStyle(t+r,m+u))?(b.setStyle(q+r,A+u,s.cloneObject(p)),n.setStyle(t+r,m+u,null)):b.setStyle(q+r,A+u,null);else{h=new d._GcSheetModel(g,k,null);for(r=0;r<g;r++)for(u=0;u<k;u++)(p=n.getActualStyle(t+r,m+u))&&h.setValue(r,u,s.cloneObject(p)),n.setStyle(t+r,m+u,null);for(r=0;r<g;r++)for(u=0;u<k;u++)b.setStyle(q+r,A+u,h.getValue(r,u))}},moveSparkline:function(n,h,a,d,b,e,f,g){var k=h,s=a,l=b,q=e;0>h&&(k=0,f=Math.min(n.getRowCount(),
d.getRowCount()));0>a&&(s=0,g=Math.min(n.getColumnCount(),d.getColumnCount()));0>b&&(l=0);0>e&&(q=0);n!==d||n._name!==d._name?(h=d._sparklineGroupManager)&&h._exMove(n,k,s,l,q,f,g):(h=n._sparklineGroupManager)&&h._move(k,s,l,q,f,g)},moveColumnRangeGroup:function(n,h,a,d,b){var e=d;0>h&&(h=0,b=Math.min(n.getColumnCount(),a.getColumnCount()));0>d&&(e=0);n!==a||n._name!==a._name?(s.crossSheetCopyRangeGroup(n.colRangeGroup,h,a.colRangeGroup,e,b),n.colRangeGroup&&n.colRangeGroup.items.clear(h,b)):(n=n.colRangeGroup)&&
n._move(h,e,b)},moveRowRangeGroup:function(n,h,a,d,b){var e=h,f=d;0>h&&(e=0,b=Math.min(n.getRowCount(),a.getRowCount()));0>d&&(f=0);n!==a||n._name!==a._name?(s.crossSheetCopyRangeGroup(n.rowRangeGroup,e,a.rowRangeGroup,f,b),n.rowRangeGroup&&n.rowRangeGroup.items.clear(e,b)):(n=n.rowRangeGroup)&&n._move(e,f,b)},moveSpan:function(n,h,a,b,e,f,g,k){var l=h,q=a,t=e,m=f;0>h&&(l=0,g=Math.min(n.getRowCount(),b.getRowCount()));0>q&&(q=0,k=Math.min(n.getColumnCount(),b.getColumnCount()));0>e&&(t=0);0>f&&(m=
0);e=!(n===b&&n._name===b._name);f=d.SheetArea;0>h&&(e?(s.crossSheetCopySpans(n._colHeaderSpanModel,-1,q,b._colHeaderSpanModel,-1,m,-1,k),n._colHeaderSpanModel&&n._colHeaderSpanModel.clear(-1,q,-1,k)):(h=n._getSpanModel(f.colHeader))&&h.move(-1,q,-1,m,-1,k));0>a&&(e?(s.crossSheetCopySpans(n._rowHeaderSpanModel,l,-1,b._rowHeaderSpanModel,t,-1,g,-1),n._rowHeaderSpanModel&&n._rowHeaderSpanModel.clear(l,-1,g,-1)):(a=n._getSpanModel(f.rowHeader))&&a.move(l,-1,t,-1,g,-1));e?(s.crossSheetCopySpans(n._spanModel,
l,q,b._spanModel,t,m,g,k),n._spanModel&&n._spanModel.clear(l,q,g,k)):(n=n._getSpanModel())&&n.move(l,q,t,m,g,k)},moveColumnAxis:function(n,h,a,b,e,f){var g=h,k=b;0>h&&(g=0,e=Math.min(n.getColumnCount(),a.getColumnCount()));0>b&&(k=0);h=d.SheetArea.colHeader;for(b=0;b<e;b++){var l=n._getActualColumnWidth(b+g);void 0!==l&&null!==l&&(n.setColumnWidth(b+g,n.defaults.colWidth),a.setColumnWidth(b+k,l));l=n.getColumnVisible(b+g);void 0!==l&&null!==l&&(n.setColumnVisible(b+g,!0),a.setColumnVisible(b+k,l));
0<(f&d.CopyToOption.Style)&&((l=n.getActualStyle(-1,b+g))?(a.setStyle(-1,b+k,s.cloneObject(l)),n.setStyle(-1,b+g,null)):a.setStyle(-1,b+k,null),(l=n.getActualStyle(-1,b+g,h))?(a.setStyle(-1,b+k,s.cloneObject(l),h),n.setStyle(-1,b+g,null,h)):a.setStyle(-1,b+k,null,h))}f=Math.min(n.getRowCount(h),a.getRowCount(h));for(g=0;g<f;g++)k=n._getActualRowHeight(g,h),void 0!==k&&null!==k&&(n.setRowHeight(g,n.defaults.colHeaderRowHeight,h),a.setRowHeight(g,k,h))},moveRowAxis:function(n,h,a,b,e,f){var g=h,k=b;
0>h&&(g=0,e=Math.min(n.getRowCount(),a.getRowCount()));0>b&&(k=0);h=d.SheetArea.rowHeader;for(b=0;b<e;b++){var l=n._getActualRowHeight(b+g);void 0!==l&&null!==l&&(n.setRowHeight(b+g,n.defaults.rowHeight),a.setRowHeight(b+k,l));l=n.getRowVisible(b+g);void 0!==l&&null!==l&&(n.setRowVisible(b+g,!0),a.setRowVisible(b+k,l));0<(f&d.CopyToOption.Style)&&((l=n.getActualStyle(b+g,-1))?(a.setStyle(b+k,-1,s.cloneObject(l)),n.setStyle(b+g,-1,null)):a.setStyle(b+k,-1,null),(l=n.getActualStyle(b+g,-1,h))?(a.setStyle(b+
k,-1,s.cloneObject(l),h),n.setStyle(b+g,-1,null,h)):a.setStyle(b+k,-1,null,h))}f=Math.min(n.getColumnCount(h),a.getColumnCount(h));for(g=0;g<f;g++)k=n._getActualColumnWidth(g,h),void 0!==k&&null!==k&&(n.setColumnWidth(g,n.defaults.rowHeaderColWidth,h),a.setColumnWidth(g,k,h))},moveSheetInfo:function(n,h,a){if(n!==h||n._name!==h._name){if(0<(a&d.CopyToOption.Style)){var b=d.SheetArea;a=b.colHeader;b=b.rowHeader;h.setDefaultStyle(n.getDefaultStyle());h.setDefaultStyle(n.getDefaultStyle(a),a);h.setDefaultStyle(n.getDefaultStyle(b),
b);n.setDefaultStyle(null);n.setDefaultStyle(null,a);n.setDefaultStyle(null,b)}h.defaults.colWidth=n.defaults.colWidth;h.defaults.rowHeight=n.defaults.rowHeight;h.defaults.rowHeaderColWidth=n.defaults.rowHeaderColWidth;n.defaults.colWidth=62;n.defaults.rowHeight=20;n.defaults.rowHeaderColWidth=40}},moveBindingPath:function(n,h,a,b,e,f,g,k){var l=h,s=a,q=e,t=f;0>h&&(l=0,g=Math.min(n.getRowCount(),b.getRowCount()));0>a&&(s=0,k=Math.min(n.getColumnCount(),b.getColumnCount()));0>e&&(q=0);0>f&&(t=0);h=
[];if(n!==b||n._name!==b._name)for(e=0;e<g;e++)for(f=0;f<k;f++)a=n.getBindingPath(l+e,s+f),b.setBindingPath(q+e,t+f,a),a&&h.push({row:e,col:f,value:n.getValue(l+e,s+f)}),n.setBindingPath(l+e,s+f,null);else{var m=new d._GcSheetModel(g,k,null);for(e=0;e<g;e++)for(f=0;f<k;f++)a=n.getBindingPath(l+e,s+f),m.setBindingPath(e,f,a),a&&h.push({row:e,col:f,value:n.getValue(l+e,s+f)});for(e=0;e<g;e++)for(f=0;f<k;f++)n.setBindingPath(l+e,s+f,null);for(e=0;e<g;e++)for(f=0;f<k;f++)b.setBindingPath(q+e,t+f,m.getBindingPath(e,
f))}return h},setRangeText:function(n,h,a,d,b,e,f,g){if(!n)throw Error("sheet");(-1>h||h>=n.getRowCount())&&m("row",h,"-1",n.getRowCount()-1);(-1>a||a>=n.getColumnCount())&&m("column",a,"-1",n.getColumnCount()-1);void 0!==d&&null!==d&&""!==d&&(-1===h&&(h=0),-1===a&&(a=0),(d=s.parseText(d,b,e,f))&&0<d.length&&s.setSheetData(n,h,a,d,g))},getRangeText:function(n,h,a,d,b,e,f,g,k,l){if(!n)throw Error("sheet");(-1>h||h>=n.getRowCount())&&m("row",h,"-1",n.getRowCount()-1);(-1>a||h+a>n.getRowCount())&&m("rowCount",
h,"-1",n.getRowCount()-h);(-1>d||d>=n.getColumnCount())&&m("column",d,"-1",n.getColumnCount()-1);(-1>b||d+b>n.getColumnCount())&&m("columnCount",d,"-1",n.getColumnCount()-d);k=g=-1;-1===h&&-1===d&&-1===a&&-1===b?(d=h=0,g=n.getRowCount()-1,k=n.getColumnCount()-1):(-1===h&&(h=0),-1===d&&(d=0),-1===a&&(a=n.getRowCount()-h),-1===b&&(b=n.getColumnCount()-d),g=h+a-1,k=d+b-1);if(void 0===e||null===e||""===e)e="\r\n";if(void 0===f||null===f||""===f)f="\t";for(a="";h<=g;h++){b=!0;for(l=d;l<=k;l++){b||(a+=
f);b=!1;var s="",q=n.getValue(h,l);void 0!==q&&null!==q&&(s=q.toString());a+=s}a+=e}return a.toString()},parseText:function(n,h,a,b){if(void 0===n||null===n||""===n)return null;if(void 0===h||null===h||""===h)h="\r\n";if(void 0===a||null===a||""===a)a="\t";if(void 0===b||null===b||""===b)b='"';d.StringHelper.EndsWith(n,h)||(n+=h);for(var e=[],f=[],g=new d.StringBuilder,k=b.length,l=h.length,s=a.length,q=0;q<n.length;q++)g.Append(n[q]),g.Length()>=k&&b===g.ToString(g.Length()-k,k)||(g.Length()>=s&&
a===g.ToString(g.Length()-s,s)?(g.Remove(g.Length()-s,s),f.push(g.toString()),g.Remove(0,g.Length())):g.Length()>=l&&h===g.ToString(g.Length()-l,l)&&(g.Remove(g.Length()-l,l),f.push(g.toString()),e.push(f),f=[],g.Remove(0,g.Length())));return e},setSheetData:function(n,h,a,b,e){var g=b.length,k=s.getMaxLength(b);if(0!==g&&0!==k){e=new f(e);e.fixOptions(n);var l=d.SheetArea,q=e.rowHeader?n.getColumnCount(l.rowHeader):0,t=e.columnHeader?n.getRowCount(l.colHeader):0,m=0,k=k-q;0>=k&&(k=0);g-=t;0>=g&&
(m=0);g-=m;0>=g&&(g=0);e.expandRows&&h+g>n.getRowCount()&&n.setRowCount(h+g);e.expandColumns&&a+k>n.getColumnCount()&&n.setColumnCount(a+k);for(var r=m=0;m<b.length;m++,r++){var u=b[m];0>=u.length||(0<t&&m<t?s.setRowData(n,u,r,a,k,l.colHeader,e):0<g&&r<n.getRowCount()&&(m===t&&(r=h),s.setRowData(n,u,r,0,q,l.rowHeader,e),u.splice(0,q),s.setRowData(n,u,r,a,k,l.viewport,e)))}}},setRowData:function(n,h,a,d,b,e,f){for(var g=0;g<h.length;g++,d++)0<b&&d<n.getColumnCount(e)&&s.setCellData(n,e,a,d,h[g],f)},
setCellData:function(n,h,a,b,e,f){var g=e,k=null;!1===f.unFormatted&&(g={value:e},k=(new d.GeneralFormatter).GetPreferredDisplayFormatter(e,g),g=g.value);if(void 0===g||null===g)n.setValue(a,b,g,h);else if(""!==e)if(f.formula&&"="===e[0])try{n.setFormula(a,b,e.substr(1),h)}catch(l){n.setText(a,b,e,h)}else{var s=n.getActualStyle(a,b,h);s&&(!1===f.unFormatted?s.formatter?"@"===s.formatter.toString()&&(g=e.toString()):(e=new d.AutoFormatter(k),n.getCell(a,b,h)._setStyleProperty("_autoFormatter",e)):
s.formatter&&n.getCell(a,b,h).formatter(null));n.setValue(a,b,g,h)}else n.setValue(a,b,null,h)},getMaxLength:function(n){if(void 0===n||null===n)return 0;for(var h=0,a=0;a<n.length;a++)h=Math.max(n[a].length,h);return h},parseCsv:function(n,h,a,d){var b=null;if(n=s.parseText(n,h,a,d)){b=n.length;h=s.getMaxLength(n);a=[];for(d=0;d<b;d++){a[d]=[];for(var e=0;e<h;e++)a[d][e]=e<n[d].length?n[d][e]:null}b=a}return b}},q=[/\\/g,/\(/g,/\[/g,/\{/g,/\^/g,/\$/g,/\|/g,/\)/g,/\+/g,/\./g],t=RegExp("{113E2532-EAF5-444c-A5CB-3D7446971C4D}",
"g"),r=RegExp("{E21523B3-0F1F-458f-B547-23D25713D0EC}","g");d.DataContext=function(n,h,a,d){this.read=n;this.create=h;this.update=a;this.remove=d};var u=/^\/Date\(-?\d+\)\/\s*$/;d.EditorStatus={Ready:0,Enter:1,Edit:2};d.GcSheet=function(n){this._init(n)};d.GcSheet.prototype={getDataSource:function(){return this._dataSource},_isDataView:function(n){var h=p.wijmo;return h&&h.data&&h.data.isDataView(n)},_dataChangedhandler:function(n){if(!this._updatingDataView){var h=this;this._bindToAutoRefresh(function(n){n&&
(h._dataViewUpdating=!0,isNaN(n.length)||h.setRowCount(n.length),h._dataViewUpdating=!1)})(n)}},_currentPositionChangedhandler:function(n){var h=this;this._bindToAutoRefresh(function(n){h._dataSource&&h._dataSource.currentPosition&&(n=h._dataSource.currentPosition(),n=h._dataSource.currentPosition(),h._activeRowIndex!==n&&h.setActiveCell(n,h._activeColIndex))})(n)},_isCellBinding:function(n){return d.CellBindingSource&&n instanceof d.CellBindingSource||n&&n.hasOwnProperty("__cellBindingSource__")},
getBindingPath:function(n,h,a){var b=d.SheetArea;if(void 0===a||null===a)a=b.viewport;return a===b.viewport&&(a=this._getModel(a))?a.getBindingPath(n,h):null},setBindingPath:function(n,h,a,b){return this._bindToAutoRefresh(function(h,n,a,b){var e=d.SheetArea;if(void 0===b||null===b)b=e.viewport;b===e.viewport&&(b=this._getModel(b))&&b.setBindingPath(h,n,a);return this})(n,h,a,b)},_autoGenerateColumnCellType:function(n){if(this._dataSource&&this._colInfos&&this._colInfos[n]){var h=this._getDataItem(this._dataSource,
0);h&&"boolean"===typeof h[this._colInfos[n].name]&&this.setCellType(-1,n,new d.CheckBoxCellType)}},setDataSource:function(n,h){this._bindToAutoRefresh(function(h,n){h&&!n||this.reset();this._dataSource&&this._dataSource.dispose&&this._dataSource.dispose();(this._dataSource=h)&&h.subscribe&&h.subscribe(this._dataChangedhandler,this);h&&h.currentPosition&&h.currentPosition.subscribe&&h.currentPosition.subscribe(this._currentPositionChangedhandler,this);if(this._isDataView(h))if(this.setRowCount(h.count()),
this.autoGenerateColumns){var a=h.getProperties();if(a&&0<a.length){this.setColumnCount(a.length);this._colInfos={};for(var d=0;d<a.length;d++)this._colInfos[d]={name:a[d].name}}}else this._colInfos||(this._colInfos={});else if(p.ko&&p.ko.isObservable(h))if(this.setRowCount(h().length),this.autoGenerateColumns){if((a=this._getProperties(h()[0]))&&0<a.length)for(this.setColumnCount(a.length),this._colInfos={},d=0;d<a.length;d++)this._colInfos[d]={name:a[d]}}else this._colInfos||(this._colInfos={});
else if(!this._isCellBinding(h)&&h&&!isNaN(h.length))if(this.setRowCount(h.length),this.autoGenerateColumns){if((a=this._getProperties(h[0]))&&0<a.length)for(this.setColumnCount(a.length),this._colInfos={},d=0;d<a.length;d++)this._colInfos[d]={name:a[d]}}else this._colInfos||(this._colInfos={});this.doDataItemChanged()})(n,h)},bindColumn:function(n,h){var a=this.isPaintSuspended();this.isPaintSuspended(!0);try{"string"===typeof h&&(h={name:h}),this._colInfos||(this._colInfos={}),(this._colInfos[n]=
h)&&h.formatter&&this.setFormatter(-1,n,h.formatter),h&&h.cellType&&this.setCellType(-1,n,h.cellType)}finally{this.isPaintSuspended(a)}},bindColumns:function(n){var h=this.isPaintSuspended();this.isPaintSuspended(!0);try{if(this._colInfos={},n){isNaN(n.length)||this.setColumnCount(n.length);for(var a=0;a<n.length;a++){var d=n[a];"string"===typeof d&&(d={name:d});(this._colInfos[a]=d)&&d.formatter&&this.setFormatter(-1,a,d.formatter);d&&d.cellType&&this.setCellType(-1,a,d.cellType)}}}finally{this.isPaintSuspended(h)}},
getDataContext:function(){return this.dataContext},setDataContext:function(n){this.dataContext=n;this.load()},_getDataLength:function(n){if(n){var h=p.ko;if(this._isDataView(n))return n.count();if(h&&h.isObservable(n))return n().length;if(!this._isCellBinding(n)&&n&&!isNaN(n.length))return n.length}return 0},_getDataItemType:function(n){if(n)for(var h=this._getDataLength(n),a=0;a<h;a++){var d=this._getDataItem(n,a);if(d)return d.constructor}return null},_getDataItem:function(n,h){var a=p.ko;return this._isDataView(n)?
n.item(h):a&&a.isObservable(n)?n()[h]:this._isCellBinding(n)?null:n[h]},getDataItem:function(n){var h=this.getDataSource();if(!h&&0===this._getDataLength(h))return null;var a=this.getColumnCount(),d={};if(h=this._getDataItem(h,n))for(var b in h)h.hasOwnProperty(b)&&typeof b!==g&&(d[b]=h[b]);for(b=0;b<a;b++)(h=this._colInfos[b])&&h.name&&0<h.name.length&&(d[h.name]=this.getValue(n,b));return d},getDirtyRows:function(){var n=[],h=this._dataModel.dirtyNodes;if(h)for(var a in h)h.hasOwnProperty(a)&&h[a]&&
"e"===h[a].rs&&n.push({row:a,item:this.getDataItem(a),originalItem:this._dataSource?this._getDataItem(this._dataSource,a):null});return n},getInsertRows:function(){var n=[],h=this._dataModel.dirtyNodes;if(h)for(var a in h)h.hasOwnProperty(a)&&h[a]&&"n"===h[a].rs&&n.push({row:a,item:this.getDataItem(a)});return n},_getDeleteRows:function(){var n=[];this.deletedRows&&l.each(this.deletedRows,function(h,a){typeof a!==g&&a&&void 0!==a.data&&null!==a.data&&n.push({row:h,originalItem:a.data})});return n},
hasPendingChanges:function(){var n=this._dataModel.dirtyNodes,h;if(n)for(h in n)if(n[h]&&("e"===n[h].rs||"n"===n[h].rs))return!0;if(this.deletedRows)for(h in this.deletedRows)if(this.deletedRows[h]&&typeof this.deletedRows[h]!==g)return!0;return!1},clearPendingChanges:function(){function n(h){l.each(h,function(h,n){typeof h!==g&&n&&n.dirty&&(n.dirty=null)})}this._dataModel.dirtyNodes={};this.deletedRows=[];n(this._rowInfos);n(this._colInfos)},load:function(){if(this.dataContext&&this.dataContext.read){var n=
this;this._dataReceivedDelegate=function(h){return n._onDataReceived(h)};l.getJSON(this.dataContext.read,this._dataReceivedDelegate)}},updateRecord:function(){if(this.autoUpdate&&this.dataContext&&this.dataContext.update&&""!==this.dataContext.update){var n=this.getDataSource();if(n&&0!==this._getDataLength(n)){var h=this;this._dataUpdatedDelegate=function(n){return h._onDataUpdated(n)};n=this._activeRowIndex;if(0<=n){var a=this.getDataItem(n),d=this.dataContext.update;this._dataModel.dataTable&&
this._dataModel.dataTable[n]&&"n"===this._dataModel.dataTable[n].rs&&(d=this.dataContext.create);l.ajax({url:d,type:"POST",data:JSON.stringify(a),dataType:"json",contentType:"application/json;charset=UTF-8",success:this._dataUpdatedDelegate})}}}},_onDataUpdated:function(n){},_onDataReceived:function(n){if(n){var h=n.data;if(h){this.setDataSource(h);isNaN(n.total)||this.setRowCount(n.total);if(p.localStorage)for(n=this.getColumnCount(),h=0;h<n;h++)p.localStorage["col,"+h]&&this.setColumnWidth(h,parseInt(p.localStorage["col,"+
h],10));this.parent&&this.parent._doResize();this.invalidateLayout();this.repaint()}}},_getProperties:function(n){var h=[];if(n)for(var a in n)typeof n[a]!==g?h.push(a):"undefined"!==typeof b&&b.isObservable(n[a])&&h.push(a);return h},referenceStyle:function(n){var h=d.ReferenceStyle;if(0===arguments.length)return this.getCalcService().useR1C1?h.R1C1:h.A1;this.getCalcService().useR1C1=n===h.R1C1;return this},recalcAll:function(){this.getCalcService().recalculateAll()},_recalcCell:function(n,h,a){this.getCalcService().recalculate({target:this,
model:n},h,a)},getCalcService:function(){this.calcService||(this.calcService=new a.Calc.Service(this));return this.calcService},_getCalcContexts:function(){var n=[],h=this._getModel();n.push({name:this._name,target:this,refModel:h});return n},updateCalcContexts:function(){this.getCalcService().contextChanged()},suspendCalcService:function(){this.calcService&&this.calcService.suspend()},resumeCalcService:function(){this.calcService&&this.calcService.resume()},_getSheetSource:function(n){return void 0===
n||null===n||n===d.SheetArea.viewport?this._vpSheetSource:null},getCustomFunction:function(n){return this._functions&&n&&""!==n?this._functions[n.toUpperCase()]:null},addCustomFunction:function(n){if(!(n&&n instanceof a.Calc.Functions.Function))throw Error("invalid custom function");var h=n.name.toUpperCase();this._functions||(this._functions={});this._functions[h]=n;this.recalcAll()},removeCustomFunction:function(n){this._functions&&n&&""!==n&&(n=n.toUpperCase(),this._functions.hasOwnProperty(n)&&
(delete this._functions[n],this.recalcAll()))},clearCustomFunctions:function(){this._functions&&(delete this._functions,this.recalcAll())},_findCustomFunction:function(n){if(!n||""===n)return null;var h=this.getCustomFunction(n);!h&&this.parent&&this.parent.getCustomFunction&&(h=this.parent.getCustomFunction(n));return h},getCustomName:function(n){return this._names?this._names[n]:null},addCustomName:function(n,h,a,b){if(!n||""===n||!h||""===h)throw Error("invalid custom name");this._names||(this._names=
{});h=this.getCalcService().parse(h,a,b);this._names[n]=new d.NameInfo(n,h,a,b);if(n=this._getSheetSource()._getNameCalc(n,!0))n.updateListening(!0,!0),n.addToDirty();this.recalcAll()},removeCustomName:function(n){if(this._names&&n&&""!==n&&this._names.hasOwnProperty(n)){delete this._names[n];if(n=this._getSheetSource()._getNameCalc(n))n.updateListening(!0,!1),n.addToDirty();this.recalcAll()}},clearCustomNames:function(){if(this._names){var n=this._names;delete this._names;for(var h=this._getSheetSource(),
a=0;a<n.length;a++){var d=h._getNameCalc(n[a]);d&&(d.updateListening(!0,!1),d.addToDirty())}this.recalcAll()}},_findCustomName:function(n){if(!n||""===n)return null;var h=this.getCustomName(n);!h&&this.parent&&this.parent.getCustomName&&(h=this.parent.getCustomName(n));return h},setFormula:function(n,h,a,b){var e=d.SheetArea;if(b!==e.colHeader&&b!==e.rowHeader){if(void 0===b||null===b)b=e.viewport;e=d.Events;if(0>n||n>=this.getRowCount()||0>h||h>=this.getColumnCount())this._trigger(e.InvalidOperation,
{sheet:this,sheetName:this._name,message:"Index out of range!"});else{var f=this._getSheetSource();f&&(f.setFormula(n,h,a),this._conditionalFormats&&this._conditionalFormats._clearCache(),1>this._eventHandler._eventSuspended&&this._trigger(e.CellChanged,{sheet:this,sheetName:this._name,row:n,col:h,sheetArea:b,propertyName:"formula"}))}}},getFormula:function(n,h,a){if(void 0===a||null===a||a===d.SheetArea.viewport)if(a=this._getSheetSource())return a.getFormula(n,h);return null},hasFormula:function(n,
h,a){if(void 0===a||null===a||a===d.SheetArea.viewport)if(a=this._getSheetSource())return a.hasFormula(n,h);return!1},_findFormulas:function(n,h,a,d){},_rebuildCalcNodes:function(){var n=this._getCalcModel();if(n){var h=this._getSheetSource();if(h)for(var a=n.nextNonNullRow(-1),d=n.getRowCount(),b=n.getColumnCount();0<=a&&a<d;){for(var e=n.nextNonNullColumn(a,-1);0<=e&&e<b;){var f=h._getCellCalc(a,e);f&&(f.stopListening(),f.startListening());e=n.nextNonNullColumn(a,e)}a=n.nextNonNullRow(a)}}},_name:"",
defaults:null,gridline:null,borderColor:"black",borderWidth:1,_zoomFactor:1,frozenRowCount:0,frozenColCount:0,rowHeaderVisible:!0,colHeaderVisible:!0,rowHeaderAutoText:d.HeaderAutoText.numbers,colHeaderAutoText:d.HeaderAutoText.letters,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,rowRangeGroup:null,colRangeGroup:null,_activeRowIndex:0,_activeColIndex:0,activeRowViewportIndex:0,activeColViewportIndex:0,_allowCellOverflow:!1,maxCellOverflowDistance:100,showEditingLocator:!0,keyMap:null,isProtected:!1,
_allowUndo:!0,_paintSuspended:!1,_layoutSuspended:0,checkingChanges:!1,autoGenerateColumns:!0,_allowEditorReservedLocations:!0,_sheetTabColor:null,_frozenlineColor:"black",toJSON:function(){return{name:this._name,defaults:this.defaults,columns:this._colInfos,rows:this._rowInfos,autoGenerateColumns:this.autoGenerateColumns,dataSource:this._dataSource,frozenRowCount:this.frozenRowCount,frozenColCount:this.frozenColCount,rowCount:this.getRowCount(),columnCount:this.getColumnCount(),data:this._dataModel.toJSON(),
sparklineGroupManager:this._sparklineGroupManager.toJSON(),spans:this._spanModel.toJSON(),selections:this._selectionModel.toJSON(),activeRow:this._activeRowIndex,activeCol:this._activeColIndex,gridline:this.gridline,allowCellOverflow:this._allowCellOverflow,referenceStyle:this.referenceStyle(),_zoomFactor:this._zoomFactor,theme:this.currentTheme(),showRowRangeGroup:this._showRowRangeGroup,showColumnRangeGroup:this._showColumnRangeGroup,rowRangeGroup:this.rowRangeGroup.toJSON(),colRangeGroup:this.colRangeGroup.toJSON(),
rowFilter:this._rowFilter?this._rowFilter.toJSON():void 0,conditionalFormats:this.getConditionalFormats().toJSON(),sheetTabColor:this._sheetTabColor,frozenlineColor:this._frozenlineColor,rowHeaderAutoText:this.rowHeaderAutoText,colHeaderAutoText:this.colHeaderAutoText,rowHeaderAutoTextIndex:this.rowHeaderAutoTextIndex,colHeaderAutoTextIndex:this.colHeaderAutoTextIndex,rowHeaderVisible:this.rowHeaderVisible,colHeaderVisible:this.colHeaderVisible,rowHeaderColCount:this.getColumnCount(d.SheetArea.rowHeader),
colHeaderRowCount:this.getRowCount(d.SheetArea.colHeader),rowHeaderData:this._rowHeaderModel.toJSON(),colHeaderData:this._colHeaderModel.toJSON(),rowHeaderSpan:this._rowHeaderSpanModel.toJSON(),colHeaderSpan:this._colHeaderSpanModel.toJSON(),rowHeaderColInfos:this._rowHeaderColInfos,colHeaderRowInfos:this._colHeaderRowInfos,clipBoardOptions:this._clipBoardOptions,isProtected:this.isProtected,borderColor:this.borderColor,borderWidth:this.borderWidth,allowDragDrop:this._allowDragDrop,allowDragFill:this._allowDragFill,
allowUndo:this._allowUndo,allowEditorReservedLocations:this._allowEditorReservedLocations}},fromJSON:function(n){if(n){var h=this.isPaintSuspended();this.isPaintSuspended(!0);try{var b=n.rowCount,e=n.columnCount;this._name=n.name;n.defaults&&(this.defaults=n.defaults);this.setRowCount(b);this.setColumnCount(e);this.setActiveCell(n.activeRow,n.activeCol);this.frozenRowCount=n.frozenRowCount;this.frozenColCount=n.frozenColCount;this.gridline=n.gridline;this._allowCellOverflow=n.allowCellOverflow;"undefined"!==
typeof n.autoGenerateColumns&&(this.autoGenerateColumns=n.autoGenerateColumns);n.dataSource&&(this._dataSource=n.dataSource);n.rows&&(this._rowInfos=n.rows,this._rowInfos.length=b);n.columns&&(this._colInfos=n.columns,this._colInfos.length=e);if(n.colStyles)for(var f in n.colStyles)if(!isNaN(f)){var k=parseInt(f,10);this.setStyle(-1,k,n.colStyles[f],a.UI.SheetArea.viewport)}if(n.rowStyles)for(f in n.rowStyles)if(!isNaN(f)){var l=parseInt(f,10);this.setStyle(l,-1,n.rowStyles[f],a.UI.SheetArea.viewport)}"undefined"!==
typeof n.rowHeaderAutoText&&(this.rowHeaderAutoText=n.rowHeaderAutoText);"undefined"!==typeof n.colHeaderAutoText&&(this.colHeaderAutoText=n.colHeaderAutoText);"undefined"!==typeof n.rowHeaderAutoTextIndex&&(this.rowHeaderAutoTextIndex=n.rowHeaderAutoTextIndex);"undefined"!==typeof n.colHeaderAutoTextIndex&&(this.colHeaderAutoTextIndex=n.colHeaderAutoTextIndex);"undefined"!==typeof n.rowHeaderVisible&&(this.rowHeaderVisible=n.rowHeaderVisible);"undefined"!==typeof n.colHeaderVisible&&(this.colHeaderVisible=
n.colHeaderVisible);"undefined"!==typeof n.rowHeaderColCount&&this.setColumnCount(n.rowHeaderColCount,d.SheetArea.rowHeader);"undefined"!==typeof n.colHeaderRowCount&&this.setRowCount(n.colHeaderRowCount,d.SheetArea.colHeader);n.rowHeaderData&&this._rowHeaderModel.fromJSON(n.rowHeaderData);n.colHeaderData&&this._colHeaderModel.fromJSON(n.colHeaderData);n.rowHeaderSpan&&this._rowHeaderSpanModel.fromJSON(n.rowHeaderSpan);n.colHeaderSpan&&this._colHeaderSpanModel.fromJSON(n.colHeaderSpan);n.rowHeaderColInfos&&
(this._rowHeaderColInfos=n.rowHeaderColInfos);n.colHeaderRowInfos&&(this._colHeaderRowInfos=n.colHeaderRowInfos);"undefined"!==typeof n.referenceStyle&&this.referenceStyle(n.referenceStyle);"undefined"!==typeof n._zoomFactor&&(this._zoomFactor=n._zoomFactor);n.spans&&this._spanModel.fromJSON(n.spans);n.selections&&(this._clearSelectionImp(),this._selectionModel.fromJSON(n.selections));if(n.data){this._dataModel.fromJSON(n.data);var s=n.data.dataTable;if(s)for(var q in s)if(typeof q!==g)for(var t in s[q])if(typeof t!==
g){var m=s[q][t].formula;m&&this.setFormula(parseInt(q,10),parseInt(t,10),m)}}if(n.sparklineGroupManager){this._sparklineGroupManager.fromJSON(n.sparklineGroupManager);for(var r=this._sparklineGroupManager.groups(),u=this._getModel(),p,K,b=0;b<r.length;b++)for(p=r[b]._innerList,q=0;q<p.length;q++)K=p[q],u.setSparkline(K.row,K.column,K)}if(n.theme){var A=n.theme;if("string"===typeof A||"undefined"===typeof A)this.currentTheme(A);else{var L=A._themeColor,D=L._colorList[2],w=L._colorList[3],M=L._colorList[0],
T=L._colorList[1],P=L._colorList[4],ia=L._colorList[5],v=L._colorList[6],V=L._colorList[7],N=L._colorList[8],R=L._colorList[9],ga=L._colorList[10],ba=L._colorList[11],W=new d.ThemeColor(A._name,new d._Color(D.a,D.r,D.g,D.b),new d._Color(w.a,w.r,w.g,w.b),new d._Color(M.a,M.r,M.g,M.b),new d._Color(T.a,T.r,T.g,T.b),new d._Color(P.a,P.r,P.g,P.b),new d._Color(ia.a,ia.r,ia.g,ia.b),new d._Color(v.a,v.r,v.g,v.b),new d._Color(V.a,V.r,V.g,V.b),new d._Color(N.a,N.r,N.g,N.b),new d._Color(R.a,R.r,R.g,R.b),new d._Color(ga.a,
ga.r,ga.g,ga.b),new d._Color(ba.a,ba.r,ba.g,ba.b)),ja=new d.SpreadTheme(A._name,W,A._headingFont,A._bodyFont);this.currentTheme(ja)}}"undefined"!==typeof n.showRowRangeGroup&&(this._showRowRangeGroup=n.showRowRangeGroup);"undefined"!==typeof n.showColumnRangeGroup&&(this._showColumnRangeGroup=n.showColumnRangeGroup);n.rowRangeGroup&&this.rowRangeGroup.fromJSON(n.rowRangeGroup);n.colRangeGroup&&this.colRangeGroup.fromJSON(n.colRangeGroup);if(n.rowFilter){var fa=n.rowFilter.range,la=new d.HideRowFilter(new d.Range(fa.row,
fa.col,fa.rowCount,fa.colCount));this.rowFilter(la);la.fromJSON(n.rowFilter)}else this.rowFilter(null);n.conditionalFormats&&this.getConditionalFormats().fromJSON(n.conditionalFormats);n.sheetTabColor&&this.sheetTabColor(n.sheetTabColor);n.frozenlineColor&&this.frozenlineColor(n.frozenlineColor);"undefined"!==typeof n.clipBoardOptions&&(this._clipBoardOptions=n.clipBoardOptions);"undefined"!==typeof n.isProtected&&(this.isProtected=n.isProtected);n.borderColor&&(this.borderColor=n.borderColor);"undefined"!==
typeof n.borderWidth&&(this.borderWidth=n.borderWidth);"undefined"!==typeof n.allowDragDrop&&(this._allowDragDrop=n.allowDragDrop);"undefined"!==typeof n.allowDragFill&&(this._allowDragFill=n.allowDragFill);"undefined"!==typeof n.allowUndo&&this.allowUndo(n.allowUndo);"undefined"!==typeof n.allowEditorReservedLocations&&this.allowEditorReservedLocations(n.allowEditorReservedLocations)}finally{this.isPaintSuspended(h)}}},isPaintSuspended:function(n){if(0===arguments.length)return this._paintSuspended;
this._paintSuspended!==n&&(this._paintSuspended=n,!n&&0>=this._layoutSuspended&&(this.invalidateLayout(),this.repaint()));return this},getName:function(){return this._name},setName:function(n){if(!this._isValidSheetName(n))throw"NotSupportedException";this._name=n;this.parent&&this.parent._doTabHSResize&&this.parent._doTabHSResize()},allowCellOverflow:function(n){if(0===arguments.length)return this._allowCellOverflow;var h=this;return this._bindToAutoRefresh(function(n){h._allowCellOverflow=n;return h})(n)},
allowUndo:function(n){if(0===arguments.length)return this._allowUndo;this._allowUndo=n;var h=this.undoManager();h&&(h._allowUndo=n);return this},allowEditorReservedLocations:function(n){if(0===arguments.length)return this._allowEditorReservedLocations;this._allowEditorReservedLocations=n;return this},sheetTabColor:function(n){if(0===arguments.length)return this._sheetTabColor;this._sheetTabColor=n;this.parent&&this.parent._doTabHSResize&&this.parent._doTabHSResize();return this},frozenlineColor:function(n){if(0===
arguments.length)return this._frozenlineColor;var h=this;return this._bindToAutoRefresh(function(n){h._frozenlineColor=n;return h})(n)},addRows:function(n,h){if(!(0>=h)){var a=this.getDataSource();if(a&&this._isDataView(a)){if(!a.canAdd||!a.canAdd())return;n=this.getRowCount()}var b=this.isPaintSuspended();this.isPaintSuspended(!0);try{if(0>n||n>this.getRowCount())n=this.getRowCount();var e=this._getSheetSource();if(e)e.onBeforeAddRemoveRows(n);var f=this._getModel();f.addRows(n,h);if(a){var g=this._getDataItemType(a);
if(this._isDataView(a)){if(!this._dataViewUpdating){this._updatingDataView=!0;if(g){for(var k=0;k<h;k++)a.add(new g);a.commitEdit()}this._updatingDataView=!1}}else if(!this._isCellBinding(a))for(k=0;k<h;k++)g?a.splice(n,0,new g):a.splice(n,0,null)}this._getCalcModel().addRows(n,h);var l=d.SheetArea;this._getModel(l.rowHeader).addRows(n,h);f.addElements(this._rowInfos,this.getRowCount(),n,h);var s=this._getSpanModel(l.rowHeader);s.addRows(n,h);s=this._getSpanModel();s.addRows(n,h);this._rowFilter&&
this._rowFilter._addRows(n,h);this.rowRangeGroup&&this.rowRangeGroup._add(n,h);this._sparklineGroupManager&&this._sparklineGroupManager._addRows(n,h);this._conditionalFormats&&this._conditionalFormats._addRows(n,h);if(e)e.onAfterAddRows(n,h);this._syncScrollbarSize();this.invalidateLayout()}finally{this.isPaintSuspended(b)}}},_onDataDeleted:function(n){},deleteRows:function(n,h){if(!(0>n||n>=this.getRowCount()||0>=h)){var a=this.getDataSource();if(!a||!this._isDataView(a)||a.canRemove&&a.canRemove()){var b=
this.isPaintSuspended();this.isPaintSuspended(!0);try{var e=this._getSheetSource();if(e)e.onBeforeAddRemoveRows(n);var f=this._getModel();if(this.autoUpdate&&this.dataContext&&this.dataContext.remove&&a&&0<a.length){var g=this;this._dataDeleteDelegate=function(h){return g._onDataDeleted(h)};if(0<=n){var k=this.getDataItem(n);l.ajax({url:this.dataContext.remove,type:"POST",data:JSON.stringify(k),dataType:"json",contentType:"application/json;charset=UTF-8",success:this._dataDeleteDelegate})}}this.deletedRows||
(this.deletedRows=[]);for(var s=this._getDataLength(a),k=0;k<h&&n+k<f.rowCount;k++){var q=null;a&&n+k<s&&(q=this._getDataItem(a,n+k));var t=null;f.dataTable&&f.dataTable[n+k]&&(t=f.dataTable[n+k].key);this.deletedRows.push({row:n+k,data:q,key:t})}if(a)if(this._isDataView(a)){if(!this._dataViewUpdating){this._updatingDataView=!0;for(var m=Math.min(h,s-n),s=0;s<m;s++)a.remove(a.item(n));this._updatingDataView=!1}}else this._isCellBinding(a)||n<s&&a.splice(n,h);f.deleteRows(n,h);this._getCalcModel().deleteRows(n,
h);var r=d.SheetArea;this._getModel(r.rowHeader).deleteRows(n,h);f.deleteElements(this._rowInfos,this.getRowCount(),n,h);var u=this._getSpanModel(r.rowHeader);u.removeRows(n,h);u=this._getSpanModel();u.removeRows(n,h);this._rowFilter&&this._rowFilter._removeRows(n,h);this.rowRangeGroup&&this.rowRangeGroup._remove(n,h);this._sparklineGroupManager&&this._sparklineGroupManager._removeRows(n,h);this._conditionalFormats&&this._conditionalFormats._removeRows(n,h);var p=this._scrollTopRow;if(0<=p){a=-1;
for(f=p;f>=this.frozenRowCount;f--)if(this.getRowVisible(f)&&0<this._getZoomRowHeight(f)){a=f;break}-1===a&&(a=0);p!==a&&(this._trigger(d.Events.TopRowChanged,{sheet:this,sheetName:this._name,oldTopRow:p,newTopRow:a}),this._scrollTopRow=a,this._syncVScrollbarPosition())}if(e)e.onAfterRemoveRows(n,h);this._syncScrollbarSize();this.invalidateLayout()}finally{this.isPaintSuspended(b)}}}},addColumns:function(n,h){0>=h||this._bindToAutoRefresh(function(h,n){if(0>h||h>this.getColumnCount())h=this.getColumnCount();
if(!this.parent||!this.parent.gcSpreadsheet){var a=this._getSheetSource();if(a)a.onBeforeAddRemoveColumns(h);var b=this._getModel();b.addColumns(h,n);this._getCalcModel().addColumns(h,n);var e=d.SheetArea;this._getModel(e.colHeader).addColumns(h,n);b.addElements(this._colInfos,this.getColumnCount(),h,n);b=this._getSpanModel(e.colHeader);b.addColumns(h,n);b=this._getSpanModel();b.addColumns(h,n);this._rowFilter&&this._rowFilter._addColumns(h,n);!0===this._allowCellOverflow&&this._clearCellOverflowModelCache();
this.colRangeGroup&&this.colRangeGroup._add(h,n);this._sparklineGroupManager&&this._sparklineGroupManager._addColumns(h,n);this._conditionalFormats&&this._conditionalFormats._addColumns(h,n);if(a)a.onAfterAddColumns(h,n);this._syncScrollbarSize();this.invalidateLayout()}})(n,h)},deleteColumns:function(n,h){0>n||n>=this.getColumnCount()||0>=h||this.parent&&this.parent.gcSpreadsheet||this._bindToAutoRefresh(function(h,n){var a=this._getSheetSource();if(a)a.onBeforeAddRemoveColumns(h);var b=this._getModel();
b.deleteColumns(h,n);this._getCalcModel().deleteColumns(h,n);var e=d.SheetArea;this._getModel(e.colHeader).deleteColumns(h,n);b.deleteElements(this._colInfos,this.getColumnCount(),h,n);b=this._getSpanModel(e.colHeader);b.removeColumns(h,n);b=this._getSpanModel(e.viewport);b.removeColumns(h,n);this._rowFilter&&this._rowFilter._removeColumns(h,n);!0===this._allowCellOverflow&&this._clearCellOverflowModelCache();this.colRangeGroup&&this.colRangeGroup._remove(h,n);this._sparklineGroupManager&&this._sparklineGroupManager._removeColumns(h,
n);this._conditionalFormats&&this._conditionalFormats._removeColumns(h,n);e=this._scrollLeftCol;if(0<=e){for(var b=-1,f=e;f>=this.frozenColCount;f--)if(this.getColumnVisible(f)&&0<this._getZoomColumnWidth(f)){b=f;break}-1===b&&(b=0);e!==b&&(this._trigger(d.Events.LeftColumnChanged,{sheet:this,sheetName:this._name,oldLeftCol:e,newLeftCol:b}),this._scrollLeftCol=b,this._syncHScollbarPosition())}if(a)a.onAfterRemoveColumns(h,n);this._syncScrollbarSize();this.invalidateLayout()})(n,h)},setFrozenCount:function(n,
h){if(void 0===n||null===n||0>n||isNaN(n))n=0;if(void 0===h||null===h||0>h||isNaN(h))h=0;this._bindToAutoRefresh(function(h,n){var a=!1;this.frozenRowCount!==h&&(this._scrollTopRow+=h-this.frozenRowCount,this.frozenRowCount=h,a=!0);this.frozenColCount!==n&&(this._scrollLeftCol+=n-this.frozenColCount,this.frozenColCount=n,a=!0);a&&(this.invalidateLayout(),this._syncScrollbarSize())})(n,h)},getRowCount:function(n){return(n=this._getModel(n))?n.rowCount:0},getColumnCount:function(n){return(n=this._getModel(n))?
n.colCount:0},setRowCount:function(n,h){n=parseInt(n,10);isNaN(n)||0>n||this._bindToAutoRefresh(function(h,n){var a=d.SheetArea;if(void 0===n||null===n)n=a.viewport;n===a.viewport||n===a.rowHeader?(this._dataModel.rowCount>h&&this.deleteRows(h,this._dataModel.rowCount-h),this._dataModel.rowCount=this._calcDataModel.rowCount=this._rowHeaderModel.rowCount=h,this.frozenRowCount>h&&this.setFrozenCount(h,this.frozenColCount),this._rowInfos||(this._rowInfos={}),this.rowRangeGroup&&this.rowRangeGroup._setCount(h)):
n===a.colHeader&&(this._colHeaderRowInfos||(this._colHeaderRowInfos={}),this._colHeaderModel.rowCount=h);this.rowRangeGroup&&this.rowRangeGroup.refresh();this._syncScrollbarSize();this._activeRowIndex>=h&&(n===a.viewport||n===a.rowHeader)&&(this._clearSelectionImp(),this._setActiveCellImp(-1,-1,this.activeRowViewportIndex,this.activeColViewportIndex))})(n,h)},setColumnCount:function(n,h){n=parseInt(n,10);isNaN(n)||0>n||this._bindToAutoRefresh(function(h,n){var a=d.SheetArea;if(void 0===n||null===
n)n=a.viewport;n===a.viewport||n===a.colHeader?(this._dataModel.colCount>h&&this.deleteColumns(h,this._dataModel.colCount-h),this._dataModel.colCount=this._calcDataModel.colCount=this._colHeaderModel.colCount=this._colFooterModel.colCount=h,this.frozenColCount>h&&this.setFrozenCount(this.frozenRowCount,h),this._colInfos||(this._colInfos={}),this.colRangeGroup&&this.colRangeGroup._setCount(h)):n===a.rowHeader&&(this._rowHeaderColInfos||(this._rowHeaderColInfos={}),this._rowHeaderModel.colCount=h);
this.colRangeGroup&&this.colRangeGroup.refresh();this._syncScrollbarSize();this._activeColIndex>=h&&(n===a.viewport||n===a.colHeader)&&(this._clearSelectionImp(),this._setActiveCellImp(-1,-1,this.activeRowViewportIndex,this.activeColViewportIndex))})(n,h)},getText:function(n,h,a){if(void 0===a||null===a)a=d.SheetArea.viewport;var b=this.getValue(n,h,a);if(void 0===b||null===b)return"";var e=this.getCellType(n,h,a);n=this.getActualStyle(n,h,a);return b=e.format(b,n.formatter?n.formatter:n._autoFormatter)},
setText:function(n,h,a,b){this._bindToAutoRefresh(function(h,n,a,b){if(void 0===b||null===b)b=d.SheetArea.viewport;var e=a,f=this.getCellType(h,n,b),g=this.getCell(h,n,b).formatter();f&&g&&(e=f.parse(a,g));this.setValue(h,n,e,b)})(n,h,a,b)},getValue:function(n,h,a){var b=d.SheetArea;if(void 0===a||null===a)a=b.viewport;var e=this._getModel(a);if(!e)return null;var f=this._getValueImp(e,n,h,a),g=d.HeaderAutoText,k;k=p.ko;if(a===b.colHeader){if(void 0===f||null===f)if(a=this.getDataSource(),(this._isDataView(a)||
a&&0<a.length||k&&k.isObservable(a))&&(k=this._colInfos[h])&&(0<=this.colHeaderAutoTextIndex&&n===this.colHeaderAutoTextIndex||-1===this.colHeaderAutoTextIndex&&n===e.rowCount-1)&&(f=k.displayName||k.name),void 0===f||null===f){k=this.colHeaderAutoTextIndex;if(0>k||k>=e.rowCount)k=e.rowCount-1;n===k&&(this.colHeaderAutoText===g.letters?f=this._indexToLetters(h+1):this.colHeaderAutoText===g.numbers&&(f=h+1))}}else if(a===b.rowHeader&&(void 0===f||null===f)){k=this.rowHeaderAutoTextIndex;if(0>k||k>=
e.colCount)k=e.colCount-1;h===k&&(this.rowHeaderAutoText===g.letters?f=this._indexToLetters(n+1):this.rowHeaderAutoText===g.numbers&&(f=n+1))}return f},setValue:function(n,h,a,b,e){this._bindToAutoRefresh(function(h,n,a,b,e){if(void 0===b||null===b)b=d.SheetArea.viewport;var f=this._getModel(b);if(f){var I=f.rowCount,k=f.colCount;if(!(0>h||h>=I||0>n||n>=k)){void 0!==a&&null!==a&&a.constructor===Date&&(a="/Date("+a.getTime()+")/");var I=this._getValueImp(f,h,n,b),E=p.ko;if(void 0===b||null===b||b===
d.SheetArea.viewport){k=!1;if(this._dataSource)if(this._isDataView(this._dataSource)){var l=this._dataSource.count();if(h<l&&(l=this._dataSource.item(h))){var s=this._colInfos[n];s&&s.name&&0<s.name.length&&(this._dataSource.setProperty(l,s.name,a),k=!0)}}else if(E&&E.isObservable(this._dataSource)){if(l=this._dataSource().length,h<l&&(l=this._dataSource()[h])&&(s=this._colInfos[n])&&s.name&&0<s.name.length){if(typeof s.value===g)s.value(l,a);else if("undefined"!==typeof E&&E.isWriteableObservable(l[s.name]))l[s.name](a);
else l[s.name]=a;k=!0}}else if(this._isCellBinding(this._dataSource)){if(E=this.getBindingPath(h,n,b))this._dataSource.setValue(E,a),k=!0}else if(l=this._dataSource.length,h<l&&(l=this._dataSource[h])&&(s=this._colInfos[n])&&s.name&&0<s.name.length){if(typeof s.value===g)s.value(l,a);else if("undefined"!==typeof E&&E.isWriteableObservable(l[s.name]))l[s.name](a);else l[s.name]=a;k=!0}if(!k||this.checkingChanges)f.setValue(h,n,a),this._activeRowDirty=!0}else f.setValue(h,n,a);void 0!==b&&null!==b&&
b!==d.SheetArea.viewport||e||this._recalcCell(f,h,n);this._allowCellOverflow&&this._clearCellOverflowModelCachebyRow(h,b);this._conditionalFormats&&this._conditionalFormats._clearCache();I!==a&&this._trigger(d.Events.CellChanged,{sheet:this,sheetName:this._name,row:h,col:n,sheetArea:b,propertyName:"value",_oldValue:I})}}})(n,h,a,b,e)},sortRange:function(n,h,a,b,e,f){return this._bindToAutoRefresh(function(h,n,a,b,e,f){var g=this.isPaintSuspended();this.isPaintSuspended(!0);try{var I=this.getSpans(new d.Range(h,
n,a,b));if(I&&0<I.length)return!1;var k=this.getRowCount(),E=this.getColumnCount(),l,q,t,m,r,u,O,H,V;-1===h&&(h=0);-1===a&&(a=k);-1===n&&(n=0);-1===b&&(b=E);if(0>h||h>=k||0>n||n>=E||0>a||h+a>k||0>b||n+b>E||!f)return!1;if(O=this._quickSort(h,n,a,b,e,f)){var N=this._getModel(),R=this._getCalcModel(),p=this._getSheetSource(),ba,W,ja;if(e)for(q=h;q<h+a;q++){if(ba=this._getSwapIndex(O,h,q,a,!0),q!==ba)for(t=q,r=ba,l=n;l<n+b;l++){m=l;H=this.getValue(t,m);V=this.getValue(r,m);var fa=p._getCellCalc(t,m,!1);
fa&&fa.hasListeners()&&fa.addListenersToAdjust();var la=p._getCellCalc(r,m,!1);la&&la.hasListeners()&&la.addListenersToAdjust();R.swapNode(t,m,r,m);W=s._copyExpression(R.getFormula(t,m),t,m);R.setFormula(t,m,W);(ja=p._getCellCalc(t,m,!!W))&&ja.startListening();W=s._copyExpression(R.getFormula(r,m),r,m);R.setFormula(r,m,W);(ja=p._getCellCalc(r,m,!!W))&&ja.startListening();p._controller.adjustFormulasOnSwap(R,t,m,R,r,m,1,1);N.swapNode(t,m,r,m);this.setValue(t,m,V);this.setValue(r,m,H)}}else for(l=n;l<
n+b;l++)if(ba=this._getSwapIndex(O,n,l,b,!1),l!==ba)for(m=l,u=ba,q=h;q<h+a;q++)t=q,H=this.getValue(t,m),V=this.getValue(t,u),(fa=p._getCellCalc(t,m,!1))&&fa.hasListeners()&&fa.addListenersToAdjust(),(la=p._getCellCalc(t,u,!1))&&la.hasListeners()&&la.addListenersToAdjust(),R.swapNode(t,m,t,u),W=s._copyExpression(R.getFormula(t,m),t,m),R.setFormula(t,m,W),(ja=p._getCellCalc(t,m,!!W))&&ja.startListening(),W=s._copyExpression(R.getFormula(t,u),t,u),R.setFormula(t,u,W),(ja=p._getCellCalc(t,u,!!W))&&ja.startListening(),
p._controller.adjustFormulasOnSwap(R,t,m,R,t,u,1,1),N.swapNode(t,m,t,u),this.setValue(t,m,V),this.setValue(t,u,H);return!0}return!1}finally{this.resumeCalcService();this.resumeEvent();for(e=0;e<a;e++)for(f=0;f<b;f++)this._raiseCellChanged("value",h+e,n+f,d.SheetArea.viewport);this._raisePropertyChanged("[sort]");this.isPaintSuspended(g)}})(n,h,a,b,e,f)},getActualStyle:function(n,h,a,b){if(void 0===a||null===a)a=d.SheetArea.viewport;var e=new d.Style,f=this.getCompositeStyle(n,h,a);if(a===d.SheetArea.viewport&&
!b){if((b=f.formatter)&&b.HasFormatedColor&&b.HasFormatedColor()){var g={};b.Format(this.getValue(n,h),g);g.value&&(e.foreColor=g.value)}if((b=this._conditionalFormats)&&0<b.count())for(b=b.getRules(n,h),g=0;g<b.length;g++){var k=b[b.length-1-g];k&&(k.isScaleRule()?k instanceof d.DataBarRule||k instanceof d.IconSetRule||!(k=k.evaluate(this,n,h,this.getValue(n,h,a)))||(e.backColor=k):(k=k.evaluate(this,n,h,this.getValue(n,h,a)),null!==k&&void 0!==k&&e.compose(k)))}}e.compose(f);if(void 0===e.locked||
null===e.locked)e.locked=!0;return e._normalize(new d._ThemeContext(this))},getStyle:function(n,h,a){if(void 0===a||null===a)a=d.SheetArea.viewport;return(a=this._getModel(a))?a.getStyle(n,h):null},setStyle:function(n,h,a,b){this._bindToAutoRefresh(function(h,n,a,b){var e=d.SheetArea;if(void 0===b||null===b)b=e.viewport;var f=this._getModel(b);f&&(f.setStyle(h,n,a),a&&a.formatter&&(a=a.formatter,"string"===typeof a&&(a=new d.GeneralFormatter(a)),a&&typeof a.Init===g&&a.Init()),a=d.Events,-1!==h&&
-1!==n?this._trigger(a.CellChanged,{sheet:this,sheetName:this._name,row:h,col:n,sheetArea:b,propertyName:"[styleinfo]"}):-1!==h&&-1===n?this._trigger(a.RowChanged,{sheet:this,sheetName:this._name,row:h,sheetArea:b,propertyName:"[styleinfo]"}):-1===h&&-1!==n&&this._trigger(a.ColumnChanged,{sheet:this,sheetName:this._name,col:n,sheetArea:b,propertyName:"[styleinfo]"}));this._allowCellOverflow&&(b===e.colHeader||-1===h?this._clearCellOverflowModelCache():b!==e.viewport&&-1!==n||this._clearCellOverflowModelCachebyRow(h,
b))})(n,h,a,b)},getDefaultStyle:function(n){var h=d.SheetArea;if(void 0===n||null===n)n=h.viewport;var a=this._getModel(n);if(a){var b=a.getStyle(-1,-1),e=new d.Style;n===h.colHeader||n===h.rowHeader?(e.foreColor="black",e.hAlign=d.HorizontalAlign.center,e.vAlign=d.VerticalAlign.center):(e.foreColor="black",e.hAlign=d.HorizontalAlign.general,e.vAlign=d.VerticalAlign.top);if(b)return b.compose(e),b;a.setStyle(-1,-1,e);return e}return null},setDefaultStyle:function(n,h){if(void 0===h||null===h)h=d.SheetArea.viewport;
var a=this._getModel(h);a&&a.setStyle(-1,-1,n)},getCompositeStyle:function(n,h,a){if(void 0===a||null===a)a=d.SheetArea.viewport;var b=new d.Style,e=this._getModel(a);if(e){var f=e.rowCount,g=e.colCount;if(0<=n&&n<f&&0<=h&&h<g){var k=e.getStyle(n,h);k&&b.compose(k)}0<=n&&n<f&&(n=e.getStyle(n,-1))&&b.compose(n);0<=h&&h<g&&(n=e.getStyle(-1,h))&&b.compose(n)}(h=this.getDefaultStyle(a))&&b.compose(h);return b},getCellType:function(n,h,a){if((n=this.getActualStyle(n,h,a))&&n.cellType)return n.cellType;
this._defaultCellType||(this._defaultCellType=new d.TextCellType);return a===d.SheetArea.corner?new d.CornerCellType:a===d.SheetArea.colHeader?new d.ColumnHeaderCellType:a===d.SheetArea.rowHeader?new d.RowHeaderCellType:this._defaultCellType},setCellType:function(n,h,a,b){var e=this.getStyle(n,h,b);e||(e=new d.Style);e.cellType=a;this.setStyle(n,h,e,b)},getFormatter:function(n,h,a){return(n=this.getActualStyle(n,h,a))?n.formatter:void 0},setFormatter:function(n,h,a,b){var e=this.getStyle(n,h,b);e||
(e=new d.Style);e.formatter=a;this.setStyle(n,h,e,b)},getDataValidator:function(n,h,a){return(n=this.getActualStyle(n,h,a))?n.validator:void 0},setDataValidator:function(n,h,a,b){if(void 0===b||null===b)b=d.SheetArea.viewport;var e=this.getStyle(n,h,b);e||(e=new d.Style);e.validator=a;this.setStyle(n,h,e,b);a&&(a.condition instanceof d.FormulaCondition&&(void 0===a.condition._baseRow||null===a.condition._baseRow)&&(a.condition._baseRow=-1!==n?n:0),a.condition instanceof d.FormulaCondition&&(void 0===
a.condition._baseCol||null===a.condition._baseCol)&&(a.condition._baseCol=-1!==h?h:0));a=d.Events;this._trigger(a.CellChanged,{sheet:this,sheetName:this._name,row:n,col:h,sheetArea:b,propertyName:"validator"});-1!==n&&-1===h?this._trigger(a.RowChanged,{sheet:this,sheetName:this._name,row:n,sheetArea:b,propertyName:"validator"}):-1===n&&-1!==h&&this._trigger(a.ColumnChanged,{sheet:this,sheetName:this._name,col:h,sheetArea:b,propertyName:"validator"})},isValid:function(a,h,d){try{this._validatingRow=
a;this._validatingColumn=h;this._validatingValue=d;this._isValidatingCell=!0;var b=this.getDataValidator(a,h);if(b)return b.isValid(this,a,h,d)}finally{this._validatingColumn=this._validatingRow=-1,this._validatingValue=null,this._isValidatingCell=!1}return!0},addSelection:function(a,h,b,e){this._bindToAutoRefresh(function(h,a,n,b){var e=h,f=a,g=n,k=b;if(-1!==e&&-1!==f){var I=this._getSpanModel().slice(0);I&&0<I.length&&(h=this._cellRangeInflate(I,new d.Range(h,a,n,b)),e=h.row,f=h.col,g=h.rowCount,
k=h.colCount)}this._selectionModel.add(e,f,g,k)})(a,h,b,e)},getSelections:function(){return this._selectionModel},_addSpanImp:function(a,h,b,e,f){this._bindToAutoRefresh(function(h,a,n,b,e){if(void 0===e||null===e)e=d.SheetArea.viewport;var f=this._getSpanModel(e);f.clear(h,a,n,b);var g=new d.Range(h,a,n,b),k=this._getActualRange(g,e);f.push(k);if(this._allowCellOverflow)for(g=h;g<h+n;g++)this._clearCellOverflowModelCachebyRow(g,e);e=this.getSelections();for(f=0;f<e.length;f++)e[f].intersect(h,a,
n,b)&&(e[f]=e[f].union(g))})(a,h,b,e,f)},addSpan:function(a,h,b,e,f){if((1!==b||1!==e)&&f!==d.SheetArea.corner){for(var g=this._getSpanModel(f).getEnumerator(a,h,b,e),k=!0;g.moveNext();){var l=g.current();if(!(new d.Range(a,h,b,e)).containsRange(l)){k=!1;break}}if(!k)throw Error("Invalid range");this._addSpanImp(a,h,b,e,f)}},removeSpan:function(a,h,b){this._bindToAutoRefresh(function(h,a,n){if(void 0===n||null===n)n=d.SheetArea.viewport;for(var b=this._getSpanModel(n),e=0;e<b.length;e++){var f=b[e];
if(f.row===h&&f.col===a){b.splice(e,1);if(this._allowCellOverflow)for(h=f.row;h<f.row+f.rowCount;h++)this._clearCellOverflowModelCachebyRow(h,n);break}}})(a,h,b)},repaint:function(a){this._paintSuspended||this._render.repaint(a)},startEdit:function(a,h){this._startEditImp(this._getCanvas(),this._activeRowIndex,this._activeColIndex,null,null,a,h)},editorStatus:function(){return this._editorStatus?this._editorStatus:d.EditorStatus.Ready},isEditing:function(){return this._editorStatus===d.EditorStatus.Enter||
this._editorStatus===d.EditorStatus.Edit},doKeyDown:function(a){this._eventHandler.doKeyDown(a)},doKeyUp:function(a){this._eventHandler.doKeyUp(a)},removeKeyMap:function(a,h,d,b,e){if(this.keyMap)for(e=0;e<this.keyMap.length;e++){var f=this.keyMap[e];if(f&&f.key===a&&f.ctrl===h&&f.shift===d&&f.alt===b){this.keyMap.splice(e,1);break}}},addKeyMap:function(a,h,b,e,f){this.keyMap||(this.keyMap=[]);var g=this._getKeyAction(a,h,b,e);g?g.action=f:this.keyMap.push(new d.KeyMap(a,h,b,e,f))},moveActiveCell:function(a,
h,b,e,f,g){var k={sheet:this,sheetName:this._name,row:this._activeRowIndex,col:this._activeColIndex,cancel:!1};this._trigger(d.Events.LeaveCell,k);if(k&&!0===k.cancel||!this.endEdit())return!1;this._activeRowDirty&&(this.updateRecord(),this._activeRowDirty=!1);var k=this._activeRowIndex,l=this._activeColIndex;if(void 0===b||null===b)b=this._activeRowIndex;if(void 0===e||null===e)e=this._activeColIndex;var s=d.Direction;a===s.left?this._moveActiveCellLeft(b,e,h,!1,!1):a===s.right?this._moveActiveCellRight(b,
e,h,!1,!1):a===s.up?this._moveActiveCellUp(b,e,h,!1,!1):a===s.down&&this._moveActiveCellDown(b,e,h,!1,!1);return f=this.moveActiveCellEnd(a,k,l,f,g)},_moveActiveCellInSelection:function(a){var h={sheet:this,sheetName:this._name,row:this._activeRowIndex,col:this._activeColIndex,cancel:!1};this._trigger(d.Events.LeaveCell,h);if(!h||!0!==h.cancel){this.endEdit();this._activeRowDirty&&(this.updateRecord(),this._activeRowDirty=!1);var h=this._activeRowIndex,b=this._activeColIndex;a===d.Direction.left?
this._moveActiveCellLeftInSelection(this._activeRowIndex,this._activeColIndex):a===d.Direction.right&&this._moveActiveCellRightInSelection(this._activeRowIndex,this._activeColIndex);this.moveActiveCellEnd(a,h,b)}},subscriptionHandlers:[],doDataItemChanged:function(){var a=this;this.activeDataItemChangedhandler=function(h){a.repaint()};var h=this.getDataSource();if(h&&"undefined"!==typeof p.ko){for(;0<this.subscriptionHandlers.length;){var d=this.subscriptionHandlers.pop();typeof d.dispose===g&&d.dispose()}d=
null;this._isDataView(h)?(h.currentPosition&&h.currentPosition(this._activeRowIndex),d=h.currentItem()):this._isCellBinding(h)||(d=h[this._activeRowIndex]);if(d)for(var b in d)d[b]&&typeof d[b].subscribe===g&&this.subscriptionHandlers.push(d[b].subscribe(this.activeDataItemChangedhandler,null,null))}},moveActiveCellEnd:function(a,h,b,e,f){a=this._selectionModel.toArray();if(!this.shift&&!this._isNavigateInSelection){var g=this._fixRange(this._getActiveSelectedRange());if(1<this._selectionModel.length||
1<g.rowCount||1<g.colCount)e=!0;this._clearSelectionImp()}(g=this._spanModel.find(this._activeRowIndex,this._activeColIndex))?(this._activeRowCount=g.rowCount,this._activeColCount=g.colCount):this._activeColCount=this._activeRowCount=1;if(!this._isNavigateInSelection){var g=this._getExtendedRange(this._activeRowIndex,this._activeColIndex),k=this.selectionPolicy(),l=this.selectionUnit();k===d.SelectionPolicy.Single?this._selectionModel.clear():k===d.SelectionPolicy.Range&&this._selectionModel.clear();
l===d.SelectionUnit.Row?(g.col=-1,g.colCount=-1):l===d.SelectionUnit.Column&&(g.row=-1,g.rowCount=-1);this._replaceActiveSelectedRange(g.row,g.col,g.rowCount,g.colCount,!1);g=this._selectionModel.toArray();this._eventHandler._notEqualSelecions(a,g)&&(k=d.Events,this._trigger(k.SelectionChanging,{sheet:this,sheetName:this._name,oldSelections:a,newSelections:g}),this._trigger(k.SelectionChanged,{sheet:this,sheetName:this._name}))}g=this.frozenColCount?this._getNextVisualColumn(this.frozenColCount-1):
this._getFirstVisualColumn();a=this.frozenRowCount?this._getNextVisualRow(this.frozenRowCount-1):this._getFirstVisualRow();this._activeColIndex<this._scrollLeftCol&&this._activeColIndex>=g&&(f=this._setLeftColumn(this._getPrevVisualColumn(this._activeColIndex+1))||f);if(this._activeColIndex>this._getLastFullyVisibleColumn()&&this._activeColIndex<=this._getLastVisualColumn()){g=this._getColumnLayout(1);if(!g||0>=g.length)return!1;g=0;k=this._activeColIndex;for(l=this._getSheetLayout();k>this._scrollLeftCol;){g+=
this._getZoomColumnWidth(k);if(g>l.viewportWidth)break;k--}g=this._getNextVisualColumn(k);f=this._setLeftColumn(g)||f}this._activeRowIndex<this._scrollTopRow&&this._activeRowIndex>=a&&(f=this._setTopRow(this._getPrevVisualRow(this._activeRowIndex+1))||f);if(this._activeRowIndex>this._getLastFullyVisibleRow()&&this._activeRowIndex<=this._getLastVisualRow()){a=this._getRowLayout(1);if(!a||0>=a.length)return!1;this.frozenRowCount?this._getNextVisualRow(this.frozenRowCount-1):this._getFirstVisualRow();
a=0;g=this._activeRowIndex;for(k=this._getSheetLayout();g>this._scrollTopRow;){a+=this._getZoomRowHeight(g);if(a>k.viewportHeight)break;g--}a=this._getNextVisualRow(g);f=this._setTopRow(a)||f}this._activeRowIndex===this._getLastVisualRow()&&(f=this._setTopRow(this._getLastPageTopRow())||f);this._activeColIndex===this._getLastVisualColumn()&&(f=this._setLeftColumn(this._getLastPageLeftColumn())||f);h!=this._activeRowIndex&&this.doDataItemChanged();e&&!f?(this.invalidateLayout(),this.repaint(),e=!0):
e||f||((g=this._spanModel.find(h,b))?(a=g.rowCount,g=g.colCount):g=a=1,this._render.repaintSelection(new d.Range(h,b,a,g)),this._render.repaintSelection(new d.Range(this._activeRowIndex,this._activeColIndex,this._activeRowCount,this._activeColCount)));h=this._eventHandler;b=h.oldTop!==this._scrollTopRow;h.oldTop=this._scrollTopRow;h.oldLeft=this._scrollLeftCol;b&&(b=this.getViewportTopRow(1),a=this.getViewportBottomRow(1),g=Math.max(0,b-60),g<this.getRowCount()&&h._loadData(g,2*a-b));this._trigger(d.Events.EnterCell,
{sheet:this,sheetName:this._name,row:this._activeRowIndex,col:this._activeColIndex});h._updateValidationUI(this._activeRowIndex,this._activeColIndex);return e||f},endEdit:function(a){var h=this._editor,b;if(h&&h.parentNode){var e=this.getCellType(this._activeRowIndex,this._activeColIndex),f=e.getEditorValue(h),g={sheet:this,sheetName:this._name,row:this._activeRowIndex,col:this._activeColIndex,editingText:f,cancel:!1};this._trigger(d.Events.EditEnd,g);if(g&&!0===g.cancel)return;if(0<=this._activeRowIndex&&
0<=this._activeColIndex&&!a&&e.isEditingValueChanged(h._oldValue,f)&&(b=new d.UndoRedo.CellEditUndoAction(this,{row:this._activeRowIndex,col:this._activeColIndex,newValue:f,autoFormat:!0}),this._doCommand(b),!0===(b.applyResult===d.DataValidationResult.Retry)))return e.focus(h),!1;this._dirty=!0;e.deactivateEditor(h)}this._eventHandler._setFocus();this._editingTimeValue=!1;this._editorStatus!==d.EditorStatus.Ready&&(a=this._editorStatus,this._editorStatus=d.EditorStatus.Ready,this._trigger(d.Events.EditorStatusChanged,
{sheet:this,sheetName:this._name,oldStatus:a,newStatus:d.EditorStatus.Ready}));this._editor=null;return b&&b.applyResult===d.DataValidationResult.Discard?!1:!0},hitTest:function(a,h,b){this._getSheetLayout();var d={x:a,y:h,rowViewportIndex:null,colViewportIndex:null,row:-1,col:-1,resizeInfo:null,hitTestType:null,groupHitInfo:null,filterButtonHitInfo:null,dragInfo:null,cellTypeHitInfo:null},e=this._render.groupHitTest(a,h);e?d.groupHitInfo=e:(d.rowViewportIndex=this._getRowPane(h),d.colViewportIndex=
this._getColumnPane(a),d.row=this._getRowIndex(h,d.rowViewportIndex),d.col=this._getColumnIndex(a,d.colViewportIndex),0<=d.rowViewportIndex&&2>d.rowViewportIndex&&0<=d.colViewportIndex&&(e=this._getCellLayout(d.rowViewportIndex,d.colViewportIndex).findCell(d.row,d.col))&&!0!==b&&(d.row=e.row,d.col=e.col),d.hitTestType=this._getSheetAreaFromHitTest(d),d.resizeInfo=this._eventHandler.getResizingRowCol(d,a,h),d.resizeInfo||(d.dragInfo=this._eventHandler.getDragInfo(d,a,h),d.dragInfo||(d.filterButtonHitInfo=
this._getFilterButtonHitInfo(d,a,h),d.filterButtonHitInfo||(d.cellTypeHitInfo=this._getCellTypeHitInfo(d,a,h)))));return d},getCellRect:function(a,h,b,e){var f=d.SheetArea,g=f.viewport;-1===b?g=f.colHeader:-1===e?g=f.rowHeader:2===b&&(g=f.colFooter);var f=d.Rect,k=this._getSheetLayout();if(-1===b&&-1===e)return new f(k.headerX,k.headerY,k.rowHeaderWidth,k.colHeaderHeight);k=this._bounds;if(void 0===b||null===b)b=a<this.frozenRowCount?0:1;if(void 0===e||null===e)e=h<this.frozenColCount?0:1;var l=this._getRowLayout(b,
g).findRow(a),s=this._getColumnLayout(e,g).findCol(h);return(a=this._getCellLayout(b,e,g).findCell(a,h))?new f(a.x-k.x,a.y-k.y,a.width,a.height):l&&s?new f(s.x-k.x,l.y-k.y,s.width,l.height):new f},_setActiveCellImp:function(a,h,b,e){this._activeRowIndex!==a&&this._activeRowDirty&&(this.updateRecord(),this._activeRowDirty=!1);var f=this._spanModel.find(a,h);f?(this._activeRowCount=f.rowCount,this._activeColCount=f.colCount):this._activeColCount=this._activeRowCount=1;this._render.repaintSelection(new d.Range(this._activeRowIndex,
this._activeColIndex,1,1));this._activeRowIndex=a;this._activeColIndex=h;this._leadingCellRow=a;this._leadingCellCol=h;this.activeRowViewportIndex=b;this.activeColViewportIndex=e;this._render.repaintSelection(new d.Range(a,h,1,1))},setActiveCell:function(a,h,d,b){this._bindToAutoRefresh(function(a,h,n,d){var b=this.getRowCount(),e=this.getColumnCount();0>a?a=0:a>=b&&(a=b-1);0>h?h=0:h>=e&&(h=e-1);this._clearSelectionImp();this._setActiveCellImp(a,h,n,d);(n=this._spanModel.find(a,h))?this._setSelectedRange(n.row,
n.col,n.rowCount,n.colCount):this._setSelectedRange(a,h,1,1)})(a,h,d,b)},getActiveRowIndex:function(){return this._activeRowIndex},getActiveColumnIndex:function(){return this._activeColIndex},selectionPolicy:function(a){if(0===arguments.length)return this._selectionModel.selectionPolicy;this._selectionModel.selectionPolicy=a;return this},selectionUnit:function(a){if(0===arguments.length)return this._selectionModel.selectionUnit;this._selectionModel.selectionUnit=a;return this},getRowResizable:function(a,
h){if(void 0===h||null===h)h=d.SheetArea.viewport;var b=!0,e=this._getRowInfos(h);e&&e[a]&&void 0!==e[a].resizable&&null!==e[a].resizable&&(b=e[a].resizable);return b},setRowResizable:function(a,h,b){if(void 0===b||null===b)b=d.SheetArea.viewport;var e=this._getRowInfos(b);e[a]||(e[a]={});e[a].resizable=h;e[a].dirty=!0;this._trigger(d.Events.RowChanged,{sheet:this,sheetName:this._name,row:a,sheetArea:b,propertyName:"resizable"})},getColumnResizable:function(a,h){if(void 0===h||null===h)h=d.SheetArea.viewport;
var b=!0,e=this._getColumnInfos(h);e&&e[a]&&void 0!==e[a].resizable&&null!==e[a].resizable&&(b=e[a].resizable);return b},setColumnResizable:function(a,h,b){if(void 0===b||null===b)b=d.SheetArea.viewport;var e=this._getColumnInfos(b);e[a]||(e[a]={});e[a].resizable=h;e[a].dirty=!0;this._trigger(d.Events.ColumnChanged,{sheet:this,sheetName:this._name,col:a,sheetArea:b,propertyName:"resizable"})},getRowHeight:function(a,h){if(void 0===h||null===h||h===d.SheetArea.rowHeader||h===d.SheetArea.viewport)if(0>
a||a>=this.getRowCount(h)||this._rowFilter&&this._rowFilter.isHideRowFilter()&&this._rowFilter.isFiltered()&&this._rowFilter.isRowFilteredOut(a)||this.rowRangeGroup&&!this.rowRangeGroup._isEmpty()&&this.rowRangeGroup.isCollapsed(a))return 0;var b=this.defaults.rowHeight;h===d.SheetArea.colHeader&&(b=this.defaults.colHeaderRowHeight);var e=this._getRowInfos(h);if(e&&e[a]){if(!1===e[a].visible)return 0;isNaN(e[a].size)||(b=parseInt(e[a].size,10))}return b},_getActualRowHeight:function(a,h){var b=d.SheetArea;
if(void 0===h||null===h||h===b.rowHeader||h===b.viewport)if(0>a||a>=this.getRowCount(h))return 0;b=this.defaults.rowHeight;h===d.SheetArea.colHeader&&(b=this.defaults.colHeaderRowHeight);var e=this._getRowInfos(h);e&&e[a]&&(isNaN(e[a].size)||(b=parseInt(e[a].size,10)));return b},setRowHeight:function(a,h,b){this._bindToAutoRefresh(function(a,h,n){if(void 0===n||null===n)n=d.SheetArea.viewport;var b=this._getRowInfos(n);b[a]||(b[a]={});b[a].size=h;b[a].dirty=!0;this._trigger(d.Events.RowChanged,{sheet:this,
sheetName:this._name,row:a,sheetArea:n,propertyName:"height"})})(a,h,b)},getRowVisible:function(a,h){var b=d.SheetArea;if(void 0===h||null===h||h===b.viewport||h===b.rowHeader)if(this._rowFilter&&this._rowFilter.isHideRowFilter()&&this._rowFilter.isFiltered()&&this._rowFilter.isRowFilteredOut(a)||this.rowRangeGroup&&!this.rowRangeGroup._isEmpty()&&0<=a&&a<this.getRowCount(h)&&this.rowRangeGroup.isCollapsed(a))return!1;var b=!0,e=this._getRowInfos(h);e&&e[a]&&void 0!==e[a].visible&&null!==e[a].visible&&
(b=e[a].visible);return b},setRowVisible:function(a,h,b){this._bindToAutoRefresh(function(a,h,n){if(void 0===n||null===n)n=d.SheetArea.viewport;var b=this._getRowInfos(n);b[a]||(b[a]={});b[a].visible!==h&&(b[a].visible=h,b[a].dirty=!0,this._trigger(d.Events.RowChanged,{sheet:this,sheetName:this._name,row:a,sheetArea:n,propertyName:"isVisible"}))})(a,h,b)},getColumnWidth:function(a,h){var b=this.defaults.colWidth,e=d.SheetArea;h===e.rowHeader&&(b=this.defaults.rowHeaderColWidth);if(void 0===h||null===
h||h===e.colHeader||h===e.viewport)if(0>a||a>=this.getColumnCount(h)||this.colRangeGroup&&!this.colRangeGroup._isEmpty()&&this.colRangeGroup.isCollapsed(a))return 0;if((e=this._getColumnInfos(h))&&e[a]){if(!1===e[a].visible)return 0;isNaN(e[a].size)||(b=parseInt(e[a].size,10))}return b},_getActualColumnWidth:function(a,h){var b=this.defaults.colWidth,e=d.SheetArea;h===e.rowHeader&&(b=this.defaults.rowHeaderColWidth);if(void 0===h||null===h||h===e.colHeader||h===e.viewport||h===e.colFooter)if(0>a||
a>=this.getColumnCount(h))return 0;(e=this._getColumnInfos(h))&&e[a]&&(isNaN(e[a].size)||(b=parseInt(e[a].size,10)));return b},setColumnWidth:function(a,h,b){this._bindToAutoRefresh(function(a,h,n){if(void 0===n||null===n)n=d.SheetArea.viewport;var b=this._getColumnInfos(n);b[a]||(b[a]={});b[a].size=h;b[a].dirty=!0;this._trigger(d.Events.ColumnChanged,{sheet:this,sheetName:this._name,col:a,sheetArea:n,propertyName:"width"});this._allowCellOverflow&&this._clearCellOverflowModelCache()})(a,h,b)},getColumnVisible:function(a,
h){var b=d.SheetArea;if((void 0===h||null===h||h===b.colHeader||h===b.viewport)&&this.colRangeGroup&&!this.colRangeGroup._isEmpty()&&0<=a&&a<this.getColumnCount(h)&&this.colRangeGroup.isCollapsed(a))return!1;var b=!0,e=this._getColumnInfos(h);e&&e[a]&&void 0!==e[a].visible&&null!==e[a].visible&&(b=e[a].visible);return b},setColumnVisible:function(a,h,b){this._bindToAutoRefresh(function(a,h,n){if(void 0===n||null===n)n=d.SheetArea.viewport;var b=this._getColumnInfos(n);b[a]||(b[a]={});b[a].visible!==
h&&(b[a].visible=h,b[a].dirty=!0,!0===this._allowCellOverflow&&this._clearCellOverflowModelCache(),this._trigger(d.Events.ColumnChanged,{sheet:this,sheetName:this._name,col:a,sheetArea:n,propertyName:"isVisible"}))})(a,h,b)},zoom:function(a){a=parseFloat(a);!isNaN(a)&&isFinite(a)&&(4<a?a=4:0.25>a&&(a=0.25),this._bindToAutoRefresh(function(a){this.showEditingLocator&&this._showEditingLocator();this._allowCellOverflow&&this._zoomFactor!==a&&this._clearCellOverflowModelCache();this._zoomFactor=a})(a))},
invalidateLayout:function(){this._cachedGroupLayout=this._layoutModel=null;this._rowLayoutCache={colHeader:[],viewport:[],colFooter:[]};this._colLayoutCache={rowHeader:[],viewport:[]};this._clearCellOverflowModelCache();this._filterButtonsModel=null;this._eventHandler&&p.gcGlobal.activeElement===this&&this._eventHandler._updateValidationUI(this._activeRowIndex,this._activeColIndex);this._dirty=!0},getViewportHeight:function(a){var h=this._getSheetLayout();return 0<a?h.viewportHeight:h.frozenHeight},
getViewportWidth:function(a){var h=this._getSheetLayout();return 0<a?h.viewportWidth:h.frozenWidth},getViewportTopRow:function(a){return 0===a?0:Math.max(this.frozenRowCount,this._scrollTopRow)},getViewportBottomRow:function(a){var h=this.getViewportTopRow(a),b=this.getViewportHeight(a),d=0,e=0,f=this.getRowCount();0===a&&(f=Math.min(this.frozenRowCount,f));for(a=h;a<f&&d<b;a++,e++)d+=this._getZoomRowHeight(a);return h+e-1},getViewportLeftColumn:function(a){return 0===a?0:Math.max(this.frozenColCount,
this._scrollLeftCol)},getViewportRightColumn:function(a){var h=this.getViewportLeftColumn(a),b=this.getViewportWidth(a),d=0,e=0,f=this.getColumnCount();0===a&&(f=Math.min(this.frozenColCount,f));for(a=h;a<f&&e<b;a++,d++)e+=this._getZoomColumnWidth(a);return h+d-1},clearSelection:function(){this._bindToAutoRefresh(function(){this._clearSelectionImp();this._setActiveCellImp(0,0)})()},_clearSelectionImp:function(){this._selectionModel.clear()},_validationError:function(a,h,b){b=this.getDataValidator(a,
h);a={sheet:this,sheetName:this._name,row:a,col:h,validator:b,validationResult:d.DataValidationResult.ForceApply};this._trigger(d.Events.ValidationError,a);return a.validationResult},getSpans:function(a,h){if(void 0===h||null===h)h=d.SheetArea.viewport;var b=this._getSpanModel(h);if(!a)return b.slice(0);for(var e=[],f=0;f<b.length;f++){var g=b[f];a&&!g.intersect(a.row,a.col,a.rowCount,a.colCount)||e.push(g)}return e},getCell:function(a,h,b){return new d.Cell(this,a,h,b)},getCells:function(a,h,b,d,
e){a=this.getCell(a,h,e);a.row2=b;a.col2=d;return a},getRow:function(a,h){return new d.Row(this,a,h)},getRows:function(a,h,b){a=this.getRow(a,b);a.index2=h;return a},getColumn:function(a,h){return new d.Col(this,a,h)},getColumns:function(a,h,b){a=this.getColumn(a,b);a.index2=h;return a},setBorder:function(a,h,b,e){if(void 0===e||null===e)e=d.SheetArea.viewport;var f=this.isPaintSuspended();this.isPaintSuspended(!0);try{var g=this._getActualRange(a,e),k=g.row,l=g.col,s=g.rowCount,q=g.colCount,t,m;
if(b.left||b.all||b.outline)for(t=0;t<s;t++)this.getCell(k+t,l,e).borderLeft(h);if(b.top||b.all||b.outline)for(m=0;m<q;m++)this.getCell(k,l+m,e).borderTop(h);if(b.right||b.all||b.outline)for(t=0;t<s;t++)this.getCell(k+t,l+q-1,e).borderRight(h);if(b.bottom||b.all||b.outline)for(m=0;m<q;m++)this.getCell(k+s-1,l+m,e).borderBottom(h);if(b.innerHorizontal||b.all||b.inside)for(t=0;t<s-1;t++)for(m=0;m<q;m++)this.getCell(k+t,l+m,e).borderBottom(h),this.getCell(k+t+1,l+m,e).borderTop(h);if(b.innerVertical||
b.all||b.inside)for(m=0;m<q-1;m++)for(t=0;t<s;t++)this.getCell(k+t,l+m,e).borderRight(h),this.getCell(k+t,l+m+1,e).borderLeft(h)}finally{this.isPaintSuspended(f)}},search:function(a){if(!a)return null;var h=d.SearchFoundFlags,b=d.SearchResult;if(!a.searchString||a.searchTarget===h.None||0>=this.getRowCount(a.sheetArea)&&0>=this.getColumnCount(a.sheetArea))return new b;-1===a.rowStart&&(a.rowStart=0);-1===a.columnStart&&(a.columnStart=0);-1===a.findBeginRow&&(a.findBeginRow=a.rowStart);-1===a.findBeginColumn&&
(a.findBeginColumn=a.columnStart);-1===a.rowEnd&&(a.rowEnd=this.getRowCount(a.sheetArea)-1);-1===a.columnEnd&&(a.columnEnd=this.getColumnCount(a.sheetArea)-1);var e=new b,f=new d.CellsEnumerator(this,a);0<(a.searchFlags&d.SearchFlags.BlockRange)&&(f.isBlockRange=!0);for(;f.moveNext();){var g=f.currentRow,k=f.currentColumn,l=f.current();if(0<(a.searchTarget&h.CellText)){var s=l.text();this._trySearch(s,a.searchString,a.searchFlags)&&""!==s&&(e.searchFoundFlag|=h.CellText,e.foundString=s)}0<(a.searchTarget&
h.CellFormula)&&(l=l.formula(),l="string"===typeof l?l.toString():null,this._trySearch(l,a.searchString,a.searchFlags)&&""!==l&&(e.searchFoundFlag|=h.CellFormula,e.foundString=l));if(e.searchFoundFlag!==h.None)return e.foundRowIndex=g,e.foundColumnIndex=k,e}return new b},showCell:function(a,h,b,e){if(!(0>a||a>=this.getRowCount()||0>h||h>=this.getColumnCount())){var f=isNaN(this.frozenRowCount)?0:this.frozenRowCount,g=isNaN(this.frozenColCount)?0:this.frozenColCount,k=this._scrollTopRow,l=this._scrollLeftCol,
s=d.HorizontalPosition;if(e!==s.left)if(e===s.center)for(e=Math.floor((this.getViewportWidth(1)-Math.floor(this.getColumnWidth(h)*this._zoomFactor))/2);0<h&&!(e-=Math.floor(this.getColumnWidth(h-1)*this._zoomFactor),0>e);h--);else if(e===s.right)for(e=this.getViewportWidth(1)-Math.floor(this.getColumnWidth(h)*this._zoomFactor);0<h&&!(e-=Math.floor(this.getColumnWidth(h-1)*this._zoomFactor),0>e);h--);else if(e===s.nearest&&h>=l)for(e=this.getViewportWidth(1)-Math.floor(this.getColumnWidth(h)*this._zoomFactor);l<
h&&!(e-=Math.floor(this.getColumnWidth(h-1)*this._zoomFactor),0>e);h--);e=d.VerticalPosition;if(b!==e.top)if(b===e.center)for(b=Math.floor((this.getViewportHeight(1)-Math.floor(this.getRowHeight(a)*this._zoomFactor))/2);0<a&&!(b-=Math.floor(this.getRowHeight(a-1)*this._zoomFactor),0>b);a--);else if(b===e.bottom)for(b=this.getViewportHeight(1)-Math.floor(this.getRowHeight(a)*this._zoomFactor);0<a&&!(b-=Math.floor(this.getRowHeight(a-1)*this._zoomFactor),0>b);a--);else if(b===e.nearest&&!(a<k||-1===
k))for(b=this.getViewportHeight(1)-Math.floor(this.getRowHeight(a)*this._zoomFactor);k<a&&!(b-=Math.floor(this.getRowHeight(a-1)*this._zoomFactor),0>b);a--);a>=f&&a!==k&&(this._scrollTopRow=a,this._syncVScrollbarPosition());h>=g&&h!==l&&(this._scrollLeftCol=h,this._syncHScollbarPosition());if(a!==k||h!==l)this.invalidateLayout(),this.repaint()}},showColumn:function(a,h){this.showCell(this._scrollTopRow,a,d.VerticalPosition.top,h)},showRow:function(a,h){this.showCell(a,this._scrollLeftCol,h,d.HorizontalPosition.left)},
bind:function(a,h,b){this._eventHandler.bind(a+".gcSheet",h,b)},unbind:function(a,h){this._eventHandler.unbind(a+".gcSheet",h)},unbindAll:function(){this._eventHandler.unbind(".gcSheet")},_bind:function(a,h,b){this._eventHandler.bind(a+".gcSheetInternal",h,b)},_unbind:function(a,h){this._eventHandler.unbind(a+".gcSheetInternal",h)},_unbindAll:function(){this._eventHandler.unbind(".gcSheetInternal")},suspendEvent:function(){this._eventHandler._eventSuspended++},resumeEvent:function(){this._eventHandler._eventSuspended--;
0>this._eventHandler._eventSuspended&&(this._eventHandler._eventSuspended=0)},currentTheme:function(a){if(0===arguments.length)return this._currentTheme||(this._currentTheme=d.SpreadThemes.Office),this._currentTheme;var h=d.SpreadThemes;"string"===typeof a&&(a=h.hasOwnProperty(a)?h[a]:new d.SpreadTheme(a));this._bindToAutoRefresh(function(a){this._currentTheme=a})(a);return this},reset:function(){this.defaults={rowHeight:20,colWidth:62,rowHeaderColWidth:40,colHeaderRowHeight:20};this.gridline={color:"#D0D7E5",
showVerticalGridline:!0,showHorizontalGridline:!0};this._rowLayoutCache={colHeader:[],viewport:[],colFooter:[]};this._colLayoutCache={rowHeader:[],viewport:[]};this._dragRect={};this._render=new d._SheetRender(this);this._eventHandler=new d._SheetEventHandler(this);var n=d._GcSheetModel;this._dataModel=new n;this._dataModel.name=this._name;this._calcDataModel=new n(this._dataModel.rowCount,this._dataModel.colCount,this._name+"_calc");this._rowHeaderModel=new n(this._dataModel.rowCount,1);this._colHeaderModel=
new n(1,this._dataModel.colCount);this._colFooterModel=new n(1,this._dataModel.colCount,this._name+"cf");n=d._SpanModel;this._spanModel=new n;this._colHeaderSpanModel=new n;this._rowHeaderSpanModel=new n;this._selectionModel=new d._SelectionModel;this._vpSheetSource=new a.Calc._SheetSource(this,d.SheetArea.viewport);this._cellOverflowModelCache=null;"undefined"!==typeof d.RangeGroup&&(this.rowRangeGroup=new d.RangeGroup(this.getRowCount()),this.colRangeGroup=new d.RangeGroup(this.getColumnCount()));
this._showColumnRangeGroup=this._showRowRangeGroup=!0;this.dataContext=this._dataSource=this._colInfos=this._rowInfos=null;this.autoUpdate=this.autoGenerateColumns=!0;this._rowFilter=null;"undefined"!==typeof d.HideRowFilter&&(this._filterButtonsModel=null);this._initDefaultKeyMap();this.frozenColCount=this.frozenRowCount=this._scrollLeftCol=this._scrollTopRow=0;d.WorksheetSparklineGroupManager&&(this._sparklineGroupManager=new d.WorksheetSparklineGroupManager(this,this));this._syncScrollbarSize();
this.invalidateLayout();this._dirty=!0},undoManager:function(){this._undoManager||(this._undoManager=this.parent&&this.parent._undoManager?this.parent._undoManager:new d._UndoManager(this,-1,this.allowUndo()));return this._undoManager},clipBoardOptions:function(a){if(0===arguments.length){if(void 0===this._clipBoardOptions||null===this._clipBoardOptions)this._clipBoardOptions=d.ClipboardPasteOptions.All;return this._clipBoardOptions}this._clipBoardOptions=a;return this},doCommand:function(a){this._doCommand(a)},
copyTo:function(a,h,b,d,e,f,g){var k=this.isPaintSuspended();this.isPaintSuspended(!0);this.suspendEvent();s.copyTo(this,a,h,this,b,d,e,f,g);this.resumeEvent();this.isPaintSuspended(k)},moveTo:function(a,h,b,d,e,f,g){var k=this.isPaintSuspended();this.isPaintSuspended(!0);this.suspendEvent();s.moveTo(this,a,h,this,b,d,e,f,g);this.resumeEvent();this.isPaintSuspended(k)},setCsv:function(a,h,b,d,e,f){var g=this.isPaintSuspended();this.isPaintSuspended(!0);this.suspendEvent();s.setRangeText(this,a,h,
b,d,e,'"',f);this.resumeEvent();this.isPaintSuspended(g)},getCsv:function(a,h,b,e,f,g){return s.getRangeText(this,a,b,h,e,f,g,'"',!1,d.TextFileOpenFlags.None)},canUserDragDrop:function(a){if(0===arguments.length){if(this.parent&&this.parent.canUserDragDrop)this._allowDragDrop=this.parent.canUserDragDrop();else if(void 0===this._allowDragDrop||null===this._allowDragDrop)this._allowDragDrop=!0;return this._allowDragDrop}this.parent&&this.parent.canUserDragDrop?this.parent.canUserDragDrop(a):this._allowDragDrop=
a;return this},canUserDragFill:function(a){if(0===arguments.length){if(this.parent&&this.parent.canUserDragFill)this._allowDragFill=this.parent.canUserDragFill();else if(void 0===this._allowDragFill||null===this._allowDragFill)this._allowDragFill=!0;return this._allowDragFill}this.canUserDragFill()!==a&&(this.parent&&this.parent.canUserDragFill?this.parent.canUserDragFill(a):this._allowDragFill=a,1===this.getSelections().length&&this._render.repaintSelection(this.getSelections().toArray()[0]));return this},
isColumnBound:function(a){return 0>a||a>=this.getColumnCount()?!1:this.getDataSource()&&this._colInfos?(a=this._colInfos[a],!(!a||!a.name)):!1},getDataColumnName:function(a){return 0>a||a>=this.getColumnCount()?null:this.getDataSource()&&this._colInfos?(a=this._colInfos[a],a.displayName||a.name):null},getSparkline:function(a,h){return this._getModel(d.SheetArea.viewport).getSparkline(a,h)},setSparkline:function(a,h,b,e,f,g,k,l){return this._bindToAutoRefresh(function(a,h,n,b,e,f,g,k){n=new d.Sparkline(a,
h,n,b,e,f);g&&void 0!==k&&null!==k&&(n.dateAxisData(g),n.dateAxisOrientation(k),n.group().displayDateAxis=!0);this.removeSparkline(a,h);this._getModel().setSparkline(a,h,n);this._sparklineGroupManager.add(n.group());this._raiseCellChanged("sparkline",a,h,d.SheetArea.viewport);return n})(a,h,b,e,f,g,k,l)},removeSparkline:function(a,h){this._bindToAutoRefresh(function(a,h){var n=this._getModel(d.SheetArea.viewport),b=n.getSparkline(a,h);if(b){var e=b.group();e.remove(b);0>=e.count()&&this._sparklineGroupManager.remove(e)}n.setSparkline(a,
h,null)})(a,h)},groupSparkline:function(a){return this._bindToAutoRefresh(function(a){for(var n=null,b=0;b<a.length;b++){var d=a[b];if(d)if(n){var e=d.group();e.remove(d);n.add(d);0>=e.count()&&this._sparklineGroupManager.remove(e)}else n=d.group()}return n})(a)},ungroupSparkline:function(a){this._bindToAutoRefresh(function(a){if(a){for(var n=[],n=n.concat(a._innerList),b=0;b<n.length;b++){var d=n[b];if(d){a.remove(d);var e=a.clone();e.add(d);this._sparklineGroupManager.add(e)}}this._sparklineGroupManager.remove(a)}})(a)},
fillAuto:function(a,h,b){if(!h)throw Error("range");this._checkFillRange(a,h,b)&&this._bindToAutoRefresh(function(a,h,n){a&&(this._eventHandler._dragFillStartRange=a);(new d.FillImp(this)).fillAuto(h,n)})(a,h,b)},fillAutobyDirection:function(a,h,b){if(!h)throw Error("range");this._checkFillRange(a,h,null,b)&&this._bindToAutoRefresh(function(a,h,n){a&&(this._eventHandler._dragFillStartRange=a);(new d.FillImp(this)).fillAutobyDirection(h,n)})(a,h,b)},fillLinear:function(a,h,b,e,f){if(!h)throw Error("range");
this._checkFillRange(a,h,b)&&this._bindToAutoRefresh(function(a,h,n,b,e){a&&(this._eventHandler._dragFillStartRange=a);(new d.FillImp(this)).fillLinear(h,n,b,e)})(a,h,b,e,f)},fillGrowth:function(a,h,b,e,f){if(!h)throw Error("range");this._checkFillRange(a,h,b)&&this._bindToAutoRefresh(function(a,h,n,b,e){a&&(this._eventHandler._dragFillStartRange=a);(new d.FillImp(this)).fillGrowth(h,n,b,e)})(a,h,b,e,f)},fillDate:function(a,h,b,e,f,g){if(!h)throw Error("range");this._checkFillRange(a,h,b)&&this._bindToAutoRefresh(function(a,
h,n,b,e,f){a&&(this._eventHandler._dragFillStartRange=a);a=new d.FillImp(this);var g=null;void 0!==f&&null!==f&&(g=(new d._DateTimeHelper(f)).toOADate());a.fillDate(h,n,b,e,g)})(a,h,b,e,f,g)},_checkFillRange:function(a,h,b,e){if(!a||!h||!h.containsRange(a))return!1;if(void 0!==b&&null!==b){var f=d.FillSeries;if(b===f.Row){if(a.row===h.row&&a.rowCount===h.rowCount)return!0}else if(b===f.Column&&a.col===h.col&&a.colCount===h.colCount)return!0}if(void 0!==e&&null!==e)if(b=d.FillDirection,e===b.Up||e===
b.Down){if(a.col===h.col&&a.colCount===h.colCount)return!0}else if((e===b.Left||e===b.Right)&&a.row===h.row&&a.rowCount===h.rowCount)return!0;return!1},clear:function(a,h,b,e,f,g){this._bindToAutoRefresh(function(a,h,n,b,e,f){this.suspendCalcService();try{var g,k,l,s,I=d.SheetArea.viewport,q=d.StorageType;if(void 0===e||null===e||e===I){if((f&q.Data)===q.Data){if(this._dataSource||this.dataContext){this.suspendEvent();for(g=a;g<a+n;g++)for(k=h;k<h+b;k++)this.setValue(g,k,null,e);this.resumeEvent()}this._conditionalFormats&&
this._conditionalFormats._clearCache();this._rowFilter&&this._rowFilter.range&&this._rowFilter._clear(a,h,n,b)}(f&q.Sparkline)===q.Sparkline&&this._sparklineGroupManager&&this._sparklineGroupManager.clear(a,h,n,b)}var E=this._getModel(e),t=this._getCalcModel(e);if(E){g=-1===a?0:a;var m=-1===a?E.rowCount:n;k=-1===h?0:h;var r=-1===h?E.colCount:b;E.clear(g,k,m,r,f);t&&t.clear(g,k,m,r,f);if((f&q.Style)===q.Style&&!(0<=a&&0<=h))if(0<=h)for(s=0;s<r;s++)this.setStyle(-1,k+s,null,e);else if(0<=a)for(l=0;l<
m;l++)this.setStyle(g+l,-1,null,e);else this.setStyle(-1,-1,null,e);if((f&q.Axis)===q.Axis&&!(0<=a&&0<=h))if(0<=h)for(s=0;s<r;s++)this.setColumnVisible(k+s,!0,e),this.setColumnResizable(k+s,!0,e),this.setColumnWidth(k+s,e===d.SheetArea.rowHeader?this.defaults.rowHeaderColWidth:this.defaults.colWidth,e);else{if(!(0<=a))for(s=0;s<r;s++)this.setColumnVisible(k+s,!0,e),this.setColumnResizable(k+s,!0,e),this.setColumnWidth(k+s,e===d.SheetArea.rowHeader?this.defaults.rowHeaderColWidth:this.defaults.colWidth,
e);for(l=0;l<m;l++)this.setRowVisible(g+l,!0,e),this.setRowResizable(g+l,!0,e),this.setRowHeight(g+l,e===d.SheetArea.colHeader?this.defaults.colHeaderRowHeight:this.defaults.rowHeight,e)}for(l=0;l<m;l++)for(s=0;s<r;s++)g=a+l,k=h+s,(f&q.Data)===q.Data&&this._raiseCellChanged("value",g,k,e),(f&q.Style)===q.Style&&this._raiseCellChanged("style",g,k,e),(f&q.Sparkline)===q.Sparkline&&this._raiseCellChanged("sparkline",g,k,e),(f&q.Axis)===q.Axis&&this._raiseCellChanged("axis",g,k,e),(f&q.BindingPath)===
q.BindingPath&&this._raiseCellChanged("bindingPath",g,k,e)}void 0!==e&&null!==e&&e!==I||(f&q.Data)!==q.Data||this._getSheetSource()._addCellsToDirty(a,h,n,b)}finally{this.resumeCalcService()}})(a,h,b,e,f,g)},getConditionalFormats:function(){this._conditionalFormats||(this._conditionalFormats=new d.ConditionalFormats(this));return this._conditionalFormats},rowFilter:function(a){return 0===arguments.length?this._rowFilter:this._bindToAutoRefresh(function(a){this._rowFilter&&this._rowFilter.reset();
if(this._rowFilter=a)this._rowFilter.sheet=this;return this})(a)},autoFitColumn:function(a){0>a||a>=this.getColumnCount()||(new d.UndoRedo.ColumnAutoFitUndoAction(this,[{col:a}],!1)).execute(this)},autoFitRow:function(a){0>a||a>=this.getRowCount()||(new d.UndoRedo.RowAutoFitUndoAction(this,[{row:a}],!1)).execute(this)},setGridlineOptions:function(a){this._bindToAutoRefresh(function(a){a&&(this.gridline||(this.gridline={}),a.color&&(this.gridline.color=a.color),null!==a.showVerticalGridline&&void 0!==
a.showVerticalGridline&&(this.gridline.showVerticalGridline=a.showVerticalGridline),null!==a.showHorizontalGridline&&void 0!==a.showHorizontalGridline&&(this.gridline.showHorizontalGridline=a.showHorizontalGridline))})(a)},getGridlineOptions:function(){this.gridline||(this.gridline={});var a={};a.color=this.gridline.color;a.showVerticalGridline=this.gridline.showVerticalGridline;a.showHorizontalGridline=this.gridline.showHorizontalGridline;return a},getFrozenRowCount:function(){return this.frozenRowCount},
getFrozenColumnCount:function(){return this.frozenColCount},setRowHeaderVisible:function(a){this._bindToAutoRefresh(function(h){this.rowHeaderVisible=a})(a)},getRowHeaderVisible:function(){return this.rowHeaderVisible},setColumnHeaderVisible:function(a){this._bindToAutoRefresh(function(h){this.colHeaderVisible=a})(a)},getColumnHeaderVisible:function(){return this.colHeaderVisible},setRowHeaderAutoText:function(a){this._bindToAutoRefresh(function(a){this.rowHeaderAutoText=a})(a)},getRowHeaderAutoText:function(){return this.rowHeaderAutoText},
setColumnHeaderAutoText:function(a){this._bindToAutoRefresh(function(a){this.colHeaderAutoText=a})(a)},getColumnHeaderAutoText:function(){return this.colHeaderAutoText},setRowHeaderAutoTextIndex:function(a){this._bindToAutoRefresh(function(a){this.rowHeaderAutoTextIndex=a})(a)},getRowHeaderAutoTextIndex:function(){return this.rowHeaderAutoTextIndex},setColumnHeaderAutoTextIndex:function(a){this._bindToAutoRefresh(function(a){this.colHeaderAutoTextIndex=a})(a)},getColumnHeaderAutoTextIndex:function(){return this.colHeaderAutoTextIndex},
setIsProtected:function(a){this._bindToAutoRefresh(function(h){this.isProtected=a})(a)},getIsProtected:function(){return this.isProtected},setArray:function(a,h,b,e){var f=this.getRowCount(),g=this.getColumnCount();if(b&&0<=a&&a<f&&0<=h&&h<g){this.suspendCalcService();var k=this.isPaintSuspended();this.isPaintSuspended(!0);try{var s=this;l.each(b,function(b,k){if(k instanceof Array)l.each(k,function(k,l){var I=a+b,q=h+k;I<f&&q<g&&(e?s.setFormula(I,q,l,d.SheetArea.viewport):s.setValue(I,q,l,d.SheetArea.viewport,
!0))});else{var I=a+b;I<f&&h<g&&(e?s.setFormula(I,h,k,d.SheetArea.viewport):s.setValue(I,h,k,d.SheetArea.viewport,!0))}})}finally{this.resumeCalcService(),this.isPaintSuspended(k)}}},getArray:function(a,h,b,d,e){var f=[],g=this.getRowCount(),k=this.getColumnCount();if(0<=a&&a<g&&0<=h&&h<k)for(a+b>g&&(b=g-a),h+d>k&&(d=k-h),g=0;g<b;g++)for(f[g]=[],k=0;k<d;k++)f[g][k]=e?this.getFormula(a+g,h+k):this.getValue(a+g,h+k);return f},showRowRangeGroup:function(a){if(0===arguments.length)return this._showRowRangeGroup;
this._showRowRangeGroup!==a&&this._bindToAutoRefresh(function(a){this._showRowRangeGroup=a})(a);return this},showColumnRangeGroup:function(a){if(0===arguments.length)return this._showColumnRangeGroup;this._showColumnRangeGroup!==a&&this._bindToAutoRefresh(function(a){this._showColumnRangeGroup=a})(a);return this},_GROUPBUTTON_WIDTH:15,_GROUPBUTTON_HEIGHT:15,_GROUPPADDING:2,_rowLayoutCache:null,_colLayoutCache:null,_scrollCallback:null,_dragRect:null,_scrollTopRow:0,_scrollLeftCol:0,_activeRowDirty:!1,
_initPaint:function(){if(!a.UI._isStandardCanvas()){var n=this._getCanvas();if(n&&n.firstChild&&n.firstChild.loaded)this.invalidateLayout(),this.repaint();else{var h=this;p.setTimeout(function(){h.initPaint.call(h)},10)}}},_bindToAutoRefresh:function(a,h){h||(h=this);return function(){var b=a.apply(h,arguments);h._paintSuspended||(typeof h.invalidateLayout===g&&h.invalidateLayout(),typeof h.repaint===g&&h.repaint());return b}},_isValidSheetName:function(a){if(!a||""===a)return!1;if(!this.parent)return!0;
for(var h=this.parent.sheets.length,b=0;b<h;b++){var d=this.parent.sheets[b];if(d!==this&&a===d._name)return!1}return!0},_init:function(a){this._name=a;this._bounds=new d.Rect(0,0,0,0);this.reset()},applyOptions:function(a){a&&("string"===typeof a.name&&0<a.name.length&&(this._name=a.name),a.data&&this.setDataSource(a.data),"number"===typeof a.defaultRowHeight&&(this.defaults.rowHeight=a.defaultRowHeight),"number"===typeof a.defaultColWidth&&(this.defaults.colWidth=a.defaultColWidth),"number"===typeof a.defaultRowHeaderColWidth&&
(this.defaults.rowHeaderColWidth=a.defaultRowHeaderColWidth),"number"===typeof a.defaultColHeaderRowHeight&&(this.defaults.colHeaderRowHeight=a.defaultColHeaderRowHeight),"number"===typeof a.rowCount&&this.setRowCount(a.rowCount),"number"===typeof a.colCount&&this.setColumnCount(a.colCount),"number"===typeof a.frozenRowCount&&(this.frozenRowCount=a.frozenRowCount),"number"===typeof a.frozenColCount&&(this.frozenColCount=a.frozenColCount),a.gridlineColor&&(this.gridline.color=a.gridlineColor),"boolean"===
typeof a.showVerticalGridline&&(this.gridline.showVerticalGridline=a.showVerticalGridline),"boolean"===typeof a.showHorizontalGridline&&(this.gridline.showHorizontalGridline=a.showHorizontalGridline),a.borderColor&&(this.borderColor=a.borderColor),"number"===typeof a.borderWidth&&(this.borderWidth=a.borderWidth),"number"===typeof a._zoomFactor&&(this._zoomFactor=a._zoomFactor),"boolean"===typeof a.rowHeaderVisible&&(this.rowHeaderVisible=a.rowHeaderVisible),"boolean"===typeof a.colHeaderVisible&&
(this.colHeaderVisible=a.colHeaderVisible),"boolean"===typeof a.autoUpdate&&(this.autoUpdate=a.autoUpdate),"boolean"===typeof a.autoGenerateColumns&&(this.autoGenerateColumns=a.autoGenerateColumns),a.rowHeaderAutoText&&(this.rowHeaderAutoText=a.rowHeaderAutoText),a.colHeaderAutoText&&(this.colHeaderAutoText=a.colHeaderAutoText),"number"===typeof a._activeRowIndex&&(this._activeRowIndex=a._activeRowIndex),"number"===typeof a._activeColIndex&&(this._activeColIndex=a._activeColIndex),"boolean"===typeof a._allowCellOverflow&&
(this._allowCellOverflow=a._allowCellOverflow),"boolean"===typeof a.isProtected&&(this.isProtected=a.isProtected),"boolean"===typeof a.allowUndo&&this.allowUndo(a.allowUndo),a.columns&&0<a.columns.length&&(this.autoGenerateColumns=!1,this.bindColumns(a.columns)),a.dataContext&&(a=new d.DataContext(a.dataContext.read,a.dataContext.create,a.dataContext.update,a.dataContext.remove),this.setDataContext(a)))},_initDefaultKeyMap:function(){var a=d.SpreadActions,h=d.Key;this.addKeyMap(h.left,!1,!1,!1,a.navigationLeft);
this.addKeyMap(h.left,!0,!1,!1,a.navigationHome2);this.addKeyMap(h.right,!1,!1,!1,a.navigationRight);this.addKeyMap(h.right,!0,!1,!1,a.navigationEnd);this.addKeyMap(h.up,!1,!1,!1,a.navigationUp);this.addKeyMap(h.up,!0,!1,!1,a.navigationTop);this.addKeyMap(h.down,!1,!1,!1,a.navigationDown);this.addKeyMap(h.down,!0,!1,!1,a.navigationBottom);this.addKeyMap(h.home,!1,!1,!1,a.navigationHome);this.addKeyMap(h.home,!0,!1,!1,a.navigationFirst);this.addKeyMap(h.end,!1,!1,!1,a.navigationEnd);this.addKeyMap(h.end,
!0,!1,!1,a.navigationLast);this.addKeyMap(h.tab,!1,!1,!1,a.commitInputNavigationTabNext);this.addKeyMap(h.tab,!1,!0,!1,a.commitInputNavigationTabPrevious);this.addKeyMap(h.pup,!1,!1,!1,a.navigationPageUp);this.addKeyMap(h.pup,!0,!1,!1,a.navigationPreviousSheet);this.addKeyMap(h.pdn,!1,!1,!1,a.navigationPageDown);this.addKeyMap(h.pdn,!0,!1,!1,a.navigationNextSheet);this.addKeyMap(h.del,!1,!1,!1,a.clear);this.addKeyMap(h.backspace,!1,!1,!1,a.clearAndEditing);this.addKeyMap(h.enter,!1,!1,!1,a.commitInputNavigationDown);
this.addKeyMap(h.enter,!1,!0,!1,a.commitInputNavigationUp);this.addKeyMap(h.esc,!1,!1,!1,a.cancelInput);this.addKeyMap(h.left,!1,!0,!1,a.selectionLeft);this.addKeyMap(h.right,!1,!0,!1,a.selectionRight);this.addKeyMap(h.up,!1,!0,!1,a.selectionUp);this.addKeyMap(h.down,!1,!0,!1,a.selectionDown);this.addKeyMap(h.home,!1,!0,!1,a.selectionHome);this.addKeyMap(h.end,!1,!0,!1,a.selectionEnd);this.addKeyMap(h.pup,!1,!0,!1,a.selectionPageUp);this.addKeyMap(h.pdn,!1,!0,!1,a.selectionPageDown);this.addKeyMap(h.left,
!0,!0,!1,a.selectionHome);this.addKeyMap(h.right,!0,!0,!1,a.selectionEnd);this.addKeyMap(h.up,!0,!0,!1,a.selectionTop);this.addKeyMap(h.down,!0,!0,!1,a.selectionBottom);this.addKeyMap(h.home,!0,!0,!1,a.selectionFirst);this.addKeyMap(h.end,!0,!0,!1,a.selectionLast);this.addKeyMap(h.c,!0,!1,!1,a.copy);this.addKeyMap(h.x,!0,!1,!1,a.cut);this.addKeyMap(h.v,!0,!1,!1,a.paste);this.addKeyMap(h.z,!0,!1,!1,a.undo);this.addKeyMap(h.y,!0,!1,!1,a.redo)},_setHost:function(a){var h=e.createElement("canvas");h.setAttribute("id",
a.getAttribute("id")+"_vp");l(h).html("You need a browser which full supports HTML5 Canvas to run SpreadJS");a.appendChild(h);h.gcObject=!0;this._canvas&&(l(this._canvas).unbind("mousedown.gcSheet"),l(this._canvas).unbind("mousemove.gcSheet"),l(this._canvas).unbind("mouseup.gcSheet"),l(this._canvas).unbind("mouseout.gcSheet"),l(this._canvas).unbind("dblclick.gcSheet"),l(this._canvas).unbind("gcmousewheel.gcSheet"),this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas));this._canvas=
h;h.setAttribute("renderMethod","auto");var b=this;this._mouseDownDelegate=function(a){return b._eventHandler.doMouseDown(a)};this._mouseMoveDelegate=function(a){b._eventHandler._isMouseCapture||b._eventHandler.doMouseMove(a)};this._mouseUpDelegate=function(a){if(!b._continueMouseUpBubble&&!b._eventHandler._isMouseCapture)return b._eventHandler.doMouseUp(a)};this._mouseOutDelegate=function(a){return b._eventHandler.doMouseOut(a)};this._dblClickDelegate=function(a){var h;if(h=b._currentTarget)if(b._trigger(d.Events.CellDoubleClick,
{sheet:b,sheetName:b._name,sheetArea:b._currentTarget.hitTestType,row:b._currentTarget.row,col:b._currentTarget.col}),h=h.resizeInfo){if("sizeRow"===h.action){var n=[];if(b._isRowSelected(h.index))for(h=0;h<b._selectionModel.length;h++){if(a=b._selectionModel[h],-1===a.col){a=b._getActualRange(a);for(var e=0;e<a.rowCount;e++)n.push({row:a.row+e})}}else n.push({row:h.index});h=new d.UndoRedo.RowAutoFitUndoAction(b,n,!1)}else{n=[];if(b._isColumnSelected(h.index))for(h=0;h<b._selectionModel.length;h++){if(a=
b._selectionModel[h],-1===a.row)for(a=b._getActualRange(a),e=0;e<a.colCount;e++)n.push({col:a.col+e})}else n.push({col:h.index});h=new d.UndoRedo.ColumnAutoFitUndoAction(b,n,!1)}b._doCommand(h);return}return b._eventHandler.startEdit(a)};l(h).bind("mousedown.gcSheet",this._mouseDownDelegate);l(h).bind("mousemove.gcSheet",this._mouseMoveDelegate);l(h).bind("mouseup.gcSheet",this._mouseUpDelegate);l(h).bind("mouseout.gcSheet",this._mouseOutDelegate);l(h).bind("dblclick.gcSheet",this._dblClickDelegate);
this._mouseWheelDelegate=function(a){a=a?a:p.event;b._eventHandler.doMouseWheel(a,parseInt(a.detail?a.detail:a.wheelDelta/-40,10));d.cancelDefault(a);return!1};l(h).bind("gcmousewheel.gcSheet",this._mouseWheelDelegate);l(p).unbind("resize.gcSheet");l(p).bind("resize.gcSheet",d.createEventHandler(this._eventHandler,this._eventHandler.doResize));this._initializeActiveCell();this._eventHandler.doResize()},_disposeValidationUI:function(){this._validationInputMessage&&(l(this._validationInputMessage).remove(),
this._validationInputMessage=null);this._validationButton&&(l(this._validationButton).remove(),this._validationButton=null);this._validationSelect&&(l(this._validationSelect).remove(),this._validationSelect=null)},_dispose:function(){this.isEditing()&&this.endEdit();var a=this._canvas;a&&(l(a).unbind("mousedown.gcSheet"),l(a).unbind("mousemove.gcSheet"),l(a).unbind("mouseup.gcSheet"),l(a).unbind("mouseout.gcSheet"),l(a).unbind("dblclick.gcSheet"),l(a).unbind("gcmousewheel.gcSheet"),a.parentNode.removeChild(a));
this._eventHandler._dispose();this._canvas=null;l(p).unbind("resize.gcSheet");this._filterDialiog&&this._filterDialiog.close();this._smartTag&&this._smartTag.close();this._editor&&l(this._editor).remove();this._disposeValidationUI()},_getModel:function(a){var h=d.SheetArea;return void 0===a||null===a||a===h.viewport?this._dataModel:a===h.rowHeader?this._rowHeaderModel:a===h.colHeader?this._colHeaderModel:null},_getCalcModel:function(a){return void 0===a||null===a||a===d.SheetArea.viewport?this._calcDataModel:
null},_getValueImp:function(a,h,b,e){if((void 0===e||null===e||e===d.SheetArea.viewport)&&this.xSheet)return this.xSheet.getValue(h,b);a=a.getValue(h,b);var f=p.ko;if((void 0===a||null===a)&&this._dataSource&&(void 0===e||null===e||e===d.SheetArea.viewport))if(this._isDataView(this._dataSource)){if(e=this._dataSource.count(),h<e){h=this._dataSource.item(h);if(!h)return null;if((e=this._colInfos[b])&&e.name&&0<e.name.length)return this._dataSource.getProperty(h,e.name)}}else if(f&&f.isObservable(this._dataSource)){if(e=
this._dataSource().length,h<e){h=this._dataSource()[h];if(!h)return null;if((e=this._colInfos[b])&&e.name&&0<e.name.length){if(typeof e.value===g)return e.value(h);a="undefined"!==typeof f&&f.isObservable(h[e.name])?h[e.name]():h[e.name]}else if(("string"===typeof h||!isNaN(h))&&0===b)return h}}else if(this._isCellBinding(this._dataSource)){if(b=this.getBindingPath(h,b,e))return this._dataSource.getValue(b)}else if(e=this._dataSource.length,h<e){h=this._dataSource[h];if(void 0===h||null===h)return null;
if((e=this._colInfos[b])&&e.name&&0<e.name.length){if(typeof e.value===g)return e.value(h);f=p.ko;a="undefined"!==typeof f&&f.isObservable(h[e.name])?h[e.name]():h[e.name]}else if(("string"===typeof h||!isNaN(h))&&0===b)return h}"string"===typeof a&&(b=a.match(u))&&0<b.length&&(b=b[0].substring(6),a=new Date(parseFloat(b)));return a},_getSwapIndex:function(a,h,b,d,e){for(d=a[b-h];d.index<b;)d=a[d.index-h];return d.index},_quickSortImp:function(a){if(1>=a.length)return a;for(var h=a[Math.floor(a.length/
2)],b=[],d=[],e=[],f=0;f<a.length;f++){var g=this._sortCompare(a[f],h);0>g?b.push(a[f]):0<g?d.push(a[f]):e.push(a[f])}return this._quickSortImp(b).concat(e,this._quickSortImp(d))},_quickSort:function(a,h,b,d,e,f){b=e?b:d;d=[];var g;if(e)for(g=0;g<b;g++)d[g]={sheet:this,index:a+g,byRows:e,sortInfo:f};else for(g=0;g<b;g++)d[g]={sheet:this,index:h+g,byRows:e,sortInfo:f};return d=this._quickSortImp(d)},_isEquals:function(a,h){return a instanceof Date&&h instanceof Date?(new d._DateTimeHelper(a)).toOADate()===
(new d._DateTimeHelper(h)).toOADate():a===h},_isGreaterThan:function(a,h){"boolean"===typeof a?a=a?1:0:a instanceof Date&&(a=(new d._DateTimeHelper(a)).toOADate());"boolean"===typeof h?h=h?1:0:h instanceof Date&&(h=(new d._DateTimeHelper(h)).toOADate());return typeof a===typeof h||"number"!==typeof a&&"number"!==typeof h?a>h:"number"===typeof h},_sortCompare:function(a,h){if(a.sortInfo&&0<a.sortInfo.length){for(var b=0,d,e,f,g,k=0;k<a.sortInfo.length;k++){if(a.sortInfo[k]){var l=a.sortInfo[k].ascending;
e=a.sortInfo[k].index;0<=e&&(a.byRows?(d=a.sheet.getValue(a.index,e),e=h.sheet.getValue(h.index,e)):(d=a.sheet.getValue(e,a.index),e=h.sheet.getValue(e,h.index)),f=void 0===d||null===d||""===d,g=void 0===e||null===e||""===e,f||g?f&&g?b=0:f&&!g?b=1:!f&&g&&(b=-1):b=this._isEquals(d,e)?0:this._isGreaterThan(d,e)?l?1:-1:l?-1:1)}if(0!==b)break}return b}return 0},_getActualRange:function(a,h){if(void 0===h||null===h)h=d.SheetArea.viewport;var b=new d.Range;if(null===a||void 0===a)return b;b.col=a.col;b.row=
a.row;b.colCount=a.colCount;b.rowCount=a.rowCount;-1===b.col&&(b.col=0,b.colCount=this.getColumnCount(h));-1===b.row&&(b.row=0,b.rowCount=this.getRowCount(h));return b},_getRangeRect:function(a,h,b){var e=this._getSheetLayout(),f=0,g=0,k=new d.Rect(e.frozenX,e.frozenY,0,0);b=this._getActualRange(b);var l=isNaN(this.frozenColCount)?0:this.frozenColCount,s=isNaN(this.frozenRowCount)?0:this.frozenRowCount;0<h&&(f=Math.max(l,this._scrollLeftCol),k.x=e.viewportX);0<a&&(g=Math.max(s,this._scrollTopRow),
k.y=e.viewportY);if(b.col>=f){for(a=f;a<b.col;a++)if(this.getColumnVisible(a)&&(k.x+=this._getZoomColumnWidth(a),k.x>e.x+e.width))return k;a=b.col}else if(0<l&&b.col<l){for(a=l-1;a>=b.col&&!(this.getColumnVisible(a)&&(k.x-=this._getZoomColumnWidth(a),k.x<e.x));a--);for(a=b.col;a<Math.min(l,b.col+b.colCount)&&!(this.getColumnVisible(a)&&(k.width+=this._getZoomColumnWidth(a),k.width+k.x>e.x+e.width));a++);a=f}else{for(a=f-1;a>=b.col;a--)if(this.getColumnVisible(a)&&(k.x-=this._getZoomColumnWidth(a),
k.x<e.x)){a--;break}a+=1}for(;a<b.col+b.colCount&&!(this.getColumnVisible(a)&&(k.width+=this._getZoomColumnWidth(a),k.width+k.x>e.x+e.width));a++);if(b.row>=g){for(f=g;f<b.row;f++)if(this.getRowVisible(f)&&(k.y+=this._getZoomRowHeight(f),k.y>e.y+e.height))return k;f=b.row}else if(0<s&&b.row<s){for(f=s-1;f>=b.row&&!(this.getRowVisible(f)&&(k.y-=this._getZoomRowHeight(f),k.y<e.y));f--);for(f=b.row;f<Math.min(s,b.row+b.rowCount)&&!(this.getRowVisible(f)&&(k.height+=this._getZoomRowHeight(f),k.height+
k.y>e.y+e.height));f++);f=g}else{for(f=g-1;f>=b.row;f--)if(this.getRowVisible(f)&&(k.y-=this._getZoomRowHeight(f),k.y<e.y)){f--;break}f+=1}for(;f<b.row+b.rowCount&&!(this.getRowVisible(f)&&(k.height+=this._getZoomRowHeight(f),k.height+k.y>e.y+e.height));f++);return k},_getActiveSelectionRect:function(a,h){return this._getRangeRect(a,h,this._getActiveSelectedRange())},_getCanvas:function(){var a=this._canvas;!a&&this.parent&&(a=this.parent.canvas);a&&!a.getContext&&a.firstChild&&(a.getContext=a.firstChild.getContext);
return a},_draw:function(a,h){var b=this._render._getCtx();b&&this._render.paint(b,h)},_getStringWidth:function(a,h){var b=this._getEditingSpan();b.style.font="";b.style.font=h?h:this._render._getZoomFont(this._render._getDefaultFont());a+="";l(b).text(a);var b=b.offsetWidth,d=this._getEditingPre();d.style.font=h?h:this._render._getZoomFont(this._render._getDefaultFont());l(d).text(a);d=d.offsetWidth;l.browser.mozilla?(b+=3,d+=3):l.browser.msie&&(b+=1,d+=1);return Math.max(b,d)},_getFontHeight:function(a){var h=
this._getEditingSpan();h.style.font=a?a:this._render._getDefaultFont();h.innerHTML="H";return h.offsetHeight},_getEditingSpan:function(){if(!this._editingSpan){var a=e.createElement("span");a.style.visibility="hidden";a.style.top="-10000px";a.style.left="-10000px";a.style.position="absolute";a.className="gcStringWidthSpanStyle";a.setAttribute("gcUIElement","gcStringWidthSpan");e.body.insertBefore(a,null);this._editingSpan=a}return this._editingSpan},_getEditingPre:function(){if(!this._editingPre){var a=
e.createElement("pre");a.style.visibility="hidden";a.style.top="-10000px";a.style.left="-10000px";a.style.position="absolute";a.className="gcStringWidthPreStyle";a.setAttribute("gcUIElement","gcStringWidthPre");e.body.insertBefore(a,null);this._editingPre=a}return this._editingPre},_getColumnPane:function(a){var h=this._getSheetLayout(),b=null;h.headerX<a&&a<h.headerX+h.rowHeaderWidth?b=-1:h.frozenX<a&&a<h.frozenX+h.frozenWidth?b=0:h.viewportX<a&&a<h.viewportX+h.viewportWidth&&(b=1);return b},_getRowPane:function(a){var h=
this._getSheetLayout(),b=null;h.headerY<a&&a<h.headerY+h.colHeaderHeight?b=-1:h.frozenY<a&&a<h.frozenY+h.frozenHeight?b=0:h.viewportY<a&&a<h.viewportY+h.viewportHeight&&(b=1);return b},_getRowIndex:function(a,h){for(var b=null,b=-1===h?this._getRowLayout(0,d.SheetArea.colHeader):0===h?this._getRowLayout(0):this._getRowLayout(1),e=0;e<b.length;e++){var f=b[e];if(f.y<=a&&a<f.y+f.height)return f.row}},_getColumnIndex:function(a,h){for(var b=null,b=-1===h?this._getColumnLayout(0,d.SheetArea.rowHeader):
0===h?this._getColumnLayout(0):this._getColumnLayout(1),e=0;e<b.length;e++){var f=b[e];if(f.x<=a&&a<f.x+f.width)return f.col}},_isActiveCell:function(a,h){return this._activeRowIndex<=a&&a<this._activeRowIndex+this._activeRowCount&&this._activeColIndex<=h&&h<this._activeColIndex+this._activeColCount},_isColumnSelected:function(a){for(var h=0;h<this._selectionModel.length;h++){var b=this._selectionModel[h],d=-1===b.col?0:b.col;if(-1===b.row&&a>=d&&a<d+b.colCount)return!0}return!1},_isRowSelected:function(a){for(var h=
0;h<this._selectionModel.length;h++){var b=this._selectionModel[h],d=-1===b.row?0:b.row;if(-1===b.col&&a>=d&&a<d+b.rowCount)return!0}return!1},_isSelected:function(a,h,b){for(var e=!1,f=0;f<this._selectionModel.length;f++){var g=this._selectionModel[f],k=this._spanModel.find(g.row,g.col);k&&k.containsRange(g)&&(g=k);g=this._getActualRange(g);k=d.SheetArea;void 0===b||null===b||b===k.viewport?e=g.row<=a&&a<g.row+g.rowCount&&g.col<=h&&h<g.col+g.colCount:b===k.rowHeader?e=a===this._activeRowIndex||g.row<=
a&&a<g.row+g.rowCount:b===k.colHeader||b===k.colFooter?e=h===this._activeColIndex||g.col<=h&&h<g.col+g.colCount||0>h&&0===g.row&&0===g.col&&g.rowCount===this.getRowCount()&&g.colCount===this.getColumnCount():b===k.corner&&(e=-1===g.row&&-1===g.col&&g.rowCount===this.getRowCount()&&g.colCount===this.getColumnCount());if(e)break}return e},_isAllSelected:function(a,h,b){for(var e=!1,f=this.getRowCount(),g=this.getColumnCount(),k=d.SheetArea,l=0;l<this._selectionModel.length;l++){var s=this._selectionModel[l];
void 0!==b&&null!==b&&b!==k.viewport&&(b===k.rowHeader?(e=-1===s.row?0:s.row,e=-1===s.col&&a>=e&&a<e+s.rowCount):b===k.colHeader||b===k.colFooter?(e=-1===s.col?0:s.col,e=-1===s.row&&h>=e&&h<e+s.colCount):b===k.corner&&(e=-1===s.row&&-1===s.col&&s.rowCount===f&&s.colCount===g));if(e)break}return e},_isHover:function(a,h,b){var e=this._currentTarget,f=d.SheetArea;if(this._currentTarget&&void 0!==b&&null!==b){if(b===f.colHeader){var f=!1,g=this._colHeaderSpanModel.find(e.row,e.col);g&&(f=g.contains(a,
h,1,1));a=a===e.row&&h===e.col||f;return e.hitTestType===b&&a}if(b===f.rowHeader)return f=!1,(g=this._rowHeaderSpanModel.find(e.row,e.col))&&(f=g.contains(a,h,1,1)),a=a===e.row&&h===e.col||f,e.hitTestType===b&&a;if(b===f.colFooter||b===f.viewport)return e.hitTestType===b&&a===e.row&&h===e.col;if(b===f.corner)return e.hitTestType===b}return!1},_indexToLetters:function(a){for(var h="";0<a;a=(a-1)/26){var b=parseInt((a-1)%26,10);if(1===a||0<=b&&1<a)h=String.fromCharCode(65+b)+h}return h},_doStartEdit:function(a,
h,b){var d=this.hitTest(h,b);if(d&&0<=d.row&&0<=d.col&&0<=d.rowViewportIndex&&0<=d.colViewportIndex&&!d.resizeInfo&&!d.dragInfo&&d.row===this._activeRowIndex&&d.col===this._activeColIndex){var e=this.isEditing();this._startEditImp(a,d.row,d.col);if(!e&&this.isEditing()){a=d.row;var e=d.col,f=d.hitTestType,d=this.getCellType(d.row,d.col);if(d._triggerButtonClicked){var g=this.getCellRect(a,e),k=this.getActualStyle(a,e,f);(h=d.getHitInfo(h,b,a,e,k,g,f))&&h.isReservedLocation&&d._triggerButtonClicked(this,
a,e)}}}},_getSheetAreaFromHitTest:function(a){var h=null,b=d.SheetArea;2===a.rowViewportIndex&&0>a.colViewportIndex||(0>a.rowViewportIndex&&0>a.colViewportIndex?h=b.corner:0>a.rowViewportIndex&&0<=a.colViewportIndex?h=b.colHeader:0<=a.rowViewportIndex&&2>a.rowViewportIndex&&0>a.colViewportIndex?h=b.rowHeader:0<=a.rowViewportIndex&&2>a.rowViewportIndex&&0<=a.colViewportIndex&&(h=b.viewport));return h},_startEditImp:function(a,h,b,f,g,k,l){if(!(this.isEditing()||0>=this.getRowHeight(h)||0>=this.getColumnWidth(b))){this.showCell(this._activeRowIndex,
this._activeColIndex,d.VerticalPosition.nearest,d.HorizontalPosition.nearest);var s=this.getActualStyle(h,b);if((!this.isProtected||!1===s.locked)&&0<=h&&0<=b){this._activeRowIndex=h;this._activeColIndex=b;var q=this.getCellType(h,b);if(q){var t=q.createEditorElement();if(t){this._editor=t;Object.defineProperty(t,"sheet",{value:this,writable:!1});var m={sheet:this,sheetName:this._name,row:h,col:b,cancel:!1};this._trigger(d.Events.EditStarting,m);if(!m||!0!==m.cancel){var m=this.getValue(h,b),r=this.getFormula(h,
b),u=this._editorStatus;this._editorStatus=this._startEditByKeydown?d.EditorStatus.Enter:null!==m&&void 0!==m||null!==r&&void 0!==r?d.EditorStatus.Edit:d.EditorStatus.Enter;this._trigger(d.Events.EditorStatusChanged,{sheet:this,sheetName:this._name,oldStatus:u,newStatus:this._editorStatus});r=this.getCellRect(h,b,f,g);m=this._getSheetLayout();u=a.currentStyle;e.defaultView&&e.defaultView.getComputedStyle&&(u=e.defaultView.getComputedStyle(a,""));u||(u=a.style);void 0===u.borderTopWidth||null===u.borderTopWidth||
isNaN(u.borderTopWidth)||(r.y+=parseFloat(u.borderTopWidth));void 0===u.borderLeftWidth||null===u.borderLeftWidth||isNaN(u.borderLeftWidth)||(r.x+=parseFloat(u.borderLeftWidth));q.activateEditor(this._editor,s,r);(a=this.getFormula(h,b))&&(a="="+a);u=a;a&&0!==a.length||((a=this.getValue(h,b))&&0<a.length&&/^=/ig.test(a)&&(a="'"+a),u=a,a=q._formatEditorValue(this._editor,s,a));null!==l&&void 0!==l&&(a=l);q.setEditorValue(this._editor,a);this._editor._oldValue=a;this._editor._originalValue=u;q.updateEditor(this._editor,
s,r);a=d.SheetArea.colHeader;s=d.SheetArea.rowHeader;this.showEditingLocator&&(l=q._getLocator(),t._editingLocator=l,t=this.getValue(this._getModel(a).rowCount-1,b,a),s=this.getValue(h,this._getModel(s).colCount-1,s),l.innerHTML=t+""+s,q._updateEditorLocator(this._editor),e.body.insertBefore(l,null));q.focus(this._editor);k&&q.selectAll(this._editor);h=this.getCellRect(h,b,f,g);h.x-=2;h.y-=2;h.width+=4;h.height+=4;this._allowCellOverflow&&(h.x=m.frozenX,h.width=m.viewportWidth);this.repaint(h);p.gcGlobal.activeElement=
this}}}}}},_showEditingLocator:function(){if(!1!==this.isEditing()&&this._editor&&this._editor._editingLocator){var a=l(this._editor),h=parseInt(a.css("left"),10)+this.getColumnWidth(this._activeColIndex)/2,a=parseInt(a.css("top"),10)+this.getRowHeight(this._activeRowIndex)/2,b=l(this._getCanvas()).offset(),h=h-b.left,a=a-b.top,a=this._getRowIndex(a,this._getRowPane(a)),h=this._getColumnIndex(h,this._getColumnPane(h));a===this._activeRowIndex&&h===this._activeColIndex?l(this._editor._editingLocator).css("visibility",
"hidden"):l(this._editor._editingLocator).css("visibility","visible")}},_getKeyAction:function(a,h,b,d){if(!this.keyMap)return null;for(var e=this.keyMap.length,f=0;f<e;f++){var g=this.keyMap[f];if(g&&g.key===a&&g.ctrl===h&&g.shift===b&&g.alt===d)return g}return null},_moveActiveCellUp:function(a,h,b,d,e){if(0!==a||b){var f=this.getRowCount(),g=this.getColumnCount();if(void 0===this._leadingCellCol||null===this._leadingCellCol)this._leadingCellCol=0;h=this._getPrevRow(a,this._leadingCellCol,d,e);
b||this._adjustCell(h);a=h.r;h=h.c;if(0>a&&b){h=this._getPrevVisualColumn(h);if(0>h||void 0===h||null===h)h=this._getPrevVisualColumn(g);this._leadingCellCol=h;h=this._getPrevRow(f,h,d,e);a=h.r;h=h.c}this._canMoveCurrentTo(a,h)&&(this._activeRowIndex=this._leadingCellRow=a,this._activeColIndex=h)}},_moveActiveCellDown:function(a,h,b,d,e){var f=this.getRowCount(),g=this.getColumnCount();if(a!==f-1||b){if(void 0===this._leadingCellCol||null===this._leadingCellCol)this._leadingCellCol=0;h=this._getNextRow(a,
this._leadingCellCol,d,e);b||this._adjustCell(h);a=h.r;h=h.c;if(a===f&&b){h=this._getNextVisualColumn(h);if(h>=g||void 0===h||null===h)h=this._getNextVisualColumn(-1);this._leadingCellCol=h;h=this._getNextRow(-1,h,d,e);a=h.r;h=h.c}this._canMoveCurrentTo(a,h)&&(this._activeRowIndex=this._leadingCellRow=a,this._activeColIndex=h)}},_moveActiveCellLeft:function(a,h,b,d,e){if(0!==h||b){var f=this.getRowCount(),g=this.getColumnCount();if(void 0===this._leadingCellRow||null===this._leadingCellRow)this._leadingCellRow=
0;h=this._getPrevColumn(this._leadingCellRow,h,d,e);b||this._adjustCell(h);a=h.r;h=h.c;if(0>h&&b){a=this._getPrevVisualRow(a);if(0>a||void 0===a||null===a)a=this._getPrevVisualRow(f);this._leadingCellRow=a;h=this._getPrevColumn(a,g,d,e);a=h.r;h=h.c}this._canMoveCurrentTo(a,h)&&(this._leadingCellCol=h,this._activeRowIndex=a,this._activeColIndex=h)}},_adjustCell:function(a){0>a.r?a.r=this._getFirstVisualRow():a.r>=this.getRowCount()&&(a.r=this._getLastVisualRow());0>a.c?a.c=this._getFirstVisualColumn():
a.c>=this.getColumnCount()&&(a.c=this._getLastVisualColumn())},_fixRange:function(a){var h=0>a.row?0:a.row,b=0>a.col?0:a.col,e=0>a.row?this.getRowCount():a.rowCount;a=0>a.col?this.getColumnCount():a.colCount;return new d.Range(h,b,e,a)},_moveActiveCellLeftInSelection:function(a,h){var b=this._fixRange(this._getActiveSelectedRange()),e=b.row,f=b.col,b=b.col+b.colCount-1,g=this._getPrevColumnInSelection(a,h,!1,!1);a=g.r;h=g.c;h<f?(a-=1,a<e?(b=this._fixRange(this._getActiveSelectedRange(d.Direction.left)),
e=b.row+b.rowCount-1,f=b.col+b.colCount,f<this._scrollLeftCol?this._scrollLeftCol=f:f>this._getPageRightColumn()&&(this._scrollLeftCol=f,this._setLeftColumn(this._getPrevPageLeftColumn())),e<this._scrollTopRow?this._setTopRow(e):e>this._getPageBottomRow()&&(this._scrollTopRow=e,this._setTopRow(this._getPrevPageTopRow())),this._moveActiveCellLeftInSelection(e,f)):this._moveActiveCellLeftInSelection(a,b+1)):0<=a&&(this._activeRowIndex=a,this._activeColIndex=h,this._leadingCellRow=a,this._leadingCellCol=
h)},_moveActiveCellRightInSelection:function(a,h){var b=this._fixRange(this._getActiveSelectedRange()),e=b.col,f=b.row+b.rowCount-1,b=b.col+b.colCount-1,g=this._getNextColumnInSelection(a,h,!1,!1);a=g.r;h=g.c;h>b?(a+=1,a>f?(b=this._fixRange(this._getActiveSelectedRange(d.Direction.right)),e=b.row,f=b.col,f<this._scrollLeftCol?this._setLeftColumn(this._getNextVisualColumn(f-1)):f>this._getPageRightColumn()&&(this._scrollLeftCol=f,this._setLeftColumn(this._getPrevPageLeftColumn())),e<this._scrollTopRow?
this._setTopRow(this._getNextVisualRow(e-1)):e>this._getPageBottomRow()&&(this._scrollTopRow=e,this._setTopRow(this._getPrevPageTopRow())),this._moveActiveCellRightInSelection(e,f-1)):this._moveActiveCellRightInSelection(a,e-1)):0<=a&&(this._activeRowIndex=a,this._activeColIndex=h,this._leadingCellRow=a,this._leadingCellCol=h)},_moveActiveCellRight:function(a,h,b,d,e){var f=this.getRowCount(),g=this.getColumnCount();if(h!==g-1||b){if(void 0===this._leadingCellRow||null===this._leadingCellRow)this._leadingCellRow=
0;h=this._getNextColumn(this._leadingCellRow,h,d,e);b||this._adjustCell(h);a=h.r;h=h.c;if(h===g&&b){a=this._getNextVisualRow(a);if(a>=f||void 0===a||null===a)a=this._getNextVisualRow(-1);this._leadingCellRow=a;h=this._getNextColumn(a,-1,d,e);a=h.r;h=h.c}this._canMoveCurrentTo(a,h)&&(this._leadingCellCol=h,this._activeRowIndex=a,this._activeColIndex=h)}},_getPrevColumn:function(a,h,b,e){for(b={r:a,c:h};0<=h;){h--;if(0>h)break;(e=this.getSpans(new d.Range(a,h,1,1)))&&0<e.length&&(e=e[0],h>=e.col&&(h=
e.col,a=e.row));if(this._canMoveCurrentTo(a,h,b))break}return{r:a,c:h}},_getPrevColumnInSelection:function(a,h,b,d){for(;0<=h;){h--;if(0>h)break;if(b=this._spanModel.find(a,h)){d=this._getActiveSelectedRange();if(d.row<=b.row&&b.row+b.rowCount<=d.row+d.rowCount&&d.col<=b.col&&b.col+b.colCount<=d.col+d.colCount){if(b.row!==a||b.col!==h)continue}else continue;h>=b.col&&(h=b.col,a=b.row)}if(this._canMoveCurrentTo(a,h))break}return{r:a,c:h}},_getNextColumn:function(a,h,b,e){b=this.getColumnCount();for(e=
{r:a,c:h};h<b;){var f=this._spanModel.find(a,h);f?h+=f.colCount:h++;if(h>=b)break;(f=this.getSpans(new d.Range(a,h,1,1)))&&0<f.length&&(f=f[0],h>f.col?h=Math.max(h,f.col+f.colCount):a=f.row);if(this._canMoveCurrentTo(a,h,e))break}return{r:a,c:h}},_getNextColumnInSelection:function(a,h,b,d){for(b=this.getColumnCount();h<b;){(d=this._spanModel.find(a,h))?h+=d.colCount:h++;if(h>=b)break;if(d=this._spanModel.find(a,h)){var e=this._getActiveSelectedRange();if(e.row<=d.row&&d.row+d.rowCount<=e.row+e.rowCount&&
e.col<=d.col&&d.col+d.colCount<=e.col+e.colCount){if(d.row!==a||d.col!==h)continue}else continue;h>d.col?h=Math.max(h,d.col+d.colCount):a=d.row}if(this._canMoveCurrentTo(a,h))break}return{r:a,c:h}},_canMoveCurrentTo:function(a,h,b){b=!1;b=this.getRowVisible(a);var d=this.getColumnVisible(h),e=this._getZoomRowHeight(a),f=this._getZoomColumnWidth(h);return b=0<=a&&a<this.getRowCount()&&0<=h&&h<this.getColumnCount()&&b&&d&&0<e&&0<f},_getPrevRow:function(a,h,b,e){for(b={r:a,c:h};0<=a;){a--;if(0>a)break;
(e=this.getSpans(new d.Range(a,h,1,1)))&&0<e.length&&(e=e[0],a>=e.row&&(a=e.row,h=e.col));if(this._canMoveCurrentTo(a,h,b))break}return{r:a,c:h}},_getNextRow:function(a,h,b,e){b=this.getRowCount();for(e={r:a,c:h};a<b;){var f=this._spanModel.find(a,h);f?a+=f.rowCount:a++;if(a>=b)break;(f=this.getSpans(new d.Range(a,h,1,1)))&&0<f.length&&(f=f[0],a>f.row?a=Math.max(a,f.row+f.rowCount):h=f.col);if(this._canMoveCurrentTo(a,h,e))break}return{r:a,c:h}},_setSelectedRange:function(a,h,b,d,e){this._selectionModel.add(a,
h,b,d);e&&this._render.repaintSelection()},_extendSelectedRange:function(a,h,b){var e=this._getExtendedRange(a,h);a=e.row;h=e.col;var f=e.rowCount,e=e.colCount,g=this.selectionPolicy(),k=this.selectionUnit();g!==d.SelectionPolicy.Single&&(g===d.SelectionPolicy.Range&&this._selectionModel.clear(),k===d.SelectionUnit.Row?e=h=-1:k===d.SelectionUnit.Column&&(f=a=-1),this._replaceActiveSelectedRange(a,h,f,e,b))},_getExtendedRange:function(a,h){var b=new d.Range(this._activeRowIndex,this._activeColIndex,
1,1),e=this._spanModel.find(this._activeRowIndex,this._activeColIndex);e&&(b=e);var e=new d.Range(a,h,1,1),f=this._spanModel.find(a,h);f&&(e=f);b=b.union(e);(e=this.getSpans())&&0<e.length&&(b=this._inflateRangeToCoverSpans(e,b));return b},_replaceActiveSelectedRange:function(a,h,b,e,f){var g=this._getActiveSelectedRange();0<this._selectionModel.length?this._selectionModel.splice(this._selectionModel.activeSelectedRangeIndex,1,new d.Range(a,h,b,e)):this._selectionModel.add(a,h,b,e);f&&(a=this._getActiveSelectedRange(),
a.row!==g.row||a.col!==g.col||a.rowCount!==g.rowCount||a.colCount!==g.colCount)&&(h=this._render,g.containsRange(a)?h.repaintSelection(g):(a.containsRange(g)||h.repaintSelection(g),h.repaintSelection(a)))},_changeActiveSelectedRange:function(a,h){if(!(0>=this._selectionModel.length)){var b=this._getActiveSelectedRange(),e=new d.Range(b.row,b.col,b.rowCount,b.colCount);0>e.row&&(e.row=0,e.rowCount=this.getRowCount());0>e.col&&(e.col=0,e.colCount=this.getColumnCount());var f=null,g=d.Key;a===g.left?
f=h?this._searchSelectedRangebyLeftCtrl(e):this._searchSelectedRangebyLeft(e):a===g.right?f=h?this._searchSelectedRangebyRightCtrl(e):this._searchSelectedRangebyRight(e):a===g.up?f=h?this._searchSelectedRangebyUpCtrl(e):this._searchSelectedRangebyUp(e):a===g.down?f=h?this._searchSelectedRangebyDownCtrl(e):this._searchSelectedRangebyDown(e):a===g.home?f=h?this._searchSelectedRangebyHomeCtrl(e):this._searchSelectedRangebyHome(e):a===g.end?f=h?this._searchSelectedRangebyEndCtrl(e):this._searchSelectedRangebyEnd(e):
a===g.pup?f=this._searchSelectedRangebyPageUp(e):a===g.pdn&&(f=this._searchSelectedRangebyPageDown(e));if(f){0>b.row&&(f.row=-1,f.rowCount=-1);0>b.col&&(f.col=-1,f.colCount=-1);var b=this._selectionModel.toArray(),e=f.row,g=f.col,k=f.rowCount,f=f.colCount,l=this.selectionPolicy(),s=this.selectionUnit();l!==d.SelectionPolicy.Single&&(l===d.SelectionPolicy.Range&&this._selectionModel.clear(),s===d.SelectionUnit.Row?f=g=-1:s===d.SelectionUnit.Column&&(k=e=-1),this._replaceActiveSelectedRange(e,g,k,f,
!0),f=this._selectionModel.toArray(),this._eventHandler._notEqualSelecions(b,f)&&(e=d.Events,this._trigger(e.SelectionChanging,{sheet:this,sheetName:this._name,oldSelections:b,newSelections:f}),this._trigger(e.SelectionChanged,{sheet:this,sheetName:this._name})))}}},_searchSelectedRangebyLeft:function(a){for(var h=a.col+a.colCount-1,b={r:a.row+a.rowCount-1,c:h},e,f,g,k,l;0<h;)if(h--,this._canMoveCurrentTo(b.r,h,b)&&(e=this._getExtendedRange(b.r,h),f=Math.min(a.row,e.row),g=Math.min(a.col,e.col),k=
Math.max(a.row+a.rowCount-1,e.row+e.rowCount-1),e=Math.min(a.col+a.colCount-1,e.col+e.colCount-1),k=k-f+1,l=e-g+1,f!==a.row||g!==a.col||k!==a.rowCount||l!==a.colCount))return a=this._getPrevVisualColumn(this._scrollLeftCol),g!==a&&e!==a||this._setLeftColumn(a),new d.Range(f,g,k,l);return null},_searchSelectedRangebyLeftCtrl:function(a,h){var b=this.frozenColCount?this._getNextVisualColumn(this.frozenColCount-1):this._getFirstVisualColumn(),b=h?b:this._getFirstVisualColumn();if(void 0!==b&&null!==
b){(0>=this.frozenColCount||h)&&this._setLeftColumn(b);var e,f,g;e=this._getExtendedRange(a.row,b);b=Math.min(a.row,e.row);f=Math.min(a.col,e.col);g=Math.max(a.row+a.rowCount-1,e.row+e.rowCount-1);e=Math.min(a.col+a.colCount-1,e.col+e.colCount-1);return new d.Range(b,f,g-b+1,e-f+1)}},_searchSelectedRangebyRight:function(a){for(var h=a.col,b=this.getColumnCount()-1,e={r:a.row+a.rowCount-1,c:h},f,g,k,l,s;h<b;)if(h++,this._canMoveCurrentTo(e.r,h,e)&&(f=this._getExtendedRange(e.r,h),g=Math.min(a.row,
f.row),k=Math.max(a.col,f.col),l=Math.max(a.row+a.rowCount-1,f.row+f.rowCount-1),f=Math.max(a.col+a.colCount-1,f.col+f.colCount-1),l=l-g+1,s=f-k+1,g!==a.row||k!==a.col||l!==a.rowCount||s!==a.colCount))return a=this.frozenColCount?this._getNextVisualColumn(this.frozenColCount-1):null,h=this._getPageRightColumn(),void 0===a||null===a||k!==a&&f!==a?k!==h&&f!==h||this._setLeftColumn(this._getNextVisualColumn(this._scrollLeftCol)):this._setLeftColumn(a),new d.Range(g,k,l,s);return null},_searchSelectedRangebyRightCtrl:function(a){var h=
this._getLastPageLeftColumn();if(void 0!==h&&null!==h){this._setLeftColumn(h);var h=this._getLastVisualColumn(),b,e,f;b=this._getExtendedRange(a.row,h);h=Math.min(a.row,b.row);e=Math.max(a.col,b.col);f=Math.max(a.row+a.rowCount-1,b.row+b.rowCount-1);a=Math.max(a.col+a.colCount-1,b.col+b.colCount-1);return new d.Range(h,e,f-h+1,a-e+1)}},_searchSelectedRangebyUp:function(a){for(var h=a.row+a.rowCount-1,b={r:h,c:a.col+a.colCount-1},e,f,g,k,l;0<h;)if(h--,this._canMoveCurrentTo(h,b.c,b)&&(e=this._getExtendedRange(h,
b.c),f=Math.min(a.row,e.row),g=Math.min(a.col,e.col),k=Math.min(a.row+a.rowCount-1,e.row+e.rowCount-1),l=Math.max(a.col+a.colCount-1,e.col+e.colCount-1),e=k-f+1,l=l-g+1,f!==a.row||g!==a.col||e!==a.rowCount||l!==a.colCount))return a=this._getPrevVisualRow(this._scrollTopRow),f!==a&&k!==a||this._setTopRow(a),new d.Range(f,g,e,l);return null},_searchSelectedRangebyUpCtrl:function(a,h){var b=this.frozenRowCount?this._getNextVisualRow(this.frozenRowCount-1):this._getFirstVisualRow(),b=h?b:this._getFirstVisualRow();
if(void 0!==b&&null!==b){(0>=this.frozenRowCount||h)&&this._setTopRow(b);var e,f,g;e=this._getExtendedRange(b,a.col);b=Math.min(a.row,e.row);f=Math.min(a.col,e.col);g=Math.min(a.row+a.rowCount-1,e.row+e.rowCount-1);e=Math.max(a.col+a.colCount-1,e.col+e.colCount-1);return new d.Range(b,f,g-b+1,e-f+1)}},_searchSelectedRangebyDown:function(a){for(var h=a.row,b=this.getRowCount()-1,e={r:h,c:a.col+a.colCount-1},f,g,k,l,s;h<b;)if(h++,this._canMoveCurrentTo(h,e.c,e)&&(f=this._getExtendedRange(h,e.c),g=Math.max(a.row,
f.row),k=Math.min(a.col,f.col),l=Math.max(a.row+a.rowCount-1,f.row+f.rowCount-1),s=Math.max(a.col+a.colCount-1,f.col+f.colCount-1),f=l-g+1,s=s-k+1,g!==a.row||k!==a.col||f!==a.rowCount||s!==a.colCount))return a=this.frozenRowCount?this._getNextVisualRow(this.frozenRowCount-1):null,h=this._getPageBottomRow(),void 0===a||null===a||g!==a&&l!==a?g!==h&&l!==h||this._setTopRow(this._getNextVisualRow(this._scrollTopRow)):this._setTopRow(a),new d.Range(g,k,f,s);return null},_searchSelectedRangebyDownCtrl:function(a){var h=
this._getLastPageTopRow();if(void 0!==h&&null!==h){this._setTopRow(h);var h=this._getLastVisualRow(),b,e,f;b=this._getExtendedRange(h,a.col);h=Math.max(a.row,b.row);e=Math.min(a.col,b.col);f=Math.max(a.row+a.rowCount-1,b.row+b.rowCount-1);a=Math.max(a.col+a.colCount-1,b.col+b.colCount-1);return new d.Range(h,e,f-h+1,a-e+1)}},_searchSelectedRangebyHome:function(a){for(var h=this.frozenColCount?this.frozenColCount-1:-1,b=this._activeColIndex,e={r:a.row+a.rowCount-1,c:a.col},f;h<b;)if(h++,this._canMoveCurrentTo(e.r,
h,e)){if(a.col<=h&&a.col+a.colCount-1===this._activeColIndex)break;f=this._getExtendedRange(e.r,h);h=Math.min(a.row,f.row);b=Math.min(a.col,f.col);e=Math.max(a.row+a.rowCount-1,f.row+f.rowCount-1);a=Math.min(a.col+a.colCount-1,f.col+f.colCount-1);e=e-h+1;a=a-b+1;this._setLeftColumn(this._getFirstVisualColumn());return new d.Range(h,b,e,a)}return null},_searchSelectedRangebyHomeCtrl:function(a){a=this._searchSelectedRangebyLeftCtrl(a,!0);return a=this._searchSelectedRangebyUpCtrl(a,!0)},_searchSelectedRangebyEnd:function(a){for(var h=
this.getColumnCount(),b=this._activeColIndex,e={r:a.row+a.rowCount-1,c:a.col+a.colCount-1},f;h>b;)if(h--,this._canMoveCurrentTo(e.r,h,e)){if(a.col+a.colCount-1>=h&&a.col===this._activeColIndex)break;f=this._getExtendedRange(e.r,h);h=Math.min(a.row,f.row);b=Math.max(a.col,f.col);e=Math.max(a.row+a.rowCount-1,f.row+f.rowCount-1);a=Math.max(a.col+a.colCount-1,f.col+f.colCount-1);e=e-h+1;a=a-b+1;this._setLeftColumn(this._getLastPageLeftColumn());return new d.Range(h,b,e,a)}return null},_searchSelectedRangebyEndCtrl:function(a){a=
this._searchSelectedRangebyRightCtrl(a);return a=this._searchSelectedRangebyDownCtrl(a)},_searchSelectedRangebyPageUp:function(a){var h=this._getPrevPageTopRow();if(void 0===h||null===h)return null;var b=this._getRowLayout(1),e=-1;this._setTopRow(h)?e=this._getNextVisualRow(a.row+a.rowCount-1-b.length):0>=this.frozenRowCount&&(e=this._getFirstVisualRow());e<this._scrollTopRow?e=this._scrollTopRow:e>=this._getPageBottomRow()&&(e=this._getPrevVisualRow(this._getPageBottomRow()));var f;f=this._getExtendedRange(e,
a.col);h=Math.min(a.row,f.row);b=Math.min(a.col,f.col);e=Math.min(a.row+a.rowCount-1,f.row+f.rowCount-1);a=Math.max(a.col+a.colCount-1,f.col+f.colCount-1);return new d.Range(h,b,e-h+1,a-b+1)},_searchSelectedRangebyPageDown:function(a){var h=this._getNextPageTopRow();if(void 0===h||null===h)return null;var b=this._getRowLayout(1);this._setTopRow(h);h=this._getPrevVisualRow(a.row+a.rowCount-1+b.length);h<this._scrollTopRow?h=this._scrollTopRow:h>=this._getPageBottomRow()&&(h=this._scrollTopRow>=this._getLastPageTopRow()?
this._getPageBottomRow():this._getPrevVisualRow(this._getPageBottomRow()));var e,f;e=this._getExtendedRange(h,a.col);h=Math.max(a.row,e.row);b=Math.min(a.col,e.col);f=Math.max(a.row+a.rowCount-1,e.row+e.rowCount-1);a=Math.max(a.col+a.colCount-1,e.col+e.colCount-1);return new d.Range(h,b,f-h+1,a-b+1)},_getPrevPageTopRow:function(){var a=this._getRowLayout(1);if(!a||0>=a.length)return null;for(var a=this.frozenRowCount?this._getNextVisualRow(this.frozenRowCount-1):this._getFirstVisualRow(),h=0,b=this._scrollTopRow,
d=this._getSheetLayout();b>a;){h+=this._getZoomRowHeight(b);if(h>d.viewportHeight)break;b--}return b},_getPrevPageLeftColumn:function(){var a=this._getColumnLayout(1);if(!a||0>=a.length)return null;if(a[0].col===this._getFirstVisualColumn())return a[0].col;for(var a=0,h=this._scrollLeftCol,b=this._getSheetLayout();0<h;){a+=this._getZoomColumnWidth(h);if(a>b.viewportWidth)break;h--}return h},_getNextPageTopRow:function(){var a=this._getRowLayout(1);return!a||0>=a.length?null:this._getLastVisualRow()===
a[a.length-1].row?this._scrollTopRow:a[a.length-1].row},_getLastPageTopRow:function(){if(this._getLastVisualRow()===this._getPageBottomRow()){var a=this._getSheetLayout(),h=this._getRowLayout(1);if(h&&1<=h.length&&(h=h[h.length-1],h.y+h.height<=a.viewportHeight))return this._scrollTopRow}a=this._scrollTopRow;try{this._scrollTopRow=this._getLastVisualRow();var b=this._getPrevPageTopRow();return b=this._getNextVisualRow(b)}catch(d){}finally{this._scrollTopRow=a}},_getLastPageLeftColumn:function(){var a;
if(this._getLastVisualColumn()===this._getPageRightColumn()){a=this._getSheetLayout();var h=this._getColumnLayout(1);if(h&&1<=h.length&&(h=h[h.length-1],h.x+h.width<=a.width))return this._scrollLeftCol}a=this._getSheetLayout();for(var h=0,b=this._getLastVisualColumn();0<b;){h+=this._getZoomColumnWidth(b);if(h>a.viewportWidth)break;b--}0<b&&(b=this._getNextVisualColumn(b));return b},_getPageBottomRow:function(){var a=this._getRowLayout(1);return!a||0>=a.length?null:a[a.length-1].row},_getPageRightColumn:function(){var a=
this._getColumnLayout(1);return!a||0>=a.length?null:a[a.length-1].col},_getLastFullyVisibleRow:function(){var a=this._getRowLayout(1);if(!a||0>=a.length)return null;var h=this._getSheetLayout(),b=a.length-1;return a[b].y+a[b].height<=h.viewportY+h.viewportHeight?a[b].row:a[Math.max(b-1,0)].row},_getLastFullyVisibleColumn:function(){var a=this._getColumnLayout(1);if(!a||0>=a.length)return null;var h=this._getSheetLayout(),b=a.length-1;return a[b].x+a[b].width<=h.viewportX+h.viewportWidth?a[b].col:
a[Math.max(b-1,0)].col},_getFirstVisualRow:function(){return this._getNextVisualRow(-1)},_getLastVisualRow:function(a){if(void 0===a||null===a)a=d.SheetArea.viewport;return this._getPrevVisualRow(this.getRowCount(a),a)},_getFirstVisualColumn:function(){return this._getNextVisualColumn(-1)},_getLastVisualColumn:function(a){if(void 0===a||null===a)a=d.SheetArea.viewport;return this._getPrevVisualColumn(this.getColumnCount(a),a)},_getFirstPageLeftColumn:function(){var a=0,a=isNaN(this.frozenColCount)?
0:this.frozenColCount;return a=0<a?this._getNextVisualColumn(a-1):this._getFirstVisualColumn()},_getFirstPageTopRow:function(){var a=0,a=isNaN(this.frozenRowCount)?0:this.frozenRowCount;return a=0<a?this._getNextVisualRow(a-1):this._getFirstVisualRow()},_getNextVisualRow:function(a){for(var h=this.getRowCount()-1;a<h;)if(a++,this.getRowVisible(a)&&0<this._getZoomRowHeight(a))return a;return null},_getPrevVisualRow:function(a,h){for(;0<a;)if(a--,this.getRowVisible(a,h)&&0<this._getZoomRowHeight(a,
h))return a;return null},_getNextVisualColumn:function(a){for(var h=this.getColumnCount()-1;a<h;)if(a++,this.getColumnVisible(a)&&0<this._getZoomColumnWidth(a))return a;return null},_getPrevVisualColumn:function(a,h){for(;0<a;)if(a--,this.getColumnVisible(a,h)&&0<this._getZoomColumnWidth(a,h))return a;return null},_inflateRangeToCoverSpans:function(a,h){if(a&&0<a.length)for(var b=0;b<a.length;b++){var d=a[b];if(h.intersect(d.row,d.col,d.rowCount,d.colCount))return a.splice(b--,1),this._inflateRangeToCoverSpans(a,
h.union(d))}return h},_getActiveSelectedRange:function(a){var h=new d.Range(-1,-1,0,0);if(0>=this._selectionModel.length)return h;var b=d.Direction;a===b.left?(this._selectionModel.activeSelectedRangeIndex--,0>this._selectionModel.activeSelectedRangeIndex&&(this._selectionModel.activeSelectedRangeIndex=this._selectionModel.length-1)):a===b.right&&(this._selectionModel.activeSelectedRangeIndex++,this._selectionModel.activeSelectedRangeIndex>=this._selectionModel.length&&(this._selectionModel.activeSelectedRangeIndex=
0));0<=this._selectionModel.activeSelectedRangeIndex&&(h=this._selectionModel[this._selectionModel.activeSelectedRangeIndex]);(a=this._spanModel.find(h.row,h.col))&&a.containsRange(h)&&(h=a);return h},_initializeActiveCell:function(){if(void 0===this._activeRowIndex||null===this._activeRowIndex||void 0===this._activeColIndex||null===this._activeColIndex||0>=this._selectionModel.length){var a=this._spanModel.find(0,0);a?(this._selectionModel.add(0,0,a.rowCount,a.colCount),this._activeColIndex=this._activeRowIndex=
0,this._activeRowCount=a.rowCount,this._activeColCount=a.colCount):(this._selectionModel.add(0,0,1,1),this._activeColIndex=this._activeRowIndex=0,this._activeColCount=this._activeRowCount=1);0<this._selectionModel.length&&this._render.repaintSelection(this._selectionModel[0])}},_setHoverCell:function(a){var h=!1,b=this._currentTarget;b||(h=!0);h||a||(h=!0);h||(h=a.col!==b.col||a.row!==b.row||a.colViewportIndex!==b.colViewportIndex||a.rowViewportIndex!==b.rowViewportIndex||a.hitTestType!==b.hitTestType);
this._currentTarget=a;var e,f;if(h){this._hoverCell=!0;var g=this._getSheetLayout(),k=null,l=d.SheetArea;if(b&&(0>b.rowViewportIndex||0>b.colViewportIndex)&&(k=this.getCellRect(b.row,b.col,b.rowViewportIndex,b.colViewportIndex))&&0<k.width&&0<k.height){e=h=0;if(f=this._getGroupLayout())h=f.width,e=f.height;if(k.x<g.rowHeaderWidth+h||k.y<g.colHeaderHeight+e||k.y>=g.height-g.footerHeight)0>b.colViewportIndex&&b.col===this.getColumnCount(l.rowHeader)-1?this._render.update(k.x-1,k.y-1,k.width+1,k.height+
2):b.row===this.getRowCount(l.colHeader)-1?this._render.update(k.x-1,k.y-1,k.width+2,k.height+1):this._render.update(k.x-1,k.y-1,k.width+2,k.height+2)}if(a&&(0>a.rowViewportIndex||0>a.colViewportIndex)&&(k=this.getCellRect(a.row,a.col,a.rowViewportIndex,a.colViewportIndex))&&0<k.width&&0<k.height){e=h=0;if(f=this._getGroupLayout())h=f.width,e=f.height;if(k.x<g.rowHeaderWidth+h||k.y<g.colHeaderHeight+e||k.y>=g.height-g.footerHeight)0>a.colViewportIndex&&a.col===this.getColumnCount(l.rowHeader)-1?this._render.update(k.x-
1,k.y-1,k.width+1,k.height+2):a.row===this.getRowCount(l.colHeader)-1?this._render.update(k.x-1,k.y-1,k.width+2,k.height+1):this._render.update(k.x-1,k.y-1,k.width+2,k.height+2)}this._hoverCell=!1}},_getAvailableActiveCell:function(a,h,b){a=this._skipSpanCell(a,h,b);return this._skipInvisibleCell(a)},_skipSpanCell:function(a,h,b){var e=this._spanModel.find(a,h);if(!e)return new d.Range(a,h,1,1);if(b&&1===e.rowCount||!b&&1===e.colCount)return e;b?h++:a++;return this._skipSpanCell(a,h,b)},_skipInvisibleCell:function(a){var h=
a.row,b,e=this.getRowCount();for(b=h;b<e&&!0!==this.getRowVisible(b);b++);b<e&&(h=b);var e=a.col,f=this.getColumnCount();for(b=e;b<f&&!0!==this.getColumnVisible(b);b++);b<f&&(e=b);return new d.Range(h,e,a.rowCount,a.colCount)},_processKeyMap:function(a){var h=!0,b=this._getKeyAction(a.keyCode,a.ctrlKey,a.shiftKey,a.altKey);b&&typeof b.action===g&&(h=b.action.call(this),a.keyCode===d.Key.enter&&!1===a.ctrlKey&&!1===a.altKey&&d.cancelDefault(a),"object"===typeof h&&(h.processed&&d.cancelDefault(a),
h=!1));return h},_getRowInfos:function(a){var h=d.SheetArea;if(void 0===a||null===a||a===h.viewport||a===h.rowHeader)return this._rowInfos||(this._rowInfos={}),this._rowInfos;if(a===h.colHeader)return this._colHeaderRowInfos||(this._colHeaderRowInfos={}),this._colHeaderRowInfos},_getZoomRowHeight:function(a,h){return parseInt(this.getRowHeight(a,h)*this._zoomFactor,10)},_getColumnInfos:function(a){var h=d.SheetArea;return void 0===a||null===a||a===h.viewport||a===h.colHeader?(this._colInfos||(this._colInfos=
{}),this._colInfos):a===h.rowHeader?(this._rowHeaderColInfos||(this._rowHeaderColInfos={}),this._rowHeaderColInfos):null},_getZoomColumnWidth:function(a,h){return parseInt(this.getColumnWidth(a,h)*this._zoomFactor,10)},_getGroupLayout:function(){this._cachedGroupLayout||(this._cachedGroupLayout=this._createGroupLayout());return this._cachedGroupLayout},_createGroupLayout:function(){var a={x:0,y:0,width:0,height:0};if(this._showRowRangeGroup&&this.rowRangeGroup){var h=this.rowRangeGroup.getMaxLevel();
if(0<=h){var b=Math.min(this._GROUPBUTTON_WIDTH,this._GROUPBUTTON_WIDTH*this._zoomFactor);a.width=b*(h+2)+2*this._GROUPPADDING}}this._showColumnRangeGroup&&this.colRangeGroup&&(h=this.colRangeGroup.getMaxLevel(),0<=h&&(b=Math.min(this._GROUPBUTTON_HEIGHT,this._GROUPBUTTON_HEIGHT*this._zoomFactor),a.height=b*(h+2)+2*this._GROUPPADDING));return a},_createLayout:function(){var a=d.Rect,h=new a(this._bounds.x+this.borderWidth,this._bounds.y+this.borderWidth,Math.max(0,this._bounds.width-2*this.borderWidth),
Math.max(0,this._bounds.height-2*this.borderWidth)),b=h.width,e=h.height,h={x:h.x,y:h.y,width:h.width,height:h.height,rowHeaderWidth:0,colHeaderHeight:0,frozenWidth:0,frozenHeight:0,footerHeight:0,footerWidth:0,headerCornerRect:function(){return new a(this.x,this.y,this.rowHeaderWidth,this.colHeaderHeight)},colHeaderRect:function(h){return 0===h?new a(this.frozenX,this.y,this.frozenWidth,this.colHeaderHeight):1===h?new a(this.viewportX,this.y,this.viewportWidth,this.colHeaderHeight):new a(this.frozenX,
this.y,this.frozenWidth+this.viewportWidth,this.colHeaderHeight)},rowHeaderRect:function(h){return 0===h?new a(this.x,this.frozenY,this.rowHeaderWidth,this.frozenHeight):1===h?new a(this.x,this.viewportY,this.rowHeaderWidth,this.viewportHeight):new a(this.x,this.frozenY,this.rowHeaderWidth,this.frozenHeight+this.viewportHeight)},viewportRect:function(h,b){return 0===h?0===b?new a(this.frozenX,this.frozenY,this.frozenWidth,this.frozenHeight):1===b?new a(this.viewportX,this.frozenY,this.viewportWidth,
this.frozenHeight):new a(this.frozenX,this.frozenY,this.frozenWidth+this.viewportWidth,this.frozenHeight):1===h?0===b?new a(this.frozenX,this.viewportY,this.frozenWidth,this.viewportHeight):1===b?new a(this.viewportX,this.viewportY,this.viewportWidth,this.viewportHeight):new a(this.frozenX,this.viewportY,this.frozenWidth+this.viewportWidth,this.viewportHeight):0===b?new a(this.frozenX,this.frozenY,this.frozenWidth,this.frozenHeight+this.viewportHeight):1===b?new a(this.viewportX,this.frozenY,this.viewportWidth,
this.frozenHeight+this.viewportHeight):new a(this.frozenX,this.frozenY,this.frozenWidth+this.viewportWidth,this.frozenHeight+this.viewportHeight)},footerRect:function(h){return 0===h?new a(this.frozenX,this.footerY,this.frozenWidth,this.footerHeight):1===h?new a(this.viewportX,this.footerY,this.viewportWidth,this.footerHeight):new a(this.frozenX,this.footerY,this.frozenWidth+this.viewportWidth,this.footerHeight)},footerCornerRect:function(){return new a(this.footerX,this.footerY,this.footerWidth,
this.footerHeight)}},f=this._getGroupLayout();h.x+=f.width;h.y+=f.height;var f=d.SheetArea,g,k;if(null===this.rowHeaderVisible||void 0===this.rowHeaderVisible||this.rowHeaderVisible)for(k=this.getColumnCount(f.rowHeader),g=0;g<k;g++)h.rowHeaderWidth+=this._getZoomColumnWidth(g,f.rowHeader);if(null===this.colHeaderVisible||void 0===this.colHeaderVisible||this.colHeaderVisible)for(k=this.getRowCount(f.colHeader),g=0;g<k;g++)h.colHeaderHeight+=this._getZoomRowHeight(g,f.colHeader);if(this._colFooterVisible)for(k=
this.getRowCount(f.colFooter),g=0;g<k;g++)h.footerHeight+=this._getZoomRowHeight(g,f.colFooter);h.footerWidth=h.rowHeaderWidth;if(0<this.frozenColCount)for(k=this.getColumnCount(),g=0;g<this.frozenColCount&&g<k;g++)this.getColumnVisible(g)&&(h.frozenWidth+=this._getZoomColumnWidth(g));h.frozenWidth>h.width&&(h.frozenWidth=h.width-h.rowHeaderWidth);if(0<this.frozenRowCount)for(k=this.getRowCount(),g=0;g<this.frozenRowCount&&g<k;g++)this.getRowVisible(g)&&(h.frozenHeight+=this._getZoomRowHeight(g));
h.frozenHeight>h.height-h.colHeaderHeight&&(h.frozenHeight=h.height-h.colHeaderHeight);b-=h.rowHeaderWidth;e-=h.colHeaderHeight;b-=h.frozenWidth;e-=h.frozenHeight;e-=h.footerHeight;h.viewportWidth=Math.max(0,b);h.viewportHeight=Math.max(0,e);h.headerX=h.x;h.headerY=h.y;h.frozenX=h.headerX+h.rowHeaderWidth;h.frozenY=h.headerY+h.colHeaderHeight;h.viewportX=h.frozenX+h.frozenWidth;h.viewportY=h.frozenY+h.frozenHeight;h.footerX=h.headerX;h.footerY=h.y+h.height-h.footerHeight;return h},_getSheetLayout:function(){this._layoutModel||
(this._layoutModel=this._createLayout());return this._layoutModel},_getColumnLayout:function(a,h){var b=null,e=d.SheetArea;void 0===h||null===h||h===e.viewport||h===e.colHeader?b=this._colLayoutCache.viewport[a]:h===e.rowHeader&&(b=this._colLayoutCache.rowHeader[a]);if(b)return b;b=this._createColumnLayout(a,h);h===e.viewport||h===e.colHeader?this._colLayoutCache.viewport[a]=b:h===e.rowHeader&&(this._colLayoutCache.rowHeader[a]=b);return b},_createColumnLayout:function(a,h){var b=new d._LayoutModel,
e=this._getSheetLayout(),f=0,g=0,k=this.getColumnCount(h),l,s=0,f=isNaN(this.frozenColCount)?0:Math.min(this.frozenColCount,this.getColumnCount());l=0;h===d.SheetArea.rowHeader?(f=e.headerX,g=e.rowHeaderWidth):(0===a?k=f:0<a&&(l=Math.max(f,this._scrollLeftCol)),f=0<a?e.viewportX:e.frozenX,g=0<a?e.viewportWidth:e.frozenWidth);0===this.colVisibleCount&&(k=0);e=l;for(l=0;e<k&&(h===d.SheetArea.rowHeader||0===a||l<=g);e++,l+=s)this.getColumnVisible(e,h)?(s=this._getZoomColumnWidth(e,h),0<=s&&b.push(new d._Layout(-1,
e,f+l,-1,s,-1))):l-=s;return b},_getRowLayout:function(a,h){var b=null,e=d.SheetArea;void 0===h||null===h||h===e.viewport||h===e.rowHeader?b=this._rowLayoutCache.viewport[a]:h===e.colHeader?b=this._rowLayoutCache.colHeader[a]:h===e.colFooter&&(b=this._rowLayoutCache.colFooter[a]);if(b)return b;b=this._createRowLayout(a,h);h===e.viewport||h===e.rowHeader?this._rowLayoutCache.viewport[a]=b:h===e.colHeader?this._rowLayoutCache.colHeader[a]=b:h===e.colFooter&&(this._rowLayoutCache.colFooter[a]=b);return b},
_createRowLayout:function(a,h){var b=new d._LayoutModel,e=this._getSheetLayout(),f=0,g=0,k=this.getRowCount(h),l,s=0;l=isNaN(this.frozenRowCount)?0:Math.min(this.frozenRowCount,this.getRowCount());var q=0,m=d.SheetArea;void 0===h||null===h||h===m.viewport||h===m.rowHeader?(0===a?k=l:0<a&&(q=Math.max(l,this._scrollTopRow)),f=0<a?e.viewportY:e.frozenY,g=0<a?e.viewportHeight:e.frozenHeight):h===m.colHeader?(f=e.headerY,g=e.colHeaderHeight):h===m.colFooter&&(f=e.footerY,g=e.footerHeight);e=q;for(l=f;e<
k&&(h===m.colHeader||h===m.colFooter||0===a||l<f+g);e++,l+=s)this.getRowVisible(e,h)?(s=this._getZoomRowHeight(e,h),0<=s&&b.push(new d._Layout(e,-1,-1,l,-1,s))):l-=s;return b},_getCellLayout:function(a,h,b){this._getSheetLayout();var e=d.SheetArea,f=this.getRowCount(b),g=this.getColumnCount(b);a=this._getRowLayout(a,b);h=this._getColumnLayout(h,b);var k=new d._LayoutModel;if(0<a.length&&0<h.length){var l=a[0].row,s=h[0].col,q=a[a.length-1].row,m=h[h.length-1].col,t=this.getSpans(new d.Range(l,s,q-
l+1,m-s+1),b);this._addCellLayout(t,l,s,q,m,k,f,g,b,a,h);if(void 0===b||null===b||b===e.viewport)t=new d._SpanModel,this._addCellLayout(t,l,s,q,m,k,f,g,b,a,h)}return k},_addCellLayout:function(a,h,b,e,f,g,k,l,s,q,m){for(var t=0;t<a.length;t++){var r=a[t];if(r.intersect(h,b,e-h+1,f-b+1)){var u=0,p=0,A=0,L=0,D;for(D=r.col;D<b;D++)u-=this._getZoomColumnWidth(D,s);for(D=b;D<r.col;D++)u+=this._getZoomColumnWidth(D,s);for(D=r.row;D<h;D++)p-=this._getZoomRowHeight(D,s);for(D=h;D<r.row;D++)p+=this._getZoomRowHeight(D,
s);for(D=r.col;D<r.col+r.colCount&&D<l;D++)A+=this._getZoomColumnWidth(D,s);for(D=r.row;D<r.row+r.rowCount&&D<k;D++)L+=this._getZoomRowHeight(D,s);g.push(new d._Layout(r.row,r.col,m[0].x+u,q[0].y+p,A,L,r.rowCount,r.colCount))}}},_syncHScollbarPosition:function(){this._scrollCallback&&this._scrollCallback({action:"scroll",orientation:"horizontal"})},_syncVScrollbarPosition:function(){this._scrollCallback&&this._scrollCallback({action:"scroll",orientation:"vertical"})},_syncScrollbarSize:function(){this._scrollCallback&&
this._scrollCallback({action:"resize"})},_setTopRow:function(b,h){if(h||void 0!==b&&null!==b&&b>=this._getFirstPageTopRow()&&b<=this._getLastVisualRow()&&b!==this._scrollTopRow){this._trigger(d.Events.TopRowChanged,{sheet:this,sheetName:this._name,oldTopRow:this._scrollTopRow,newTopRow:b});var e=!1;if(a.UI._useDoubleBuffer()){var f=this._render._getBufferCtx(),g=this._scrollTopRow,k=null,l=this._getRowLayout(1,a.UI.SheetArea.viewport);this._scrollTopRow=b;if(this._scrollTopRow>g&&l){var s=l.findRow(this._scrollTopRow);
if(s){e=!0;k=this._getSheetLayout();if(0>=l.length)return!1;var q=l.length-1,m=l[q],t=l[q].height+2;l[q].y+l[q].height>k.viewportHeight&&(t+=l[q-1].height);if(0<k.viewportHeight-s.y-t){this._render.translateScreen(k.x,s.y,k.rowHeaderWidth+k.frozenWidth+k.viewportWidth,k.viewportHeight-s.y-t,k.x,k.viewportY);this._render._copyDoubleBufferRect(new d.Rect(k.x,s.y,k.rowHeaderWidth+k.frozenWidth+k.viewportWidth,k.viewportHeight-s.y-t),k.x,k.viewportY,null,f,f);for(q=g;q<this._scrollTopRow;q++)this._clearCellOverflowModelCachebyRow(q);
f=this._cellOverflowModelCache;this.invalidateLayout();this._cellOverflowModelCache=f;l=this._getRowLayout(1,a.UI.SheetArea.viewport);if(!l||0>=l.length)return!1;f=l[l.length-1];for(q=m.row+1;q<=f.row+1;q++)this._render._buildCellOverflowLayoutModel(q,a.UI.SheetArea.viewport);this._render.update(k.x,k.viewportY+k.viewportHeight-s.y-t,k.rowHeaderWidth+k.frozenWidth+k.viewportWidth,s.y+t,!1)}else this.invalidateLayout(),this.repaint()}}else{k=this._getSheetLayout();s=0;for(q=this._scrollTopRow;q<g&&
s<k.viewportHeight;q++)s+=this._getZoomRowHeight(q);if(s<k.viewportHeight){e=!0;l=this._getRowLayout(1,a.UI.SheetArea.viewport);if(!l)return!1;if(m=l.findRow(g)){t=m.height+2;q=this.getActiveColumnIndex();0<=q&&q<this.getColumnCount()&&this._getColumnLayout(1,a.UI.SheetArea.viewport).findCol(q)&&(m=this.getCellRect(m.row,q))&&(t=m.height+2);this._render.translateScreen(k.x,k.viewportY+t,k.rowHeaderWidth+k.frozenWidth+k.viewportWidth,k.viewportHeight-s-t,k.x,k.viewportY+s+t);this._render._copyDoubleBufferRect(new d.Rect(k.x,
k.viewportY+t,k.rowHeaderWidth+k.frozenWidth+k.viewportWidth,k.viewportHeight-s-t),k.x,k.viewportY+s+t,null,f,f);for(q=this._scrollTopRow;q<g;q++)this._render._buildCellOverflowLayoutModel(q,a.UI.SheetArea.viewport);if(0>=l.length)return!1;m=l[l.length-1];f=this._cellOverflowModelCache;this.invalidateLayout();this._cellOverflowModelCache=f;l=this._getRowLayout(1,a.UI.SheetArea.viewport);if(!l||0>=l.length)return!1;f=l[l.length-1];for(q=f.row+1;q<=m.row;q++)this._clearCellOverflowModelCachebyRow(q);
this._render.update(k.x,k.viewportY,k.rowHeaderWidth+k.frozenWidth+k.viewportWidth,s+t,!1)}}}}else this._scrollTopRow=b;e||(this.invalidateLayout(),this.repaint());this._syncVScrollbarPosition();return!0}},_setLeftColumn:function(a,h){if(h||void 0!==a&&null!==a&&a>=this._getFirstPageLeftColumn()&&a<=this._getLastVisualColumn()&&a!==this._scrollLeftCol)return this._trigger(d.Events.LeftColumnChanged,{sheet:this,sheetName:this._name,oldLeftCol:this._scrollLeftCol,newLeftCol:a}),this._scrollLeftCol=
a,this.invalidateLayout(),this.repaint(),this._syncHScollbarPosition(),!0},_getSpanModel:function(a){var h=d.SheetArea;if(void 0===a||null===a||a===h.viewport)return this._spanModel;if(a===h.colHeader)return this._colHeaderSpanModel;if(a===h.rowHeader)return this._rowHeaderSpanModel},_clipboardCopy:function(a,h){if(a){var b=new d.Range(a.row,a.col,a.rowCount,a.colCount);-1===b.row&&(b.row=0);-1===b.col&&(b.col=0);-1===b.rowCount&&(b.rowCount=this.getRowCount()-b.row);-1===b.colCount&&(b.colCount=
this.getColumnCount()-b.col);var b=this.getCsv(b.row,b.col,b.rowCount,b.colCount,"\r\n","\t"),e=this._getClipboardHelper();e.fromSheet=this;e.range=a;e.isCutting=h;try{if(p.clipboardData&&p.clipboardData.setData){var f={sheet:this,sheetName:this._name,copyData:b,cancel:!1},g=d.Events;this._trigger(g.ClipboardChanging,f);f&&!1===f.cancel?(p.clipboardData.setData("Text",b),this._trigger(g.ClipboardChanged,{sheet:this,sheetName:this._name,copyData:b})):(e.fromSheet=null,e.range=null)}}catch(k){}}},_trySearch:function(a,
h,b){if(a){var e=d.SearchFlags;a=a.toString();h=h.toString();var f=0<(b&e.ExactMatch);if(f&&0===(b&e.UseWildCards))return 0<(b&e.IgnoreCase)&&(a=a.toLowerCase(),h=h.toLowerCase()),a===h;var g=0<(b&e.UseWildCards);b=0<(b&e.IgnoreCase)?RegExp(k(h,g,f),"i"):RegExp(k(h,g,f));b=-1<a.search(b);f&&b&&-1>=h.search(/\*/)&&(b=a.length===h.length);return b}return!1},_getFilterButtonHitInfo:function(a,b,e){if(!this._rowFilter)return null;if(!this._filterButtonsModel){this._filterButtonsModel={};for(var f=-1;1>=
f;f++){this._filterButtonsModel[f]={};for(var g=-1;1>=g;g++)this._filterButtonsModel[f][g]=[]}var f=this._getActualRange(this._rowFilter.range),g=f.row-1,k=f.col,l=1,s=1,q=d.SheetArea.viewport;0>g?(l=-1,q=d.SheetArea.colHeader,g=this.getRowCount(q)-1):g<this.frozenRowCount&&(l=0);for(var t=this._filterButtonsModel[l],m=0;m<f.colCount;m++){var r=g,u=k+m;(s=this.getSpans(new d.Range(r,u,1,1),q))&&0<s.length&&(r=s[0].row);var s=u<this.frozenColCount?0:1,p=this.getCellRect(r,u,l,s),p=this._render._getFilterButtonRect(p);
t[s].push({row:r,col:u,x:p.x,y:p.y,width:p.width,height:p.height,sheetArea:q})}}for(var K in this._filterButtonsModel)if(this._filterButtonsModel[K]){var f=this._filterButtonsModel[K],A;for(A in f)if(f[A]&&(g=f[A],0<g.length))for(k=0;k<g.length;k++)if(l=g[k],a.row===l.row&&a.col===l.col&&a.hitTestType===l.sheetArea&&b>=l.x&&b<=l.x+l.width&&e>=l.y&&e<=l.y+l.height)return l}return null},_getCellTypeHitInfo:function(a,b,e){var d=a.row,f=a.col;a=a.hitTestType;var g=this.getCellType(d,f,a),k=this.getCellRect(d,
f),l=this.getActualStyle(d,f,a);return this.isProtected&&l.locked?null:this._allowEditorReservedLocations?g.getHitInfo(b,e,d,f,l,k,a):null},_clearCellOverflowModelCachebyRow:function(a,b){!this._cellOverflowModelCache||void 0!==b&&null!==b&&b!==d.SheetArea.viewport||(this._cellOverflowModelCache[a]=null)},_clearCellOverflowModelCache:function(){this._cellOverflowModelCache&&(this._cellOverflowModelCache=null)},_trigger:function(a,b){this._eventHandler.trigger(a,b)},_disposeUserEvents:function(){this.unbindAll();
this._unbindAll()},_doCommand:function(a){this.undoManager().doAction(a)},_refreshTabStrip:function(){this.parent&&this.parent._tab&&this.parent._tab.repaint&&this.parent._tab.repaint()},_isAnyCellInRangeLocked:function(a){a=this._getActualRange(a);for(var b=a.row;b<a.row+a.rowCount;b++)for(var e=a.col;e<a.col+a.colCount;e++)if(!0===this.getActualStyle(b,e).locked)return!0;return!1},_isValidRange:function(a,b,e,d,f,g){if(-1<=a&&a<f&&-1<=b&&b<g){if(-1===a&&-1===b)return!0;if(-1===a){if(0!==d&&b+d<=
g)return!0}else if(-1===b){if(0!==e&&a+e<=f)return!0}else if(0!==d&&b+d<=g&&0!==e&&a+e<=f)return!0}return!1},_setValueInternal:function(a,b,e,d,f){this.setValue(a,b,d,e,!1)},_hasPartSpans:function(a,b,e,d){var f,g;if(0>a&&0>b)return!1;if(0>a){if((g=this._colHeaderSpanModel)&&0!==g.length)for(f=g.getEnumerator(-1,b,-1,d);f.moveNext();)if(g=f.current(),g.col<b||g.col+g.colCount>b+d)return!0}else if(0>b&&(g=this._rowHeaderSpanModel)&&0!==g.length)for(f=g.getEnumerator(a,-1,e,-1);f.moveNext();)if(g=f.current(),
g.row<a||g.row+g.rowCount>a+e)return!0;if((g=this._spanModel)&&0!==g.length)for(f=g.getEnumerator(a,b,e,d);f.moveNext();)if(g=f.current(),-1!==a&&(g.row<a||g.row+g.rowCount>a+e)||-1!==b&&(g.col<b||g.col+g.colCount>b+d))return!0;return!1},_hasSpans:function(a,b,e,d){var f=this._spanModel;if(f)for(var g=0;g<f.length;g++)if(f[g].intersect(a,b,e,d))return!0;return!1},_hasPartArrayFormulas:function(a,b,e,d){var f=this._getsArrayFormulas(a,b,e,d);if(f&&0<f.length)for(var g=f.length,k=0;k<g;k++){var l=f[k][0];
if(-1!==a&&(l.row<a||l.row+l.rowCount>a+e)||-1!==b&&(l.col<b||l.col+l.colCount>b+d))return!0}return!1},_getsArrayFormulas:function(a,b,e,d){if((d=this._findFormulas(a,b,e,d))&&0<d.length){a=[];b=[];var f=d.length;for(e=0;e<f;e++){var g=d[e][1];g&&""!==g&&"{"===g[0]&&"}"===g[g.length-1]&&(b.push(d[e][0]),a.push(g))}if(0<a.length){d={};for(e=0;e<a.length;e++)d[e][0]=b[e],d[e][1]=a[e];return d}}return null},_raiseDragDropBlock:function(a,b,e,f,g,k,l,s,q){a={sheet:this,sheetName:this._name,fromRow:a,
fromCol:b,toRow:e,toCol:f,rowCount:g,colCount:k,copy:l,insert:s,copyOption:q,cancel:!1};this._trigger(d.Events.DragDropBlock,a);return a&&!0===a.cancel},_raiseDragDropBlockCompleted:function(a,b,e,f,g,k,l,s,q){this._trigger(d.Events.DragDropBlockCompleted,{sheet:this,sheetName:this._name,fromRow:a,fromCol:b,toRow:e,toCol:f,rowCount:g,colCount:k,copy:l,insert:s,copyOption:q})},_raiseInvalidOperation:function(a){this._trigger(d.Events.InvalidOperation,{sheet:this,sheetName:this._name,message:a})},_suspendInvalidate:function(){this._layoutSuspended++},
_resumeInvalidate:function(){this._layoutSuspended--;0>=this._layoutSuspended&&(this.isPaintSuspended()||(this.invalidateLayout(),this.repaint()),this._layoutSuspended=0)},_raiseSelectionChanging:function(a,b){return!0===this._eventHandler._notEqualSelecions(a,b)?(this._trigger(d.Events.SelectionChanging,{sheet:this,sheetName:this._name,oldSelections:a,newSelections:b}),!0):!1},_raiseSelectionChanged:function(){this._trigger(d.Events.SelectionChanged,{sheet:this,sheetName:this._name})},_raiseDragFillBlock:function(a,
b,e){a={sheet:this,sheetName:this._name,fillRange:a,autoFillType:e,fillDirection:b,cancel:!1};this._trigger(d.Events.DragFillBlock,a);return a&&!0===a.cancel},_raiseDragFillBlockCompleted:function(a,b,e){this._trigger(d.Events.DragFillBlockCompleted,{sheet:this,sheetName:this._name,fillRange:a,autoFillType:e,fillDirection:b})},_raiseCellChanged:function(a,b,e,f){this._trigger(d.Events.CellChanged,{sheet:this,sheetName:this._name,row:b,col:e,sheetArea:f,propertyName:a})},_raisePropertyChanged:function(a){},
_nextNonNullRow:function(a,b){a++;var e=d.SheetArea,e=b?this._getModel(e.rowHeader):this._getModel(e.viewport),f=e.rowCount;for(!1===b&&this._dataSource&&(f=Math.max(f,this._getDataLength(this._dataSource)));!(!(0<=a&&a<f)||e.dataTable.hasOwnProperty(a)&&e.dataTable[a]||!1===b&&this._dataSource&&this._getDataItem(this._dataSource,a));)a++;return a<f?a:-1},_nextNonNullColumn:function(a,b,e){var f=null,g=d.SheetArea,g=e?this._getModel(g.colHeader):this._getModel(g.viewport);0<=a&&a<g.rowCount&&g.dataTable.hasOwnProperty(a)&&
(f=g.dataTable[a]);!1===e&&!f&&this._dataSource&&0<=a&&a<this._getDataLength(this._dataSource)&&(f=this._getDataItem(this._dataSource,a));if(!f)return-1;for(b++;0<=b&&(b<g.colCount||b<f.length)&&(!f.hasOwnProperty(b)||!f[b]);){if(!1===e&&this._dataSource){var k=this._getValueImp(g,a,b);if(void 0!==k&&null!==k)break}b++}return b<g.colCount||!1===e&&f&&b<f.length?b:-1},_closeDragFillPopup:function(){this._smartTag&&this._smartTag.close()},_cellRangeInflate:function(a,b){if(a&&0<a.length)for(var e=0;e<
a.length;e++){var d=a[e];if(b.intersect(d.row,d.col,d.rowCount,d.colCount))return a.splice(e--,1),this._cellRangeInflate(a,this._unionCellRange(b,d))}return b},_unionCellRange:function(a,b){var e=Math.min(a.row,b.row),f=Math.min(a.col,b.col),g=Math.max(a.row+a.rowCount-1,b.row+b.rowCount-1),k=Math.max(a.col+a.colCount-1,b.col+b.colCount-1),l=d.Range;return 0<=e&&0<=f?new l(e,f,g-e+1,k-f+1):0<=e?new l(e,-1,g-e+1,-1):0<=f?new l(-1,f,-1,k-f+1):new l(-1,-1,-1,-1)},_getClipboardHelper:function(){!this._clipboardHelper&&
this.parent&&this.parent._clipboardHelper?this._clipboardHelper=this.parent._clipboardHelper:this._clipboardHelper||(this._clipboardHelper={fromSheet:null,range:null,isCutting:!1});return this._clipboardHelper},_checkPastedRange:function(a,b,e,f,g,k){k.pastedInternal=!1;k.pastedRange=null;if(!(a||g&&""!==g))return!1;if(this._isPastedInternal(a,b,this,g)||!g){k.pastedInternal=!0;if(f&&a.isProtected&&a._isAnyCellInRangeLocked(b))return this._raiseInvalidOperation("Source sheet's cells are locked."),
!1;k.pastedRange=this._getPastedRange(a,b,this,e,f)}else k.pastedRange=this._getPastedRangefromText(e,g);if(!k.pastedRange)return this._raiseInvalidOperation("The copy and paste areas are not the same size."),!1;if(this.isProtected&&this._isAnyCellInRangeLocked(k.pastedRange))return this._raiseInvalidOperation("The cell you are trying to change is protected and therefore read-only."),!1;if(k.pastedInternal){if(a._hasPartSpans(b.row,b.col,b.rowCount,b.colCount))return this._raiseInvalidOperation("Cannot change part of a merged cell."),
!1;if(a._hasPartArrayFormulas(b.row,b.col,b.rowCount,b.colCount))return this._raiseInvalidOperation("Cannot change part of an array."),!1;var l=0>k.pastedRange.row?this.getRowCount():k.pastedRange.rowCount,s=0>k.pastedRange.col?this.getColumnCount():k.pastedRange.colCount;f=0>b.row?a.getRowCount():b.rowCount;a=0>b.Column?a.getColumnCount():b.colCount;if(l>f||s>a){b=e.row;g=e.col;0>e.row&&f<this.getRowCount()&&(b=0);0>e.col&&a<this.getColumnCount()&&(g=0);if(0!==l%f||0!==s%a)l=f,s=a,k.pastedRange=
new d.Range(b,g,l,s);e=Math.floor(l/f);k=Math.floor(s/a);for(s=0;s<e;s++)for(l=0;l<k;l++){if(this._hasPartSpans(0>b?-1:b+s*f,0>g?-1:g+l*a,0>b?-1:f,0>g?-1:a))return this._raiseInvalidOperation("Cannot change part of a merged cell."),!1;if(this._hasPartArrayFormulas(0>b?-1:b+s*f,0>g?-1:g+l*a,0>b?-1:f,0>g?-1:a))return this._raiseInvalidOperation("Cannot change part of an array."),!1}}else{if(this._hasPartSpans(k.pastedRange.row,k.pastedRange.col,k.pastedRange.rowCount,k.pastedRange.colCount))return this._raiseInvalidOperation("Cannot change part of a merged cell."),
!1;if(this._hasPartArrayFormulas(k.pastedRange.row,k.pastedRange.col,k.pastedRange.rowCount,k.pastedRange.colCount))return this._raiseInvalidOperation("Cannot change part of an array."),!1}}else{if(this._hasPartSpans(k.pastedRange.row,k.pastedRange.col,k.pastedRange.rowCount,k.pastedRange.colCount))return this._raiseInvalidOperation("Cannot change part of a merged cell."),!1;if(this._hasPartArrayFormulas(k.pastedRange.row,k.pastedRange.col,k.pastedRange.rowCount,k.pastedRange.colCount))return this._raiseInvalidOperation("Cannot change part of an array."),
!1;if(k.pastedRange.row+k.pastedRange.rowCount>this.getRowCount()||k.pastedRange.col+k.pastedRange.colCount>this.getColumnCount())return this._raiseInvalidOperation("The copy and paste areas are not the same size."),!1}return!0},_isPastedInternal:function(a,b,e,d){return a&&b&&e&&a.getCsv(b.row,b.col,b.rowCount,b.colCount,"\r\n","\t")===d},_getPastedRange:function(a,b,e,f,g){var k=0>b.row?0:b.row,l=0>b.col?0:b.col,s=0>b.row?a.getRowCount():b.rowCount;b=0>b.col?a.getColumnCount():b.colCount;var q=
0>f.row?0:f.row,t=0>f.col?0:f.col,m=0>f.row?e.getRowCount():f.rowCount,r=0>f.col?e.getColumnCount():f.colCount;if(g||0!==m%s||0!==r%b)m=s,r=b;if(!this._isValidRange(k,l,s,b,a.getRowCount(),a.getColumnCount())||!this._isValidRange(q,t,m,r,e.getRowCount(),e.getColumnCount()))return null;var u=new d.Range(q,t,m,r);if(!g&&a._name===e._name)if(u.contains(k,l,s,b)){if(0!==(k-q)%s||0!==(l-t)%b)return null}else if(u.intersect(k,l,s,b)&&(m>s||r>b))return null;-1===f.row&&(m=q=-1);-1===f.col&&(r=t=-1);return new d.Range(q,
t,m,r)},_getPastedRangefromText:function(a,b){var e=null,f=s.parseCsv(b,"\r\n","\t",'"');if(f)var e=0>a.row?0:a.row,g=0>a.col?0:a.col,k=f.length,f=s.getMaxLength(f),e=new d.Range(e,g,k,f);return e},_getClipboardData:function(){try{if(p.clipboardData&&p.clipboardData.getData)return p.clipboardData.getData("Text")}catch(a){return null}},_clearClipboard:function(){try{p.clipboardData&&p.clipboardData.clearData&&p.clipboardData.clearData("Text")}catch(a){}},_clipboardPaste:function(a,b,e,f,g,k,l){if(a&&
e._name===a._name&&e.parent&&!e.parent.sheets.contains(a))this._clearClipboard();else{var q,m,t,r,u;if(a&&b)if(k=d.UndoRedo.ClipboardPasteRangeUndoAction.convertPasteOption,g)s.moveTo(a,b.row,b.col,e,f.row,f.col,b.rowCount,b.colCount,k(l)),this._clearClipboard();else{var p=0>f.row?e.getRowCount():f.rowCount,J=0>f.col?e.getColumnCount():f.colCount;m=0>b.row?a.getRowCount():b.rowCount;t=0>b.col?a.getColumnCount():b.colCount;if(p>m||J>t){g=f.row;q=f.col;0>f.row&&m<e.getRowCount()&&(g=0);0>f.col&&t<e.getColumnCount()&&
(q=0);if(0!==p%m||0!==J%t)p=m,J=t;f=Math.floor(p/m);J=Math.floor(J/t);a.suspendCalcService();e.suspendCalcService();try{for(r=0;r<f;r++)for(u=0;u<J;u++)s.copyTo(a,b.row,b.col,e,0>g?-1:g+r*m,0>q?-1:q+u*t,0>g?-1:m,0>q?-1:t,k(l))}finally{a.resumeCalcService(),e.resumeCalcService()}}else s.copyTo(a,b.row,b.col,e,f.row,f.col,b.rowCount,b.colCount,k(l))}else{g=f.row;q=f.col;m=f.rowCount;t=f.colCount;for(a=e._spanModel.getEnumerator(g,q,m,t);a.moveNext();)(b=a.current())&&e._spanModel.remove(b);if(k&&""!==
k)e.setCsv(g,q,k,"\r\n","\t",d.TextFileOpenFlags.ImportFormula);else for(r=0;r<m;r++)for(u=0;u<t;u++)e.setValue(g+r,q+u,null)}}},_raiseClipboardPasting:function(a,b){var e={sheet:this,sheetName:this._name,cellRange:a,pastOption:b,cancel:!1};this._trigger(d.Events.ClipboardPasting,e);return!0===e.cancel},_raiseClipboardPasted:function(a,b){this._trigger(d.Events.ClipboardPasted,{sheet:this,sheetName:this._name,cellRange:a,pastOption:b})},_raiseValueChanged:function(a,b){this._trigger(d.Events.ValueChanged,
{sheet:this,sheetName:this._name,row:a,col:b})},_raiseRangeDataChanged:function(a,b,e,f){this._trigger(d.Events.RangeChanged,{sheet:this,sheetName:this._name,row:a,column:b,rowCount:e,columnCount:f})},_copyFormula:function(a,b,e,d,f,g){s.copyFormula(this,a,b,this,e,d,f,g)}}})(window,jQuery);
(function(p){function l(){}function m(a,b){return a&&a._editorStatus!==w.EditorStatus.Edit?(a.moveActiveCell(b,!1),!0):!1}function k(a,b,h,e){a&&a._editorStatus!==w.EditorStatus.Edit&&a.moveActiveCell(b,!1,h,e)}function g(a,b,h){a&&a._editorStatus!==w.EditorStatus.Edit&&(a.endEdit(),a._changeActiveSelectedRange(b,h))}function a(a,b,h){this.row=a;this.column=b;this.value=h}function d(a,b){this._rowCount=a;this._columnCount=b;this._init()}function e(a){this._columnCount=a;this._init()}function b(a){this._rowCount=
a;this._init()}function f(){this.canExecuteChanged=null}function s(a,b,h,e){this._sheet=a;this._columns=b;this._size=h;this._rowHeader=e;this._oldSizes=[];this._oldVisibles=[]}function q(a,b,h,e){this._sheet=a;this._rows=b;this._size=h;this._columnHeader=e;this._oldSizes=[];this._oldVisibles=[]}function t(a,b,h){this._sheet=a;this._columns=b;this._rowHeader=h;this._oldSizes=[];this._oldVisibles=[]}function r(a,b,h){this._sheet=a;this._rows=b;this._columnHeader=h;this._oldSizes=[];this._oldVisibles=
[]}function u(a,b){this._sheet=a;this._columnGroupExtent=b}function n(a,b){this._sheet=a;this._columnUngroupExtent=b;this._canUndo=!1}function h(a,b){this._sheet=a;this._rowGroupExtent=b}function I(a,b){this._sheet=a;this._rowUngroupExtent=b;this._canUndo=!1}function E(a,b){this._sheet=a;this._columnExpandExtent=b}function O(a,b){this._sheet=a;this._rowExpandExtent=b}function H(a,b){this._sheet=a;this._columnGroupHeaderExpandExtent=b;this._oldStatus={}}function C(a,b){this._sheet=a;this._rowGroupHeaderExpandExtent=
b;this._oldStatus={}}function G(a,b,h,e,d){this._sheet=a;this._dragDropExtent=b;this._copy=h;this._insert=e;this._option=d}function z(a,b){this._sheet=a;this._cellEditInfo=b;this._canUndo=!1}function S(a,b){this._sheet=a;this._newName=b;this._oldName=null}function Q(a,b){this._sheet=a;0.25>b?b=0.25:4<b&&(b=4);this._zoomFactor=b;this._prevZoomFactor=-1}function aa(a,b){this._sheet=a;this._clearRange=b;this._cachedValues=this._cachedFilteredColumns=null}function ka(a,b){this._sheet=a;this._cachedActions=
null;if(b&&0<b.length){this._cachedActions=[b.length];for(var h=0;h<b.length;h++)this._cachedActions[h]=new aa(a,b[h])}}function J(a,b){this._workSheet=a;this._dragFillExtent=b;this._dragFillExtent.autoFillType===M.ClearValues?this._clearValueUndoAction=new ka(a,[this._dragFillExtent.fillRange]):this.initWholeFilledRange();this._fillSeries=this._dragFillExtent.fillDirection===T.Left||this._dragFillExtent.fillDirection===T.Right?P.Row:P.Column}function K(a,b,h,e,d){this._sheet=a;this._fromSheet=b;
this._toSheet=h;this._pasteExtent=e;this._pasteOption=d}function A(a,b,h,e,d){this._sheet=a;if(!h)throw Error("destSheet");if(!e)throw Error("pasteExtent");if(e.pastedRanges&&0<e.pastedRanges.length){this._cachedActions=Array(e.pastedRanges.length);for(var f=0;f<e.pastedRanges.length;f++)this._cachedActions[f]=new K(a,b,h,{sourceRange:e.fromRange,targetRange:e.pastedRanges[f],isCutting:e.isCutting,clipboardText:e.clipboardText},d)}}function L(a,b){this.value=a;this.isFormula=b}var D=p.GrapeCity;"undefined"===
typeof D&&(D=p.GrapeCity={});"undefined"===typeof D.UI&&(D.UI={});var w=D.UI;w.AutoFillType={CopyCells:0,FillSeries:1,FillFormattingOnly:2,FillWithoutFormatting:3,ClearValues:4};var M=w.AutoFillType;w.FillDirection={Left:0,Right:1,Up:2,Down:3};var T=w.FillDirection;w.FillSeries={Column:0,Row:1};var P=w.FillSeries;w.StorageType={Data:1,Style:2,Sparkline:16,Axis:32,BindingPath:64};var ia=w.StorageType;w.DragFillDirection={Left:0,Right:1,Up:2,Down:3,LeftClear:4,UpClear:5};d.prototype={_init:function(){this._values=
[];this._formulas=[];this._sparklines=[];this._styles=[];this._tags=[];this._bindingPaths=[];this._arrayFormulas=this._spans=null;this._bindingPathSaved=this._arrayFormulaSaved=this._spanSaved=this._tagSaved=this._styleSaved=this._sparklineSaved=this._formulaSaved=this._valueSaved=!1},saveValue:function(b,h,e){void 0!==e&&null!==e&&this._values.push(new a(b,h,e));this._valueSaved=!0},getValues:function(){return this._values},saveFormula:function(b,h,e){e&&""!==e&&this._formulas.push(new a(b,h,e));
this._formulaSaved=!0},getFormulas:function(){return this._formulas},saveArrayFormula:function(a){this._arrayFormulas=a;this._arrayFormulaSaved=!0},getArrayFormula:function(){return this._arrayFormulas},saveSparkline:function(b,h,e){e&&this._sparklines.push(new a(b,h,e));this._sparklineSaved=!0},getSparklines:function(){return this._sparklines},saveStyle:function(b,h,e){e&&this._styles.push(new a(b,h,e));this._styleSaved=!0},getStyles:function(){return this._styles},saveTag:function(b,h,e){void 0!==
e&&null!==e&&this._tags.push(new a(b,h,e));this._tagSaved=!0},getTags:function(){return this._tags},saveBindingPath:function(b,h,e){void 0!==e&&null!==e&&this._bindingPaths.push(new a(b,h,e));this._bindingPathSaved=!0},getBindingPaths:function(){return this._bindingPaths},saveSpan:function(a){this._spans||(this._spans=[]);this._spans.push(a);this._spanSaved=!0},isValueSaved:function(){return this._valueSaved},isFormulaSaved:function(){return this._formulaSaved},isArrayFormulaSaved:function(){return this._arrayFormulaSaved},
isSparklineSaved:function(){return this._sparklineSaved},isStyleSaved:function(){return this._styleSaved},isTagSaved:function(){return this._tagSaved},isSpanSaved:function(){return this._spanSaved},isBindingPathSaved:function(){return this._bindingPathSaved}};e.prototype={_init:function(){this._widths={};this._visibles={};this._resizables={};this._tags={};this._viewportColumnStyles={};this._headerColumnStyles={};this._levels={};this._collapsed={};this._bindingFields={};this._bindingFieldSaved=this._rangeGroupSaved=
this._headerColumnStyleSaved=this._viewportColumnStyleSaved=this._tagSaved=this._resizableSaved=this._visibleSaved=this._widthSaved=!1},saveWidth:function(a,b){null!==this._widths[a]?this._widths[a]=0>b?null:b:0<=b&&(this._widths[a]=b);this._widthSaved=!0},getWidth:function(a){return null!==this._widths[a]?this._widths[a]:-1},saveVisible:function(a,b){null!==this._visibles[a]?this._visibles[a]=b?null:b:b||(this._visibles[a]=b);this._visibleSaved=!0},getVisible:function(a){return null!==this._visibles[a]?
this._visibles[a]:!0},saveResizable:function(a,b){null!==this._resizables[a]?this._resizables[a]=b?null:b:b||(this._resizables[a]=b);this._resizableSaved=!0},getResizable:function(a){return null!==this._resizables[a]?this._resizables[a]:!0},saveTag:function(a,b){null!==this._tags[a]?this._tags[a]=void 0===b||null===b?null:b:null!==b&&(this._tags[a]=b);this._tagSaved=!0},getTag:function(a){return null!==this._tags[a]?this._tags[a]:null},saveViewportColumnStyle:function(a,b){this._viewportColumnStyles[a]?
this._viewportColumnStyles[a]=b?b:null:b&&(this._viewportColumnStyles[a]=b);this._viewportColumnStyleSaved=!0},getViewportColumnStyle:function(a){return this._viewportColumnStyles[a]?this._viewportColumnStyles[a]:null},saveHeaderColumnStyle:function(a,b){this._headerColumnStyles[a]?this._headerColumnStyles[a]=b?b:null:b&&(this._headerColumnStyles[a]=b);this._headerColumnStyleSaved=!0},getHeaderColumnStyle:function(a){return this._headerColumnStyles[a]?this._headerColumnStyles[a]:null},saveRangeGroup:function(a,
b,h){null!==this._levels[a]?this._levels[a]=0>b?null:b:0<=b&&(this._levels[a]=b);null!==this._collapsed[a]?this._collapsed[a]=h?h:null:h&&(this._collapsed[a]=h);this._rangeGroupSaved=!0},getRangeGroup:function(a,b){b.level=-1;b.collapsed=!1;null!==this._levels[a]&&(b.level=this._levels[a]);null!==this._collapsed[a]&&(b.collapsed=this._collapsed[a])},saveBindingField:function(a,b){this._bindingFields[a]=b;this._bindingFieldSaved=!0},getBindingField:function(a,b){b.fieldName=null;return null!==this._bindingFields[a]?
(b.fieldName=this._bindingFields[a],!0):!1},isWidthSaved:function(){return this._widthSaved},isVisibleSaved:function(){return this._visibleSaved},isResizableSaved:function(){return this._resizableSaved},isTagSaved:function(){return this._tagSaved},isViewportColumnStyleSaved:function(){return this._viewportColumnStyleSaved},isHeaderColumnStyleSaved:function(){return this._headerColumnStyleSaved},isRangeGroupSaved:function(){return this._rangeGroupSaved},isBindingFieldSaved:function(){return this._bindingFieldSaved}};
var v={getStyleObject:function(a,b,h,e){return a.getStyle(b,h,e)},setStyleObject:function(a,b,h,e,d){"string"!==typeof d&&a.setStyle(b,h,d,e)},saveSheetInfo:function(a,b,h){0<(h&w.CopyToOption.Style)&&(b.saveDefaultStyle(a.getDefaultStyle()),b.saveColumnHeaderDefaultStyle(a.getDefaultStyle(w.SheetArea.colHeader)),b.saveRowHeaderDefaultStyle(a.getDefaultStyle(w.SheetArea.rowHeader)));b.saveDefaultColumnWidth(a.defaults.colWidth);b.saveDefaultRowHeight(a.defaults.rowHeight);b.saveColumnHeaderDefaultRowHeight(a.defaults.rowHeight);
b.saveRowHeaderDefaultColumnWidth(a.defaults.rowHeaderColWidth)},saveColumnHeaderInfo:function(a,b,h,e,d){var f=b._rowCount,g=b._columnCount,k,n;for(k=0;k<f;k++)for(n=0;n<g;n++){if(0<(d&w.CopyToOption.Value)){var l=a._getModel(w.SheetArea.colHeader).getValue(k,e+n);b.saveValue(k,n,l)}0<(d&w.CopyToOption.Style)&&b.saveStyle(k,n,v.getStyleObject(a,k,e+n,w.SheetArea.colHeader))}if(0<(d&w.CopyToOption.Value))for(n=0;n<g;n++)a.isColumnBound(e+n)&&h.saveBindingField(n,a.getDataColumnName(e+n));if(0<(d&
w.CopyToOption.Span))for(g=a._colHeaderSpanModel.getEnumerator(0,e,f,g);g.moveNext();)b.saveSpan(g.current());g=h._columnCount;for(n=0;n<g;n++)h.saveWidth(n,a._getActualColumnWidth(e+n)),h.saveVisible(n,a.getColumnVisible(e+n)),h.saveResizable(n,a.getColumnResizable(e+n));if(0<(d&w.CopyToOption.Style))for(n=0;n<g;n++)h.saveViewportColumnStyle(n,v.getStyleObject(a,-1,e+n,w.SheetArea.viewport)),h.saveHeaderColumnStyle(n,v.getStyleObject(a,-1,e+n,w.SheetArea.colHeader));if(0<(d&w.CopyToOption.RangeGroup)&&
(a=a.colRangeGroup)&&!a._isEmpty())for(n=0;n<g;n++)h.saveRangeGroup(n,a.getLevel(e+n),a.getCollapsed(e+n))},saveRowHeaderInfo:function(a,b,h,e,d){if(!(0>=(d&w.CopyToOption.All))){var f=b._rowCount,g=b._columnCount,k,n;for(k=0;k<f;k++)for(n=0;n<g;n++){if(0<(d&w.CopyToOption.Value)){var l=a._getModel(w.SheetArea.rowHeader).getValue(e+k,n);b.saveValue(k,n,l)}0<(d&w.CopyToOption.Style)&&b.saveStyle(k,n,v.getStyleObject(a,e+k,n,w.SheetArea.rowHeader))}if(0<(d&w.CopyToOption.Span))for(f=a._rowHeaderSpanModel.getEnumerator(e,
0,f,g);f.moveNext();)b.saveSpan(f.current());f=h._rowCount;for(k=0;k<f;k++)h.saveHeight(k,a._getActualRowHeight(e+k)),h.saveVisible(k,a.getRowVisible(e+k)),h.saveResizable(k,a.getRowResizable(e+k));if(0<(d&w.CopyToOption.Style))for(k=0;k<f;k++)h.saveViewportRowStyle(k,v.getStyleObject(a,e+k,-1,w.SheetArea.viewport)),h.saveHeaderRowStyle(k,v.getStyleObject(a,e+k,-1,w.SheetArea.rowHeader));if(0<(d&w.CopyToOption.RangeGroup)&&(a=a.rowRangeGroup)&&!a._isEmpty())for(k=0;k<f;k++)h.saveRangeGroup(k,a.getLevel(e+
k),a.getCollapsed(e+k))}},saveViewportInfo:function(a,b,h,e,d){if(!(0>=(d&w.CopyToOption.All))){for(var f=b._rowCount,g=b._columnCount,k=0;k<f;k++)for(var n=0;n<g;n++){0<(d&w.CopyToOption.Value)&&b.saveValue(k,n,a.getValue(h+k,e+n,w.SheetArea.viewport));if(0<(d&w.CopyToOption.Value)||0<(d&w.CopyToOption.Formula)){b.saveFormula(k,n,a.getFormula(h+k,e+n));var l=a._getsArrayFormulas(h,e,f,g);b.saveArrayFormula(l)}if(0<(d&w.CopyToOption.Sparkline)){var l=a.getSparkline(h+k,e+n),s=null;l&&(s=l.data(),
l.dateAxisData());l&&s?b.saveSparkline(k,n,l.clone()):b.saveSparkline(k,n,null)}0<(d&w.CopyToOption.Style)&&b.saveStyle(k,n,v.getStyleObject(a,h+k,e+n,w.SheetArea.viewport));0<(d&w.CopyToOption.BindingPath)&&b.saveBindingPath(k,n,a.getBindingPath(h+k,e+n,w.SheetArea.viewport))}if(0<(d&w.CopyToOption.Span))for(a=a._spanModel.getEnumerator(h,e,f,g);a.moveNext();)b.saveSpan(a.current())}},undoCellsInfo:function(a,b,h,e,d){var f=b._rowCount,g=b._columnCount,k,n,l,s,q;a.suspendCalcService();try{for(var m=
0;m<f;m++)for(var t=0;t<g;t++)b.isBindingPathSaved()&&a.setBindingPath(h+m,e+t,null,d),b.isFormulaSaved()&&d===w.SheetArea.viewport&&a.setFormula(h+m,e+t,null),b.isSparklineSaved()&&d===w.SheetArea.viewport&&a.removeSparkline(h+m,e+t),b.isValueSaved()&&a.setValue(h+m,e+t,null,d),b.isStyleSaved()&&v.setStyleObject(a,h+m,e+t,d,null);if(b.isBindingPathSaved()){var r=b.getBindingPaths();for(k=0;k<r.length;k++){var u=r[k];a.setBindingPath(h+u.row,e+u.column,u.value,d)}}if(b.isFormulaSaved()&&d===w.SheetArea.viewport){var M=
b.getFormulas();for(k=0;k<M.length;k++)l=M[k],a.setFormula(h+l.row,e+l.column,l.value)}if(b.isSparklineSaved()&&d===w.SheetArea.viewport)for(var I=b.getSparklines(),m=0;m<I.length;m++){var B=I[m],sa=B.value;sa?sa.dateAxisData()?a.setSparkline(h+B.row,e+B.column,sa.data(),sa.dataOrientation(),sa.sparklineType(),sa.setting(),sa.dateAxisData(),sa.dateAxisOrientation()):a.setSparkline(h+B.row,e+B.column,sa.data(),sa.dataOrientation(),sa.sparklineType(),sa.setting()):a.removeSparkline(h+B.row,e+B.column)}if(b.isValueSaved()){var U=
b.getValues();for(k=0;k<U.length;k++){var Ba=U[k];a.setValue(h+Ba.row,e+Ba.column,Ba.value,d)}}if(b.isStyleSaved()){var wa=b.getStyles();for(k=0;k<wa.length;k++){var E=wa[k];v.setStyleObject(a,h+E.row,e+E.column,d,E.value)}}if(b.isArrayFormulaSaved()&&d===w.SheetArea.viewport){var y=a._getsArrayFormulas(h,e,f,g);if(y&&0<y.length)for(s=y.getLength(0),q=0;q<s;q++)n=y[q][0],a.setFormula(n.row,n.col,n.rowCount,n.colCount,null);if((y=b.getArrayFormula())&&0<y.length)for(s=y.getLength(0),q=0;q<s;q++)n=
y[q][0],l=y[q][1],l.StartsWith("{")&&l.EndsWith("}")&&(l=l.substring(1,l.length-2)),a.setFormula(n.row,n.col,n.rowCount,n.colCount,l)}}finally{a.resumeCalcService()}n=null;d===w.SheetArea.viewport?n=a._spanModel:d===w.SheetArea.colHeader?n=a._colHeaderSpanModel:d===w.SheetArea.rowHeader&&(n=a._rowHeaderSpanModel);if(n&&0<n.length){a=[];for(k=n.getEnumerator(h,e,f,g);k.moveNext();)(h=k.current())&&a.push(h);for(k=0;k<a.length;k++)h=a[k],n.remove(h)}if(b.isSpanSaved()&&n)for(k=0;k<b._spans.length;k++)h=
b._spans[k],n.push(h)},undoColumnsInfo:function(a,b,h){var e=b._columnCount,d;if(b.isBindingFieldSaved()){var f={fieldName:null};for(d=0;d<e;d++)b.getBindingField(d,f)&&a.bindColumn(h+d,f.fieldName)}if(b.isWidthSaved())for(d=0;d<e;d++)a.setColumnWidth(h+d,b.getWidth(d),w.SheetArea.viewport);if(b.isVisibleSaved())for(d=0;d<e;d++)a.setColumnVisible(h+d,b.getVisible(d),w.SheetArea.viewport);if(b.isResizableSaved())for(d=0;d<e;d++)a.setColumnResizable(h+d,b.getResizable(d),w.SheetArea.viewport);if(b.isViewportColumnStyleSaved())for(d=
0;d<e;d++)v.setStyleObject(a,-1,h+d,w.SheetArea.viewport,b.getViewportColumnStyle(d));if(b.isHeaderColumnStyleSaved())for(d=0;d<e;d++)v.setStyleObject(a,-1,h+d,w.SheetArea.colHeader,b.getHeaderColumnStyle(d));if(b.isRangeGroupSaved()&&(a=a.colRangeGroup))for(f={level:null,collapsed:null},d=0;d<e;d++)b.getRangeGroup(d,f),a._setLevel(h+d,f.level),a.setCollapsed(h+d,f.collapsed)},undoRowsInfo:function(a,b,h){var e=b._rowCount,d;if(b.isHeightSaved())for(d=0;d<e;d++)a.setRowHeight(h+d,b.getHeight(d),w.SheetArea.viewport);
if(b.isVisibleSaved())for(d=0;d<e;d++)a.setRowVisible(h+d,b.getVisible(d),w.SheetArea.viewport);if(b.isResizableSaved())for(d=0;d<e;d++)a.setRowResizable(h+d,b.getResizable(d),w.SheetArea.viewport);if(b.isViewportRowStyleSaved())for(d=0;d<e;d++)v.setStyleObject(a,h+d,-1,w.SheetArea.viewport,b.getViewportRowStyle(d));if(b.isHeaderRowStyleSaved())for(d=0;d<e;d++)v.setStyleObject(a,h+d,-1,w.SheetArea.rowHeader,b.getHeaderRowStyle(d));if(b.isRangeGroupSaved()&&(a=a.rowRangeGroup)){var f={level:null,collapsed:null};
for(d=0;d<e;d++)b.getRangeGroup(d,f),a._setLevel(h+d,f.level),a.setCollapsed(h+d,f.collapsed)}},undoSheetInfo:function(a,b){b.isDefaultStyleSaved()&&a.setDefaultStyle(b.getDefaultStyle());b.isDefaultColumnWidthSaved()&&(a.defaults.colWidth=b.getDefaultColumnWidth());b.isDefaultRowHeightSaved()&&(a.defaults.rowHeight=b.getDefaultRowHeight());b.isColumnHeaderDefaultStyleSaved()&&a.setDefaultStyle(b.getColumnHeaderDefaultStyle(),w.SheetArea.colHeader);b.isColumnHeaderDefaultRowHeightSaved()&&(a.defaults.rowHeight=
b.getColumnHeaderDefaultRowHeight());b.isRowHeaderDefaultStyleSaved()&&a.setDefaultStyle(b.getRowHeaderDefaultStyle(),w.SheetArea.rowHeader);b.isRowHeaderDefaultColumnWidthSaved()&&(a.defaults.rowHeaderColWidth=b.getRowHeaderDefaultColumnWidth())},getValues:function(b,h,e,d,f){0>h&&(h=0,d=b.getRowCount());0>e&&(e=0,f=b.getColumnCount());for(var g=[],k=0;k<d;k++)for(var n=0;n<f;n++){var l=b.getValue(h+k,e+n);void 0!==l&&null!==l&&g.push(new a(k,n,l))}return g},raiseRangeDataChanged:function(a,b,h,
e,d,f){a&&(0>b&&(b=0,e=a.getRowCount()),0>h&&(h=0,d=a.getColumnCount()),a._raiseRangeDataChanged(b,h,e,d))},convertToKey:function(a,b){var h=0,h=a<<32;return h|=b},remove:function(a,b,h){var e=null,d=-1,f=a.length;if(0<f)for(var g=0;g<f;g++)if(a[g].row===b&&a[g].column===h){d=g;break}-1!==d&&(e=a[d],a.splice(d,1));return e}};b.prototype={_init:function(){this._heights={};this._visibles={};this._resizables={};this._tags={};this._viewportRowStyles={};this._headerRowStyles={};this._levels={};this._collapsed=
{};this._rangeGroupSaved=this._headerRowStyleSaved=this._viewportRowStyleSaved=this._tagSaved=this._resizableSaved=this._visibleSaved=this._heightSaved=!1},saveHeight:function(a,b){null!==this._heights[a]?this._heights[a]=0>b?null:b:0<=b&&(this._heights[a]=b);this._heightSaved=!0},getHeight:function(a){return null!==this._heights[a]?this._heights[a]:-1},saveVisible:function(a,b){null!==this._visibles[a]?this._visibles[a]=b?null:b:b||(this._visibles[a]=b);this._visibleSaved=!0},getVisible:function(a){return null!==
this._visibles[a]?this._visibles[a]:!0},saveResizable:function(a,b){null!==this._resizables[a]?this._resizables[a]=b?null:b:b||(this._resizables[a]=b);this._resizableSaved=!0},getResizable:function(a){return null!==this._resizables[a]?this._resizables[a]:!0},saveTag:function(a,b){null!==this._tags[a]?this._tags[a]=void 0===b||null===b?null:b:null!==b&&(this._tags[a]=b);this._tagSaved=!0},getTag:function(a){return null!==this._tags[a]?this._tags[a]:null},saveViewportRowStyle:function(a,b){this._viewportRowStyles[a]?
this._viewportRowStyles[a]=b?b:null:b&&(this._viewportRowStyles[a]=b);this._viewportRowStyleSaved=!0},getViewportRowStyle:function(a){return this._viewportRowStyles[a]?this._viewportRowStyles[a]:null},saveHeaderRowStyle:function(a,b){this._headerRowStyles[a]?this._headerRowStyles[a]=b?b:null:b&&(this._headerRowStyles[a]=b);this._headerRowStyleSaved=!0},getHeaderRowStyle:function(a){return this._headerRowStyles[a]?this._headerRowStyles[a]:null},saveRangeGroup:function(a,b,h){null!==this._levels[a]?
this._levels[a]=0>b?null:b:0<=b&&(this._levels[a]=b);null!==this._collapsed[a]?this._collapsed[a]=h?h:null:h&&(this._collapsed[a]=h);this._rangeGroupSaved=!0},getRangeGroup:function(a,b){b.level=-1;b.collapsed=!1;null!==this._levels[a]&&(b.level=this._levels[a]);null!==this._collapsed[a]&&(b.collapsed=this._collapsed[a])},isHeightSaved:function(){return this._heightSaved},isVisibleSaved:function(){return this._visibleSaved},isResizableSaved:function(){return this._resizableSaved},isTagSaved:function(){return this._tagSaved},
isViewportRowStyleSaved:function(){return this._viewportRowStyleSaved},isHeaderRowStyleSaved:function(){return this._headerRowStyleSaved},isRangeGroupSaved:function(){return this._rangeGroupSaved}};f.prototype={execute:function(a){},canExecute:function(a){},canUndo:function(){return!0},saveState:function(){},undo:function(a){},_raiseCanExecuteChanged:function(){this.canExecuteChanged&&"function"===typeof this.canExecuteChanged&&this.canExecuteChanged(this)},_suspendInvalidate:function(a){a&&a._suspendInvalidate&&
a._suspendInvalidate()},_resumeInvalidate:function(a){a&&a._resumeInvalidate&&a._resumeInvalidate()}};s.prototype=new f;q.prototype=new f;t.prototype=new f;r.prototype=new f;u.prototype=new f;n.prototype=new f;h.prototype=new f;I.prototype=new f;E.prototype=new f;O.prototype=new f;H.prototype=new f;C.prototype=new f;G.prototype=new f;z.prototype=new f;S.prototype=new f;Q.prototype=new f;aa.prototype=new f;ka.prototype=new f;J.prototype=new f;K.prototype=new f;A.prototype=new f;w.SpreadActions={navigationLeft:function(){return{processed:m(this,
w.Direction.left)}},navigationRight:function(){return{processed:m(this,w.Direction.right)}},navigationUp:function(){return{processed:m(this,w.Direction.up)}},navigationDown:function(){return{processed:m(this,w.Direction.down)}},commitInputNavigationDown:function(){this.moveActiveCell(w.Direction.down,!1)},commitInputNavigationUp:function(){this.moveActiveCell(w.Direction.up,!1)},navigationHome:function(){k(this,w.Direction.right,this._activeRowIndex,this.frozenColCount?this.frozenColCount-1:-1)},
navigationHome2:function(){k(this,w.Direction.right,this._activeRowIndex,-1)},navigationEnd:function(){k(this,w.Direction.left,this._activeRowIndex,this.getColumnCount())},navigationTop:function(){k(this,w.Direction.down,-1,this._activeColIndex)},navigationBottom:function(){k(this,w.Direction.up,this.getRowCount(),this._activeColIndex)},navigationPageUp:function(){if(this._editorStatus!==w.EditorStatus.Edit){this._editorStatus===w.EditorStatus.Enter&&this.endEdit();var a=this._getPrevPageTopRow();
if(null!==a&&a!==this._scrollTopRow){var b=this._getRowLayout(1,w.SheetArea.viewport);this._rowLayoutCache.viewport={};b=this._getNextVisualRow(this._activeRowIndex-b.length);b<a?b=a:b>=this._getPageBottomRow()&&(b=this._getPrevVisualRow(this._getPageBottomRow()));this._leadingCellRow=this._activeRowIndex=b;this.moveActiveCell()?this._setTopRow(a):this._setTopRow(a,!0)}}},navigationPageDown:function(){if(this._editorStatus!==w.EditorStatus.Edit){this._editorStatus===w.EditorStatus.Enter&&this.endEdit();
var a=this._getNextPageTopRow();if(null!==a&&a!==this._scrollTopRow){var b=this._getRowLayout(1,w.SheetArea.viewport);this._rowLayoutCache.viewport={};b=this._getPrevVisualRow(this._activeRowIndex+b.length);b<a?b=a:b>=this._getPageBottomRow()&&(b=this._getPrevVisualRow(this._getPageBottomRow()));this._leadingCellRow=this._activeRowIndex=b;this.moveActiveCell()?this._setTopRow(a):this._setTopRow(a,!0)}}},navigationNextSheet:function(){var a=this.parent;if(a||a instanceof w.GcSpread){var b=a.getSheetCount(),
h=a.getActiveSheetIndex();h<b-1&&(h++,a.setActiveSheetIndex(h),a.repaint())}},navigationPreviousSheet:function(){var a=this.parent;if(a||a instanceof w.GcSpread){var b=a.getActiveSheetIndex();0<b&&(b--,a.setActiveSheetIndex(b),a.repaint())}},navigationPrevious:function(){},navigationNext:function(){},navigationFirst:function(){if(this._editorStatus!==w.EditorStatus.Edit){var a=this.frozenRowCount?this.frozenRowCount-1:-1;this.moveActiveCell(w.Direction.right,!1,this._activeRowIndex,this.frozenColCount?
this.frozenColCount-1:-1);this.moveActiveCell(w.Direction.down,!1,a,this._activeColIndex)}},navigationLast:function(){this._editorStatus!==w.EditorStatus.Edit&&(this.moveActiveCell(w.Direction.left,!1,this._activeRowIndex,this.getColumnCount()),this.moveActiveCell(w.Direction.up,!1,this.getRowCount(),this._activeColIndex))},commitInputNavigationTabNext:function(){this._isNavigateInSelection?this._moveActiveCellInSelection(w.Direction.right):this.moveActiveCell(w.Direction.right,!0)},commitInputNavigationTabPrevious:function(){this._isNavigateInSelection?
this._moveActiveCellInSelection(w.Direction.left):this.moveActiveCell(w.Direction.left,!0)},cancelInput:function(){if(this.isEditing()){var a=this.getValue(this._activeRowIndex,this._activeColIndex,w.SheetArea.viewport);this.endEdit(!0);this.setValue(this._activeRowIndex,this._activeColIndex,a,w.SheetArea.viewport,!0)}},clear:function(){if(!this.isEditing()){for(var a=this.getSelections(),b=0;b<a.length;b++)if(this.isProtected&&this._isAnyCellInRangeLocked(a[b]))return;a=a.toArray();a=new ka(this,
a);a.canExecute(this)&&this._doCommand(a)}},clearAndEditing:function(){var a=!1;this.isEditing()||(this.startEdit(!0,""),a=!0);return{processed:a}},copy:function(){if(!this.isEditing()){var a=this.getSelections();a&&1===a.length&&this._clipboardCopy(a[0],!1)}},cut:function(){if(!this.isEditing()){var a=this.getSelections();a&&1===a.length&&this._clipboardCopy(a[0],!0)}},paste:function(){if(this&&!this.isEditing()){var a=this._getClipboardHelper(),b=a.fromSheet,h=a.range,e=this._getClipboardData(),
d=a.isCutting;d&&(a.fromSheet=null,a.range=null,a.isCutting=!1);d&&b&&h&&b.isProtected&&b._isAnyCellInRangeLocked(h)&&(d=!1);var f={pastedRange:null,pastedInternal:!1},a=[],g=this.getSelections(),k;if(1<g.length)for(var n=0;n<g.length;n++){k=g[n];if(!this._checkPastedRange(b,h,k,d,e,f))return;if(k.containsRange(f.pastedRange)&&!k.equals(f.pastedRange)){this._raiseInvalidOperation("The pasted area should have the same size as the copy or cut area.");return}a.push(f.pastedRange)}else{0<g.length?k=g[0]:
(k=this._getSpanModel().find(this._activeRowIndex,this._activeColIndex))||(k=new w.Range(this._activeRowIndex,this._activeColIndex,1,1));if(!this._checkPastedRange(b,h,k,d,e,f))return;a.push(f.pastedRange)}0<a.length&&(f.pastedInternal||(h=b=null),f=this.clipBoardOptions(),d&&(f=w.ClipboardPasteOptions.All),h={fromRange:h,pastedRanges:a.slice(0),isCutting:d,clipboardText:e},b=new A(this,b,this,h,f),this._doCommand(b))}},selectionLeft:function(){g(this,w.Key.left)},selectionRight:function(){g(this,
w.Key.right)},selectionUp:function(){g(this,w.Key.up)},selectionDown:function(){g(this,w.Key.down)},selectionHome:function(){g(this,w.Key.left,!0)},selectionEnd:function(){g(this,w.Key.right,!0)},selectionPageUp:function(){g(this,w.Key.pup)},selectionPageDown:function(){g(this,w.Key.pdn)},selectionTop:function(){g(this,w.Key.up,!0)},selectionBottom:function(){g(this,w.Key.down,!0)},selectionFirst:function(){g(this,w.Key.home,!0)},selectionLast:function(){g(this,w.Key.end,!0)},undo:function(){var a=
this.undoManager();!1===this.isProtected&&a.canUndo()&&a.undo()},redo:function(){var a=this.undoManager();!1===this.isProtected&&a.canRedo()&&a.redo()}};s.prototype.canExecute=function(a){return!0};s.prototype.execute=function(a){var b=this._sheet;if(b&&this._columns&&0<this._columns.length){this._suspendInvalidate(a);var h=this._getColumnsReiszed(this._columns),e={sheet:b,sheetName:b._name,colList:h,header:this._rowHeader,cancel:!1};b._trigger(w.Events.ColumnWidthChanging,e);if(e&&!0===e.cancel)this._canUndo=
!1,this._resumeInvalidate(a);else{this._canUndo=!0;this.saveState();for(var e=this._rowHeader?b.getColumnCount(w.SheetArea.rowHeader):b.getColumnCount(w.SheetArea.viewport),d=0;d<this._columns.length;d++)for(var f=this._columns[d],g=f.firstCol;g<=f.lastCol;g++)0<=g&&g<e&&(this._rowHeader&&b.getColumnResizable(g,w.SheetArea.rowHeader)&&this._size!==b.getColumnWidth(g,w.SheetArea.rowHeader)?b.setColumnWidth(g,this._size,w.SheetArea.rowHeader):b.getColumnResizable(g,w.SheetArea.viewport)&&this._size!==
b.getColumnWidth(g,w.SheetArea.viewport)&&b.setColumnWidth(g,this._size,w.SheetArea.viewport));this._resumeInvalidate(a);b.invalidateLayout();b.repaint();b._trigger(w.Events.ColumnWidthChanged,{sheet:b,sheetName:b._name,colList:h,header:this._rowHeader})}}};s.prototype.saveState=function(){var a=null,b=null,h=this._sheet;if(h&&this._columns&&0<this._columns.length)for(var e=this._rowHeader?h.getColumnCount(w.SheetArea.rowHeader):h.getColumnCount(w.SheetArea.viewport),a=[this._columns.length],b=[this._columns.length],
d=0;d<this._columns.length;d++){var f=this._columns[d];a[d]=[f.lastCol-f.firstCol+1];b[d]=[f.lastCol-f.firstCol+1];for(var g=f.firstCol;g<=f.lastCol;g++)0<=g&&g<e?(a[d][g-f.firstCol]=this._rowHeader?h.getColumnWidth(g,w.SheetArea.rowHeader):h.getColumnWidth(g,w.SheetArea.viewport),b[d][g-f.firstCol]=this._rowHeader?h.getColumnVisible(g,w.SheetArea.rowHeader):h.getColumnVisible(g,w.SheetArea.viewport)):(a[d][g-f.firstCol]=-1,b[d][g-f.firstCol]=!1)}this._oldSizes=a;this._oldVisibles=b};s.prototype.undo=
function(a){var b=!1,h=this._sheet;if(h&&this._columns&&0<this._columns.length){this._suspendInvalidate(a);var e=this._getColumnsReiszed(this._columns),d={sheet:h,sheetName:h._name,colList:e,header:this._rowHeader,cancel:!1};h._trigger(w.Events.ColumnWidthChanging,d);if(d&&!0===d.cancel)return this._resumeInvalidate(a),!1;for(var d=this._rowHeader?h.getColumnCount(w.SheetArea.rowHeader):h.getColumnCount(w.SheetArea.viewport),f,g,k=0;k<this._columns.length;k++)for(var n=this._columns[k],l=n.firstCol;l<=
n.lastCol;l++)f=this._oldSizes[k][l-n.firstCol],g=this._oldVisibles[k][l-n.firstCol],0<=l&&l<d&&-1!==f&&(this._rowHeader&&h.getColumnResizable(l,w.SheetArea.rowHeader)?(h.setColumnWidth(l,f,w.SheetArea.rowHeader),b=!0):h.getColumnResizable(l,w.SheetArea.viewport)&&(h.setColumnWidth(l,f,w.SheetArea.viewport),b=!0),this._rowHeader&&h.getColumnVisible(l,w.SheetArea.rowHeader)!==g?(h.setColumnVisible(l,g,w.SheetArea.rowHeader),b=!0):h.getColumnVisible(l,w.SheetArea.viewport)!==g&&(h.setColumnVisible(l,
g,w.SheetArea.viewport),b=!0));this._resumeInvalidate(a);h.invalidateLayout();h.repaint();h._trigger(w.Events.ColumnWidthChanged,{sheet:h,sheetName:h._name,colList:e,header:this._rowHeader})}return b};s.prototype._getColumnsReiszed=function(a){for(var b=[],h=0;h<a.length;h++)for(var e=a[h],d=e.firstCol;d<=e.lastCol;d++)b.push(d);return b};s.prototype.canUndo=function(){return this._canUndo};q.prototype.canExecute=function(a){return!0};q.prototype.execute=function(a){var b=this._sheet;if(b&&this._rows&&
0<this._rows.length){this._suspendInvalidate(a);var h=this._getRowsReiszed(this._rows),e={sheet:b,sheetName:b._name,rowList:h,header:this._columnHeader,cancel:!1};b._trigger(w.Events.RowHeightChanging,e);if(e&&!0===e.cancel)this._canUndo=!1,this._resumeInvalidate(a);else{this._canUndo=!0;this.saveState();for(var e=this._columnHeader?b.getRowCount(w.SheetArea.colHeader):b.getRowCount(w.SheetArea.viewport),d=0;d<this._rows.length;d++)for(var f=this._rows[d],g=f.firstRow;g<=f.lastRow;g++)0<=g&&g<e&&
(this._columnHeader&&b.getRowResizable(g,w.SheetArea.colHeader)&&this._size!==b.getRowHeight(g,w.SheetArea.colHeader)?b.setRowHeight(g,this._size,w.SheetArea.colHeader):b.getRowResizable(g,w.SheetArea.viewport)&&this._size!==b.getRowHeight(g,w.SheetArea.viewport)&&(b.setRowHeight(g,this._size,w.SheetArea.viewport),b.rowFilter()&&b.rowFilter()._addRowFilteredIn(g)));this._resumeInvalidate(a);b.invalidateLayout();b.repaint();b._trigger(w.Events.RowHeightChanged,{sheet:b,sheetName:b._name,rowList:h,
header:this._columnHeader})}}};q.prototype.saveState=function(){var a=null,b=null,h=this._sheet;if(h&&this._rows&&0<this._rows.length)for(var e=this._columnHeader?h.getRowCount(w.SheetArea.colHeader):h.getRowCount(w.SheetArea.viewport),a=[this._rows.length],b=[this._rows.length],d=0;d<this._rows.length;d++){var f=this._rows[d];a[d]=[f.lastRow-f.firstRow+1];b[d]=[f.lastRow-f.firstRow+1];for(var g=f.firstRow;g<=f.lastRow;g++)0<=g&&g<e?(a[d][g-f.firstRow]=this._columnHeader?h.getRowHeight(g,w.SheetArea.colHeader):
h.getRowHeight(g,w.SheetArea.viewport),b[d][g-f.firstRow]=this._columnHeader?h.getRowVisible(g,w.SheetArea.colHeader):h.getRowVisible(g,w.SheetArea.viewport)):(a[d][g-f.firstRow]=-1,b[d][g-f.firstRow]=!1)}this._oldVisibles=b;this._oldSizes=a};q.prototype.undo=function(a){var b=!1,h=this._sheet;if(h&&this._rows&&0<this._rows.length){this._suspendInvalidate(a);var e=this._getRowsReiszed(this._rows),d={sheet:h,sheetName:h._name,rowList:e,header:this._columnHeader,cancel:!1};h._trigger(w.Events.RowHeightChanging,
d);if(d&&!0===d.cancel)return this._resumeInvalidate(a),!1;for(var d=this._columnHeader?h.getRowCount(w.SheetArea.colHeader):h.getRowCount(w.SheetArea.viewport),f,g,k=0;k<this._rows.length;k++)for(var n=this._rows[k],l=n.firstRow;l<=n.lastRow;l++)f=this._oldSizes[k][l-n.firstRow],g=this._oldVisibles[k][l-n.firstRow],0<=l&&l<d&&-1!==f&&(this._columnHeader&&h.getRowResizable(l,w.SheetArea.colHeader)?(h.setRowHeight(l,f,w.SheetArea.colHeader),b=!0):h.getRowResizable(l,w.SheetArea.viewport)&&(h.setRowHeight(l,
f,w.SheetArea.viewport),b=!0),this._columnHeader&&h.getRowVisible(l,w.SheetArea.colHeader)!==g?(h.setRowVisible(l,g,w.SheetArea.colHeader),b=!0):h.getRowVisible(l,w.SheetArea.viewport)!==g&&(h.setRowVisible(l,g,w.SheetArea.viewport),b=!0));this._resumeInvalidate(a);h.invalidateLayout();h.repaint();h._trigger(w.Events.RowHeightChanged,{sheet:h,sheetName:h._name,rowList:e,header:this._columnHeader})}return b};q.prototype._getRowsReiszed=function(a){for(var b=[],h=0;h<a.length;h++)for(var e=a[h],d=e.firstRow;d<=
e.lastRow;d++)b.push(d);return b};q.prototype.canUndo=function(){return this._canUndo};t.prototype.canExecute=function(a){return this._sheet&&this._columns&&0<this._columns.length};t.prototype.execute=function(a){if(this.canExecute(a)){var b=this._sheet;this._suspendInvalidate(a);var h=this._getColumnsReiszed(this._columns),h={sheet:b,sheetName:b._name,colList:h,header:this._rowHeader,cancel:!1};b._trigger(w.Events.ColumnWidthChanging,h);if(h&&!0===h.cancel)this._canUndo=!1,this._resumeInvalidate(a);
else{this._canUndo=!0;this.saveState();var h=this._rowHeader?b.getColumnCount(w.SheetArea.rowHeader):b.getColumnCount(w.SheetArea.viewport),e=b.isPaintSuspended();b.isPaintSuspended(!0);for(var d,f=0;f<this._columns.length;f++){var g=this._columns[f];0<=g.col&&g.col<h&&(this._rowHeader&&b.getColumnResizable(g.col,w.SheetArea.rowHeader)?(d=this._getColumnAutoFitValue(g.col,!0),d!==b.getColumnWidth(g.col,w.SheetArea.rowHeader)&&(b.setColumnWidth(g.col,d,w.SheetArea.rowHeader),b._trigger(w.Events.ColumnWidthChanged,
{sheet:b,sheetName:b._name,colList:[g.col],header:this._rowHeader}))):b.getColumnResizable(g.col,w.SheetArea.viewport)&&(d=this._getColumnAutoFitValue(g.col,!1),d!==b.getColumnWidth(g.col,w.SheetArea.viewport)&&(b.setColumnWidth(g.col,d,w.SheetArea.viewport),b._trigger(w.Events.ColumnWidthChanged,{sheet:b,sheetName:b._name,colList:[g.col],header:this._rowHeader}))))}b.isPaintSuspended(e);this._resumeInvalidate(a);b.invalidateLayout();b.repaint()}}};t.prototype.saveState=function(){var a=null,b=null,
h=this._sheet;if(h&&this._columns&&0<this._columns.length)for(var e=this._rowHeader?h.getColumnCount(w.SheetArea.rowHeader):h.getColumnCount(w.SheetArea.viewport),a=[this._columns.length],b=[this._columns.length],d=0;d<this._columns.length;d++){var f=this._columns[d];0<=f.col&&f.col<e?this._rowHeader?(a[d]=h.getColumnWidth(f.col,w.SheetArea.rowHeader),b[d]=h.getColumnVisible(f.col,w.SheetArea.rowHeader)):(a[d]=h.getColumnWidth(f.col,w.SheetArea.viewport),b[d]=h.getColumnVisible(f.col,w.SheetArea.viewport)):
(a[d]=-1,b[d]=!1)}this._oldSizes=a;this._oldVisibles=b};t.prototype.undo=function(a){var b=!1;if(this._sheet&&this._columns&&0<this._columns.length){var h=this._sheet;this._suspendInvalidate(a);var e=this._getColumnsReiszed(this._columns),d={sheet:h,sheetName:h._name,colList:e,header:this._rowHeader,cancel:!1};h._trigger(w.Events.ColumnWidthChanging,d);if(d&&!0===d.cancel)return this._resumeInvalidate(a),!1;var d=this._rowHeader?h.getColumnCount(w.SheetArea.rowHeader):h.getColumnCount(w.SheetArea.viewport),
f,g,k=h.isPaintSuspended();h.isPaintSuspended(!0);for(var n=0;n<this._columns.length;n++){var l=this._columns[n];f=this._oldSizes[n];g=this._oldVisibles[n];0<=n&&n<d&&-1!==f&&(this._rowHeader&&h.getColumnResizable(l.col,w.SheetArea.rowHeader)?(h.setColumnWidth(l.col,f,w.SheetArea.rowHeader),h.setColumnVisible(l.col,g,w.SheetArea.rowHeader),b=!0):h.getColumnResizable(l.col,w.SheetArea.viewport)&&(h.setColumnWidth(l.col,f,w.SheetArea.viewport),h.setColumnVisible(l.col,g,w.SheetArea.viewport),b=!0))}h.isPaintSuspended(k);
this._resumeInvalidate(a);h.invalidateLayout();h.repaint();h._trigger(w.Events.ColumnWidthChanged,{sheet:h,sheetName:h._name,colList:e,header:this._rowHeader})}return b};t.prototype._getColumnsReiszed=function(a){for(var b=[],h=0;h<a.length;h++)b.push(a[h].col);return b};t.prototype._nextAutoFitRow=function(a,b,h){var e=this._sheet,d=e._nextNonNullRow(a,h),f=-1;h=h?w.SheetArea.rowHeader:w.SheetArea.viewport;var g=e.getRowCount(h);for(a+=1;a<g;a++){var k=e.getActualStyle(a,b,h);if(k&&k.cellType){f=
a;break}}return 0<=d&&0<=f?Math.min(d,f):0<=d?d:0<=f?f:-1};t.prototype._getColumnAutoFitValue=function(a,b){for(var h=this._sheet,e=0,d=0,f=b?w.SheetArea.rowHeader:w.SheetArea.viewport;0<=d;){var g=h._getSpanModel(f).find(d,a);if(g&&(g.col<a||1<g.colCount))d=g.row+g.rowCount;else{var g=h.getActualStyle(d,a,f),k=g.font||h._render._getDefaultFont(f);g.font=h._render._getZoomFont(k);var n=0;if(k=h.getCellType(d,a,f))var n=!(!h.rowFilter()||!h.rowFilter().isFilterHeader(d,a,f)),l=h.getText(d,a,f),s=h.getValue(d,
a,f),n=k._getAutoFitWidth(h,s,l,g,n);n>e&&(e=n);d=this._nextAutoFitRow(d,a,b)}}return e=0===e?h.defaults.colWidth:e+Math.ceil(4/h._zoomFactor)};t.prototype.canUndo=function(){return this._canUndo};r.prototype.canExecute=function(a){return this._sheet&&this._rows&&0<this._rows.length};r.prototype.execute=function(a){if(this.canExecute(a)){var b=this._sheet;this._suspendInvalidate(a);var h=this._getRowsResized(this._rows),h={sheet:b,sheetName:b._name,rowList:h,header:this._columnHeader,cancel:!1};b._trigger(w.Events.RowHeightChanging,
h);if(h&&!0===h.cancel)this._canUndo=!1,this._resumeInvalidate(a);else{this._canUndo=!0;this.saveState();var h=this._columnHeader?b.getRowCount(w.SheetArea.colHeader):b.getRowCount(w.SheetArea.viewport),e=b.isPaintSuspended();b.isPaintSuspended(!0);for(var d,f=0;f<this._rows.length;f++){var g=this._rows[f];0<=g.row&&g.row<h&&(this._columnHeader&&b.getRowResizable(g.row,w.SheetArea.colHeader)?(d=this._getRowAutoFitValue(g.row,!0),d!==b.getRowHeight(g.row,w.SheetArea.colHeader)&&(b.setRowHeight(g.row,
d,w.SheetArea.colHeader),b._trigger(w.Events.RowHeightChanged,{sheet:b,sheetName:b._name,rowList:[g.row],header:this._columnHeader}))):b.getRowResizable(g.row,w.SheetArea.viewport)&&(d=this._getRowAutoFitValue(g.row,!1),d!==b.getRowHeight(g.row,w.SheetArea.viewport)&&(b.setRowHeight(g.row,d,w.SheetArea.viewport),b._trigger(w.Events.RowHeightChanged,{sheet:b,sheetName:b._name,rowList:[g.row],header:this._columnHeader}))))}b.isPaintSuspended(e);this._resumeInvalidate(a);b.invalidateLayout();b.repaint()}}};
r.prototype.saveState=function(){var a=null,b=null,h=this._sheet;if(h&&this._rows&&0<this._rows.length)for(var a=[this._rows.length],b=[this._rows.length],e=this._columnHeader?h.getRowCount(w.SheetArea.colHeader):h.getRowCount(w.SheetArea.viewport),d=0;d<this._rows.length;d++){var f=this._rows[d];0<=f.row&&f.row<e?this._columnHeader?(a[d]=h.getRowHeight(f.row,w.SheetArea.colHeader),b[d]=h.getRowVisible(f.row,w.SheetArea.colHeader)):(a[d]=h.getRowHeight(f.row,w.SheetArea.viewport),b[d]=h.getRowVisible(f.row,
w.SheetArea.viewport)):(a[d]=-1,b[d]=!1)}this._oldSizes=a;this._oldVisibles=b};r.prototype.undo=function(a){var b=!1,h=this._sheet;if(h&&this._rows&&0<this._rows.length){this._suspendInvalidate(a);var e=this._getRowsResized(this._rows),d={sheet:h,sheetName:h._name,rowList:e,header:this._columnHeader,cancel:!1};h._trigger(w.Events.RowHeightChanging,d);if(d&&!0===d.cancel)return this._resumeInvalidate(a),!1;var f,g=this._columnHeader?h.getRowCount(w.SheetArea.colHeader):h.getRowCount(w.SheetArea.viewport),
k=h.isPaintSuspended();h.isPaintSuspended(!0);for(var n=0;n<this._rows.length;n++){var l=this._rows[n],d=this._oldSizes[n];f=this._oldVisibles[n];0<=n&&n<g&&-1!==d&&(this._columnHeader&&h.getRowResizable(l.row,w.SheetArea.colHeader)?(h.setRowHeight(l.row,d,w.SheetArea.colHeader),h.setRowVisible(l.row,f,w.SheetArea.colHeader),b=!0):h.getRowResizable(l.row,w.SheetArea.viewport)&&(h.setRowHeight(l.row,d,w.SheetArea.viewport),h.setRowVisible(l.row,f,w.SheetArea.viewport),b=!0))}h.isPaintSuspended(k);
this._resumeInvalidate(a);h.invalidateLayout();h.repaint();h._trigger(w.Events.RowHeightChanged,{sheet:h,sheetName:h._name,rowList:e,header:this._columnHeader})}return b};r.prototype._getRowsResized=function(a){for(var b=[],h=0;h<a.length;h++)b.push(a[h].row);return b};r.prototype._nextAutoFitColumn=function(a,b,h){var e=this._sheet,d=e._nextNonNullColumn(a,b,h),f=-1;h=h?w.SheetArea.colHeader:w.SheetArea.viewport;var g=e.getColumnCount(h);for(b+=1;b<g;b++){var k=e.getActualStyle(a,b,h);if(k&&k.cellType){f=
b;break}}return 0<=d&&0<=f?Math.min(d,f):0<=d?d:0<=f?f:-1};r.prototype._getRowAutoFitValue=function(a,b){for(var h=this._sheet,e=0,d=0,f=b?w.SheetArea.colHeader:w.SheetArea.viewport;0<=d;){var g=h._getSpanModel(f).find(a,d);if(g&&(g.row<a||1<g.rowCount))d=g.col+g.colCount;else{var g=h.getActualStyle(a,d,f),k=g.font||h._render._getDefaultFont(f);g.font=h._render._getZoomFont(k);var n=0;if(k=h.getCellType(a,d,f))var n=h.getText(a,d,f),l=h.getValue(a,d,f),n=k._getAutoFitHeight(h,l,n,g);n>e&&(e=n);d=
this._nextAutoFitColumn(a,d,b)}}return e=0===e?h.defaults.rowHeight:e+Math.ceil(4/h._zoomFactor)};r.prototype.canUndo=function(){return this._canUndo};u.prototype.canExecute=function(a){return!0};u.prototype.execute=function(a){var b=this._sheet;b&&this._columnGroupExtent&&b.colRangeGroup&&(this._suspendInvalidate(a),b.colRangeGroup.group(this._columnGroupExtent.index,this._columnGroupExtent.count),this._resumeInvalidate(a),b.invalidateLayout(),b.repaint())};u.prototype.saveState=function(){};u.prototype.undo=
function(a){var b=!1,h=this._sheet;h&&this._columnGroupExtent&&h.colRangeGroup&&(this._suspendInvalidate(a),h.colRangeGroup.ungroupRange(this._columnGroupExtent.index,this._columnGroupExtent.count),b=!0,this._resumeInvalidate(a),h.invalidateLayout(),h.repaint());return b};n.prototype.canExecute=function(a){return!0};n.prototype.execute=function(a){var b=this._sheet;if(b&&this._columnUngroupExtent&&b.colRangeGroup){var h=this._columnUngroupExtent.index,e=this._columnUngroupExtent.count;0<=b.colRangeGroup.getLevel(h)||
0<=b.colRangeGroup.getLevel(h+e-1)?(this._suspendInvalidate(a),this._canUndo=!0,b.colRangeGroup.ungroupRange(h,e),this._resumeInvalidate(a),b.invalidateLayout(),b.repaint()):this._canUndo=!1}};n.prototype.canUndo=function(){return this._canUndo};n.prototype.saveState=function(){};n.prototype.undo=function(a){var b=!1,h=this._sheet;!0===this._canUndo&&h&&this._columnUngroupExtent&&h.colRangeGroup&&(this._suspendInvalidate(a),h.colRangeGroup.group(this._columnUngroupExtent.index,this._columnUngroupExtent.count),
b=!0,this._resumeInvalidate(a),h.invalidateLayout(),h.repaint());return b};h.prototype.canExecute=function(a){return!0};h.prototype.execute=function(a){var b=this._sheet;b&&this._rowGroupExtent&&b.rowRangeGroup&&(this._suspendInvalidate(a),b.rowRangeGroup.group(this._rowGroupExtent.index,this._rowGroupExtent.count),this._resumeInvalidate(a),b.invalidateLayout(),b.repaint())};h.prototype.saveState=function(){};h.prototype.undo=function(a){var b=!1,h=this._sheet;h&&this._rowGroupExtent&&h.rowRangeGroup&&
(this._suspendInvalidate(a),h.rowRangeGroup.ungroupRange(this._rowGroupExtent.index,this._rowGroupExtent.count),b=!0,this._resumeInvalidate(a),h.invalidateLayout(),h.repaint());return b};I.prototype.canExecute=function(a){return!0};I.prototype.execute=function(a){var b=this._sheet;if(b&&this._rowUngroupExtent&&b.rowRangeGroup){var h=this._rowUngroupExtent.index,e=this._rowUngroupExtent.count;0<=b.rowRangeGroup.getLevel(h)||0<=b.rowRangeGroup.getLevel(h+e-1)?(this._suspendInvalidate(a),this._canUndo=
!0,b.rowRangeGroup.ungroupRange(h,e),this._resumeInvalidate(a),b.invalidateLayout(),b.repaint()):this._canUndo=!1}};I.prototype.canUndo=function(){return this._canUndo};I.prototype.saveState=function(){};I.prototype.undo=function(a){var b=!1,h=this._sheet;!0===this._canUndo&&h&&this._rowUngroupExtent&&h.rowRangeGroup&&(this._suspendInvalidate(a),h.rowRangeGroup.group(this._rowUngroupExtent.index,this._rowUngroupExtent.count),b=!0,this._resumeInvalidate(a),h.invalidateLayout(),h.repaint());return b};
E.prototype.canExecute=function(){return!0};E.prototype.execute=function(a){var b=this._sheet;if(b&&this._columnExpandExtent&&b.colRangeGroup){this._suspendInvalidate(a);var h=this._columnExpandExtent.collapsed;b.colRangeGroup.setCollapsed(this._columnExpandExtent.index,h);!0===b._allowCellOverflow&&b._clearCellOverflowModelCache();this._resumeInvalidate(a);this._showColumnRangeGroup(h);b.invalidateLayout();b.repaint()}};E.prototype.saveState=function(){};E.prototype.undo=function(a){var b=!1,h=this._sheet;
if(h&&this._columnExpandExtent&&h.colRangeGroup){this._suspendInvalidate(a);var e=this._columnExpandExtent.collapsed;h.colRangeGroup.setCollapsed(this._columnExpandExtent.index,!e);!0===h._allowCellOverflow&&h._clearCellOverflowModelCache();b=!0;this._resumeInvalidate(a);this._showColumnRangeGroup(!e);h.invalidateLayout();h.repaint()}return b};E.prototype._showColumnRangeGroup=function(a){var b=this._sheet,h=this._columnExpandExtent.index;if(!(0>h||h>=b.getColumnCount())){var e,d,f;if(b.colRangeGroup.direction===
w.RangeGroupDirection.Forward){e=b.colRangeGroup.find(h-1,this._columnExpandExtent.level);if(!e)return;d=e.start;e=h;f=1;a?d=h:d<b.frozenColCount&&(d=b.frozenColCount);a=b.getViewportLeftColumn(f);d<a&&(a=d);f=b.getViewportWidth(f);e=this._getColsTotalWidth(b,a,e);e>f&&(a=this._getNewLeftColumn(b,a,e-f));b._scrollLeftCol=this._tryGetNextScrollableCol(b,a)}else{e=b.colRangeGroup.find(h+1,this._columnExpandExtent.level);if(!e)return;d=h;e=e.end;f=1;a?e=h:(a=b.getColumnCount(),e>=a&&(e=a-1));a=b.getViewportLeftColumn(f);
d<a?b._scrollLeftCol=this._tryGetNextScrollableCol(b,d):(f=b.getViewportWidth(f),e=this._getColsTotalWidth(b,a,e),e>f&&(a=this._getNewLeftColumn(b,a,e-f),b._scrollLeftCol=this._tryGetNextScrollableCol(b,Math.min(d,a))))}b._syncHScollbarPosition()}};E.prototype._getColsTotalWidth=function(a,b,h){for(var e=0,d=a.getColumnCount();b<=h&&b<d;b++)e+=a.getColumnWidth(b)*a._zoomFactor;return e};E.prototype._getNewLeftColumn=function(a,b,h){for(var e=0,d=a.getColumnCount(),f=b;f<d&&e<h;f++)b++,e+=a.getColumnWidth(f)*
a._zoomFactor;return b>=d?d-1:b};E.prototype._tryGetNextScrollableCol=function(a,b){var h=a.frozenColCount,e=a.getColumnCount()-1;if(b<h)return h;if(b>e)return e;for(h=b;h<=e;h++)if(0<a.getColumnWidth(h))return h;return-1};O.prototype.canExecute=function(){return!0};O.prototype.execute=function(a){var b=this._sheet;if(b&&this._rowExpandExtent&&b.rowRangeGroup){this._suspendInvalidate(a);var h=this._rowExpandExtent.collapsed;b.rowRangeGroup.setCollapsed(this._rowExpandExtent.index,h);this._resumeInvalidate(a);
this._showRowRangeGroup(h);b.invalidateLayout();b.repaint()}};O.prototype.saveState=function(){};O.prototype.undo=function(a){var b=!1,h=this._sheet;if(h&&this._rowExpandExtent&&h.rowRangeGroup){this._suspendInvalidate(a);var e=this._rowExpandExtent.collapsed;h.rowRangeGroup.setCollapsed(this._rowExpandExtent.index,!e);b=!0;this._resumeInvalidate(a);this._showRowRangeGroup(!e);h.invalidateLayout();h.repaint()}return b};O.prototype._showRowRangeGroup=function(a){var b=this._sheet,h=this._rowExpandExtent.index;
if(!(0>h||h>=b.getRowCount())){var e,d,f;if(b.rowRangeGroup.direction===w.RangeGroupDirection.Forward){e=b.rowRangeGroup.find(h-1,this._rowExpandExtent.level);if(!e)return;d=e.start;e=h;f=1;a?d=h:d<b.frozenRowCount&&(d=b.frozenRowCount);a=b.getViewportTopRow(f);d<a&&(a=d);f=b.getViewportHeight(f);e=this._getRowsTotalHeight(b,a,e);e>f&&(a=this._getNewTopRow(b,a,e-f));b._scrollTopRow=this._tryGetNextScrollableRow(b,a)}else{e=b.rowRangeGroup.find(h+1,this._rowExpandExtent.level);if(!e)return;d=h;e=e.end;
f=1;a?e=h:(a=b.getRowCount(),e>=a&&(e=a-1));a=b.getViewportTopRow(f);d<a?b._scrollTopRow=this._tryGetNextScrollableRow(b,d):(f=b.getViewportHeight(f),e=this._getRowsTotalHeight(b,a,e),e>f&&(a=this._getNewTopRow(b,a,e-f),b._scrollTopRow=this._tryGetNextScrollableRow(b,Math.min(d,a))))}b._syncVScrollbarPosition()}};O.prototype._getRowsTotalHeight=function(a,b,h){for(var e=0,d=a.getRowCount();b<=h&&b<d;b++)e+=a.getRowHeight(b)*a._zoomFactor;return e};O.prototype._getNewTopRow=function(a,b,h){for(var e=
0,d=a.getRowCount(),f=b;f<=d&&e<h;f++)b++,e+=a.getRowHeight(f)*a._zoomFactor;return b>=d?d-1:b};O.prototype._tryGetNextScrollableRow=function(a,b){var h=a.frozenRowCount,e=a.getRowCount()-1;if(b<h)return h;if(b>e)return e;for(h=b;h<=e;h++)if(0<a.getRowHeight(h))return h;return-1};H.prototype.canExecute=function(){return!0};H.prototype.execute=function(a){var b=this._sheet;if(b&&this._columnGroupHeaderExpandExtent&&b.colRangeGroup){this._suspendInvalidate(a);this.saveState();for(var h=this._columnGroupHeaderExpandExtent.level,
e=0;e<h;e++)b.colRangeGroup.expand(e,!0);b.colRangeGroup.expand(h,!1);this._resumeInvalidate(a);b.invalidateLayout();b.repaint()}};H.prototype.saveState=function(){var a=null,b=this._sheet;if(b&&this._columnGroupHeaderExpandExtent&&b.colRangeGroup)for(var h=this._columnGroupHeaderExpandExtent.level,a={},e=0;e<=h;e++)for(var d=0,f=b.getColumnCount(),g=b.colRangeGroup.direction;d<f;){var k=b.colRangeGroup.find(d,e);if(k){var n=-1;switch(g){case w.RangeGroupDirection.Backward:n=k.start-1;break;case w.RangeGroupDirection.Forward:n=
k.end+1}var l=k.getState()===w.GroupState.Collapsed;a[n]||(a[n]=l);d+=k.end-k.start+1}d++}this._oldStatus=a};H.prototype.undo=function(a){var b=!1,h=this._sheet;if(h&&this._oldStatus&&h.colRangeGroup){this._suspendInvalidate(a);for(var e in this._oldStatus)e&&(h.colRangeGroup.setCollapsed(e,this._oldStatus[e]),b=!0);this._resumeInvalidate(a);h.invalidateLayout();h.repaint()}return b};C.prototype.canExecute=function(){return!0};C.prototype.execute=function(a){var b=this._sheet;if(b&&this._rowGroupHeaderExpandExtent&&
b.rowRangeGroup){this._suspendInvalidate(a);this.saveState();for(var h=this._rowGroupHeaderExpandExtent.level,e=0;e<h;e++)b.rowRangeGroup.expand(e,!0);b.rowRangeGroup.expand(h,!1);this._resumeInvalidate(a);b.invalidateLayout();b.repaint()}};C.prototype.saveState=function(){var a=null,b=this._sheet;if(b&&this._rowGroupHeaderExpandExtent&&b.rowRangeGroup)for(var h=this._rowGroupHeaderExpandExtent.level,a={},e=0;e<=h;e++)for(var d=0,f=b.getRowCount(),g=b.rowRangeGroup.direction;d<f;){var k=b.rowRangeGroup.find(d,
e);if(k){var n=-1;switch(g){case w.RangeGroupDirection.Backward:n=k.start-1;break;case w.RangeGroupDirection.Forward:n=k.end+1}var l=k.getState()===w.GroupState.Collapsed;a[n]||(a[n]=l);d+=k.end-k.start+1}d++}this._oldStatus=a};C.prototype.undo=function(a){var b=!1,h=this._sheet;if(h&&this._oldStatus&&h.rowRangeGroup){this._suspendInvalidate(a);for(var e in this._oldStatus)e&&(h.rowRangeGroup.setCollapsed(e,this._oldStatus[e]),b=!0);this._resumeInvalidate(a);h.invalidateLayout();h.repaint()}return b};
G.prototype.canExecute=function(a){return!0};G.prototype.execute=function(a){var b=this._sheet;if(b._isValidRange(this._dragDropExtent.fromRow,this._dragDropExtent.fromColumn,this._dragDropExtent.rowCount,this._dragDropExtent.columnCount,this._sheet.getRowCount(),this._sheet.getColumnCount())&&(this._insert||b._isValidRange(this._dragDropExtent.toRow,this._dragDropExtent.toColumn,this._dragDropExtent.rowCount,this._dragDropExtent.columnCount,this._sheet.getRowCount(),this._sheet.getColumnCount()))){this.saveState();
var h,e,d;if(this._insert)if(h=this._dragDropExtent.fromRow,0<=this._dragDropExtent.fromColumn&&0>h){h=this._dragDropExtent.fromColumn;e=this._dragDropExtent.toColumn;d=this._dragDropExtent.columnCount;var f=this._dragDropExtent.toColumn;this._suspendInvalidate(a);try{this._sheet.addColumns(e,d),this._copy?this._sheet.copyTo(-1,e<=h?h+d:h,-1,e,-1,d,this._option):(this._sheet.moveTo(-1,e<=h?h+d:h,-1,e,-1,d,this._option),this._sheet.deleteColumns(e<=h?h+d:h,d),h<e&&(f=e-d))}finally{this._resumeInvalidate(a)}b&&
(h=b.getSelections().toArray(),b._clearSelectionImp(),b.addSelection(-1,f,b.getRowCount(),d),d=b.getSelections(),b._trigger(w.Events.SelectionChanging,{sheet:b,sheetName:b._name,oldSelections:h,newSelections:d}),b._trigger(w.Events.SelectionChanged,{sheet:b,sheetName:b._name}),b._setActiveCellImp(b._getFirstVisualRow(),f,b.activeRowViewportIndex,b.activeColViewportIndex),b.invalidateLayout(),b._dragRect={},b.repaint())}else{if(0<=this._dragDropExtent.fromRow&&0>this._dragDropExtent.fromColumn){h=
this._dragDropExtent.fromRow;e=this._dragDropExtent.toRow;d=this._dragDropExtent.rowCount;f=this._dragDropExtent.toRow;this._suspendInvalidate(a);try{this._sheet.addRows(e,d),this._copy?this._sheet.copyTo(e<=h?h+d:h,-1,e,-1,d,-1,this._option):(this._sheet.moveTo(e<=h?h+d:h,-1,e,-1,d,-1,this._option),this._sheet.deleteRows(e<=h?h+d:h,d),h<e&&(f=e-d))}finally{this._resumeInvalidate(a)}b&&(h=b.getSelections().toArray(),b._clearSelectionImp(),b.addSelection(f,-1,d,b.getColumnCount()),d=b.getSelections(),
b._trigger(w.Events.SelectionChanging,{sheet:b,sheetName:b._name,oldSelections:h,newSelections:d}),b._trigger(w.Events.SelectionChanged,{sheet:b,sheetName:b._name}),b._setActiveCellImp(f,b._getFirstVisualColumn(),b.activeRowViewportIndex,b.activeColViewportIndex),b.invalidateLayout(),b._dragRect={},b.repaint())}}else{f=this._dragDropExtent.fromRow;e=this._dragDropExtent.fromColumn;var g=this._dragDropExtent.toRow,k=this._dragDropExtent.toColumn,n=this._dragDropExtent.rowCount,l=this._dragDropExtent.columnCount;
this._suspendInvalidate(a);try{this._copy?this._sheet.copyTo(f,e,g,k,n,l,this._option):this._sheet.moveTo(f,e,g,k,n,l,this._option),b&&(h=b.getSelections().toArray(),b._clearSelectionImp(),b.addSelection(g,k,n,l),d=b.getSelections().toArray(),b._trigger(w.Events.SelectionChanging,{sheet:b,sheetName:b._name,oldSelections:h,newSelections:d}),b._trigger(w.Events.SelectionChanged,{sheet:b,sheetName:b._name}),b._setActiveCellImp(Math.max(b._getFirstVisualRow(),g),Math.max(b._getFirstVisualColumn(),k),
b.activeRowViewportIndex,b.activeColViewportIndex),!this._copy&&this._savedFromViewportCells&&this._savedFromViewportCells.isValueSaved()&&v.raiseRangeDataChanged(b,f,e,n,l,this._savedFromViewportCells.getValues()),this._savedToViewportCells&&this._savedToViewportCells.isValueSaved()&&v.raiseRangeDataChanged(b,g,k,n,l,this._savedToViewportCells.getValues()))}finally{this._resumeInvalidate(a)}b&&(b.invalidateLayout(),b._dragRect={},b.repaint())}}};G.prototype.saveState=function(){this.initSaveState();
var a=0>this._dragDropExtent.fromRow?0:this._dragDropExtent.fromRow,h=0>this._dragDropExtent.fromColumn?0:this._dragDropExtent.fromColumn,f=0>this._dragDropExtent.toRow?0:this._dragDropExtent.toRow,g=0>this._dragDropExtent.toColumn?0:this._dragDropExtent.toColumn,k=0>this._dragDropExtent.fromRow?this._sheet.getRowCount():this._dragDropExtent.rowCount,n=0>this._dragDropExtent.fromColumn?this._sheet.getColumnCount():this._dragDropExtent.columnCount;if(!this._insert){if(0>this._dragDropExtent.fromRow){var l=
new d(this._sheet.getRowCount(w.SheetArea.colHeader),n),s=new e(n);v.saveColumnHeaderInfo(this._sheet,l,s,g,this._option);this._savedToColumnHeaderCells=l;this._savedToColumns=s;this._copy||(l=new d(this._sheet.getRowCount(w.SheetArea.colHeader),n),s=new e(n),v.saveColumnHeaderInfo(this._sheet,l,s,h,this._option),this._savedFromColumnHeaderCells=l,this._savedFromColumns=s)}0>this._dragDropExtent.fromColumn&&(l=new d(k,this._sheet.getColumnCount(w.SheetArea.rowHeader)),s=new b(k),v.saveRowHeaderInfo(this._sheet,
l,s,f,this._option),this._savedToRowHeaderCells=l,this._savedToRows=s,this._copy||(l=new d(k,this._sheet.getColumnCount(w.SheetArea.rowHeader)),s=new b(k),v.saveRowHeaderInfo(this._sheet,l,s,a,this._option),this._savedFromRowHeaderCells=l,this._savedFromRows=s));l=new d(k,n);v.saveViewportInfo(this._sheet,l,f,g,this._option);this._savedToViewportCells=l;this._copy||(f=new d(k,n),v.saveViewportInfo(this._sheet,f,a,h,this._option),this._savedFromViewportCells=f)}this._savedAcitveRowViewportIndex=this._sheet.activeRowViewportIndex;
this._savedAcitveColumnViewportIndex=this._sheet.activeColViewportIndex;this._savedActiveRow=this._sheet._activeRowIndex;this._savedActiveColumn=this._sheet._activeColIndex};G.prototype.initSaveState=function(){this._savedToRows=this._savedToRowHeaderCells=this._savedToViewportCells=this._savedToColumns=this._savedToColumnHeaderCells=this._savedFromRows=this._savedFromRowHeaderCells=this._savedFromViewportCells=this._savedFromColumns=this._savedFromColumnHeaderCells=null;this._savedAcitveColumnViewportIndex=
this._savedAcitveRowViewportIndex=-2;this._savedActiveColumn=this._savedActiveRow=-1};G.prototype.undo=function(a){var b=this._sheet;if(!b._isValidRange(this._dragDropExtent.fromRow,this._dragDropExtent.fromColumn,this._dragDropExtent.rowCount,this._dragDropExtent.columnCount,this._sheet.getRowCount(),this._sheet.getColumnCount())||!this._insert&&!b._isValidRange(this._dragDropExtent.toRow,this._dragDropExtent.toColumn,this._dragDropExtent.rowCount,this._dragDropExtent.columnCount,this._sheet.getRowCount(),
this._sheet.getColumnCount()))return!1;var h=!1,e,d,f,g;if(this._insert){if(!(0<=this._dragDropExtent.fromColumn&&0<=this._dragDropExtent.fromRow))if(0<=this._dragDropExtent.fromColumn){h=this._dragDropExtent.fromColumn;d=this._dragDropExtent.columnCount;this._suspendInvalidate(a);try{this._copy?this._sheet.deleteColumns(this._dragDropExtent.toColumn,d):(f=this._dragDropExtent.toColumn,g=this._dragDropExtent.fromColumn,this._dragDropExtent.fromColumn<this._dragDropExtent.toColumn?f=this._dragDropExtent.toColumn-
d:g=this._dragDropExtent.fromColumn+d,this._sheet.addColumns(g,d),this._sheet.copyTo(-1,g<=f?f+d:f,-1,g,-1,d,this._option),this._sheet.deleteColumns(g<=f?f+d:f,d),f<g&&(h=g-d))}finally{this._resumeInvalidate(a)}b&&(a=b.getSelections().toArray(),b._clearSelectionImp(),b.addSelection(-1,h,b.getRowCount(),d),e=b.getSelections(),b._trigger(w.Events.SelectionChanging,{sheet:b,sheetName:b._name,oldSelections:a,newSelections:e}),b._trigger(w.Events.SelectionChanged,{sheet:b,sheetName:b._name}),b.invalidateLayout(),
b.repaint());h=!0}else if(0<=this._dragDropExtent.fromRow){d=this._dragDropExtent.rowCount;var k=this._dragDropExtent.fromRow;this._suspendInvalidate(a);try{this._copy?this._sheet.deleteRows(this._dragDropExtent.toRow,d):(f=this._dragDropExtent.toRow,g=this._dragDropExtent.fromRow,this._dragDropExtent.fromRow<this._dragDropExtent.toRow?f=this._dragDropExtent.toRow-d:g=this._dragDropExtent.fromRow+d,this._sheet.addRows(g,d),this._savedFromViewportCells&&(v.undoCellsInfo(this._sheet,this._savedFromViewportCells,
g,0,w.SheetArea.viewport),h=!0),this._savedFromRowHeaderCells&&(v.undoCellsInfo(this._sheet,this._savedFromRowHeaderCells,g,0,w.SheetArea.rowHeader),h=!0),this._savedFromRows&&(v.undoRowsInfo(this._sheet,this._savedFromRows,g),h=!0),h||this._sheet.copyTo(g<=f?f+d:f,-1,g,-1,d,-1,this._option),this._sheet.deleteRows(g<=f?f+d:f,d),f<g&&(k=g-d))}finally{this._resumeInvalidate(a)}b&&(a=b.getSelections().toArray(),b._clearSelectionImp(),b.addSelection(k,-1,d,b.getColumnCount()),e=b.getSelections(),b._trigger(w.Events.SelectionChanging,
{sheet:b,sheetName:b._name,oldSelections:a,newSelections:e}),b._trigger(w.Events.SelectionChanged,{sheet:b,sheetName:b._name}),b.invalidateLayout(),b.repaint());h=!0}}else{d=0>this._dragDropExtent.fromRow?0:this._dragDropExtent.fromRow;f=0>this._dragDropExtent.fromColumn?0:this._dragDropExtent.fromColumn;g=0>this._dragDropExtent.toRow?0:this._dragDropExtent.toRow;var k=0>this._dragDropExtent.toColumn?0:this._dragDropExtent.toColumn,n=0>this._dragDropExtent.fromRow?this._sheet.getRowCount():this._dragDropExtent.rowCount,
l=0>this._dragDropExtent.fromColumn?this._sheet.getColumnCount():this._dragDropExtent.columnCount,s=null,q=null;!this._copy&&this._savedFromViewportCells&&this._savedFromViewportCells.isValueSaved()&&(q=v.getValues(this._sheet,d,f,n,l));this._savedToViewportCells&&this._savedToViewportCells.isValueSaved()&&(s=v.getValues(this._sheet,g,k,n,l));this._suspendInvalidate(a);try{this._savedToColumnHeaderCells&&(v.undoCellsInfo(this._sheet,this._savedToColumnHeaderCells,0,k,w.SheetArea.colHeader),h=!0),
this._savedToColumns&&(v.undoColumnsInfo(this._sheet,this._savedToColumns,k),h=!0),this._savedToViewportCells&&(v.undoCellsInfo(this._sheet,this._savedToViewportCells,g,k,w.SheetArea.viewport),h=!0),this._savedToRowHeaderCells&&(v.undoCellsInfo(this._sheet,this._savedToRowHeaderCells,g,0,w.SheetArea.rowHeader),h=!0),this._savedToRows&&(v.undoRowsInfo(this._sheet,this._savedToRows,g),h=!0),this._savedFromColumnHeaderCells&&(v.undoCellsInfo(this._sheet,this._savedFromColumnHeaderCells,0,f,w.SheetArea.colHeader),
h=!0),this._savedFromColumns&&(v.undoColumnsInfo(this._sheet,this._savedFromColumns,f),h=!0),this._savedFromViewportCells&&(v.undoCellsInfo(this._sheet,this._savedFromViewportCells,d,f,w.SheetArea.viewport),h=!0),this._savedFromRowHeaderCells&&(v.undoCellsInfo(this._sheet,this._savedFromRowHeaderCells,d,0,w.SheetArea.rowHeader),h=!0),this._savedFromRows&&(v.undoRowsInfo(this._sheet,this._savedFromRows,d),h=!0)}finally{this._resumeInvalidate(a)}h&&b&&(a=b.getSelections().toArray(),b._clearSelectionImp(),
b.addSelection(this._dragDropExtent.fromRow,this._dragDropExtent.fromColumn,this._dragDropExtent.rowCount,this._dragDropExtent.columnCount),e=b.getSelections(),b._trigger(w.Events.SelectionChanging,{sheet:b,sheetName:b._name,oldSelections:a,newSelections:e}),b._trigger(w.Events.SelectionChanged,{sheet:b,sheetName:b._name}),s&&v.raiseRangeDataChanged(b,g,k,n,l,s),q&&v.raiseRangeDataChanged(b,d,f,n,l,q))}h&&b&&(-1!==this._savedActiveRow&&-1!==this._savedActiveColumn&&(a=b.getSelections()[0],a.contains(this._savedActiveRow,
this._savedActiveColumn)?b._setActiveCellImp(this._savedActiveRow,this._savedActiveColumn,!1):b._setActiveCellImp(Math.max(b._getFirstVisualRow(),a.row),Math.max(b._getFirstVisualColumn(),a.col),!1)),-2!==this._savedAcitveRowViewportIndex&&-2!==this._savedAcitveColumnViewportIndex&&-1!==this._savedActiveRow&&-1!==this._savedActiveColumn&&b.showCell(this._savedActiveRow,this._savedActiveColumn,w.VerticalPosition.nearest,w.HorizontalPosition.nearest),b.invalidateLayout(),b.repaint());return h};z.prototype.canExecute=
function(a){return!0};z.prototype.saveState=function(){var a=this._sheet.getFormula(this._cellEditInfo.row,this._cellEditInfo.col);null!==a&&""!==a?(this._oldValue=a,this._oldValueIsFormula=!0):(this._oldValue=this._sheet.getValue(this._cellEditInfo.row,this._cellEditInfo.col),this._oldValueIsFormula=!1)};z.prototype.undo=function(a){var b=this._sheet,h=this._cellEditInfo.row,e=this._cellEditInfo.col;try{this._suspendInvalidate(a);b._bind(w.Events.CellChanged,function(a,h){"value"===h.propertyName&&
b._trigger(w.Events.ValueChanged,{sheet:h.sheet,sheetName:h.sheetName,row:h.row,col:h.col,oldValue:h._oldValue,newValue:h.sheet.getValue(h.row,h.col)})});if(this._oldValueIsFormula)b.setFormula(h,e,this._oldValue);else{var d=b.getFormula(h,e);null!==d&&""!==d&&b.setFormula(h,e,null);b.setValue(h,e,this._oldValue)}this._resumeInvalidate(a);this._sheet.repaint();return!0}catch(f){return!1}finally{b._unbind(w.Events.CellChanged)}};z.prototype.execute=function(a){this._suspendInvalidate(a);this.saveState();
var b=this._sheet,h=b.isPaintSuspended();try{b.isPaintSuspended(!0),b._bind(w.Events.CellChanged,function(a,h){"value"===h.propertyName&&b._trigger(w.Events.ValueChanged,{sheet:h.sheet,sheetName:h.sheetName,row:h.row,col:h.col,oldValue:h._oldValue,newValue:h.sheet.getValue(h.row,h.col)})}),this.applyResult=this._applyEditing(a)}finally{this._sheet._unbind(w.Events.CellChanged),this._resumeInvalidate(a),b.isPaintSuspended(h)}this._canUndo=this.applyResult===w.DataValidationResult.ForceApply};z.prototype._applyEditing=
function(a){a=this._sheet;var b=this._cellEditInfo.row,h=this._cellEditInfo.col,e=this._cellEditInfo.newValue,d=this._cellEditInfo.hasOwnProperty("autoFormat")?this._cellEditInfo.autoFormat:!0,f=w.DataValidationResult.ForceApply,g=a.parent?a.parent.canUserEditFormula():!0,k;if(e&&0<e.length&&"="===e[0]){if(a.getDataValidator(b,h)){var n=e.substring(1);if(""!==n&&n!==a.getFormula(b,h)){var l=a.getCalcService();l&&(n=l.parse(n,0<=b?b:0,0<=h?h:0))&&(l=l.evaluateParsedFormula(a._getSheetSource(),n,b,
h),a.isValid(b,h,l)||(f=a._validationError(b,h,l)))}}}else k=this._getValueFromEditing(b,h,e,d),a.isValid(b,h,k)||(f=a._validationError(b,h,e),a._eventHandler._forceCancelSelectiong=!0);if(f!==w.DataValidationResult.Discard&&f!==w.DataValidationResult.Retry&&f===w.DataValidationResult.ForceApply)if(g&&e&&0<e.length&&"="===e[0]){try{a.setFormula(b,h,e.substring(1))}catch(s){throw a._trigger(w.Events.InvalidOperation,{sheet:a,sheetName:a._name,message:s.message}),s;}a._trigger(w.Events.UserFormulaEntered,
{sheet:a,sheetName:a._name,row:b,col:h,formula:e.substring(1).toUpperCase()})}else{a.hasFormula(b,h)&&a.setFormula(b,h,null);try{/^('=)/ig.test(e)&&(e=e.substring(1));if(void 0===k||null===k)k=this._getValueFromEditing(b,h,e,d);a.setValue(b,h,k)}catch(q){a.setValue(b,h,e)}}return f};z.prototype.canUndo=function(a){return this._canUndo};z.prototype._getValueFromEditing=function(a,b,h,e){var d=null,f=this._sheet.getActualStyle(a,b);f&&(f.formatter?(d=f.formatter,"string"===typeof d&&(d=new w.GeneralFormatter(d),
this._sheet._editingTimeValue&&(d=new w.GeneralFormatter("yyyy/mm/dd hh:mm:ss")))):d=f._autoFormatter);if(!d||d instanceof w.AutoFormatter){if(e){e={};var g=null;try{g=(new w.GeneralFormatter).GetPreferredDisplayFormatter(h,e)}catch(k){}f=null;d&&d instanceof w.AutoFormatter&&null!==e.value&&g&&"General"!==g.FormatString()?f=new w.AutoFormatter(g):!d&&g&&(f=new w.AutoFormatter(g));f&&((d=this._sheet.getStyle(a,b))||(d=new w.Style),d._autoFormatter=f,this._sheet.setStyle(a,b,d));return null!==e.value?
e.value:h}return h}a=null;try{a=d.Parse(h)}catch(n){}return void 0===a||null===a?h:a};S.prototype.canUndo=function(){return!!this._oldName};S.prototype.canExecute=function(a){return this._sheet&&this._newName&&this._newName!==this._oldName};S.prototype.execute=function(a){var b=this._sheet;b&&this._newName&&this._newName!==this._oldName&&(this.saveState(),this._suspendInvalidate(a),b._name=this._newName,this._resumeInvalidate(a),b._refreshTabStrip())};S.prototype.canUndo=function(){return!!this._oldName};
S.prototype.saveState=function(){this._sheet&&(this._oldName=this._sheet._name)};S.prototype.undo=function(a){var b=this._sheet;return b?(this._suspendInvalidate(a),b._name=this._oldName,this._resumeInvalidate(a),b._refreshTabStrip(),!0):!1};Q.prototype.canExecute=function(a){return this._sheet&&this._sheet.parent._allowUserZoom&&this._sheet._zoomFactor!==this._zoomFactor};Q.prototype.execute=function(a){var b=this._sheet;this.saveState();!b||b.parent&&!0!==b.parent._allowUserZoom||b._zoomFactor===
this._zoomFactor||(!0===b.isEditing()&&b.endEdit(),this._suspendInvalidate(a),b.zoom(this._zoomFactor),this._resumeInvalidate(a),b.invalidateLayout(),b.repaint())};Q.prototype.canUndo=function(){return this._sheet&&0<this._prevZoomFactor};Q.prototype.saveState=function(){this._sheet&&(this._prevZoomFactor=this._sheet._zoomFactor)};Q.prototype.undo=function(a){var b=this._sheet;return b?(this._suspendInvalidate(a),b.zoom(this._prevZoomFactor),this._resumeInvalidate(a),b.invalidateLayout(),b.repaint(),
!0):!1};ka.prototype.canExecute=function(a){if(this._cachedActions){for(var b=0;b<this._cachedActions.length;b++)if(!this._cachedActions[b].canExecute(a))return!1;return!0}return!1};ka.prototype.execute=function(a){this.saveState();if(this._cachedActions){this._suspendInvalidate(a);for(var b=0;b<this._cachedActions.length;b++)this._cachedActions[b].execute(a);this._resumeInvalidate(a);this._sheet.repaint()}};ka.prototype.canUndo=function(){if(this._cachedActions){for(var a=0;a<this._cachedActions.length;a++)if(!this._cachedActions[a].canUndo())return!1;
return!0}return!1};ka.prototype.saveState=function(){if(this._cachedActions)for(var a=0;a<this._cachedActions.length;a++)this._cachedActions[a].saveState()};ka.prototype.undo=function(a){if(this._cachedActions){for(var b=this._cachedActions.length-1;0<=b;b--){var h=this._cachedActions[b];this._suspendInvalidate(a);h=h.undo(a);this._resumeInvalidate(a);if(h)this._sheet.repaint();else return!1}return!0}return!1};aa.prototype.execute=function(a){this.saveState();var b=this._sheet;if(b&&(a=b._getActualRange(this._clearRange),
0<a.colCount&&0<a.rowCount))try{b._bind(w.Events.CellChanged,function(a,h){"value"===h.propertyName&&b._trigger(w.Events.ValueChanged,{sheet:h.sheet,sheetName:h.sheetName,row:h.row,col:h.col})});var h=b.isPaintSuspended();b.isPaintSuspended(!0);b.suspendEvent();b.clear(a.row,a.col,a.rowCount,a.colCount,w.SheetArea.viewport,ia.Data);b.resumeEvent();b.isPaintSuspended(h);b.repaint();v.raiseRangeDataChanged(b,a.row,a.col,a.rowCount,a.colCount)}finally{this._sheet._unbind(w.Events.CellChanged)}};aa.prototype.canExecute=
function(a){a=this._sheet;return!0===a.isProtected&&a._isAnyCellInRangeLocked(this._clearRange)?!1:!0};aa.prototype.canUndo=function(){return!!this._cachedValues};aa.prototype.saveState=function(){var a=this._sheet;if(a){this._cachedFilteredColumns=[];var b=a.rowFilter(),h,e;if(b&&b.range&&b.isFiltered()&&(h=b.range.row,e=b.range.rowCount,b.showFilterButton&&(h=b.range.row-1,e=b.range.rowCount+1,0>h&&(e=h=-1)),(-1===this._clearRange.row||this._clearRange.row<=h&&h+e<=this._clearRange.row+this._clearRange.rowCount)&&
(-1===this._clearRange.col||this._clearRange.col<=b.range.col&&b.range.col+b.range.colCount<=this._clearRange.col+this._clearRange.colCount))){e=0>b.range.col?0:b.range.col;h=0>b.range.colCount?a.getColumnCount():b.range.colCount;for(var d=0;d<h;d++)b.isColumnFiltered(e+d)&&this._cachedFilteredColumns.push(e+d)}b=a._getActualRange(this._clearRange);if(0<b.colCount&&0<b.rowCount)for(this._cachedValues=[b.row+b.rowCount],d=0;d<b.rowCount;d++){this._cachedValues[b.row+d]=[b.col+b.colCount];for(var f=
0;f<b.colCount;f++){h=b.row+d;e=b.col+f;var g=a.getFormula(h,e);g&&""!==g?this._cachedValues[h][e]=new L(g,!0):(g=a.getValue(h,e),void 0!==g&&null!==g&&(this._cachedValues[h][e]=new L(g,!1)))}}}};aa.prototype.undo=function(a){var b=this._sheet;if(b){a=!1;var h,e=b._getActualRange(this._clearRange);if(this._cachedValues&&0<e.colCount&&0<e.rowCount)try{b._bind(w.Events.CellChanged,function(a,h){"value"===h.propertyName&&b._trigger(w.Events.ValueChanged,{sheet:h.sheet,sheetName:h.sheetName,row:h.row,
col:h.col})});var d=e.rowCount,f=e.colCount,g=b.isPaintSuspended();b.isPaintSuspended(!0);b.suspendEvent();for(h=0;h<d;h++)for(var k=0;k<f;k++){var n=e.row+h,l=e.col+k;if(this._cachedValues[n][l]){var s=this._cachedValues[n][l];s.isFormula?b.setFormula(n,l,s.value):(b.setFormula(n,l,null),b.setValue(n,l,s.value))}else b.setFormula(n,l,null),b.setValue(n,l,null)}b.resumeEvent();b.isPaintSuspended(g);v.raiseRangeDataChanged(b,e.row,e.col,e.rowCount,e.colCount);a=!0}finally{b._unbind(w.Events.CellChanged)}if((d=
b.rowFilter())&&this._cachedFilteredColumns&&0<this._cachedFilteredColumns.length)for(h=0;h<this._cachedFilteredColumns.length;h++)d.filter(this._cachedFilteredColumns[h]);if(a)return b.repaint(),!0}return!1};J.prototype.canExecute=function(a){return this._dragFillExtent.autoFillType===M.ClearValues?this.canExecuteDragClear():this.canExecuteDragFill()};J.prototype.canExecuteDragClear=function(){return!0};J.prototype.canExecuteDragFill=function(){var a=this._dragFillExtent.startRange;return!this._dragFillExtent.fillRange.intersect(a.row,
a.col,a.rowCount,a.colCount)};J.prototype.execute=function(a){if(this.canExecute(a)){a=this._workSheet;try{this._suspendInvalidate(a),a.suspendCalcService(),this.saveState(),this._execute(a)}finally{a.resumeCalcService(),this._resumeInvalidate(a)}a.invalidateLayout();a.repaint()}};J.prototype._execute=function(a){var b=this._workSheet,h=b.getSelections()?b.getSelections().toArray():null;this._dragFillExtent.autoFillType===M.ClearValues?this.executeDragFillClear(a):this.executeDragFill(a);if(this._savedFilledViewportCells&&
this._savedFilledViewportCells.isValueSaved()&&a===this._workSheet){var e=this._dragFillExtent.fillRange;v.raiseRangeDataChanged(a,e.row,e.col,e.rowCount,e.colCount,this._savedFilledViewportCells.getValues())}a=b.getSelections()?b.getSelections().toArray():null;b._raiseSelectionChanging(h,a)&&b._raiseSelectionChanged()};J.prototype.executeDragFillClear=function(a){this._clearValueUndoAction.execute(a);var b=this._dragFillExtent.startRange,h=this._dragFillExtent.fillRange;b.equals(h)||(b=this._fillSeries===
P.Column?new w.Range(b.row,b.col,Math.max(1,b.rowCount-h.rowCount),b.colCount):new w.Range(b.row,b.col,b.rowCount,Math.max(1,b.colCount-h.colCount)),a._setActiveCellImp(Math.max(a._getFirstVisualRow(),b.row),Math.max(a._getFirstVisualColumn(),b.col),a.activeRowViewportIndex,a.activeColViewportIndex),a._clearSelectionImp(),a.addSelection(b.row,b.col,b.rowCount,b.colCount))};J.prototype.executeDragFill=function(a){var b=this._workSheet,h=this._dragFillExtent.startRange,e=this._dragFillExtent.fillRange,
d,f;if(this._dragFillExtent.autoFillType===M.FillSeries)this.clearData(e),(d=this._dragFillExtent.fillDirection===T.Down||this._dragFillExtent.fillDirection===T.Right)?b.fillAuto(h,this._wholeFillRange,this._fillSeries):b.fillLinear(h,this._wholeFillRange,this._fillSeries);else if(this._dragFillExtent.autoFillType===M.CopyCells)this.copyCells(h,e,w.CopyToOption.All);else if(this._dragFillExtent.autoFillType===M.FillFormattingOnly)this.copyCells(h,e,w.CopyToOption.Style);else if(this._dragFillExtent.autoFillType===
M.FillWithoutFormatting)if(this.clearData(e),1!==h.rowCount||1!==h.colCount||-1===h.row&&-1!==h.col||-1===h.col&&-1!==h.row){var e=this.adjustRange(this._wholeFillRange),g=new w._GcSheetModel(e.rowCount,e.colCount,null);for(d=0;d<e.rowCount;d++)for(f=0;f<e.colCount;f++)g.setStyle(d,f,v.getStyleObject(this._workSheet,e.row+d,e.col+f,w.SheetArea.viewport));(d=this._dragFillExtent.fillDirection===T.Down||this._dragFillExtent.fillDirection===T.Right)?b.fillAuto(h,this._wholeFillRange,this._fillSeries):
b.fillLinear(h,this._wholeFillRange,this._fillSeries);for(d=0;d<e.rowCount;d++)for(f=0;f<e.colCount;f++)v.setStyleObject(this._workSheet,e.row+d,e.col+f,w.SheetArea.viewport,g.getStyle(d,f))}else this.copyCells(h,e,w.CopyToOption.Formula|w.CopyToOption.RangeGroup|w.CopyToOption.Span|w.CopyToOption.Sparkline|w.CopyToOption.Tag|w.CopyToOption.Value);b._setActiveCellImp(Math.max(a._getFirstVisualRow(),this._wholeFillRange.row),Math.max(a._getFirstVisualColumn(),this._wholeFillRange.col),a.activeRowViewportIndex,
a.activeColViewportIndex);a._selectionModel&&a._clearSelectionImp();b.addSelection(this._wholeFillRange.row,this._wholeFillRange.col,this._wholeFillRange.rowCount,this._wholeFillRange.colCount)};J.prototype.clearData=function(a){this._workSheet.clear(a.row,a.col,a.rowCount,a.colCount,w.SheetArea.viewport,ia.Data)};J.prototype.adjustRange=function(a){var b=-1!==a.row?a.row:0,h=-1!==a.col?a.col:0,e=-1!==a.rowCount?a.rowCount:this._workSheet.getRowCount();a=-1!==a.colCount?a.colCount:this._workSheet.getColumnCount();
return new w.Range(b,h,e,a)};J.prototype.copyCells=function(a,b,h){var e=this._workSheet;a=this.adjustRange(a);b=this.adjustRange(b);var d,f,g,k,n,l,s;if(this._fillSeries===P.Column){var q=Math.floor(b.rowCount/a.rowCount);for(d=0;d<q;d++)f=a.row,g=a.col,this._dragFillExtent.fillDirection===T.Down?k=b.row+d*a.rowCount:(k=b.row+b.rowCount,k-=(d+1)*a.rowCount),n=b.col,l=a.rowCount,s=a.colCount,e.copyTo(f,g,k,n,l,s,h);d=b.rowCount%a.rowCount;0!==d&&(f=this._dragFillExtent.fillDirection===T.Down?a.row:
a.row+(a.rowCount-(b.rowCount-a.rowCount*q)),g=a.col,this._dragFillExtent.fillDirection===T.Down?k=b.row+a.rowCount*q:(k=b.row+b.rowCount,k=k-q*a.rowCount-d),n=b.col,s=a.colCount,e.copyTo(f,g,k,n,d,s,h))}else{q=Math.floor(b.colCount/a.colCount);for(d=0;d<q;d++)f=a.row,g=a.col,k=b.row,n=this._dragFillExtent.fillDirection===T.Right?b.col+d*a.colCount:b.col+b.colCount-(d+1)*a.colCount,l=a.rowCount,s=a.colCount,e.copyTo(f,g,k,n,l,s,h);d=b.colCount%a.colCount;0!==d&&(f=a.row,g=this._dragFillExtent.fillDirection===
T.Right?a.col:a.col+(a.colCount-(b.colCount-a.colCount*q)),k=b.row,n=this._dragFillExtent.fillDirection===T.Right?b.col+a.colCount*q:b.col+b.colCount-q*a.colCount-d,l=a.rowCount,e.copyTo(f,g,k,n,l,d,h))}};J.prototype.saveState=function(){this._dragFillExtent.AutoFillType===M.ClearValues?this.saveDragClearState():this.saveDragFillState()};J.prototype.saveDragClearState=function(){this._clearValueUndoAction.saveState()};J.prototype.saveDragFillState=function(){this._savedFilledViewportCells=this.saveRangeStates(this._dragFillExtent.fillRange);
this._savedStartViewportCells=this.saveRangeStates(this._dragFillExtent.startRange)};J.prototype.saveRangeStates=function(a){a=this.adjustRange(a);var b=new d(a.rowCount,a.colCount);v.saveViewportInfo(this._workSheet,b,a.row,a.col,w.CopyToOption.All);return b};J.prototype.undo=function(a){a=this._workSheet;var b=!1;try{b=this._undo(a)}finally{this._workSheet.resumeCalcService(),this._resumeInvalidate(a)}return b};J.prototype._undo=function(a){var b,h=a.getSelections()?a.getSelections().toArray():
null,e=null,d=this._dragFillExtent.fillRange;this._savedFilledViewportCells&&this._savedFilledViewportCells.isValueSaved()&&(e=v.getValues(this._workSheet,d.row,d.col,d.rowCount,d.colCount));b=this._dragFillExtent.autoFillType===M.ClearValues?this.undoDragClear(a):this.undoDragFill(a);!0!==a._skipCloseDragFillSmartTag&&a._closeDragFillPopup();e&&v.raiseRangeDataChanged(a,d.row,d.col,d.rowCount,d.colCount,e);e=a.getSelections()?a.getSelections().toArray():null;a._raiseSelectionChanging(h,e)&&a._raiseSelectionChanged();
a.repaint();return b};J.prototype.undoDragClear=function(a){var b=this._clearValueUndoAction.undo(a);a._setActiveCellImp(Math.max(a._getFirstVisualRow(),this._dragFillExtent.startRange.row),Math.max(a._getFirstVisualColumn(),this._dragFillExtent.startRange.col),a.activeRowViewportIndex,a.activeColViewportIndex);a._clearSelectionImp();a.addSelection(this._dragFillExtent.startRange.row,this._dragFillExtent.startRange.col,this._dragFillExtent.startRange.rowCount,this._dragFillExtent.startRange.colCount);
return b};J.prototype.undoDragFill=function(a){this._suspendInvalidate(a);a.suspendCalcService();try{this.undoRangeStates(this._savedFilledViewportCells,this._dragFillExtent.fillRange),this.undoRangeStates(this._savedStartViewportCells,this._dragFillExtent.startRange),a._setActiveCellImp(Math.max(a._getFirstVisualRow(),this._dragFillExtent.startRange.row),Math.max(a._getFirstVisualColumn(),this._dragFillExtent.startRange.col),a.activeRowViewportIndex,a.activeColViewportIndex),a._clearSelectionImp(),
a.addSelection(this._dragFillExtent.startRange.row,this._dragFillExtent.startRange.col,this._dragFillExtent.startRange.rowCount,this._dragFillExtent.startRange.colCount)}finally{a.resumeCalcService(),this._resumeInvalidate(a)}a.invalidateLayout();return!0};J.prototype.undoRangeStates=function(a,b){var h=this.adjustRange(b);v.undoCellsInfo(this._workSheet,a,h.row,h.col,w.SheetArea.viewport)};J.prototype.initWholeFilledRange=function(){var a=0,b=0,h=0,e=0,h=this._dragFillExtent.fillDirection,e=this._dragFillExtent.startRange,
d=this._dragFillExtent.fillRange;h===T.Left||h===T.Right?(a=e.row,b=e.rowCount,h=h===T.Left?d.col:e.col,e=e.colCount+d.colCount):(a=h===T.Up?d.row:e.row,b=e.rowCount+d.rowCount,h=e.col,e=e.colCount);this._wholeFillRange=new w.Range(a,h,b,e)};A.prototype.execute=function(a){if(this._cachedActions){for(var b=this._sheet,h=0;h<this._cachedActions.length;h++){var e=this._cachedActions[h];b?b._raiseClipboardPasting(e.pasteRange(),e.pasteOption())||(e.execute(a),b._raiseClipboardPasted(e.pasteRange(),e.pasteOption())):
e.execute(a)}this.refreshSelection(a);this.refreshUI(a)}};A.prototype.refreshSelection=function(a){if((a=this._sheet)&&this._cachedActions){var b=a.getSelections().toArray();a._clearSelectionImp();if(1<this._cachedActions.length)for(var h=0;h<this._cachedActions.length;h++){var e=this._cachedActions[h].pasteRange();a.addSelection(e.row,e.col,e.rowCount,e.colCount)}else 0<this._cachedActions.length&&(h=this._cachedActions[0].pasteRange(),a.addSelection(h.row,h.col,h.rowCount,h.colCount),h.contains(a._activeRowIndex,
a._activeColIndex)||a._setActiveCellImp(Math.max(a._getFirstVisualRow(),h.row),Math.max(a._getFirstVisualColumn(),h.col),a.activeRowViewportIndex,a.activeColViewportIndex));a._raiseSelectionChanging(b,a.getSelections().toArray())&&a._raiseSelectionChanged()}};A.prototype.refreshUI=function(a){if(a=this._sheet)a.invalidateLayout(),a.repaint()};A.prototype.canExecute=function(a){if(this._cachedActions){for(var b=0;b<this._cachedActions.length;b++)if(!this._cachedActions[b].canExecute(a))return!1;return!0}return!1};
A.prototype.canUndo=function(){if(this._cachedActions){for(var a=0;a<this._cachedActions.length;a++)if(!this._cachedActions[a].canUndo())return!1;return!0}return!1};A.prototype.saveState=function(){if(this._cachedActions)for(var a=0;a<this._cachedActions.length;a++)this._cachedActions[a].saveState()};A.prototype.undo=function(a){if(this._cachedActions){for(var b=!0,h=0;h<this._cachedActions.length;h++)b&=this._cachedActions[h].undo(a);this.refreshUI(a);return b}return!1};K.prototype.canUndo=function(){return!0};
K.prototype.canExecute=function(a){return!0};K.prototype.saveState=function(){this.initSaveState();var a=this._pasteExtent.isCutting,h=K.convertPasteOption(this._pasteOption),f=this._pasteExtent.sourceRange,g=this._pasteExtent.targetRange;if(this._fromSheet&&f&&a){var a=0>f.row?0:f.row,k=0>f.col?0:f.col,n=0>f.row?this._fromSheet.getRowCount():f.rowCount,s=0>f.col?this._fromSheet.getColumnCount():f.colCount;if(0>f.row&&0>f.col&&0>g.row&&0>g.col&&this._fromSheet._name!==this._toSheet._name){var q=new l;
v.saveSheetInfo(this._fromSheet,q,h);this._savedFromSheetInfo=q}if(0>f.row){var q=new d(this._fromSheet.getRowCount(w.SheetArea.colHeader),s),m=new e(s);v.saveColumnHeaderInfo(this._fromSheet,q,m,k,h);this._savedFromColumnHeaderCells=q;this._savedFromColumns=m}0>f.col&&(q=new d(n,this._fromSheet.getColumnCount(w.SheetArea.rowHeader)),m=new b(n),v.saveRowHeaderInfo(this._fromSheet,q,m,a,h),this._savedFromRowHeaderCells=q,this._savedFromRows=m);n=new d(n,s);v.saveViewportInfo(this._fromSheet,n,a,k,
h);this._savedFromViewportCells=n}a=0>g.row?0:g.row;k=0>g.col?0:g.col;n=0>g.row?this._toSheet.getRowCount():g.rowCount;s=0>g.col?this._toSheet.getColumnCount():g.colCount;this._fromSheet&&f&&(0>f.row&&0>f.col&&0>g.row&&0>g.col&&this._fromSheet._name!==this._toSheet._name&&(g=new l,v.saveSheetInfo(this._toSheet,g,h),this._savedToSheetInfo=g),0>f.row&&(g=new d(this._toSheet.getRowCount(w.SheetArea.colHeader),s),q=new e(s),v.saveColumnHeaderInfo(this._toSheet,g,q,k,h),this._savedToColumnHeaderCells=
g,this._savedToColumns=q),0>f.col&&(f=new d(n,this._toSheet.getColumnCount(w.SheetArea.rowHeader)),g=new b(n),v.saveRowHeaderInfo(this._toSheet,f,g,a,h),this._savedToRowHeaderCells=f,this._savedToRows=g));f=new d(n,s);v.saveViewportInfo(this._toSheet,f,a,k,h);this._savedToViewportCells=f};K.prototype.initSaveState=function(){this._savedToRows=this._savedToRowHeaderCells=this._savedToViewportCells=this._savedToColumns=this._savedToColumnHeaderCells=this._savedToSheetInfo=this._savedFromRows=this._savedFromRowHeaderCells=
this._savedFromViewportCells=this._savedFromColumns=this._savedFromColumnHeaderCells=this._savedFromSheetInfo=null};K.prototype.pasteOption=function(){return this._pasteOption};K.prototype.pasteRange=function(){return this._pasteExtent.targetRange};K.prototype.execute=function(a){var b=this._pasteExtent.sourceRange,h=this._pasteExtent.targetRange;if((!this._fromSheet||!b||this._fromSheet._isValidRange(b.row,b.col,b.rowCount,b.colCount,this._fromSheet.getRowCount(),this._fromSheet.getColumnCount()))&&
this._toSheet&&h&&this._toSheet._isValidRange(h.row,h.col,h.rowCount,h.colCount,this._toSheet.getRowCount(),this._toSheet.getColumnCount())){this.saveState();this._suspendInvalidate(a);try{this._toSheet._clipboardPaste(this._fromSheet,b,this._toSheet,h,this._pasteExtent.isCutting,this._pasteExtent.clipboardText,this._pasteOption),this._sheet&&(this._pasteExtent.isCutting&&this._savedFromViewportCells&&this._savedFromViewportCells.isValueSaved()&&this._fromSheet&&v.raiseRangeDataChanged(this._fromSheet,
b.row,b.col,b.rowCount,b.colCount,this._savedFromViewportCells.getValues()),this._savedToViewportCells&&this._savedToViewportCells.isValueSaved()&&this._toSheet&&v.raiseRangeDataChanged(this._toSheet,h.row,h.col,h.rowCount,h.colCount,this._savedToViewportCells.getValues()))}finally{this._resumeInvalidate(a)}}};K.prototype.undo=function(a){var b=this._pasteExtent.sourceRange,h=this._pasteExtent.targetRange;if(!this._toSheet||!h||!this._toSheet._isValidRange(h.row,h.col,h.rowCount,h.colCount,this._toSheet.getRowCount(),
this._toSheet.getColumnCount())||this._fromSheet&&b&&(!this._fromSheet._isValidRange(b.row,b.col,b.rowCount,b.colCount,this._fromSheet.getRowCount(),this._fromSheet.getColumnCount())||this._fromSheet&&this._fromSheet._name===this._toSheet._name&&this._toSheet.parent&&!this._toSheet.parent.sheets.contains(this._fromSheet)))return!1;this._suspendInvalidate(a);var e=!1;try{var d=null,f=null,g=0>h.row?0:h.row,k=0>h.col?0:h.col,n=0>h.row?this._toSheet.getRowCount():h.rowCount,l=0>h.col?this._toSheet.getColumnCount():
h.colCount;this._savedToSheetInfo&&(v.undoSheetInfo(this._toSheet,this._savedToSheetInfo),e=!0);this._savedToViewportCells&&this._savedToViewportCells.isValueSaved()&&(d=v.getValues(this._toSheet,g,k,n,l));this._savedToColumnHeaderCells&&(v.undoCellsInfo(this._toSheet,this._savedToColumnHeaderCells,0,k,w.SheetArea.colHeader),e=!0);this._savedToColumns&&(v.undoColumnsInfo(this._toSheet,this._savedToColumns,k),e=!0);this._savedToViewportCells&&(v.undoCellsInfo(this._toSheet,this._savedToViewportCells,
g,k,w.SheetArea.viewport),e=!0);this._savedToRowHeaderCells&&(v.undoCellsInfo(this._toSheet,this._savedToRowHeaderCells,g,0,w.SheetArea.rowHeader),e=!0);this._savedToRows&&(v.undoRowsInfo(this._toSheet,this._savedToRows,g),e=!0);var s=h=0,q=0,m=0;this._fromSheet&&b&&(h=0>b.row?0:b.row,s=0>b.col?0:b.col,q=0>b.row?this._fromSheet.getRowCount():b.rowCount,m=0>b.col?this._fromSheet.getColumnCount():b.colCount,this._savedFromViewportCells&&this._savedFromViewportCells.isValueSaved()&&(f=v.getValues(this._fromSheet,
h,s,q,m)),this._savedFromColumnHeaderCells&&(v.undoCellsInfo(this._fromSheet,this._savedFromColumnHeaderCells,0,s,w.SheetArea.colHeader),e=!0),this._savedFromColumns&&(v.undoColumnsInfo(this._fromSheet,this._savedFromColumns,s),e=!0),this._savedFromViewportCells&&(v.undoCellsInfo(this._fromSheet,this._savedFromViewportCells,h,s,w.SheetArea.viewport),e=!0),this._savedFromRowHeaderCells&&(v.undoCellsInfo(this._fromSheet,this._savedFromRowHeaderCells,h,0,w.SheetArea.rowHeader),e=!0),this._savedFromRows&&
(v.undoRowsInfo(this._fromSheet,this._savedFromRows,h),e=!0));e&&a&&(d&&this._toSheet&&v.raiseRangeDataChanged(this._toSheet,g,k,n,l,d),f&&this._fromSheet&&v.raiseRangeDataChanged(this._fromSheet,h,s,q,m,f))}finally{this._resumeInvalidate(a)}return e};K.convertPasteOption=function(a){var b=0;if(a===w.ClipboardPasteOptions.All||a===w.ClipboardPasteOptions.Values)b|=w.CopyToOption.Value;if(a===w.ClipboardPasteOptions.All||a===w.ClipboardPasteOptions.Formatting)b|=w.CopyToOption.Style;if(a===w.ClipboardPasteOptions.All||
a===w.ClipboardPasteOptions.Formulas)b|=w.CopyToOption.Formula;a===w.ClipboardPasteOptions.All&&(b|=w.CopyToOption.Span,b|=w.CopyToOption.Sparkline,b|=w.CopyToOption.BindingPath);return b};l.prototype={saveDefaultStyle:function(a){this._defaultStyle=a;this._defaultStyleSaved=!0},getDefaultStyle:function(){return this._defaultStyle},saveDefaultColumnWidth:function(a){this._defaultColumnWidth=a;this._defaultColumnWidthSaved=!0},getDefaultColumnWidth:function(){return this._defaultColumnWidth},saveDefaultRowHeight:function(a){this._defaultRowHeight=
a;this._defaultRowHeightSaved=!0},getDefaultRowHeight:function(){return this._defaultRowHeight},saveColumnHeaderDefaultStyle:function(a){this._columnHeaderDefaultStyle=a;this._columnHeaderDefaultStyleSaved=!0},getColumnHeaderDefaultStyle:function(){return this._columnHeaderDefaultStyle},saveColumnHeaderDefaultRowHeight:function(a){this._columnHeaderDefaultRowHeight=a;this._columnHeaderDefaultRowHeightSaved=!0},getColumnHeaderDefaultRowHeight:function(){return this._columnHeaderDefaultRowHeight},saveRowHeaderDefaultStyle:function(a){this._rowHeaderDefaultStyle=
a;this._rowHeaderDefaultStyleSaved=!0},getRowHeaderDefaultStyle:function(){return this._rowHeaderDefaultStyle},saveRowHeaderDefaultColumnWidth:function(a){this._rowHeaderDefaultColumnWidth=a;this._rowHeaderDefaultColumnWidthSaved=!0},getRowHeaderDefaultColumnWidth:function(){return this._rowHeaderDefaultColumnWidth},isDefaultStyleSaved:function(){return this._defaultStyleSaved},isDefaultColumnWidthSaved:function(){return this._defaultColumnWidthSaved},isDefaultRowHeightSaved:function(){return this._defaultRowHeightSaved},
isColumnHeaderDefaultStyleSaved:function(){return this._columnHeaderDefaultStyleSaved},isColumnHeaderDefaultRowHeightSaved:function(){return this._columnHeaderDefaultRowHeightSaved},isRowHeaderDefaultStyleSaved:function(){return this._rowHeaderDefaultStyleSaved},isRowHeaderDefaultColumnWidthSaved:function(){return this._rowHeaderDefaultColumnWidthSaved}};w.CopyMoveCellsInfo=d;w.CopyMoveHelper=v;w.UndoRedo={DragDropExtent:function(a,b,h,e,d,f){this.fromRow=a;this.fromColumn=b;this.toRow=h;this.toColumn=
e;this.rowCount=d;this.columnCount=f},GroupExtent:function(a,b){this.index=a;this.count=b},ActionBase:f,ColumnResizeUndoAction:s,RowResizeUndoAction:q,ColumnAutoFitUndoAction:t,RowAutoFitUndoAction:r,ColumnGroupUndoAction:u,ColumnUngroupUndoAction:n,RowGroupUndoAction:h,RowUngroupUndoAction:I,ColumnGroupExpandUndoAction:E,RowGroupExpandUndoAction:O,ColumnGroupHeaderExpandUndoAction:H,RowGroupHeaderExpandUndoAction:C,DragDropUndoAction:G,CellEditUndoAction:z,SheetRenameUndoAction:S,ZoomUndoAction:Q,
ClearValueUndoAction:ka,DragFillUndoAction:J,ClipboardPasteUndoAction:A,ClipboardPasteRangeUndoAction:K}})(window);
(function(p){var l=p.GrapeCity;"undefined"===typeof l&&(l=p.GrapeCity={});"undefined"===typeof l.UI&&(l.UI={});var m=l.UI.LineStyle,k=function(){};l.UI.Line=k;k.prototype={adjust:function(a){0===a.orientation?(a.offsetEnd&&(this._x2+=a.offsetEnd),a.offsetStart&&(this._x1+=a.offsetStart)):1===a.orientation&&(a.offsetEnd&&(this._y2+=a.offsetEnd),a.offsetStart&&(this._y1+=a.offsetStart))},paint:function(a){var b=!1;a.lineWidth!==this._lineWidth&&(b=!0);var h=this._color?this._color:"#9EB6CE";a.strokeStyle!==
h&&(b=!0);b&&(a.closePath(),a.stroke(),a.beginPath(),a.lineWidth=this._lineWidth,a.strokeStyle=h);this.paintLine(a)},paintLine:function(a){a.moveTo(this._x1,this._y1);a.lineTo(this._x2,this._y2)}};var g=function(a,b,h,e,d,f){f%2||(a!==h?(b-=0.5,e-=0.5):(a-=0.5,h-=0.5));this._x1=a;this._y1=b;this._x2=h;this._y2=e;this._color=d;this._lineWidth=f};g.prototype=new k;var a=function(a,b,h,e,d,f,g){f%2||(a!==h?(b-=0.5,e-=0.5):(a-=0.5,h-=0.5));this._x1=a;this._y1=b;this._x2=h;this._y2=e;this._color=d;this._lineWidth=
f;this._pattern=g};a.prototype=new k;a.prototype.paintLine=function(b){a.render(b,this._x1,this._y1,this._x2,this._y2,this._pattern)};a.render=function(a,b,h,e,d,f){var g=Math.sqrt(Math.pow(e-b,2)+Math.pow(d-h,2));e=(e-b)/g;d=(d-h)/g;var k=0,l=0;for(f=f&&f.length?f:[4,4];k<g;){var s=Math.min(f[l++%f.length],g-k),q=l%2,k=k+s;q&&a.moveTo(b,h);b+=s*e;h+=s*d;q&&a.lineTo(b,h)}};var d=function(a,b,h,e,d,f,g,k){f?(a-=1,h-=1):(b-=1,e-=1);this._x1=a;this._y1=b;this._x2=h;this._y2=e;this._color=d;this._horizental=
f;this._lineWidth=1;this._pattern1=g;this._pattern2=k};d.prototype=new k;d.prototype.paintLine=function(b){var e=this._horizental?0:1,h=this._horizental?1:0;a.render(b,this._x1-e,this._y1-h,this._x2-e,this._y2-h,this._pattern1);a.render(b,this._x1,this._y1,this._x2,this._y2,this._pattern2)};var e=function(a,b,h,e,d,f){var k=f?0:1,l=f?1:0;this._line1=new g(a-k,b-l,h-k,e-l,d,1);this._line2=new g(a+k,b+l,h+k,e+l,d,1);this._color=d;this._horizental=f;this._lineWidth=1};e.prototype=new k;e.prototype.paintLine=
function(a){this._line1.paintLine(a);this._line2.paintLine(a)};e.prototype.adjust=function(a){a.lineSide?1===a.lineSide?this._line1.adjust(a):2===a.lineSide&&this._line2.adjust(a):(this._line1.adjust(a),this._line2.adjust(a))};k.Create=function(b,f,h,k,l,s){if(void 0===s||null===s)s=m.thin;switch(s){case m.thin:return new g(b,f,h,k,l,1);case m.medium:return new g(b,f,h,k,l,2);case m.thick:return new g(b,f,h,k,l,3);case m.dashed:return new a(b,f,h,k,l,1,[3,1]);case m.dashDot:return new a(b,f,h,k,l,
1,[8,2,2,2]);case m.dotted:return new a(b,f,h,k,l,1,[2,2]);case m.dashDotDot:return new a(b,f,h,k,l,1,[9,3,3,3,3,3]);case m.slantedDashDot:return new d(b,f,h,k,l,b!==h,[11,1,5,1],[10,2,4,2]);case m.mediumDashDot:return new a(b,f,h,k,l,2,[9,3,3,3]);case m.mediumDashDotDot:return new a(b,f,h,k,l,2,[9,3,3,3,3,3]);case m.mediumDashed:return new a(b,f,h,k,l,2,[9,3]);case m.hair:return new a(b,f,h,k,l,1,[1]);case m["double"]:return new e(b,f,h,k,l,b!==h)}return null};var b=function(a,b){if(!a)return b?
-1:0;if(!b)return 1;var h=l.UI.LineBorder.prototype._weight(a),e=l.UI.LineBorder.prototype._weight(b);return h===e?0:h-e},f=function(a){if(a){if(a.isGridLine)return 1;if(a.style)return l.UI.LineBorder.prototype.width(a.style)}return 0},s=function(){var a=function(a,h){return a?h?0<b(a.style,h.style)?a:h:a:h?h:null},e=function(a,b){a&&a.line&&a.line.adjust(b)},h=function(a,h){return null===a||void 0===a?null===h||void 0===h?0:-1:null===h||void 0===h?1:a.isGridLine?h.isGridLine?0:-1:h.isGridLine?1:
b(a.style,h.style)},d=function(a){return a&&a.style&&a.style.style===m["double"]},g=function(a,b,h,e){return d(a)?!0:(a=0+(d(b)?1:0),a+=d(h)?1:0,a+=d(e)?1:0,2>a)},k=function(a,b,d,f,g,k){b={orientation:k?1:0,offsetStart:0,offsetEnd:0};d=h(a,d);f=h(a,f);0<=d&&0<=f?0===d&&0===f?-1!==g&&1===g&&(b.offsetEnd-=g):-1===g?b.offsetStart-=g:g===g.next&&(b.offsetEnd-=2*g):0<=f?(b.lineSide=2,b.offsetStart+=g):0<=d&&(b.lineSide=1,b.offsetStart+=g);e(a,b)},l=function(a,b,g,k,l,s,q,m,t){var r={orientation:m?1:0,
lineSide:t?2:1,offsetStart:0,offsetEnd:0};m={orientation:m?1:0,lineSide:t?1:2,offsetStart:0,offsetEnd:0};t=1===s?k:l;var u=1===q?g:b;if(d(u)){var M=h(a,t);0===M?(M=h(a,u),0===M?1===q&&(m.offsetEnd-=q):0<M&&(-1===q?m.offsetStart-=2*q:1===q&&(m.offsetEnd-=2*q))):0<M?(M=h(a,u),0===M?1===q&&(m.offsetEnd-=q):0<M&&(-1===q?m.offsetStart-=2*q:1===q&&(m.offsetEnd-=2*q))):(M=h(a,u),0===M?-1===q?r.offsetStart+=2*q:1===q&&(r.offsetEnd+=2*q):0<M&&(-1===q?r.offsetStart-=3*q:1===q&&(r.offsetEnd-=3*q)))}else 0<=
h(a,t)?-1===q?m.offsetStart-=2*q:1===q&&(m.offsetEnd-=2*q):-1===q?r.offsetStart+=2*q:1===q&&(r.offsetEnd+=2*q);k=1===(1===s?2:1)?k:l;l=!1;s=0;!l&&d(k)&&0<h(k,a)&&(l=!0,M=f(k),0<h(k,t)?0<M&&(s=1===q&&d(g)?2<=M?2:1:-1===q&&d(b)?3<=M?2:1:3===M?3:2):s=3===M?3:2);l||d(u)||!(u&&!u.isGridLine||k&&!k.isGridLine)||(l=!0,s=-1===q?2:1);l&&(-1===q?(r.offsetStart+=q*s,m.offsetStart+=q*s):1===q&&(r.offsetEnd+=q*s,m.offsetEnd+=q*s));(r.offsetStart||r.offsetEnd)&&e(a,r);(m.offsetStart||m.offsetEnd)&&e(a,m)},s=function(a,
b,f,g,k,l){0<=h(a,f)&&0<=h(a,g)&&(f={orientation:l?1:0,offsetStart:0,offsetEnd:0},-1===k?(f.offsetStart-=2*k,d(a)&&0<h(b,a)&&(f.offsetStart-=1)):1===k&&(f.offsetEnd-=2*k,d(a)&&0<h(b,a)&&(f.offsetEnd+=1)),e(a,f))},q=function(b,h,g,k,l,s){d(b)&&(h=a(g,k))&&!h.isGridLine&&(h=f(h),0<h&&(s={orientation:s?1:0,offsetStart:0,offsetEnd:0},-1===l?s.offsetStart+=h*l:s.offsetEnd+=h*l,(s.offsetStart||s.offsetEnd)&&e(b,s)))};return{calcLayoutHorizontal:function(b,k,l,s,q,m,t){var r;if(k||l||s){var p=a(l,s);g(b,
k,l,s)?0<(r=h(p,b))?(r=f(p),d(b)&&(d(l)||d(s)||d(k))||3===r&&e(b,{orientation:0,offsetStart:1})):p&&0>r?0<(r=h(b,k))?(r=f(p),3===r||2===r?e(b,{orientation:0,offsetStart:-2}):1===r&&e(b,{orientation:0,offsetStart:-1})):0!==r&&0<h(k,p)&&(r=f(p),3===r&&e(b,{orientation:0,offsetStart:1})):0===r&&(!k||0<h(b,k))&&(r=f(p),3===r||2===r?e(b,{orientation:0,offsetStart:-2}):1===r&&e(b,{orientation:0,offsetStart:-1})):e(b,{orientation:0,offsetStart:1})}if(q||m||t)(k=a(m,t),g(b,q,m,t))?0<(r=h(k,b))?(r=f(k),d(b)&&
(d(m)||d(t)||d(q))||(3===r?e(b,{orientation:0,offsetEnd:-2}):2!==r&&1!==r||e(b,{orientation:0,offsetEnd:-1}))):0>r?0<(r=h(b,q))?(r=f(k),3===r&&e(b,{orientation:0,offsetEnd:1})):0!==r&&e(b,{orientation:0,offsetEnd:-1}):0===r&&(0<(r=h(b,q))?(r=f(k),3===r&&e(b,{orientation:0,offsetEnd:1})):0!==r&&e(b,{orientation:0,offsetEnd:-1})):e(b,{orientation:0,offsetEnd:-2})},calcLayoutVertical:function(b,k,l,s,q,m,t){var r;if(k||l||s){var p=a(l,s);g(b,k,l,s)?0<(r=h(p,b))?(r=f(p),d(b)&&(d(l)||d(s)||d(k))||3===
r&&e(b,{orientation:1,offsetStart:1})):0>r?0<(r=h(b,k))?(r=f(p),3===r||2===r?e(b,{orientation:1,offsetStart:-2}):1===r&&e(b,{orientation:1,offsetStart:-1})):0!==r&&0<h(k,p)&&(r=f(p),3===r&&e(b,{orientation:1,offsetStart:1})):0===r&&0<h(b,k)&&(r=f(p),3===r||2===r?e(b,{orientation:1,offsetStart:-2}):1===r&&e(b,{orientation:1,offsetStart:-1})):e(b,{orientation:1,offsetStart:1})}if(q||m||t)(k=a(m,t),g(b,q,m,t))?0>(r=h(b,k))?(r=f(k),d(b)&&(d(m)||d(t)||d(q))||(3===r||2===r?e(b,{orientation:1,offsetEnd:-2}):
1===r&&e(b,{orientation:1,offsetEnd:-1}))):null!==k&&0<r?0<(r=h(b,q))?(r=f(k),3===r&&e(b,{orientation:1,offsetEnd:1})):0!==r&&e(b,{orientation:1,offsetEnd:-1}):0===r&&(0<(r=h(b,q))?(r=f(k),3===r&&e(b,{orientation:1,offsetEnd:1})):0!==r&&e(b,{orientation:1,offsetEnd:-1})):e(b,{orientation:1,offsetEnd:-2})},calcDoubleLayout:function(a,b,h,e,f,g,n,m){m?this.calcLayoutVertical(a,b,h,e,f,g,n):this.calcLayoutHorizontal(a,b,h,e,f,g,n);var t=d(h),r=d(e),u=d(b);t&&r&&u?k(a,b,h,e,-1,m):t&&!r?l(a,b,f,h,e,1,
-1,m,!0):!t&&r?l(a,b,f,h,e,2,-1,m,!1):t&&r&&!u?s(a,b,h,e,-1,m):u&&q(a,b,h,e,-1,m);t=d(g);r=d(n);h=d(f);t&&r&&h?k(a,f,g,n,1,m):t&&!r?l(a,b,f,g,n,1,1,m,!0):!t&&r?l(a,b,f,g,n,2,1,m,!1):t&&r&&!h?s(a,f,g,n,1,m):h&&q(a,f,g,n,1,m)}}}(),q={layoutHorizontal:function(a,b,h,e,d,f,g){s.calcLayoutHorizontal(a,b,h,e,d,f,g)},layoutVertical:function(a,b,h,e,d,f,g){s.calcLayoutVertical(a,b,h,e,d,f,g)}},t={layoutHorizontal:function(a,b,h,e,d,f,g){s.calcDoubleLayout(a,b,h,e,d,f,g,!1)},layoutVertical:function(a,b,h,
e,d,f,g){s.calcDoubleLayout(a,b,h,e,d,f,g,!0)}},r={layoutHorizontal:function(a,b,h,e,d,f,g){},layoutVertical:function(a,b,h,e,d,f,g){}};l.UI._GcBorders=function(a,b,h,e){this._sheet=a;this._sheetArea=e;this._rowViewportIndex=b;this._colViewportIndex=h};l.UI._GcBorders.prototype={_isInitialized:!1,_isMerged:!1,_initialize:function(){this._spanCells=[];this._rowIndecies=[];this._colIndecies=[];this._overflowedCells=[];this._adjustingRanges=[];this._hGridLine=[];this._vGridLine=[];this._hBorders=[];
this._vBorders=[];var a=0,b=0,h=0,e=0;this._sheetArea===l.UI.SheetArea.viewport?(a=this._sheet.getViewportLeftColumn(this._colViewportIndex),b=this._sheet.getViewportRightColumn(this._colViewportIndex),h=this._sheet.getViewportTopRow(this._rowViewportIndex),e=this._sheet.getViewportBottomRow(this._rowViewportIndex)):this._sheetArea===l.UI.SheetArea.colHeader?(a=this._sheet.getViewportLeftColumn(this._colViewportIndex),b=this._sheet.getViewportRightColumn(this._colViewportIndex),e=this._sheet.getRowCount(this._sheetArea)):
this._sheetArea===l.UI.SheetArea.rowHeader&&(b=this._sheet.getColumnCount(this._sheetArea),h=this._sheet.getViewportTopRow(this._rowViewportIndex),e=this._sheet.getViewportBottomRow(this._rowViewportIndex));for(;h<=e;h++)this._sheet.getRowVisible(h,this._sheetArea)&&this._rowIndecies.push(h);for(;a<=b;a++)this._sheet.getColumnVisible(a,this._sheetArea)&&this._colIndecies.push(a);this._isInitialized=!0},addCellLines:function(a,b,h,e,d,f,g,k,l){this._isInitialized||this._initialize();l&&(l={row:a,startCol:l.startCol,
endCol:l.endCol},this._overflowedCells.contains(l)||this._overflowedCells.push(l));if(k)this._spanCells.push(k);else{var s,q,m,t,r;g&&(s=g.borderLeft,q=g.borderTop,m=g.borderRight,t=g.borderBottom,r=g.backColor,void 0!==r&&null!==r||void 0===g._backColor&&null===g._backColor||(r=g._backColor));!r||s||m||q||t||this._adjustingRanges.push({r:a,c:b,rc:1,cc:1});this._addCellLineImp(a,b,h,e,d,f,s,q,m,t,r)}},_addCellLineImp:function(a,b,h,e,d,f,g,k,l,s,q,m,t){var r=this._addCellLineSide(a,b,h,e-0.5,h+d,
e-0.5,k,this._hBorders),p=this._addCellLineSide(a,b,h-0.5,e,h-0.5,e+f,g,this._vBorders),K=this._addCellLineSide(a+1,b,h,e+f-0.5,h+d,e+f-0.5,s,this._hBorders),A=this._addCellLineSide(a,b+1,h+d-0.5,e,h+d-0.5,e+f,l,this._vBorders);q&&0!==this._sheet.getRowHeight(a)&&0!==this._sheet.getColumnWidth(b)||(m=!K&&!m,t=!A&&!t,(m||t)&&this._addGridLine(a,b,h,e,d,f,m,t));(r||void 0!==q)&&this._removeLineItem(a-1,b,this._hGridLine);(p||void 0!==q)&&this._removeLineItem(a,b-1,this._vGridLine);!q||g||l||k||s||(this._adjustLineItem(a-
1,b-1,this._vGridLine,!1),this._adjustLineItem(a-1,b-1,this._hGridLine,!0))},_addCellLineSide:function(a,e,h,d,f,g,l,s){if(l){var q=this._queryLineItem(a,e,s,!0);q.success?(a=q.lineItem,a.style.style!==m["double"]&&(l.style===m["double"]||0<b(l,a.style))&&(a.line=k.Create(h,d,f,g,l.color,l.style),a.style=l)):(a=this._queryLineItem(a,e,s).lineItem,a.line=k.Create(h,d,f,g,l.color,l.style),a.style=l);return null!==a.line}return!1},_addGridLine:function(a,b,h,e,d,f,g,s){var q=this._sheetArea===l.UI.SheetArea.viewport,
m=this._sheet.gridline;if(!q||m){var t=q?m.color:"#9EB6CE";!g||!m.showHorizontalGridline&&q||(g=this._queryLineItem(a,b,this._hGridLine).lineItem,g.isGridLine=!0,g.line=k.Create(h,e+f-0.5,h+d,e+f-0.5,t));!s||!m.showVerticalGridline&&q||(a=this._queryLineItem(a,b,this._vGridLine).lineItem,a.isGridLine=!0,a.line=k.Create(h+d-0.5,e,h+d-0.5,e+f,t))}},_adjustLineItem:function(a,b,h,e){a=this._queryLineItem(a,b,h,!0);a.success&&(a=a.lineItem)&&a.line&&a.line.adjust({orientation:e?0:1,offsetEnd:-1})},_removeLineItem:function(a,
b,h){0<=a&&0<=b&&(a=h[a])&&a[b]&&(a[b]=null)},_queryLineItem:function(a,b,h,e){if(-1===a||-1===b)return{success:!1};var d=h[a];if(!d){if(e)return{success:!1};h[a]=d=[]}a=d[b];if(!a){if(e)return{success:!1};d[b]=a={}}return{success:!0,lineItem:a}},_processOverflowCells:function(){for(var a=0;a<this._overflowedCells.length;a++)for(var b=this._overflowedCells[a],h=b.row,e=b.endCol,d=b.startCol;d<e;d++)b=this._queryLineItem(h,d+1,this._vBorders,!0),b.success?this._removeLineItem(h,d+1,this._vBorders):
(b=this._queryLineItem(h,d,this._vGridLine,!0),b.success&&this._removeLineItem(h,d,this._vGridLine))},_processSpans:function(){if(0<this._spanCells.length)for(var a=0;a<this._spanCells.length;a++)this._processSpanCell(this._spanCells[a])},_processSpanCell:function(a){var b=a.row,h=a.col,e=a.x,d=a.y,f,g,k,l,s=this._sheet.getActualStyle(b,h,this._sheetArea),s=s?s.backColor:null,q,m,t,r,p,K,A,L,D=e,w=d;if(1===a.rowCount)for(q=b,t=this._sheet._getZoomRowHeight(q,this._sheetArea),d=0;d<a.colCount;d++)p=
0===d,A=d===a.colCount-1,m=h+d,r=this._sheet._getZoomColumnWidth(m,this._sheetArea),(l=this._sheet.getActualStyle(q,m,this._sheetArea))?(f=l.borderLeft,g=l.borderTop,k=l.borderRight,l=l.borderBottom):f=g=k=l=null,p?this._addCellLineImp(q,m,D,w,r,t,f,g,null,l,s,!1,!0):A?this._addCellLineImp(q,m,D,w,r,t,null,g,k,l,s):this._addCellLineImp(q,m,D,w,r,t,null,g,null,l,s,!1,!0),D+=r;else if(1===a.colCount)for(m=h,r=this._sheet._getZoomColumnWidth(m,this._sheetArea),d=0;d<a.rowCount;d++)K=0===d,L=d===a.rowCount-
1,q=b+d,t=this._sheet._getZoomRowHeight(q,this._sheetArea),(l=this._sheet.getActualStyle(q,m,this._sheetArea))?(f=l.borderLeft,g=l.borderTop,k=l.borderRight,l=l.borderBottom):f=g=k=l=null,K?this._addCellLineImp(q,m,D,w,r,t,f,g,k,null,s,!0,!1):L?this._addCellLineImp(q,m,D,w,r,t,f,null,k,l,s):this._addCellLineImp(q,m,D,w,r,t,f,null,k,null,s,!0,!1),w+=t;else for(d=0;d<a.rowCount;d++){q=b+d;K=0===d;L=d===a.rowCount-1;t=this._sheet._getZoomRowHeight(q,this._sheetArea);for(var M=0;M<a.colCount;M++)m=h+
M,p=0===M,A=M===a.colCount-1,r=this._sheet._getZoomColumnWidth(m,this._sheetArea),(l=this._sheet.getActualStyle(q,m,this._sheetArea))?(f=l.borderLeft,g=l.borderTop,k=l.borderRight,l=l.borderBottom):f=g=k=l=null,K?p?this._addCellLineImp(q,m,D,w,r,t,f,g,null,null,s,!0,!0):A?this._addCellLineImp(q,m,D,w,r,t,null,g,k,null,s,!0,!1):this._addCellLineImp(q,m,D,w,r,t,null,g,null,null,s,!0,!0):L?p?this._addCellLineImp(q,m,D,w,r,t,f,null,null,l,s,!1,!0):A?this._addCellLineImp(q,m,D,w,r,t,null,null,k,l,s):this._addCellLineImp(q,
m,D,w,r,t,null,null,null,l,s,!1,!0):p?this._addCellLineImp(q,m,D,w,r,t,f,null,null,null,s,!0,!0):A&&this._addCellLineImp(q,m,D,w,r,t,null,null,k,null,s,!0,!1),D+=r;D=e;w+=t}!s||f||k||g||l||this._adjustingRanges.push({r:b,c:h,rc:a.rowCount,cc:a.colCount})},_adjust:function(){(0<this._vBorders.length||0<this._hBorders.length)&&this._adjustBorders();0<this._adjustingRanges.length&&this._adjustGridlines()},_adjustGridlines:function(){for(var a=0;a<this._adjustingRanges.length;a++){var b=this._adjustingRanges[a],
h=b.r,e=b.c,d=h,f=h-1,g=e-1,k=e;1<b.rc&&(d+=b.rc-1);1<b.cc&&(k+=b.cc-1);for(var l=b=!1,s=0;s<this._adjustingRanges.length;s++){var q=this._adjustingRanges[s];q.c===k+1&&q.r===h&&(l=!0);q.r===d+1&&q.c===e&&(b=!0);if(b&&l)break;if(q.r>h+1&&q.c>e+1)break}b||this._adjustLineItem(d,g,this._hGridLine,!0);l||this._adjustLineItem(f,k,this._vGridLine,!1)}},_adjustBorders:function(){var a,b,h,e;for(a=0;a<=this._rowIndecies.length;a++)for(h=this._rowIndecies[a],void 0===h&&a===this._rowIndecies.length&&(h=this._rowIndecies[a-
1]+1),b=0;b<=this._colIndecies.length;b++)e=this._colIndecies[b],void 0===e&&b===this._colIndecies.length&&(e=this._colIndecies[b-1]+1),this._adjustHorizontalBorderLine(a,b,h,e);for(b=0;b<=this._colIndecies.length;b++)for(e=this._colIndecies[b],void 0===e&&b===this._colIndecies.length&&(e=this._colIndecies[b-1]+1),a=0;a<=this._rowIndecies.length;a++)h=this._rowIndecies[a],void 0===h&&a===this._rowIndecies.length&&(h=this._rowIndecies[a-1]+1),this._adjustVerticalBorderLine(a,b,h,e)},_adjustHorizontalBorderLine:function(a,
b,h,e){var d,f,g,k;d=this._queryLineItem(h,e,this._hBorders,!0);var l=0;if(d.success)l++;else if(d=this._queryLineItem(h-1,e,this._hGridLine,!0),!d.success)return;d=d.lineItem;f=this._getLineItemImp(h,this._prevCol(b),!1);this._isBorderLineInLayout(f)&&l++;g=this._getLineItemImp(this._prevRow(a),e,!0);this._isBorderLineInLayout(g)&&l++;e=this._getLineItemImp(h,e,!0);this._isBorderLineInLayout(e)&&l++;k=this._getLineItemImp(h,this._nextCol(b),!1);this._isBorderLineInLayout(k)&&l++;a=this._getLineItemImp(this._prevRow(a),
this._nextCol(b),!0);this._isBorderLineInLayout(a)&&l++;b=this._getLineItemImp(h,this._nextCol(b),!0);this._isBorderLineInLayout(b)&&l++;0<l&&(d.style&&d.style.style===m["double"]?t.layoutHorizontal(d,f,g,e,k,a,b):d.style&&d.style.style===m.slantedDashDot?r.layoutHorizontal(d,f,g,e,k,a,b):q.layoutHorizontal(d,f,g,e,k,a,b))},_adjustVerticalBorderLine:function(a,b,h,e){var d,f,g,k;d=this._queryLineItem(h,e,this._vBorders,!0);var l=0;if(d.success)l++;else if(d=this._queryLineItem(h,e-1,this._vGridLine,
!0),!d.success)return;d=d.lineItem;f=this._getLineItemImp(this._prevRow(a),e,!0);this._isBorderLineInLayout(f)&&l++;g=this._getLineItemImp(h,this._prevCol(b),!1);this._isBorderLineInLayout(g)&&l++;h=this._getLineItemImp(h,e,!1);this._isBorderLineInLayout(h)&&l++;k=this._getLineItemImp(this._nextRow(a),e,!0);this._isBorderLineInLayout(k)&&l++;b=this._getLineItemImp(this._nextRow(a),this._prevCol(b),!1);this._isBorderLineInLayout(b)&&l++;a=this._getLineItemImp(this._nextRow(a),e,!1);this._isBorderLineInLayout(a)&&
l++;0<l&&(d.style&&d.style.style===m["double"]?t.layoutVertical(d,f,g,h,k,b,a):d.style&&d.style.style===m.slantedDashDot?r.layoutVertical(d,f,g,h,k,b,a):q.layoutVertical(d,f,g,h,k,b,a))},_isBorderLineInLayout:function(a){return a&&!a.isGridLine&&a.line},_prevCol:function(a){return 0>a?-1:this._colIndecies[a-1]},_nextCol:function(a){var b=this._colIndecies[a+1];return void 0===b&&a+1>=this._colIndecies.length?this._colIndecies[this._colIndecies.length-1]+1:b},_prevRow:function(a){return 0>a?-1:this._rowIndecies[a-
1]},_nextRow:function(a){var b=this._rowIndecies[a+1];return void 0===b&&a+1>=this._rowIndecies.length?this._rowIndecies[this._rowIndecies.length-1]+1:b},_getLineItemImp:function(a,b,h){if(void 0===a||0>a||void 0===b||0>b)return null;var e=h?this._vBorders:this._hBorders,e=this._queryLineItem(a,b,e,!0);if(e.success)return e.lineItem;e=h?this._vGridLine:this._hGridLine;if(h){if(b--,0>b)return null}else if(a--,0>a)return null;e=this._queryLineItem(a,b,e,!0);return e.success?e.lineItem:null},paint:function(a,
b){this._isInitialized&&(this._isMerged||(this._processSpans(),this._processOverflowCells(),this._adjust(),this._isMerged=!0),a.save(),a.beginPath(),this._paint(a,b),a.closePath(),a.stroke(),a.restore())},_paint:function(a,b){this._paintGridLine(a);this._paintBorderLines(a)},_paintGridLine:function(a){this._paintLines(a,this._hGridLine);this._paintLines(a,this._vGridLine)},_paintBorderLines:function(a){this._paintLines(a,this._hBorders);this._paintLines(a,this._vBorders)},_paintLines:function(a,b){if(b&&
0<b.length)for(var h in b)if(h){var e=b[h];if(e&&0<e.length)for(var d in e)if(d){var f=e[d];f&&f.line&&f.line.paint(a)}}}}})(window);
(function(p,l){var m=p.GrapeCity;"undefined"===typeof m&&(m=p.GrapeCity={});"undefined"===typeof m.UI&&(m.UI={});var k=m.UI,g=p.document;m.UI._SheetEventHandler=function(a){this._init(a)};m.UI._SheetEventHandler.prototype={_init:function(a){this._sheet=a;this._elem=null;this._eventSuspended=0},_getElem:function(){this._elem||(this._elem=g.createElement("input"));return this._elem},_dispose:function(){this._hScrollTimer&&this._hScrollTimer._dispose();this._vScrollTimer&&this._vScrollTimer._dispose()},
_getHScrollTimer:function(){this._hScrollTimer||(this._hScrollTimer=new m.UI.Timer(this._sheet));return this._hScrollTimer},_getVScrollTimer:function(){this._vScrollTimer||(this._vScrollTimer=new m.UI.Timer(this._sheet));return this._vScrollTimer},doResize:function(){var a=this._sheet,d=a._getCanvas();d&&d.parentNode&&0!==d.parentNode.clientWidth&&0!==d.parentNode.clientHeight&&(d.style.display="none",d.width=Math.max(d.parentNode.clientWidth-0,0),d.height=Math.max(d.parentNode.clientHeight-0,0),
d.style.display="",a._bounds.width=d.clientWidth||d.width,a._bounds.height=d.clientHeight||d.height,a.invalidateLayout(),a.repaint())},_getCanvasOffset:function(){var a=l(this._sheet._getCanvas()).offset();a?(isNaN(g.body.clientTop)||(a.top+=g.body.clientTop),isNaN(g.body.clientLeft)||(a.left+=g.body.clientLeft)):a={top:0,left:0};return a},doMouseDown:function(a){if(2!==a.button){var d=this._sheet;d.inCanvas||this.handleDocumentMouseMove();var e=this._getCanvasOffset();a=this.doMouseDownImp(a,a.pageX-
e.left,a.pageY-e.top);d.isEditing()||a||this._setFocus();d._isMouseDownInSheet=!0;return!1}},handleDocumentMouseMove:function(){var a=this;this._isMouseCapture||(l(g).bind("mousemove.gcSheet",function(d){a.doMouseMove(d)}),l(g).bind("mouseup.gcSheet",function(d){a.doMouseUp(d)}),this._isMouseCapture=!0)},unhandleDocumentMouseMove:function(){this._isMouseCapture&&(this._isMouseCapture=!1,l(g).unbind("mousemove.gcSheet"),l(g).unbind("mouseup.gcSheet"))},doMouseDownImp:function(a,d,e){var b=this._sheet,
f=b.hitTest(d,e),g=f.groupHitInfo;if(g)b.isEditing()||this._doClickRangeGroup(g);else if(b._currentTarget=f,this.isMouseDown=!0,f.resizeInfo)b.endEdit(),this.isWorking=!0;else if(f.dragInfo&&f.dragInfo.side&&"corner"!==f.dragInfo.side)b.endEdit()&&this.startDragDropping(a,d,e,f);else if(f.dragInfo&&"corner"===f.dragInfo.side)b.endEdit()&&this.startDragFill(a,d,e,f);else if(f.filterButtonHitInfo)b.endEdit()&&this._openFilterDialog(f.filterButtonHitInfo);else{var g=b.getActiveRowIndex(),l=b.getActiveColumnIndex();
if(f.cellTypeHitInfo){var t=f.row,r=f.col;if(t!==g||r!==l){var u=b.isPaintSuspended();b.isPaintSuspended(!0);try{if(!b.endEdit())return;var n={sheet:b,sheetName:b._name,row:g,col:l,cancel:!1};b._trigger(m.UI.Events.LeaveCell,n);if(n&&!0===n.cancel)return;var h=b._selectionModel.toArray(),n=null,I=b._spanModel.find(t,r),n=I?[new k.Range(I.row,I.col,I.rowCount,I.colCount)]:[new k.Range(t,r,1,1)];b._trigger(m.UI.Events.SelectionChanging,{sheet:b,sheetName:b._name,oldSelections:h,newSelections:n});b.setActiveCell(t,
r);b._trigger(m.UI.Events.EnterCell,{sheet:b,sheetName:b._name,row:t,col:r});this._lastSelections=n;b._trigger(m.UI.Events.SelectionChanged,{sheet:b,sheetName:b._name});this._updateValidationUI(t,r)}finally{b.isPaintSuspended(u)}}h=b.getCellType(t,r,f.hitTestType);f.cellTypeHitInfo.sheet=b;h.processMouseDown(f.cellTypeHitInfo)}if(f.cellTypeHitInfo&&f.cellTypeHitInfo.isReservedLocation)return!0;this.setMetaKeyState(a);try{if(this._hitTestResult=f,b.isEditing()&&g===b.getActiveRowIndex()&&l===b.getActiveColumnIndex()&&
!b.endEdit())return}finally{this._hitTestResult=null}void 0!==f.row&&null!==f.row&&void 0!==f.col&&null!==f.col&&(f.hitTestType===m.UI.SheetArea.viewport&&this._updateValidationUI(f.row,f.col),g=b._selectionModel.toArray(),this.startSelecting(a,d,e,f),a=b._selectionModel.toArray(),this._notEqualSelecions(g,a)&&b._trigger(m.UI.Events.SelectionChanging,{sheet:b,sheetName:b._name,oldSelections:g,newSelections:a}))}},_openFilterDialog:function(a){a&&(this._sheet._filterDialiog=new m.UI._GcFilterDialog(this._sheet,
a),this._sheet._filterDialiog.open())},_doClickRangeGroup:function(a){var d=this._sheet;if(d&&a){var e,b,f;"rgh"===a.what?d&&!d.isEditing()&&(a=a.info.index,e={sheet:d,sheetName:d._name,isRowGroup:!0,index:-1,level:a,cancel:!1},d._trigger(m.UI.Events.RangeGroupStateChanging,e),e&&!1===e.cancel&&(b=new m.UI.UndoRedo.RowGroupHeaderExpandUndoAction(d,{level:a}),d._doCommand(b),d._trigger(m.UI.Events.RangeGroupStateChanged,{sheet:d,sheetName:d._name,isRowGroup:!0,index:-1,level:a}))):"cgh"===a.what?d.isEditing()||
(a=a.info.index,e={sheet:d,sheetName:d._name,isRowGroup:!1,index:-1,level:a,cancel:!1},d._trigger(m.UI.Events.RangeGroupStateChanging,e),e&&!1===e.cancel&&(b=new m.UI.UndoRedo.ColumnGroupHeaderExpandUndoAction(d,{level:a}),d._doCommand(b),d._trigger(m.UI.Events.RangeGroupStateChanged,{sheet:d,sheetName:d._name,isRowGroup:!1,index:-1,level:a}))):"rg"===a.what?d.rowRangeGroup&&(b=a.info.index,f=a.info.isExpanded,a.info.lineDirection===m.UI.RangeGroupDirection.Forward?b--:b++,e={sheet:d,sheetName:d._name,
isRowGroup:!0,index:b,level:a.info.level,cancel:!1},d._trigger(m.UI.Events.RangeGroupStateChanging,e),e&&!1===e.cancel&&(e=new m.UI.UndoRedo.RowGroupExpandUndoAction(d,{index:a.info.index,level:a.info.level,collapsed:f}),d._doCommand(e),d._trigger(m.UI.Events.RangeGroupStateChanged,{sheet:d,sheetName:d._name,isRowGroup:!0,index:b,level:a.info.level}))):"cg"===a.what&&d.colRangeGroup&&(b=a.info.index,f=a.info.isExpanded,a.info.lineDirection===m.UI.RangeGroupDirection.Forward?b--:b++,e={sheet:d,sheetName:d._name,
isRowGroup:!1,index:b,level:a.info.level,cancel:!1},d._trigger(m.UI.Events.RangeGroupStateChanging,e),e&&!1===e.cancel&&(e=new m.UI.UndoRedo.ColumnGroupExpandUndoAction(d,{index:a.info.index,level:a.info.level,collapsed:f}),d._doCommand(e),d._trigger(m.UI.Events.RangeGroupStateChanged,{sheet:d,sheetName:d._name,isRowGroup:!1,index:b,level:a.info.level})))}},_updateValidationUI:function(a,d){var e=this._sheet;if(e&&e.parent){e._disposeValidationUI();var b=e.parent.getActiveSheet();if(b&&e.getName()===
b.getName()){var f=e.getDataValidator(a,d),b=this._getCanvasOffset(),s=e.getCellRect(a,d),q=e._getSheetLayout();if(!(null===s.x||void 0===s.x||null===s.y||void 0===s.y||null===s.width||void 0===s.width||null===s.height||void 0===s.height||s.x+s.width>q.viewportX+q.viewportWidth||s.y+s.height>q.viewportY+q.viewportHeight)&&(f&&f.showInputMessage&&f.inputMessage&&(q=g.createElement("span"),l(q).css("position","absolute").css("border","1px #C0C0C0 solid").css("padding","3px 8px 3px 8px").css("background-color",
"#FFFFFF").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("font","normal normal normal 12px/normal Arial").width("auto").height("auto").css("top",s.y+s.height+b.top+5).css("left",s.x+s.width/2+b.left).html("<b>"+f.inputTitle+"</b><br/>"+f.inputMessage).attr("gcUIElement","gcValidationInputMessage").appendTo(g.body),e._validationInputMessage=q),f&&f.type===k.CriteriaType.List&&f.inCellDropdown)){for(var m=f.condition.getValidList(e,a,d),f=m.length,r=g.createElement("select"),q="",u=0;u<f;u++){var n=
m[u];null===n||void 0===n?n="":n instanceof Date&&(n=(new k._DateTimeHelper(n)).localeFormat("M/d/yyyy h:mm:ss"));q+='<option value="'+n+'">'+n+"</option>"}m=(m=e.getActualStyle(a,d))&&m.font?m.font:e._render._getDefaultFont();1<e._zoomFactor&&(m=e._render._getZoomFont(m));l(r).html(q).css("outline","none").css("position","absolute").css("font",m).width(s.width).height(8<f?140:"auto").css("top",s.y+s.height+b.top).css("left",s.x+b.left).attr("gcUIElement","gcValidationSelect").appendTo(g.body).attr("size",
2<f?f:2).hide().val(e.getValue(a,d)).bind("click",function(){var b=l(r).val();b&&(b=new k.UndoRedo.CellEditUndoAction(e,{row:a,col:d,newValue:b,autoFormat:!0}),e._doCommand(b));l(r).hide()}).bind("keydown",function(b){if(b.keyCode!==k.Key.enter||b.ctrlKey||b.shiftKey||b.altKey)b.keyCode!==k.Key.esc||b.ctrlKey||b.shiftKey||b.altKey||l(r).hide();else{if(b=l(r).val())b=new k.UndoRedo.CellEditUndoAction(e,{row:a,col:d,newValue:b,autoFormat:!0}),e._doCommand(b);l(r).hide()}});e._validationSelect=r;f=e.getSpans(new k.Range(a,
d,1,1));q=1;f&&0<f.length&&f[0]&&(q=f[0].colCount);f=d+q-1===e.getColumnCount()-1;q=g.createElement("input");q.type="image";q.src=k._GcFilterDialog.getImageSrc(k._FilterButtonState.noSortFilter);q.alt="v";m=e.getRowHeight(a)*e._zoomFactor;15<m&&(m=15);l(q).css("position","absolute").width(m).height(m).css("top",s.y+s.height+b.top-(m+3)).css("left",s.x+s.width+b.left-(f?m:0)).css("background-color","white").css("border","1px solid gray").attr("gcUIElement","gcValidationButton").appendTo(g.body).click(function(){e.isEditing()&&
e.endEdit();l(e._validationSelect).toggle().focus()});e._validationButton=q}}}},startSelecting:function(a,d,e,b){e=e=d=d=0;a=this._sheet;this._getHScrollTimer().start();this._getVScrollTimer().start();this.ctrl||this.shift||a._clearSelectionImp();this.beginHitTest=b;if(b.hitTestType===m.UI.SheetArea.corner){if(!this.shift){e=a.frozenRowCount?a._getFirstVisualRow():a._scrollTopRow;b=a.frozenColCount?a._getFirstVisualColumn():a._scrollLeftCol;d={sheet:a,sheetName:a._name,row:a._activeRowIndex,col:a._activeColIndex,
cancel:!1};a._trigger(m.UI.Events.LeaveCell,d);if(d&&!0===d.cancel)return;a._setActiveCellImp(e,b,1,1);a._trigger(m.UI.Events.EnterCell,{sheet:a,sheetName:a._name,row:e,col:b});this._updateValidationUI(e,b)}this.ctrl||a._clearSelectionImp();a._setSelectedRange(-1,-1,a.getRowCount(),a.getColumnCount(),!0);this.isWorking=!0}else if(b.hitTestType===m.UI.SheetArea.colHeader||b.hitTestType===m.UI.SheetArea.colFooter){if(!this.shift){e=a.frozenRowCount?a._getFirstVisualRow():a._scrollTopRow;e=a._getAvailableActiveCell(e,
b.col,!1);d={sheet:a,sheetName:a._name,row:a._activeRowIndex,col:a._activeColIndex,cancel:!1};a._trigger(m.UI.Events.LeaveCell,d);if(d&&!0===d.cancel)return;a._setActiveCellImp(e.row,e.col,1,b.colViewportIndex);a._trigger(m.UI.Events.EnterCell,{sheet:a,sheetName:a._name,row:e.row,col:e.col});this._updateValidationUI(e.row,e.col)}this.shift?(d=Math.min(a._activeColIndex,b.col),e=Math.abs(a._activeColIndex-b.col)+1,a._replaceActiveSelectedRange(-1,d,a.getRowCount(),e,!0)):a._setSelectedRange(-1,a._activeColIndex,
a.getRowCount(),1,!0);this.isWorking=!0}else if(b.hitTestType===m.UI.SheetArea.rowHeader){if(!this.shift){d=a.frozenColCount?a._getFirstVisualColumn():a._scrollLeftCol;e=a._getAvailableActiveCell(b.row,d,!0);d={sheet:a,sheetName:a._name,row:a._activeRowIndex,col:a._activeColIndex,cancel:!1};a._trigger(m.UI.Events.LeaveCell,d);if(d&&!0===d.cancel)return;d=a._activeRowIndex!==e.row;a._setActiveCellImp(e.row,e.col,b.rowViewportIndex,1);d&&a.doDataItemChanged();a._trigger(m.UI.Events.EnterCell,{sheet:a,
sheetName:a._name,row:e.row,col:e.col});this._updateValidationUI(e.row,e.col)}this.shift?(d=Math.min(a._activeRowIndex,b.row),e=Math.abs(a._activeRowIndex-b.row)+1,a._replaceActiveSelectedRange(d,-1,e,a.getColumnCount(),!0)):a._setSelectedRange(a._activeRowIndex,-1,1,a.getColumnCount(),!0);this.isWorking=!0}else if(b.hitTestType===m.UI.SheetArea.viewport)if(isNaN(b.row)||isNaN(b.col))a.isEditing()&&(b=a.getCellRect(a._activeRowIndex,a._activeColIndex,a.activeRowViewportIndex,a.activeColViewportIndex),
a._render.update(b.x,b.y,b.width,b.height)),this.beginHitTest=null;else{if(!this.shift&&(a._activeRowIndex!==b.row||a._activeColIndex!==b.col)){d={sheet:a,sheetName:a._name,row:a._activeRowIndex,col:a._activeColIndex,cancel:!1};a._trigger(m.UI.Events.LeaveCell,d);if(d&&!0===d.cancel)return;d=a._activeRowIndex!==b.row;a._setActiveCellImp(b.row,b.col,b.rowViewportIndex,b.colViewportIndex);d&&a.doDataItemChanged();a._trigger(m.UI.Events.EnterCell,{sheet:a,sheetName:a._name,row:b.row,col:b.col});this._updateValidationUI(b.row,
b.col)}this.shift?a._extendSelectedRange(b.row,b.col,!0):(d=a._spanModel.find(b.row,b.col))?a._setSelectedRange(d.row,d.col,d.rowCount,d.colCount,!0):a._setSelectedRange(b.row,b.col,1,1,!0);this.isWorking=!0}},continueSelecting:function(a,d,e,b){if(this.beginHitTest&&!0!==this._forceCancelSelectiong){this.isWorking=!0;var f=this._sheet;if(!this.beginHitTest.freezeInfo){var g={freezeTop:!1,freezeLeft:!1};this.beginHitTest.col<f._getFirstPageLeftColumn()&&(g.freezeLeft=!0);this.beginHitTest.row<f._getFirstPageTopRow()&&
(g.freezeTop=!0);this.beginHitTest.freezeInfo=g}f=this.beginHitTest.hitTestType;f===m.UI.SheetArea.viewport?this.continueCellSelecting(a,d,e,b):f===m.UI.SheetArea.rowHeader?this.continueRowSelecting(a,d,e,b):f!==m.UI.SheetArea.colHeader&&f!==m.UI.SheetArea.colFooter||this.continueColumnSelecting(a,d,e,b)}},continueCellSelecting:function(a,d,e,b){var f=this._sheet,g=this,k=this.beginHitTest.freezeInfo.freezeLeft,l=this.beginHitTest.freezeInfo.freezeTop,r=this.getMousePosition(a,d,e,m.UI.SheetArea.viewport);
r.left?k||this._getHScrollTimer().setAction(function(){var k=f._getFirstPageLeftColumn(),l=f._getPrevVisualColumn(isNaN(f.frozenColCount)?f._scrollLeftCol:Math.max(f._scrollLeftCol,f.frozenColCount));l>=k&&(f._setLeftColumn(l),g.continueCellSelecting(a,d,e,b))}):r.right&&(k?(f._setLeftColumn(f._getFirstPageLeftColumn()),this.beginHitTest.freezeInfo.freezeLeft=!1):this._getHScrollTimer().setAction(function(){var k=f._getLastPageLeftColumn(),l=f._getNextVisualColumn(isNaN(f.frozenColCount)?f._scrollLeftCol:
Math.max(f._scrollLeftCol,f.frozenColCount));l<=k&&(f._setLeftColumn(l),g.continueCellSelecting(a,d,e,b))}));r.top?l||this._getVScrollTimer().setAction(function(){var k=f._getFirstPageTopRow(),l=f._getPrevVisualRow(isNaN(f.frozenRowCount)?f._scrollTopRow:Math.max(f._scrollTopRow,f.frozenRowCount));50>=g.getIntervalFromDistance(r.distanceX)&&(l=f._getPrevVisualRow(l));l>=k&&(f._setTopRow(l),g.continueCellSelecting(a,d,e,b))}):r.bottom&&(l?(f._setTopRow(f._getFirstPageTopRow()),this.beginHitTest.freezeInfo.freezeTop=
!1):this._getVScrollTimer().setAction(function(){var k=f._getLastPageTopRow(),l=f._getNextVisualRow(isNaN(f.frozenRowCount)?f._scrollTopRow:Math.max(f._scrollTopRow,f.frozenRowCount));50>=g.getIntervalFromDistance(r.distanceX)&&(l=f._getNextVisualRow(l));l<=k&&(f._setTopRow(l),g.continueCellSelecting(a,d,e,b))}));this._getHScrollTimer().setInterval(this.getIntervalFromDistance(r.distanceX));this._getVScrollTimer().setInterval(this.getIntervalFromDistance(r.distanceY));b=f.hitTest(r.nearMouseX,r.nearMouseY);
k=f._selectionModel.toArray();f._extendSelectedRange(b.row,b.col,!0);l=f._selectionModel.toArray();this._notEqualSelecions(k,l)&&f._trigger(m.UI.Events.SelectionChanging,{sheet:f,sheetName:f._name,oldSelections:k,newSelections:l})},continueRowSelecting:function(a,d,e,b){var f=this._sheet,g=this,l=this.beginHitTest.freezeInfo.freezeTop,t=this.getMousePosition(a,d,e,m.UI.SheetArea.rowHeader);t.top?l||this._getVScrollTimer().setAction(function(){var k=f._getFirstPageTopRow(),h=f._getPrevVisualRow(f._scrollTopRow);
h>=k&&(f._setTopRow(h),g.continueRowSelecting(a,d,e,b))}):t.bottom&&(l?(f._setTopRow(f._getFirstPageTopRow()),this.beginHitTest.freezeInfo.freezeTop=!1):this._getVScrollTimer().setAction(function(){var k=f._getLastPageTopRow(),h=f._getNextVisualRow(f._scrollTopRow);h<=k&&(f._setTopRow(h),g.continueRowSelecting(a,d,e,b))}));this._getVScrollTimer().setInterval(this.getIntervalFromDistance(t.distanceY));b=f.hitTest(t.nearMouseX,t.nearMouseY);var t=Math.min(f._activeRowIndex,b.row),r=Math.max(f._activeRowIndex,
b.row)-t+1,u=f.getColumnCount();f.selectionPolicy()!==k.SelectionPolicy.Single&&(f.selectionUnit()===k.SelectionUnit.Column&&(r=t=-1),l=f._selectionModel.toArray(),f._replaceActiveSelectedRange(t,-1,r,u,!0),t=f._selectionModel.toArray(),this._notEqualSelecions(l,t)&&f._trigger(m.UI.Events.SelectionChanging,{sheet:f,sheetName:f._name,oldSelections:l,newSelections:t}))},continueColumnSelecting:function(a,d,e,b){var f=this._sheet,g=this,l=this.beginHitTest.freezeInfo.freezeLeft,t=this.getMousePosition(a,
d,e,m.UI.SheetArea.colHeader);t.left?l||this._getHScrollTimer().setAction(function(){var k=f._getFirstPageLeftColumn(),h=f._getPrevVisualColumn(f._scrollLeftCol);h>=k&&(f._setLeftColumn(h),g.continueColumnSelecting(a,d,e,b))}):t.right&&(l?(f._setLeftColumn(f._getFirstPageLeftColumn()),this.beginHitTest.freezeInfo.freezeLeft=!1):this._getHScrollTimer().setAction(function(){var k=f._getLastPageLeftColumn(),h=f._getNextVisualColumn(f._scrollLeftCol);h<=k&&(f._setLeftColumn(h),g.continueColumnSelecting(a,
d,e,b))}));this._getHScrollTimer().setInterval(this.getIntervalFromDistance(t.distanceX));b=f.hitTest(t.nearMouseX,t.nearMouseY);var t=Math.min(f._activeColIndex,b.col),r=Math.max(f._activeColIndex,b.col)-t+1,u=f.getRowCount();f.selectionPolicy()!==k.SelectionPolicy.Single&&(f.selectionUnit()===k.SelectionUnit.Row&&(r=t=-1),l=f._selectionModel.toArray(),f._replaceActiveSelectedRange(-1,t,u,r,!0),t=f._selectionModel.toArray(),this._notEqualSelecions(l,t)&&f._trigger(m.UI.Events.SelectionChanging,{sheet:f,
sheetName:f._name,oldSelections:l,newSelections:t}))},stopSelecting:function(){this.beginHitTest=null;this._getHScrollTimer().stop();this._getVScrollTimer().stop();this._forceCancelSelectiong=null;if(!1!==this.isWorking){this.isWorking=!1;var a=this._sheet,d=!this._lastSelections;if(d)this._lastSelections=a._selectionModel.toArray();else{var e=a._selectionModel.toArray();if(d=this._notEqualSelecions(this._lastSelections,e))this._lastSelections=e}d&&a._trigger(m.UI.Events.SelectionChanged,{sheet:this._sheet,
sheetName:this._sheet._name})}},startDragDropping:function(a,d,e,b){a=this._sheet;if(!this.isDragDropping&&(d=null,1===a._selectionModel.length?d=a._selectionModel[0]:1>a._selectionModel.length&&(d=(d=a._spanModel.find(a._activeRowIndex,a._activeColIndex))?d:new m.UI.Range(a._activeRowIndex,a._activeColIndex,1,1)),d)){this.isWorking=this.isDragDropping=!0;this._dragDropFromRange=d;d=null;d=(d=a._getActiveSelectedRange())&&(0<d.rowCount||0<d.colCount)?{r:d.row,c:d.col,rc:d.rowCount,cc:d.colCount}:
{r:a._activeRowIndex,c:a._activeColIndex,rc:1,cc:1};this.beginHitTest=b;b=a._currentTarget;e=a._getActiveSelectionRect(b.rowViewportIndex,b.colViewportIndex);a=a._dragRect;a.x=e.x;a.y=e.y;a.width=e.width-1;a.height=e.height-1;a.row=d.r;a.col=d.c;a.rowCount=d.rc;a.colCount=d.cc;a.beginHitRow=b.row;a.beginHitCol=b.col;a.hitRow=b.row;a.hitCol=b.col;if(this.beginHitTest){b=this.beginHitTest.dragInfo;if(!0===b.outside)switch(b.side){case "left":a.col--;break;case "right":a.col++;break;case "top":a.row--;
break;case "bottom":a.row++}a.beginRow=a.row;a.beginCol=a.col}this._getHScrollTimer().start();this._getVScrollTimer().start()}},continueDragDropping:function(a,d,e){var b=this._sheet;if(this.beginHitTest){var f=b.hitTest(d,e,!0);this.isDragDropping&&this._dragDropFromRange&&(this.isWorking=!0,b._dragRect.hitTarget=f,this.beginHitTest.freezeInfo||(f={freezeTop:!1,freezeLeft:!1},this.beginHitTest.col<b._getFirstPageLeftColumn()&&(f.freezeLeft=!0),this.beginHitTest.row<b._getFirstPageTopRow()&&(f.freezeTop=
!0),this.beginHitTest.freezeInfo=f),this.continueCellDragDropping(a,d,e))}},continueCellDragDropping:function(a,d,e){var b=this._sheet,f=this,g=this.getMousePosition(a,d,e,m.UI.SheetArea.viewport);if(g){var k=this.beginHitTest.freezeInfo.freezeLeft,l=this.beginHitTest.freezeInfo.freezeTop;g.left?k||this._getHScrollTimer().setAction(function(){var g=b._getFirstPageLeftColumn(),k=b._getPrevVisualColumn(isNaN(b.frozenColCount)?b._scrollLeftCol:Math.max(b._scrollLeftCol,b.frozenColCount));k>=g&&(b._setLeftColumn(k),
f.continueCellDragDropping(a,d,e))}):g.right&&(k?(b._setLeftColumn(b._getFirstPageLeftColumn()),this.beginHitTest.freezeInfo.freezeLeft=!1):this._getHScrollTimer().setAction(function(){var g=b._getLastPageLeftColumn(),k=b._getNextVisualColumn(isNaN(b.frozenColCount)?b._scrollLeftCol:Math.max(b._scrollLeftCol,b.frozenColCount));k<=g&&(b._setLeftColumn(k),f.continueCellDragDropping(a,d,e))}));g.top?l||this._getVScrollTimer().setAction(function(){var g=b._getFirstPageTopRow(),k=b._getPrevVisualRow(isNaN(b.frozenRowCount)?
b._scrollTopRow:Math.max(b._scrollTopRow,b.frozenRowCount));k>=g&&(b._setTopRow(k),f.continueCellDragDropping(a,d,e))}):g.bottom&&(l?(b._setTopRow(b._getFirstPageTopRow()),this.beginHitTest.freezeInfo.freezeTop=!1):this._getVScrollTimer().setAction(function(){var g=b._getLastPageTopRow(),k=b._getNextVisualRow(isNaN(b.frozenRowCount)?b._scrollTopRow:Math.max(b._scrollTopRow,b.frozenRowCount));k<=g&&(b._setTopRow(k),f.continueCellDragDropping(a,d,e))}));this._getHScrollTimer().setInterval(this.getIntervalFromDistance(g.distanceX));
this._getVScrollTimer().setInterval(this.getIntervalFromDistance(g.distanceY));this.updateDragDropRect(g.nearMouseX,g.nearMouseY)}},updateDragDropRect:function(a,d){var e=this._sheet;if(this.beginHitTest){var b=e.hitTest(a,d,!0);if(void 0!==b.row&&null!==b.row&&void 0!==b.col&&null!==b.col&&this.isDragDropping&&this._dragDropFromRange){var f=e._dragRect,g=e._getActiveSelectedRange();-1===g.row&&-1!==g.col?(f.row=-1,f.col=b.col):-1!==g.row&&-1===g.col?(f.row=b.row,f.col=-1):(f.row=f.beginRow+(b.row-
f.beginHitRow),f.col=f.beginCol+(b.col-f.beginHitCol),0>f.row&&(f.row=0),0>f.col&&(f.col=0));f.hitRow=b.row;f.hitCol=b.col;b=e.getRowCount();g=e.getColumnCount();f.row+f.rowCount>b&&(f.row=b-f.rowCount);f.col+f.colCount>g&&(f.col=g-f.colCount);f=new m.UI.Range(0>f.row?0:f.row,0>f.col?0:f.col,f.rowCount,f.colCount);b=e._oldDragRange;b&&f.row===b.row&&f.col===b.col&&f.rowCount===b.rowCount&&f.colCount===b.colCount&&f.row>e._getFirstVisualRow()&&f.col>e._getFirstVisualColumn()&&f.row+f.rowCount-1<e._getLastVisualRow()&&
f.col+f.colCount-1<e._getLastVisualColumn()||(e._actualDragRange=f,e._render.refreshDragDropIndicator())}}},stopDragDrop:function(a){a=!1;var d="",e=!1,b=this._sheet,f=null;this.beginHitTest=null;this._getHScrollTimer().stop();this._getVScrollTimer().stop();var g=b._getActiveSelectedRange(),f=g&&(0<g.rowCount||0<g.colCount)?{r:g.row,c:g.col,rc:g.rowCount,cc:g.colCount}:{r:b._activeRowIndex,c:b._activeColIndex,rc:1,cc:1};if(!0===this.isDragDropping&&!0===this.isWorking){var g=f.r,k=f.c,l=f.rc,f=f.cc,
r=b._dragRect.row,u=b._dragRect.col;if(this._isDragInsert&&(-1===g||-1===k))if(0<=k&&0>g){if(this._isDragCopy&&(u<=k||u>=k+f)||!this._isDragCopy&&(u<k||u>k+f)){if(b._hasPartSpans(-1,k,-1,f)||b._hasPartSpans(-1,u,-1,0))a=!0,d="Cannot change part of a merged cell.";a||!b._hasPartArrayFormulas(-1,k,-1,f)&&!b._hasPartArrayFormulas(-1,u,-1,0)||(a=!0,d="Cannot change part of an array.");!a&&b.isProtected&&(a=!0,d="The column you are trying to change is protected and therefore read-only.");a||(g=new m.UI.UndoRedo.DragDropExtent(-1,
k,-1,u,-1,f),k=b._raiseDragDropBlock(g.fromRow,g.fromColumn,g.toRow,g.toColumn,g.rowCount,g.columnCount,this._isDragCopy,!0,m.UI.CopyToOption.All),k||(e=new m.UI.UndoRedo.DragDropUndoAction(b,g,this._isDragCopy,!0,m.UI.CopyToOption.All),b.doCommand(e),b._raiseDragDropBlockCompleted(g.fromRow,g.fromColumn,g.toRow,g.toColumn,g.rowCount,g.columnCount,this._isDragCopy,!0,m.UI.CopyToOption.All),e=!0))}}else{if(0<=g&&0>k&&(this._isDragCopy&&(r<=g||r>=g+l)||!this._isDragCopy&&(r<g||r>g+l))){if(b._hasPartSpans(g,
-1,l,-1)||b._hasPartSpans(r,-1,0,-1))a=!0,d="Cannot change part of a merged cell.";a||!b._hasPartArrayFormulas(g,-1,l,-1)&&!b._hasPartArrayFormulas(r,-1,0,-1)||(a=!0,d="Cannot change part of an array.");!a&&b.isProtected&&(a=!0,d="The row you are trying to change is protected and therefore read-only.");a||(g=new m.UI.UndoRedo.DragDropExtent(g,-1,r,-1,l,-1),k=b._raiseDragDropBlock(g.fromRow,g.fromColumn,g.toRow,g.toColumn,g.rowCount,g.columnCount,this._isDragCopy,!0,m.UI.CopyToOption.All),k||(e=new m.UI.UndoRedo.DragDropUndoAction(b,
g,this._isDragCopy,!0,m.UI.CopyToOption.All),b.doCommand(e),b._raiseDragDropBlockCompleted(g.fromRow,g.fromColumn,g.toRow,g.toColumn,g.rowCount,g.columnCount,this._isDragCopy,!0,m.UI.CopyToOption.All),e=!0))}}else if(r!==g||u!==k){if(b._hasPartSpans(g,k,l,f)||b._hasPartSpans(r,u,l,f))a=!0,d="Cannot change part of a merged cell.";a||!b._hasPartArrayFormulas(g,k,l,f)&&!b._hasPartArrayFormulas(r,u,l,f)||(a=!0,d="Cannot change part of an array.");!a&&b.isProtected&&(!this._isDragCopy&&b._isAnyCellInRangeLocked(new m.UI.Range(g,
k,l,f))||b._isAnyCellInRangeLocked(new m.UI.Range(r,u,l,f)))&&(a=!0,d="The cells you are trying to change is protected and therefore read-only.");a||(g=new m.UI.UndoRedo.DragDropExtent(g,k,r,u,l,f),k=b._raiseDragDropBlock(g.fromRow,g.fromColumn,g.toRow,g.toColumn,g.rowCount,g.columnCount,this._isDragCopy,!1,m.UI.CopyToOption.All),k||(e=new m.UI.UndoRedo.DragDropUndoAction(b,g,this._isDragCopy,!1,m.UI.CopyToOption.All),b.doCommand(e),b._raiseDragDropBlockCompleted(g.fromRow,g.fromColumn,g.toRow,g.toColumn,
g.rowCount,g.columnCount,this._isDragCopy,!1,m.UI.CopyToOption.All),e=!0))}}this.isDragDropping=this.isWorking=!1;this._dragDropFromRange=null;this._isDragCopy=this._isDragInsert=!1;!1===e&&(b._dragRect={},b.repaint());a&&b._raiseInvalidOperation(d)},startDragFill:function(a,d,e,b){!0!==this.isDraggingFill&&!0!==this.isWorking&&(this.beginHitTest=b,this.updateDragFillStartRange(),this._dragFillStartRange&&(this.isWorking=!0,this._dragStartRowViewport=b.rowViewportIndex,this._dragStartColumnViewport=
b.colViewportIndex,this._dragToRowViewport=b.rowViewportIndex,this._dragToColumnViewport=b.colViewportIndex,this.updateDragStartRangeViewports(),this._getHScrollTimer().start(),this._getVScrollTimer().start()))},updateDragStartRangeViewports:function(){var a=this.dragFillStartTopRow();0<=a&&a<this._sheet.frozenRowCount?this._dragFillStartTopRowViewport=0:a>=this._sheet.frozenRowCount&&a<=this._sheet.getRowCount()&&(this._dragFillStartTopRowViewport=1);this.isDragFillWholeColumns()?this._dragFillStartBottomRowViewport=
1:this._dragFillStartBottomRowViewport=this._dragStartRowViewport;a=this.dragFillStartLeftColumn();0<=a&&a<this._sheet.frozenColCount?this._dragFillStartLeftColumnViewport=0:a>=this._sheet.frozenColCount&&a<=this._sheet.getColumnCount()&&(this._dragFillStartLeftColumnViewport=1);this.isDragFillWholeRows()?this._dragFillStartRightColumnViewport=1:this._dragFillStartRightColumnViewport=this._dragStartColumnViewport},updateDragToViewports:function(a,d,e){this.updateDragToRowViewport(a,d,e);this.updateDragToColumnViewport(a,
d,e)},updateDragToRowViewport:function(a,d,e){this._dragToRowViewport=this._dragStartRowViewport;a=this._sheet._getRowIndex(e,this._dragToRowViewport);if(void 0===a||null===a||null===this._sheet._getRowLayout(this._dragToRowViewport).findRow(a))e<this._sheet._currentTarget.y?this._dragToRow<=this._sheet.frozenRowCount?this._dragToRowViewport=0:this._dragToRow<=this._sheet.getRowCount()&&(this._dragToRowViewport=1):0===this._dragStartRowViewport&&this._dragToRow>=this._sheet.frozenRowCount&&(this._dragToRowViewport=
1)},updateDragToColumnViewport:function(a,d,e){this._dragToColumnViewport=this._dragStartColumnViewport;a=this._sheet._getColumnIndex(d,this._dragToColumnViewport);if(void 0===a||null===a||null===this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(a))d<this._sheet._currentTarget.x?this._dragToColumn<=this._sheet.frozenColCount?this._dragToColumnViewport=0:this._dragToColumn<=this._sheet.getColumnCount()&&(this._dragToColumnViewport=1):0===this._dragStartColumnViewport&&this._dragToColumn>=
this._sheet.frozenColCount&&(this._dragToColumnViewport=1)},continueDragFill:function(a,d,e){var b=this._sheet;if(this.beginHitTest&&this.isWorking&&this._dragFillStartRange){this.isDraggingFill=!0;if(!this.beginHitTest.freezeInfo){var f={freezeTop:!1,freezeLeft:!1};this.beginHitTest.col<b._getFirstPageLeftColumn()&&(f.freezeLeft=!0);this.beginHitTest.row<b._getFirstPageTopRow()&&(f.freezeTop=!0);this.beginHitTest.freezeInfo=f}this.continueCellDragFill(a,d,e)}},continueCellDragFill:function(a,d,e){var b=
this._sheet,f=this,g=this.getMousePosition(a,d,e,m.UI.SheetArea.viewport);if(g){var k=this.beginHitTest.freezeInfo.freezeLeft,l=this.beginHitTest.freezeInfo.freezeTop;g.left?k||this._getHScrollTimer().setAction(function(){var g=b._getFirstPageLeftColumn(),k=b._getPrevVisualColumn(isNaN(b.frozenColCount)?b._scrollLeftCol:Math.max(b._scrollLeftCol,b.frozenColCount));k>=g&&(b._setLeftColumn(k),f.continueCellDragFill(a,d,e))}):g.right&&(k?(b._setLeftColumn(b._getFirstPageLeftColumn()),this.beginHitTest.freezeInfo.freezeLeft=
!1):this._getHScrollTimer().setAction(function(){var g=b._getLastPageLeftColumn(),k=b._getNextVisualColumn(isNaN(b.frozenColCount)?b._scrollLeftCol:Math.max(b._scrollLeftCol,b.frozenColCount));k<=g&&(b._setLeftColumn(k),f.continueCellDragFill(a,d,e))}));g.top?l||this._getVScrollTimer().setAction(function(){var g=b._getFirstPageTopRow(),k=b._getPrevVisualRow(isNaN(b.frozenRowCount)?b._scrollTopRow:Math.max(b._scrollTopRow,b.frozenRowCount));k>=g&&(b._setTopRow(k),f.continueCellDragFill(a,d,e))}):g.bottom&&
(l?(b._setTopRow(b._getFirstPageTopRow()),this.beginHitTest.freezeInfo.freezeTop=!1):this._getVScrollTimer().setAction(function(){var g=b._getLastPageTopRow(),k=b._getNextVisualRow(isNaN(b.frozenRowCount)?b._scrollTopRow:Math.max(b._scrollTopRow,b.frozenRowCount));k<=g&&(b._setTopRow(k),f.continueCellDragFill(a,d,e))}));this._getHScrollTimer().setInterval(this.getIntervalFromDistance(g.distanceX));this._getVScrollTimer().setInterval(this.getIntervalFromDistance(g.distanceY));this.updateDragFillRect(a,
g.nearMouseX,g.nearMouseY)}},updateDragFillRect:function(a,d,e){this.updateDragToViewports(a,d,e);this.updateDragToCoordinates(a,d,e);0>this._dragToRow&&0>this._dragToColumn||(this.updateCurrentFillSettings(a,d,e),this.updateCurrentFillRange(),this.refreshDragFill())},refreshDragFill:function(){if(l.browser.chrome||l.browser.safari){var a=this._sheet,d=a._render._getCtx(),e=a._render._getBufferCtx(),b=a._render._getBufferCtx2(),f=this.getDragFillFrameRange();if(this._oldDragFillFrameRange){var g=
null,g=f.containsRange(this._oldDragFillFrameRange)?a._getRangeRect(1,1,f):a._getRangeRect(1,1,this._oldDragFillFrameRange);g.x-=2;g.y-=2;g.width+=4;g.height+=4;a._render._copyDoubleBufferRect(g,null,null,null,e,b)}f&&(g=a._getRangeRect(1,1,f),this.refreshSelectionBorder(b),a._render.paintDragRectangle(b,g),g=!this._oldDragFillFrameRange||f.containsRange(this._oldDragFillFrameRange)?a._getRangeRect(1,1,f):a._getRangeRect(1,1,this._oldDragFillFrameRange),g.x-=2,g.y-=2,g.width+=4,g.height+=4,a._render._copyDoubleBufferRect(g,
null,null,null,b,d));this._oldDragFillFrameRange=f}else this.clearDragFill(),this.refreshSelectionBorder(),this.paintDragFill(),this._oldDragFillFrameRange=this.getDragFillFrameRange()},clearDragFill:function(){var a=this._sheet;if(this._oldDragFillFrameRange){var d=a._getRangeRect(1,1,this._oldDragFillFrameRange);d.x-=2;d.y-=2;d.width+=4;d.height+=4;a._render._copyDoubleBufferRect(d)}},refreshSelectionBorder:function(a){this._sheet._render.repaintSelection(this._dragFillStartRange,null,a)},paintDragFill:function(){var a=
this._sheet,d=a._render,e=this.getDragFillFrameRange();if(e)for(var b=d._getCtx(),f=a._getSheetLayout(),g=0;2>g;g++)for(var k=0;2>k;k++){var l=a._getRangeRect(g,k,e),m=f.viewportRect(g,k);b.save();b.rect(m.x,m.y,m.width,m.height);b.clip();b.beginPath();d.paintDragRectangle(b,l);b.beginPath();b.restore()}},updateCurrentFillRange:function(){this._currentFillRange=this.getCurrentFillRange()},isDragFillWholeRows:function(){return-1===this._dragFillStartRange.col&&-1!==this._dragFillStartRange.row},isDragFillWholeColumns:function(){return-1===
this._dragFillStartRange.row&&-1!==this._dragFillStartRange.col},isDragClear:function(){return this._currentFillDirection===m.UI.DragFillDirection.LeftClear||this._currentFillDirection===m.UI.DragFillDirection.UpClear},getCurrentFillRange:function(){var a=-1,d=-1,e=-1,b=-1;switch(this._currentFillDirection){case m.UI.DragFillDirection.Left:this.isDragFillWholeColumns()?e=a=-1:(a=this.dragFillStartTopRow(),e=this._dragFillStartRange.rowCount);d=this._dragToColumn;b=this.dragFillStartLeftColumn()-d;
break;case m.UI.DragFillDirection.Right:this.isDragFillWholeColumns()?e=a=-1:(a=this.dragFillStartTopRow(),e=this._dragFillStartRange.rowCount);d=this.dragFillStartRightColumn()+1;b=this._dragToColumn-d+1;break;case m.UI.DragFillDirection.Up:a=this._dragToRow;e=this.dragFillStartTopRow()-a;this.isDragFillWholeRows()?b=d=-1:(d=this.dragFillStartLeftColumn(),b=this._dragFillStartRange.colCount);break;case m.UI.DragFillDirection.Down:a=this.dragFillStartBottomRow()+1;e=this._dragToRow-a+1;this.isDragFillWholeRows()?
b=d=-1:(d=this.dragFillStartLeftColumn(),b=this._dragFillStartRange.colCount);break;case m.UI.DragFillDirection.UpClear:a=this._dragToRow;e=this.dragFillStartBottomRow()-a+1;this.isDragFillWholeRows()?b=d=-1:(d=this.dragFillStartLeftColumn(),b=this._dragFillStartRange.colCount);break;case m.UI.DragFillDirection.LeftClear:this.isDragFillWholeColumns()?e=a=-1:(a=this._dragFillStartRange.row,e=this._dragFillStartRange.rowCount),d=this._dragToColumn,b=this.dragFillStartRightColumn()-d+1}return new m.UI.Range(a,
d,e,b)},updateDragToCoordinates:function(a,d,e){a=this._sheet;d=a.hitTest(d,e,!0);if(null!==d.row&&null!==d.col){e=a._getLastFullyVisibleRow();var b=a._getLastFullyVisibleColumn(),f=a._getLastVisualRow(),g=a._getLastVisualColumn();this._dragToRow=d.row>e&&e<f?a._getPrevVisualRow(d.row):d.row;this._dragToColumn=d.col>b&&b<g?a._getPrevVisualColumn(d.col):d.col}},dragFillStartBottomRowLayout:function(){var a=this.dragFillStartBottomRow();return-1!==a?this._sheet._getRowLayout(this._dragFillStartBottomRowViewport).findRow(a):
null},dragFillToViewportBottomRowLayout:function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this.dragFillToViewportBottomRow())},dragFillToViewportBottomRow:function(){return this._sheet.getViewportBottomRow(this._dragToRowViewport)},dragFillStartRightColumnLayout:function(){var a=this.dragFillStartRightColumn();return-1!==a?this._sheet._getColumnLayout(this._dragFillStartRightColumnViewport).findCol(a):null},dragFillToViewportRightColumnLayout:function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this.dragFillToViewportRightColumn())},
dragFillToViewportRightColumn:function(){return this._sheet.getViewportRightColumn(this._dragToColumnViewport)},updateCurrentFillSettings:function(a,d,e){var b=this.isDragFillWholeRows(),f=this.isDragFillWholeColumns(),g=l(this._sheet._getCanvas()).offset(),k=a.pageX-g.left;a=a.pageY-g.top;var g=!1,t,r;b||f?f?this._dragToColumn>=this.dragFillStartLeftColumn()&&this._dragToColumn<=this.dragFillStartRightColumn()?this._currentFillDirection=m.UI.DragFillDirection.LeftClear:this._dragToColumn<this.dragFillStartLeftColumn()?
this._currentFillDirection=m.UI.DragFillDirection.Left:this._dragToColumn>this.dragFillStartRightColumn()&&(this._currentFillDirection=m.UI.DragFillDirection.Right):b&&(this._dragToRow>=this.dragFillStartTopRow()&&this._dragToRow<=this.dragFillStartBottomRow()?this._currentFillDirection=m.UI.DragFillDirection.UpClear:this._dragToRow<this.dragFillStartTopRow()?this._currentFillDirection=m.UI.DragFillDirection.Up:this._dragToRow>this.dragFillStartBottomRow()&&(this._currentFillDirection=m.UI.DragFillDirection.Down)):
this._dragToRow>=this.dragFillStartTopRow()&&this._dragToRow<=this.dragFillStartBottomRow()?this._dragToColumn>=this.dragFillStartLeftColumn()&&this._dragToColumn<=this.dragFillStartRightColumn()?(t=Math.abs(this._dragToColumn-this.dragFillStartRightColumn()),r=Math.abs(this._dragToRow-this.dragFillStartBottomRow()),r>t?this._currentFillDirection=m.UI.DragFillDirection.UpClear:r<t?this._currentFillDirection=m.UI.DragFillDirection.LeftClear:((t=this.dragFillStartBottomRowLayout())||(t=this.dragFillToViewportBottomRowLayout()),
e>t.y+t.height?this._currentFillDirection=m.UI.DragFillDirection.Down:((r=this.dragFillStartRightColumnLayout())||(r=this.dragFillToViewportRightColumnLayout()),d=r.x+r.width-d,e=t.y+t.height-e,k>=r.x&&k<=r.x+r.width&&a>=t.y&&a<=t.y+t.height?this._currentFillDirection=d>=e?m.UI.DragFillDirection.LeftClear:m.UI.DragFillDirection.UpClear:g=!0))):this._dragToColumn<this.dragFillStartLeftColumn()?this._currentFillDirection=m.UI.DragFillDirection.Left:this._dragToColumn>this.dragFillStartRightColumn()&&
(this._currentFillDirection=m.UI.DragFillDirection.Right):this._dragToRow<this.dragFillStartTopRow()?this._dragToColumn>=this.dragFillStartLeftColumn()&&this._dragToColumn<=this.dragFillStartRightColumn()?this._currentFillDirection=m.UI.DragFillDirection.Up:this._dragToColumn<this.dragFillStartLeftColumn()?(t=Math.abs(this._dragToColumn-this.dragFillStartLeftColumn()),r=Math.abs(this._dragToRow-this.dragFillStartTopRow()),this._currentFillDirection=r>=t?m.UI.DragFillDirection.Up:m.UI.DragFillDirection.Left):
this._dragToColumn>this.dragFillStartRightColumn()&&(t=Math.abs(this._dragToColumn-this.dragFillStartRightColumn()),r=Math.abs(this._dragToRow-this.dragFillStartTopRow()),this._currentFillDirection=r>=t?m.UI.DragFillDirection.Up:m.UI.DragFillDirection.Right):this._dragToRow>this.dragFillStartBottomRow()&&(this._dragToColumn>=this.dragFillStartLeftColumn()&&this._dragToColumn<=this.dragFillStartRightColumn()?this._currentFillDirection=m.UI.DragFillDirection.Down:this._dragToColumn<this.dragFillStartLeftColumn()?
(t=Math.abs(this._dragToColumn-this.dragFillStartLeftColumn()),r=Math.abs(this._dragToRow-this.dragFillStartBottomRow()),this._currentFillDirection=r>=t?m.UI.DragFillDirection.Down:m.UI.DragFillDirection.Left):this._dragToColumn>this.dragFillStartRightColumn()&&(t=Math.abs(this._dragToColumn-this.dragFillStartRightColumn()),r=Math.abs(this._dragToRow-this.dragFillStartBottomRow()),this._currentFillDirection=r>=t?m.UI.DragFillDirection.Down:m.UI.DragFillDirection.Right));if(e=this._sheet._dragFillIndicatorRect){d=
this.dragFillStartBottomRow();var u=this.dragFillStartRightColumn();t=d+1;r=u+1;d=this._sheet.getRowHeight(d,m.UI.SheetArea.viewport);u=this._sheet.getColumnWidth(u,m.UI.SheetArea.viewport);t=this._sheet.getRowHeight(t,m.UI.SheetArea.viewport);var n=this._sheet.getColumnWidth(r,m.UI.SheetArea.viewport);r=e.x+e.width/2-Math.min(10,u/2);u=e.x+e.width/2+Math.min(10,n/2);d=e.y+e.height/2-Math.min(10,d/2);e=e.y+e.height/2+Math.min(10,t/2);t=!1;b||f?f?t=r<=k&&k<=u:b&&(t=d<=a&&a<=e):t=r<=k&&k<=u&&d<=a&&
a<=e;t||g?(this._isDragAroundIndicator=!0,this._currentFillDirection=m.UI.DragFillDirection.LeftClear):this._isDragAroundIndicator=!1}},dragFillStartTopRow:function(){return this._dragFillStartRange?-1===this._dragFillStartRange.row?0:this._dragFillStartRange.row:-1},dragFillStartBottomRow:function(){return this._dragFillStartRange?-1===this._dragFillStartRange.row?this._sheet.getRowCount()-1:this._dragFillStartRange.row+this._dragFillStartRange.rowCount-1:-1},dragFillStartLeftColumn:function(){return this._dragFillStartRange?
-1===this._dragFillStartRange.col?0:this._dragFillStartRange.col:-1},dragFillStartRightColumn:function(){return this._dragFillStartRange?-1===this._dragFillStartRange.col?this._sheet.getColumnCount()-1:this._dragFillStartRange.col+this._dragFillStartRange.colCount-1:-1},endDragFill:function(a){this.beginHitTest=null;this._getHScrollTimer().stop();this._getVScrollTimer().stop();if(this.isDraggingFill&&this.isWorking){if(this.isWorking=this.isDraggingFill=!1,a=this.getDragFillFrameRange())if(!this.validateFillRange(a)||
this._isDragAroundIndicator)this.resetDragFill(),this.refreshSelection(a);else{var d=this.getDragAutoFillType();!this.executeDragFillAction(this._currentFillRange,d)&&this.isDragFill()?this.showDragFillSmartTag(d):this.refreshSelection(a);this.resetDragFill()}}else this.resetDragFill()},showDragFillSmartTag:function(a){var d=this._sheet,e=d._dragFillIndicatorRect;d._smartTag=new m.UI._GcFillDialog(d,{x:e.x+e.width,y:e.y+e.height,fillType:a});d._smartTag.open()},updateDragFillStartRange:function(){var a=
this._sheet;1===a._selectionModel.length?this._dragFillStartRange=a._selectionModel[0]:0<=a._activeRowIndex&&0<=a._activeColIndex&&(this._dragFillStartRange=new m.UI.Range(a._activeRowIndex,a._activeColIndex,1,1))},resetDragFill:function(){this.isDraggingFill=this.isWorking=!1},refreshSelection:function(a){this._sheet._render.repaintSelection(a)},getDragAutoFillType:function(){return this.isDragClear()?m.UI.AutoFillType.ClearValues:1!==this._dragFillStartRange.rowCount||1!==this._dragFillStartRange.colCount||
this.isDragFillWholeColumns()||this.isDragFillWholeRows()?this.isControlPressed?m.UI.AutoFillType.CopyCells:m.UI.AutoFillType.FillSeries:this.isControlPressed?m.UI.AutoFillType.FillSeries:m.UI.AutoFillType.CopyCells},getDragFillFrameRange:function(){if(!this._dragFillStartRange)return null;if(this.isDragClear())return this._dragFillStartRange;if(!this._currentFillRange)return null;var a=0,d=0,e=0,b=0;this.isVerticalDragFill()?(a=this._currentFillDirection===m.UI.DragFillDirection.Up?this._currentFillRange.row:
this._dragFillStartRange.row,d=this._dragFillStartRange.rowCount+this._currentFillRange.rowCount,e=this._dragFillStartRange.col,b=this._dragFillStartRange.colCount):(a=this._dragFillStartRange.row,d=this._dragFillStartRange.rowCount,e=this._currentFillDirection===m.UI.DragFillDirection.Left?this._currentFillRange.col:this._dragFillStartRange.col,b=this._dragFillStartRange.colCount+this._currentFillRange.colCount);return new m.UI.Range(a,e,d,b)},validateFillRange:function(a){var d=this._sheet,e=!0,
b="";d._hasSpans(a.row,a.col,a.rowCount,a.colCount)&&(e=!1,b="Can not fill range that contains merged cell.");e&&d.isProtected&&d._isAnyCellInRangeLocked(a)&&(e=!1,b="The cells you are trying to fill is protected and therefore read-only.");e||d._raiseInvalidOperation(b);return e},executeDragFillAction:function(a,d){var e=this._sheet,b=e._getActualRange(a);this._preFillCellsInfo=new m.UI.CopyMoveCellsInfo(b.rowCount,b.colCount);m.UI.CopyMoveHelper.saveViewportInfo(e,this._preFillCellsInfo,b.row,b.col,
m.UI.CopyToOption.All);b={startRange:this._dragFillStartRange,fillRange:a,autoFillType:d,fillDirection:this.getCurrentFillDirection()};if(!e._raiseDragFillBlock(b.fillRange,b.fillDirection,b.autoFillType)){var f=new m.UI.UndoRedo.DragFillUndoAction(e,b);e.doCommand(f);e._raiseDragFillBlockCompleted(b.fillRange,b.fillDirection,b.autoFillType);return!1}return!0},isDragFill:function(){return this.isIncreaseFill()||this.isDecreaseFill()},isIncreaseFill:function(){return this._currentFillDirection===m.UI.DragFillDirection.Down||
this._currentFillDirection===m.UI.DragFillDirection.Right},isDecreaseFill:function(){return this._currentFillDirection===m.UI.DragFillDirection.Left||this._currentFillDirection===m.UI.DragFillDirection.Up},isVerticalDragFill:function(){return this._currentFillDirection===m.UI.DragFillDirection.Up||this._currentFillDirection===m.UI.DragFillDirection.Down||this._currentFillDirection===m.UI.DragFillDirection.UpClear},isDragToRowInView:function(){return this.isRowInViewport(this._dragToRowViewport,this._dragToRow)},
isRowInViewport:function(a,d){var e=this._sheet.getViewportTopRow(a),b=this._sheet.getViewportBottomRow(a);return d>=e&&d<=b?!0:!1},getCurrentDragToRowLayout:function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this._dragToRow)},isDragFillStartBottomRowInView:function(){return this.isRowInViewport(this._dragFillStartBottomRowViewport,this.dragFillStartBottomRow())},dragFillStartViewportBottomRowLayout:function(){return this._sheet._getRowLayout(this._dragStartRowViewport).findRow(this.dragFillStartViewportBottomRow())},
dragFillStartViewportBottomRow:function(){return this._sheet.getViewportBottomRow(this._dragStartRowViewport)},getValidVerDragToRowLayout:function(){return this.isIncreaseFill()?this.isDragToRowInView()?this.getCurrentDragToRowLayout():this.dragFillToViewportBottomRowLayout():this.isDragFillStartBottomRowInView?this.dragFillStartBottomRowLayout():this.dragFillStartViewportBottomRowLayout()},isDragToColumnInView:function(){return this.isColumnInViewport(this._dragToColumnViewport,this._dragToColumn)},
isColumnInViewport:function(a,d){var e=this._sheet.getViewportLeftColumn(a),b=this._sheet.getViewportRightColumn(a);return d>=e&&d<=b?!0:!1},getCurrentDragToColumnLayout:function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this._dragToColumn)},isDragFillStartRightColumnInView:function(){return this.isColumnInViewport(this._dragFillStartRightColumnViewport,this.dragFillStartRightColumn())},dragFillStartViewportRightColumnLayout:function(){return this._sheet._getColumnLayout(this._dragStartColumnViewport).findCol(this.dragFillStartViewportRightColumn())},
dragFillStartViewportRightColumn:function(){return this._sheet.getViewportRightColumn(this._dragStartColumnViewport)},getValidHorDragToColumnLayout:function(){return this.isIncreaseFill()?this.isDragToColumnInView()?this.getCurrentDragToColumnLayout():this.dragFillToViewportRightColumnLayout():this.isDragFillStartRightColumnInView()?this.dragFillStartRightColumnLayout():this.dragFillStartViewportRightColumnLayout()},dragFillToViewportTopRowLayout:function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this.dragFillToViewportTopRow())},
dragFillToViewportTopRow:function(){return this._sheet.getViewportTopRow(this._dragToRowViewport)},dragFillToViewportLeftColumnLayout:function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this.dragFillToViewportLeftColumn())},dragFillToViewportLeftColumn:function(){return this._sheet.getViewportLeftColumn(this._dragToColumnViewport)},getCurrentFillDirection:function(){switch(this._currentFillDirection){case m.UI.DragFillDirection.Left:return m.UI.FillDirection.Left;case m.UI.DragFillDirection.Right:return m.UI.FillDirection.Right;
case m.UI.DragFillDirection.Up:return m.UI.FillDirection.Up;case m.UI.DragFillDirection.LeftClear:return m.UI.FillDirection.Left;case m.UI.DragFillDirection.UpClear:return m.UI.FillDirection.Up}return m.UI.FillDirection.Down},getMousePosition:function(a,d,e,b){var f=null;b===m.UI.SheetArea.viewport?(b=this.getViewPortRect(),f=this.createMousePosition(a,d,e,b)):b===m.UI.SheetArea.rowHeader?(b=this.getRowHeaderRect(),f=this.createMousePosition(a,d,e,b)):b===m.UI.SheetArea.colHeader&&(b=this.getColHeaderRect(),
f=this.createMousePosition(a,d,e,b));return f},getViewPortRect:function(){var a=this._sheet,d=a._getSheetLayout(),e=a._getColumnLayout(1,m.UI.SheetArea.viewport),b=a._getRowLayout(1,m.UI.SheetArea.viewport),f=null,g=this.beginHitTest.freezeInfo.freezeLeft,k=this.beginHitTest.freezeInfo.freezeTop;g&&k?f=new m.UI.Rect(d.x+d.rowHeaderWidth,d.y+d.colHeaderHeight,d.frozenWidth,d.frozenHeight):!g&&k?f=new m.UI.Rect(d.viewportX,d.y+d.colHeaderHeight,d.viewportWidth,d.frozenHeight):g&&!k?f=new m.UI.Rect(d.x+
d.rowHeaderWidth,d.viewportY,d.frozenWidth,d.viewportHeight):g||k||(f=new m.UI.Rect(d.viewportX,d.viewportY,d.viewportWidth,d.viewportHeight));a._scrollLeftCol<=a._getFirstPageLeftColumn()&&(f.x=d.x+d.rowHeaderWidth,f.width=d.width-f.x);a._scrollTopRow<=a._getFirstPageTopRow()&&(f.y=d.y+d.colHeaderHeight,f.height=d.height-f.y);a._scrollLeftCol>=a._getLastPageLeftColumn()&&!g&&0<e.length&&(f.width=e[e.length-1].x+e[e.length-1].width-f.x);a._scrollTopRow>=a._getLastPageTopRow()&&!k&&0<b.length&&(f.height=
b[b.length-1].y+b[b.length-1].height-f.y);return f},getRowHeaderRect:function(){var a=this._sheet,d=a._getSheetLayout(),e=a._getRowLayout(1,m.UI.SheetArea.viewport),b=null,f=this.beginHitTest.freezeInfo.freezeTop,b=f?new m.UI.Rect(d.headerX,d.headerY,d.rowHeaderWidth,d.frozenHeight):new m.UI.Rect(d.headerX,d.viewportY,d.rowHeaderWidth,d.viewportHeight);a._scrollTopRow===a._getFirstPageTopRow()&&(b.y=d.headerY+d.colHeaderHeight,b.height=d.height-b.y);a._scrollTopRow>=a._getLastPageTopRow()&&!f&&0<
e.length&&(b.height=e[e.length-1].y+e[e.length-1].height-b.y);return b},getColHeaderRect:function(){var a=this._sheet,d=a._getSheetLayout(),e=a._getColumnLayout(1,m.UI.SheetArea.viewport),b=null,f=this.beginHitTest.freezeInfo.freezeLeft,b=f?new m.UI.Rect(d.headerX,d.headerY,d.frozenWidth,d.colHeaderHeight):new m.UI.Rect(d.viewportX,d.headerY,d.viewportWidth,d.colHeaderHeight);a._scrollLeftCol===a._getFirstPageLeftColumn()&&(b.x=d.headerX+d.rowHeaderWidth,b.width=d.width-b.x);a._scrollLeftCol>=a._getLastPageLeftColumn()&&
!f&&0<e.length&&(b.width=e[e.length-1].x+e[e.length-1].width-b.x);return b},createMousePosition:function(a,d,e,b){a={top:!1,bottom:!1,left:!1,right:!1,distanceX:null,distanceY:null,nearMouseX:d,nearMouseY:e};d<=b.x?a.left=!0:d>=b.x+b.width&&(a.right=!0);e<=b.y?a.top=!0:e>=b.y+b.height&&(a.bottom=!0);a.left?(a.distanceX=b.x-d,a.nearMouseX=b.x+0.5):a.right&&(a.distanceX=d-b.x-b.width,a.nearMouseX=b.x+b.width-0.5);a.top?(a.distanceY=b.y-e,a.nearMouseY=b.y+0.5):a.bottom&&(a.distanceY=e-b.y-b.height,a.nearMouseY=
b.y+b.height-0.5);return a},getIntervalFromDistance:function(a){var d=-1;!isNaN(a)&&0<a&&(d=Math.ceil(500/a),d=Math.max(20,10*d),200<d&&(d=200));return d},updateRange:function(a,d,e,b){if(0!==e&&0!==b){var f=this._sheet,g=m.UI.SheetArea.viewport,k=f._getRowLayout(0,g),l=f._getColumnLayout(0,g),r=f._getRowLayout(1,g),u=f._getColumnLayout(1,g),n=0;l&&0<l.length&&(n=l[l.length-1].col);u&&0<u.length&&(n=u[u.length-1].col);var g=this.getYForRow(a,d,e,b,!0,n,k,r),n=this.getYForRow(a,d,e,b,!1,n,k,r),h=0;
k&&0<k.length&&(h=k[k.length-1].row);r&&0<r.length&&(h=r[r.length-1].row);k=this.getXForCol(a,d,e,b,!0,h,l,u);a=this.getXForCol(a,d,e,b,!1,h,l,u);d=f._getSheetLayout();a>k&&n>g&&f._render.update(k-d.headerX-2,g-d.headerY-2,a-k+2*d.headerX+2,n-g+2*d.headerY+2);n>g&&f._render.update(d.headerX,g,d.rowHeaderWidth,n-g);a>k&&(f._render.update(k,d.headerY,a-k,d.colHeaderHeight),f._render.update(k,d.footerY,a-k,d.colHeaderHeight))}},getYForRow:function(a,d,e,b,f,g,k,l){var m=this._sheet,u=a;f||(u=a+e-1);
if(u<m.frozenRowCount){if(1>k.length)return-1}else{if(1>l.length)return-1;f?u<l[0].row&&(u=l[0].row):u>l[l.length-1].row&&(u=l[l.length-1].row)}a=0;f&&(a=9E4);for(e=Math.max(m._scrollLeftCol,d);e<d+b&&e<=g;e++)if(k=m.getCellRect(u,e))f?k.y<a&&(a=k.y):a<k.y+k.height&&(a=k.y+k.height);return a},getXForCol:function(a,d,e,b,f,g,k,l){var m=this._sheet,u=d;f||(u=d+b-1);if(u<m.frozenColCount){if(1>k.length)return}else{if(1>l.length)return;f?u<l[0].col&&(u=l[0].col):u>l[l.length-1].col&&(u=l[l.length-1].col)}d=
0;f&&(d=9E4);for(b=Math.max(m._scrollTopRow,a);b<a+e&&b<=g;b++)if(k=m.getCellRect(b,u))f?k.x<d&&(d=k.x):d<k.x+k.width&&(d=k.x+k.width);return d},getResizingArea:function(){return 4},_getPrevVisualRowBeforeFindRow:function(a,d){var e=this._sheet,b=a;return e._render._isCellHiddenByGroup(b,0,d)?(b=e._getPrevVisualRow(b,d),null!==b?b:a):a},_getPrevVisualColBeforeFindCol:function(a,d){var e=this._sheet,b=a;return e._render._isCellHiddenByGroup(0,b,d)?(b=e._getPrevVisualColumn(b,d),null!==b?b:a):a},_getResizeRowInfo:function(a,
d,e,b,f){var g=null,k=a._getRowLayout(d.rowViewportIndex,b);if(!isNaN(d.row)&&!isNaN(d.col)){d.row=this._getPrevVisualRowBeforeFindRow(d.row,b);var l=k.findRow(d.row);l&&(l.y+l.height-e<f&&f<l.y+l.height+e?(g={action:"sizeRow",index:d.row,sheetArea:b},d=a.getRowCount(b)-1,0<=d&&(k=a._getLastVisualRow(b),g.index===k&&g.index!==d&&l.y+l.height-e/2<f&&(g={action:"sizeRow",index:d,sheetArea:b}))):l.y-e<f&&f<l.y+e&&0<k.indexOf(l)&&(g={action:"sizeRow",index:d.row-1,sheetArea:b}))}g&&!a.getRowResizable(g.index,
b)&&(g=null);return g},_getResizeColInfo:function(a,d,e,b,f){var g=null,k=a._getColumnLayout(d.colViewportIndex,b);if(!isNaN(d.col)&&!isNaN(d.row)){d.col=this._getPrevVisualColBeforeFindCol(d.col,b);var l=k.findCol(d.col);l&&(l.x+l.width-e<f&&f<l.x+l.width+e?(g={action:"sizeCol",index:d.col,sheetArea:b},d=a.getColumnCount(b)-1,0<=d&&(k=a._getLastVisualColumn(b),g.index===k&&g.index!==d&&l.x+l.width-e/2<f&&(g={action:"sizeCol",index:d,sheetArea:b}))):l.x-e<f&&f<l.x+e&&0<k.indexOf(l)&&(g={action:"sizeCol",
index:d.col-1,sheetArea:b}))}g&&!a.getColumnResizable(g.index,b)&&(g=null);return g},getResizingRowCol:function(a,d,e){var b=this._sheet,f=null;if(!b.parent||b.parent._allowUserResize){var g=this.getResizingArea(),k=b._getSheetLayout();0>a.rowViewportIndex&&0<=a.colViewportIndex?(f=this._getResizeColInfo(b,a,g,m.UI.SheetArea.colHeader,d))||(f=this._getResizeRowInfo(b,a,g,m.UI.SheetArea.colHeader,e)):0<=a.rowViewportIndex&&0>a.colViewportIndex?(f=this._getResizeRowInfo(b,a,g,m.UI.SheetArea.rowHeader,
e))||(f=this._getResizeColInfo(b,a,g,m.UI.SheetArea.rowHeader,d)):0>a.rowViewportIndex&&0>a.colViewportIndex?null===b._getLastVisualRow(m.UI.SheetArea.rowHeader)&&Math.abs(e-k.colHeaderHeight)<=g?(a=b.getRowCount()-1,0<=a&&(f={action:"sizeRow",index:a,sheetArea:m.UI.SheetArea.rowHeader})):null===b._getLastVisualColumn(m.UI.SheetArea.colHeader)&&Math.abs(d-k.rowHeaderWidth)<=g&&(a=b.getColumnCount()-1,0<=a&&(f={action:"sizeCol",index:a,sheetArea:m.UI.SheetArea.colHeader})):0<=a.rowViewportIndex&&0<=
a.colViewportIndex&&(0===k.colHeaderHeight&&e<=g?(a=b.getRowCount(m.UI.SheetArea.colHeader)-1,0<=a&&(f={action:"sizeRow",index:a,sheetArea:m.UI.SheetArea.colHeader})):0===k.rowHeaderWidth&&d<=g&&(a=b.getColumnCount(m.UI.SheetArea.rowHeader)-1,0<=a&&(f={action:"sizeCol",index:a,sheetArea:m.UI.SheetArea.rowHeader})))}return f},getDragInfo:function(a,d,e){var b=null,f=this._sheet,g=f._getActiveSelectedRange();if(-1===g.row&&-1===g.col)return b;0<=a.rowViewportIndex&&0<=a.colViewportIndex&&1===f._selectionModel.length&&
(a=f._getActiveSelectionRect(a.rowViewportIndex,a.colViewportIndex),a.x-4<d&&d<a.x+4&&a.y<=e&&e<a.y+a.height&&(b={action:"drag",side:"left"}),b||(f=this._sheet._dragFillIndicatorRect)&&f.x<=d&&d<=f.x+f.width&&f.y<=e&&e<=f.y+f.height&&(b={action:"drag",side:"corner"}),b||a.x+a.width-4<d&&d<a.x+a.width+4&&a.y<=e&&e<a.y+a.height&&(b={action:"drag",side:"right"}),b||a.y-4<e&&e<a.y+4&&a.x<=d&&d<a.x+a.width&&(b={action:"drag",side:"top"}),b||a.y+a.height-4<e&&e<a.y+a.height+4&&a.x<=d&&d<a.x+a.width&&(b=
{action:"drag",side:"bottom"}),b&&(d<a.x||d>a.x+a.width||e<a.y||e>a.y+a.height)&&(b.outside=!0));!this._sheet.canUserDragDrop()&&b&&"corner"!==b.side&&(b.side=null);!this._sheet.canUserDragFill()&&b&&"corner"===b.side&&(b.side=null);return b},doMouseMove:function(a){var d=this._getCanvasOffset();this.doMouseMoveImp(a,a.pageX-d.left,a.pageY-d.top)},doMouseOut:function(a){a=this._sheet;var d=a._currentTarget;d&&d.cellTypeHitInfo&&a.getCellType(d.row,d.col,d.hitTestType).processMouseLeave(d.cellTypeHitInfo);
this.isMouseDown||a._setHoverCell({x:-1E4,y:-1E4,rowViewportIndex:null,colViewportIndex:null,row:-1,col:-1,resizeInfo:null,hitTestType:null})},doMouseMoveImp:function(a,d,e){var b=this._sheet;this.isMouseDown&&!p.gcGlobal.activeElement&&(p.gcGlobal.activeElement=b);if(this.isMouseDown&&this.isWorking){var f=b._currentTarget,g=f.resizeInfo;if(g){if(f.x!==d||f.y!==e)if(a=b._getSheetLayout(),-1===f.rowViewportIndex&&-1===f.colViewportIndex&&(f.rowViewportIndex=1,f.colViewportIndex=1),"sizeRow"===g.action){d=
b._getRowLayout(f.rowViewportIndex,g.sheetArea);g.index=this._getPrevVisualRowBeforeFindRow(g.index,g.sheetArea);var k=d.findRow(g.index);k||(k=d.findRow(f.row));g.startY=k.y;g.movingY=e;g.movingY<k.y&&(g.movingY=k.y);f=a.y+a.height;g.movingY>f&&(g.movingY=f);b._render.update(a.x,g.startY,a.width,a.height-g.startY,!0)}else e=b._getColumnLayout(f.colViewportIndex,g.sheetArea),g.index=this._getPrevVisualColBeforeFindCol(g.index,g.sheetArea),(k=e.findCol(g.index))||(k=e.findCol(f.col)),g.startX=k.x,
g.movingX=d,g.movingX<k.x&&(g.movingX=k.x),f=a.x+a.width,g.movingX>f&&(g.movingX=f),b._render.update(g.startX,a.y,a.width-g.startX,a.height,!0)}else f.dragInfo&&"corner"!==f.dragInfo.side?this.continueDragDropping(a,d,e):f.dragInfo&&"corner"===f.dragInfo.side?this.continueDragFill(a,d,e):this.continueSelecting(a,d,e)}else if(g=b.hitTest(d,e))if(f=b._getCanvas())d=b._currentTarget,a=!d||g.row!==d.row||g.col!==d.col||g.hitTestType!==d.hitTestType||g.resizeInfo&&!d.resizeInfo||!g.resizeInfo&&d.resizeInfo||
g.resizeInfo&&g.resizeInfo.action!==d.resizeInfo.action||g.dragInfo&&!d.dragInfo||!g.dragInfo&&d.dragInfo||g.dragInfo&&g.dragInfo.action!==d.dragInfo.action,d&&a&&d.cellTypeHitInfo&&(e=d.row,k=d.col,e=b.getCellType(e,k,d.hitTestType),e.processMouseLeave(d.cellTypeHitInfo)),(d=g.resizeInfo)?f.style.cursor="sizeCol"===d.action?"w-resize":"sizeRow"===d.action?"n-resize":"default":(d=g.dragInfo)&&"drag"===d.action?"corner"===d.side?f.style.cursor="crosshair":d.side&&(f.style.cursor="move"):(g.cellTypeHitInfo&&
(e=g.row,k=g.col,e=b.getCellType(e,k,g.hitTestType),g.cellTypeHitInfo.sheet=b,a&&e.processMouseEnter(g.cellTypeHitInfo),e.processMouseMove(g.cellTypeHitInfo)),!a&&g.cellTypeHitInfo&&g.cellTypeHitInfo.isReservedLocation||(f.style.cursor="default")),g&&b._setHoverCell(g)},doMouseUp:function(a){var d=this._sheet;d.inCanvas||this.unhandleDocumentMouseMove();var e=this._getCanvasOffset();this.doMouseUpImp(a,a.pageX-e.left,a.pageY-e.top);e=d._isMouseDownInSheet;return!e},doMouseUpImp:function(a,d,e){d=
this._sheet;if(!0===d._isMouseDownInSheet){d._isMouseDownInSheet=!1;e=p.gcGlobal.activeElement;this.isMouseDown=!1;e&&e!==d&&e.endEdit&&(e.endEdit(),e.repaint());if(e=d._currentTarget){e=e.resizeInfo;var b,f,g;if(e){if("sizeRow"===e.action){if(void 0!==e.movingY&&null!==e.movingY){b=Math.max(0,(e.movingY-e.startY)/d._zoomFactor);var k=[];if(d._isRowSelected(e.index))for(f=0;f<d._selectionModel.length;f++)g=d._selectionModel[f],-1===g.col&&(g=d._getActualRange(g),k.push({firstRow:g.row,lastRow:g.row+
g.rowCount-1}));else k.push({firstRow:e.index,lastRow:e.index});e=new m.UI.UndoRedo.RowResizeUndoAction(d,k,b,e.sheetArea===m.UI.SheetArea.colHeader);d._doCommand(e)}}else if(void 0!==e.movingX&&null!==e.movingX){b=Math.max(0,(e.movingX-e.startX)/d._zoomFactor);k=[];if(d._isColumnSelected(e.index))for(f=0;f<d._selectionModel.length;f++)g=d._selectionModel[f],-1===g.row&&(g=d._getActualRange(g),k.push({firstCol:g.col,lastCol:g.col+g.colCount-1}));else k.push({firstCol:e.index,lastCol:e.index});e=new m.UI.UndoRedo.ColumnResizeUndoAction(d,
k,b,e.sheetArea===m.UI.SheetArea.rowHeader);d._doCommand(e)}this.isWorking=!1}else d._currentTarget.dragInfo&&!this.isDraggingFill?(this.stopDragDrop(a),d._currentTarget=null):d._currentTarget.dragInfo&&!0===this.isDraggingFill?(this.endDragFill(a),d._currentTarget=null):(d._currentTarget.cellTypeHitInfo&&(e=d.getCellType(d._currentTarget.row,d._currentTarget.col,d._currentTarget.hitTestType),d._currentTarget.cellTypeHitInfo.sheet=d,e.processMouseUp(d._currentTarget.cellTypeHitInfo)),d._currentTarget.cellTypeHitInfo&&
d._currentTarget.cellTypeHitInfo.isReservedLocation||d._trigger(m.UI.Events.CellClick,{sheet:d,sheetName:d._name,sheetArea:d._currentTarget.hitTestType,row:d._currentTarget.row,col:d._currentTarget.col}))}p.gcGlobal.activeElement=d;this.stopSelecting();this.setMetaKeyState(a)}},startEdit:function(a){var d=this._sheet,e=d._getCanvas(),b=this._getCanvasOffset();a.shiftKey||a.ctrlKey||d._doStartEdit(e,a.pageX-b.left,a.pageY-b.top)},doKeyDown:function(a){this._sheet.isEditing()||a.ctrlKey||a.keyCode!==
m.UI.Key.pdn&&a.keyCode!==m.UI.Key.pup&&a.keyCode!==m.UI.Key.left&&a.keyCode!==m.UI.Key.right&&a.keyCode!==m.UI.Key.tab&&a.keyCode!==m.UI.Key.up&&a.keyCode!==m.UI.Key.down?this._keyDownImp(a):this._keyPressed?(5>this._keyPressedCount&&this._keyPressedCount++,m.UI.cancelDefault(a)):(this._keyPressed=!0,this._keyPressedCount=1,this._repeatKeyDown(a))},_repeatKeyDown:function(a){if(this._keyPressed){var d=this;d._keyDownImp(a);this._keyPressed&&p.setTimeout(function(){d._repeatKeyDown(a)},100/this._keyPressedCount)}},
_keyDownImp:function(a){var d=this._sheet;this.setMetaKeyState(a);a.keyCode===m.UI.Key.tab&&m.UI.cancelDefault(a);d.isEditing()||a.keyCode!==m.UI.Key.esc||a.altKey||a.ctrlKey||a.shiftKey||!d._validationInputMessage||(l(d._validationInputMessage).remove(),d._validationInputMessage=null);d.isEditing()||a.keyCode!==m.UI.Key.pdn&&a.keyCode!==m.UI.Key.pup&&a.keyCode!==m.UI.Key.end&&a.keyCode!==m.UI.Key.home&&a.keyCode!==m.UI.Key.up&&a.keyCode!==m.UI.Key.down||m.UI.cancelDefault(a);d.isEditing()||a.keyCode!==
m.UI.Key.left&&a.keyCode!==m.UI.Key.right||m.UI.cancelDefault(a);if(d._processKeyMap(a)){var e=d._getCanvas();if(e&&this.allowEnterEditing(a)){d._startEditByKeydown=!0;try{var b=d.isEditing();d._startEditImp(e,d._activeRowIndex,d._activeColIndex,null,null,!0);if(!b&&d.isEditing()){var f=d.getCellType(d._activeRowIndex,d._activeColIndex);!f._triggerButtonClicked||a.keyCode!==k.Key.space||a.ctrlKey||a.shiftKey||a.altKey||f._triggerButtonClicked(d,d._activeRowIndex,d._activeColIndex);f._cancelDefaultKeydown&&
f._cancelDefaultKeydown(a)}}finally{d._startEditByKeydown=!1}}}},doKeyUp:function(a){this._keyPressed=!1;this.setMetaKeyState(a)},allowEnterEditing:function(a){return a.ctrlKey||a.altKey?!1:65<=a.keyCode&&90>=a.keyCode||48<=a.keyCode&&57>=a.keyCode||96<=a.keyCode&&105>=a.keyCode||186<=a.keyCode&&192>=a.keyCode||220<=a.keyCode&&222>=a.keyCode||219===a.keyCode||106<=a.keyCode&&111>=a.keyCode||32===a.keyCode||61===a.keyCode||173===a.keyCode||229===a.keyCode||0===a.keyCode?!0:!1},setMetaKeyState:function(a){var d=
this._sheet;this.shift=a.shiftKey&&!a.ctrlKey;this.ctrl=a.ctrlKey&&!a.shiftKey;d._isNavigateInSelection=!1;if(a.keyCode===m.UI.Key.tab)if(1<d._selectionModel.length)d._isNavigateInSelection=!0;else{var e=d._getActiveSelectedRange();e&&0<d._selectionModel.length&&(d._isNavigateInSelection=!(d._activeRowIndex===e.row&&d._activeColIndex===e.col&&d._activeRowCount===e.rowCount&&d._activeColCount===e.colCount))}if(!0===this.isDragDropping){var e=d._getActiveSelectedRange(),b=this._isDragInsert,f=this._isDragCopy;
this._isDragInsert=-1===e.row||-1===e.col?a.shiftKey:!1;this._isDragCopy=a.ctrlKey;b===this._isDragInsert&&f===this._isDragCopy||d._render.refreshDragDropIndicator()}this.isShiftPressed=a.shiftKey;this.isControlPressed=a.ctrlKey},doMouseWheel:function(a,d){var e=this._sheet;if(e.endEdit()){if(a.ctrlKey){if(!e.parent||e.parent._allowUserZoom){var b=e._zoomFactor,f=e._zoomFactor-0.05*d,f=new m.UI.UndoRedo.ZoomUndoAction(e,f);e._doCommand(f);f=e._zoomFactor;b!==f&&e._trigger(m.UI.Events.UserZooming,
{sheet:e,sheetName:e._name,oldZoomFactor:b,newZoomFactor:f});return}}else b=e._scrollTopRow,0<e.frozenRowCount&&(0===e._scrollTopRow&&0<d?e._scrollTopRow=e.frozenRowCount:0>d&&e._scrollTopRow===e.frozenRowCount-d&&(e._scrollTopRow=0)),e._scrollTopRow+=d,e._scrollTopRow<e._getFirstPageTopRow()?e._scrollTopRow=e._getFirstPageTopRow():e._scrollTopRow>e._getLastVisualRow()&&(e._scrollTopRow=e._getLastVisualRow()),b!==e._scrollTopRow&&e._trigger(m.UI.Events.TopRowChanged,{sheet:e,sheetName:e._name,oldTopRow:b,
newTopRow:e._scrollTopRow}),this.scrolling=!0;e.invalidateLayout();e.repaint();e._syncVScrollbarPosition()}},waittime:100,scrollTop:0,scrollLeft:0,oldLeft:0,oldTop:0,doVScroll:function(a){var d=this._sheet;if(d.endEdit()){this.scrolling=!0;d._scrollTopRow=a;var e=this;this.scrollTimer||(this.scrollTimer=p.setInterval(function(){e._scrollView()},this.waittime))}},doHScroll:function(a){var d=this._sheet;if(d.endEdit()){this.scrolling=!0;d._scrollLeftCol=a;var e=this;this.scrollTimer||(this.scrollTimer=
p.setInterval(function(){e._scrollView()},this.waittime))}},_scrollView:function(){if(this.scrolling)this.scrolling=!1,this._updateView();else if(this.scrollTimer){p.clearInterval(this.scrollTimer);this.scrollTimer=null;this._sheet.repaint();var a=this.oldTop!==this._sheet._scrollTopRow;this.oldTop=this._sheet._scrollTopRow;this.oldLeft=this._sheet._scrollLeftCol;if(a){var a=this._sheet.getViewportTopRow(1),d=this._sheet.getViewportBottomRow(1),e=Math.max(0,a-60);e<this._sheet.getRowCount()&&this._loadData(e,
2*d-a)}}},_getLoadingProgress:function(a){var d=a+"_loading",e=l("#"+d);if(!e||0===e.length){var b=g.createElement("div"),e=l(b);e.attr("id",d);e.css("textAlign","center");e.css("background-color","#DCDCDC");g.body.insertBefore(b,null)}e.css("position","absolute");a=l("#"+a);d=a.position();e.css("left",d.left);e.css("top",d.top);e.css("width",a.width());e.css("height",a.height());return{show:function(){e.fadeIn("fast");e.append("postback and loading ...")},hide:function(){e.fadeOut("fast");e.html("")}}},
_loadData:function(a,d){if(this._sheet.parent&&this._sheet.parent._host)if(this._sheet.dataContext&&this._sheet.dataContext.read){var e=this;this._dataContextLoadDelegate=function(a,b){return e._dataContextLoaded(a,b)};this.lastLoadedRowIndex=a;jQuery.ajax({url:this._sheet.dataContext.read,type:"POST",data:JSON.stringify({index:a,count:d-a+1}),dataType:"json",contentType:"application/json;charset=UTF-8",success:this._dataContextLoadDelegate})}else{var b=this._sheet.parent._host.id;b&&0<b.length&&
"undefined"!==typeof p.WebForm_DoCallback&&(this.lastLoadedRowIndex=a,this._doLoadData(b,a,d))}},_dataContextLoaded:function(a,d){var e=a.data;if(e&&0<e.length){var b=this._sheet,f=b.getDataSource();if(f&&this.lastLoadedRowIndex===a.start)for(var g=0;g<e.length;g++)f[a.start+g]=e[g];b.recalcAll();b.repaint()}},_doCallBack:function(a,d){var e=this._sheet.parent._host.id;if(e&&0<e.length&&"undefined"!==typeof p.WebForm_DoCallback){var b=l(g.forms);if(b&&0!==b.length){b=b[0];b.__EVENTTARGET.value=e;
b.__EVENTARGUMENT.value=a;this._sheet.parent.saveData();p.__theFormPostCollection.length=0;p.__theFormPostData="";p.WebForm_InitCallback();p.__theFormPostData="gcallback=true&"+p.__theFormPostData;b.__EVENTVALIDATION&&(p.__theFormPostData+="&__EVENTVALIDATION="+WebForm_EncodeCallback(b.__EVENTVALIDATION.value));var b=b.action,f=this._getLoadingProgress(e);f&&f.show();var k=this;this._updateDelegate=function(a,b){f.hide();return k._onUpdateCallback(a,b)};this._errorDelegate=function(a,b){f.hide()};
l.ajax({url:b,type:"POST",data:p.__theFormPostData,dataType:"html",contentType:"application/x-www-form-urlencoded, charset=UTF-8",success:this._updateDelegate,error:this._errorDelegate})}}},_doLoadData:function(a,d,e){var b={start:d,end:e},f=this;if(this._sheet.hasPendingChanges()){if((b=l(g.forms))&&0!==b.length){b=b[0];b.__EVENTTARGET.value=a;b.__EVENTARGUMENT.value="loadData,"+d+","+e;this._sheet.parent.saveData();p.__theFormPostCollection.length=0;p.__theFormPostData="";p.WebForm_InitCallback();
p.__theFormPostData="gcallback=true&"+p.__theFormPostData;b.__EVENTVALIDATION&&(p.__theFormPostData+="&__EVENTVALIDATION="+WebForm_EncodeCallback(b.__EVENTVALIDATION.value));d=b.action;var k=this._getLoadingProgress(a);k&&k.show();this._updateDelegate=function(a,b){k.hide();return f._onUpdateCallback(a,b)};this._errorDelegate=function(a,b){k.hide()};l.ajax({url:d,type:"POST",data:p.__theFormPostData,dataType:"html",contentType:"application/x-www-form-urlencoded, charset=UTF-8",success:this._updateDelegate,
error:this._errorDelegate})}}else this._loadDataDelegate=function(a,b){return f._onLoadDataCallback(a,b)},this._sheet.parent.saveData(),p.__theFormPostCollection.length=0,p.__theFormPostData="",p.WebForm_InitCallback(),p.WebForm_DoCallback(a,"loadData,"+d+","+e,this._loadDataDelegate,b,null,!0)},_onUpdateCallback:function(a,d){this._sheet.clearPendingChanges();try{g.selection.empty()}catch(e){}var b=g.createElement("div");if(b){b.innerHTML=a;var f=l(g.forms);if(f&&0!==f.length){f=f[0];f.__EVENTTARGET.value=
"";f.__EVENTARGUMENT.value="";var f=g.getElementById("__VIEWSTATE"),k=this.getElementById(b,"__VIEWSTATE");f&&k&&(f.value=k.value);f=g.getElementById("__EVENTVALIDATION");k=this.getElementById(b,"__EVENTVALIDATION");f&&k&&(f.value=k.value);k=this._sheet.parent._host.id;f=g.getElementById(k+"_data");k=this.getElementById(b,k+"_data");f&&k&&(f.value=k.value);b.innerHTML="";this._sheet.parent._loadData(!0);this._sheet.parent.invalidateLayout();this._sheet.parent.repaint()}}},getElementById:function(a,
d){if(!a)return null;for(var e=a.firstChild;e;){if(e.id===d||e.name===d)return e;var b=this.getElementById(e,d);if(b)return b;e=e.nextSibling}return null},_onLoadDataCallback:function(a,d){if(a){var e=this._sheet,b=JSON.parse(a);if(b){var f=b.dataSource,g;if(f&&0<f.length){var k=e.getDataSource();if(k&&this.lastLoadedRowIndex===d.start)for(f=JSON.parse(f),g=0;g<f.length;g++)k[d.start+g]=f[g]}if((k=b.data)&&this.lastLoadedRowIndex===d.start){for(g in k)"function"!==typeof g&&(e._dataModel.dataTable[g]=
k[g]);if(b.rows)for(g in b.rows)"function"!==typeof g&&(e._rowInfos[g]=b.rows[g]);e.suspendCalcService();e.suspendEvent();e.isPaintSuspended(!0);b=e.getColumnCount();for(g in k)if("function"!==typeof g&&(f=k[g]))for(var l=0;l<b;l++){var m=null;f[l]&&(m=f[l].formula);m&&(f[l].formula=null,e.setFormula(parseInt(g,10),l,m))}e.resumeCalcService();e.resumeEvent();e.isPaintSuspended(!1)}e.suspendEvent();e.isPaintSuspended(!0);e.recalcAll();e.resumeEvent();e.isPaintSuspended(!1);e.clearPendingChanges();
e.repaint()}}},_updateView:function(){var a=this._sheet;if(!this.painting){this.painting=!0;var d=!1;this.oldTop!==a._scrollTopRow&&this.oldLeft===a._scrollLeftCol?d=this._vScrollView(a):this.oldTop===a._scrollTopRow&&this.oldLeft!==a._scrollLeftCol&&(d=this._hScrollView(a));d||(a.invalidateLayout(),a.repaint());this.painting=!1}},_vScrollView:function(a){var d=!1,e=this.oldTop,b;if(a._scrollTopRow>e){if(e=a._getRowLayout(1,m.UI.SheetArea.viewport).findRow(a._scrollTopRow))d=!0,b=a._getSheetLayout(),
a._render.translateScreen(b.x,e.y,b.rowHeaderWidth+b.frozenWidth+b.viewportWidth,b.viewportHeight-e.y,b.x,b.viewportY),a.invalidateLayout(),a._render.update(b.x,b.viewportY+b.viewportHeight-e.y,b.rowHeaderWidth+b.frozenWidth+b.viewportWidth,e.y,!1)}else{b=a._getSheetLayout();for(var f=0,g=a._scrollTopRow;g<e&&f<b.viewportHeight;g++)f+=a._getZoomRowHeight(g);f<b.viewportHeight&&(d=!0,a._render.translateScreen(b.x,b.viewportY,b.rowHeaderWidth+b.frozenWidth+b.viewportWidth,b.viewportHeight-f,b.x,b.viewportY+
f),a.invalidateLayout(),a._render.update(b.x,b.viewportY,b.rowHeaderWidth+b.frozenWidth+b.viewportWidth,f,!1))}return d},_hScrollView:function(a){var d=!1,e=this.oldLeft,b;if(a._scrollLeftCol>e){if(e=a._getColumnLayout(1,m.UI.SheetArea.viewport).findCol(a._scrollLeftCol))d=!0,b=a._getSheetLayout(),a._render.translateScreen(e.x,b.y,b.viewportWidth-e.x,b.colHeaderHeight+b.frozenHeight+b.viewportHeight,b.viewportX,b.y),a.invalidateLayout(),a._render.update(b.viewportX+b.viewportWidth-e.x,b.y,e.x,b.colHeaderHeight+
b.frozenHeight+b.viewportHeight,!1)}else{b=a._getSheetLayout();for(var f=0,g=a._scrollLeftCol;g<e&&f<b.viewportWidth;g++)f+=a._getZoomColumnWidth(g);f<b.viewportWidth&&(d=!0,a._render.translateScreen(b.viewportX,b.y,b.viewportWidth-f,b.colHeaderHeight+b.frozenHeight+b.viewportHeight,b.viewportX+f,b.y),a.invalidateLayout(),a._render.update(b.viewportX,b.y,f,b.colHeaderHeight+b.frozenHeight+b.viewportHeight,!1))}return d},_notEqualSelecions:function(a,d){var e=!0;if(a.length===d.length)for(var b=0;b<
a.length;b++){var e=a[b],f=d[b];if(e.row!==f.row||e.col!==f.col||e.rowCount!==f.rowCount||e.colCount!==f.colCount){e=!0;break}else e=!1}return e},_setFocus:function(){if(!this._focusHolder){var a=g.createElement("div");a.style.position="relative";a.style.overflow="hidden";a.style.width="0px";a.style.height="0px";var d=null,e=this._sheet._getCanvas();e&&(d=e.parentNode);d&&d.insertBefore(a,e);this._focusHolder=a}this._focusElem||(a=g.createElement("input"),a.type="text",a.style.position="absolute",
a.className="gcSheetFocusInputStyle",a.setAttribute("gcUIElement","gcSheetFocusInput"),this._focusHolder.insertBefore(a,null),this._focusElem=a);var b;this._hitTestResult?(a=this._hitTestResult.row,d=this._hitTestResult.col,e=this._hitTestResult.rowViewportIndex,b=this._hitTestResult.colViewportIndex):(a=this._sheet.getActiveRowIndex(),d=this._sheet.getActiveColumnIndex(),e=this._sheet.activeRowViewportIndex,b=this._sheet.activeColViewportIndex);a=this._sheet._getRangeRect(e,b,{row:a,col:d,rowCount:1,
colCount:1});this._focusHolder.style.left=""+(a.x+1)+"px";this._focusHolder.style.top=""+(a.y+1)+"px";g.body.focus();this._focusElem.focus();p.gcGlobal.activeElement||(p.gcGlobal.activeElement=this._sheet,this._sheet._eventHandler&&this._sheet._eventHandler._updateValidationUI(this._sheet._activeRowIndex,this._sheet._activeColIndex))},bind:function(a,d,e){l(this._getElem()).bind(a,d,e)},unbind:function(a,d){l(this._getElem()).unbind(a,d)},trigger:function(a,d){0===this._eventSuspended&&l(this._getElem()).trigger(a,
d)}};k.Events={ValidationError:"ValidationError",CellClick:"CellClick",CellDoubleClick:"CellDoubleClick",EnterCell:"EnterCell",LeaveCell:"LeaveCell",ValueChanged:"ValueChanged",TopRowChanged:"TopRowChanged",LeftColumnChanged:"LeftColumnChanged",InvalidOperation:"InvalidOperation",RangeFiltering:"RangeFiltering",RangeFiltered:"RangeFiltered",RangeSorting:"RangeSorting",RangeSorted:"RangeSorted",ClipboardChanging:"ClipboardChanging",ClipboardChanged:"ClipboardChanged",ClipboardPasting:"ClipboardPasting",
ClipboardPasted:"ClipboardPasted",ColumnWidthChanging:"ColumnWidthChanging",ColumnWidthChanged:"ColumnWidthChanged",RowHeightChanging:"RowHeightChanging",RowHeightChanged:"RowHeightChanged",DragDropBlock:"DragDropBlock",DragDropBlockCompleted:"DragDropBlockCompleted",DragFillBlock:"DragFillBlock",DragFillBlockCompleted:"DragFillBlockCompleted",EditStarting:"EditStarting",EditChange:"EditChange",EditEnd:"EditEnd",RangeGroupStateChanging:"RangeGroupStateChanging",RangeGroupStateChanged:"RangeGroupStateChanged",
SelectionChanging:"SelectionChanging",SelectionChanged:"SelectionChanged",SheetTabClick:"SheetTabClick",SheetTabDoubleClick:"SheetTabDoubleClick",SheetTabEditEnd:"SheetTabEditEnd",UserZooming:"UserZooming",UserFormulaEntered:"UserFormulaEntered",CellChanged:"CellChanged",ColumnChanged:"ColumnChanged",RowChanged:"RowChanged",ActiveSheetChanging:"ActiveSheetChanging",ActiveSheetChanged:"ActiveSheetChanged",SparklineChanged:"SparklineChanged",RangeChanged:"RangeChanged",ButtonClicked:"ButtonClicked",
EditorStatusChanged:"EditorStatusChanged"}})(window,jQuery);
(function(p){function l(g,a){for(var d=0;d<g.length;d++){var e=g[d];if(a(e))return e}return null}var m=p.GrapeCity;"undefined"===typeof m&&(m={});"undefined"===typeof m.UI&&(m.UI={});var k=m.UI;k.Range=function(g,a,d,e){this.row=g;this.rowCount=d;this.col=a;this.colCount=e};k.Range.prototype={intersect:function(g,a,d,e){return(-1===g||-1===this.row||this.row<g+d&&g<this.row+this.rowCount)&&(-1===a||-1===this.col||this.col<a+e&&a<this.col+this.colCount)},contains:function(g,a,d,e){if(2===arguments.length)return(-1===
this.row||this.row<=g&&g<this.row+this.rowCount)&&(-1===this.col||this.col<=a&&a<this.col+this.colCount);if(4===arguments.length)return this.containsRange(new k.Range(g,a,d,e))},containsRange:function(g){return(-1===this.row||this.row<=g.row&&g.row+g.rowCount<=this.row+this.rowCount)&&(-1===this.col||this.col<=g.col&&g.col+g.colCount<=this.col+this.colCount)},offset:function(g,a){var d=this.col,e=this.row;-1!==this.col&&(d+=g);-1!==this.row&&(e+=a);return new k.Range(e,d,this.rowCount,this.colCount)},
union:function(g){var a=Math.min(this.row,g.row),d=Math.min(this.col,g.col),e=Math.max(this.row+this.rowCount-1,g.row+g.rowCount-1);g=Math.max(this.col+this.colCount-1,g.col+g.colCount-1);return new k.Range(a,d,e-a+1,g-d+1)},equals:function(g){return g instanceof k.Range?this.row===g.row&&this.col===g.col&&this.rowCount===g.rowCount&&this.colCount===g.colCount:!1}};k.SheetArea={corner:0,colHeader:1,rowHeader:2,viewport:3};k.CopyToOption={Value:1,Formula:2,RangeGroup:8,Sparkline:16,Span:32,Style:64,
Tag:128,BindingPath:256};p=k.CopyToOption;p.All=p.Value|p.Formula|p.RangeGroup|p.Sparkline|p.Span|p.Style|p.Tag|p.BindingPath;k.SelectionPolicy={Single:0,Range:1,MultiRange:2};k.SelectionUnit={Cell:0,Row:1,Column:2};k._SpanModel=function(){};k._SpanModel.prototype=[];p=k._SpanModel.prototype;p.find=function(g,a){return l(this,function(d){return d.contains(g,a)})};p.remove=function(g){for(var a=0;a<this.length;a++)if(this[a]===g){this.splice(a,1);break}};p.copy=function(g,a,d,e,b,f){var l=this.length,
q,m,r;if(-1===g)for(r=[],m=0;m<l;m++)q=this[m],a<=q.col&&q.col<a+f?r.push(new k.Range(q.row,e+q.col-a,q.rowCount,q.colCount)):e<=q.col&&q.col<e+f&&(this.splice(m,1),m--,l--);else if(-1===a)for(r=[],m=0;m<l;m++)q=this[m],g<=q.row&&q.row<g+b?r.push(new k.Range(d+q.row-g,q.col,q.rowCount,q.colCount)):d<=q.row&&q.row<d+b&&(this.splice(m,1),m--,l--);else for(r=[],m=0;m<l;m++)q=this[m],g<=q.row&&q.row<g+b&&a<=q.col&&q.col<a+f?r.push(new k.Range(d+q.row-g,e+q.col-a,q.rowCount,q.colCount)):d<=q.row&&q.row<
d+b&&e<=q.col&&q.col<e+f&&(this.splice(m,1),m--,l--);for(m=0;m<r.length;m++){g=r[m];if(!this.isValid(this,0,this.length,g))throw Error("This operation will cause overlapping spans.");this.push(g)}};p.isValid=function(g,a,d,e){for(;a<d&&a<g.length;a++)if(g[a].intersect(e.row,e.col,e.rowCount,e.colCount))return!1;return!0};p.getEnumerator=function(g,a,d,e){return new k._SpanEnumerator(this,g,a,d,e)};p.clear=function(g,a,d,e){for(var b=0;b<this.length;b++){var f=this[b];(-1===g||g<=f.row&&f.row<g+d)&&
(-1===a||a<=f.col&&f.col<a+e)&&this.splice(b--,1)}};p.move=function(g,a,d,e,b,f){var l=!1,q=new k._SpanModel,m=[],r=this.length,u,n=k.Range,h;if(-1===g)for(h=0;h<r;h++)u=this[h],a<=u.col&&u.col<a+f?(l=new n(u.row,e+u.col-a,u.rowCount,u.colCount),m.push(l),l=!0):e<u.col&&u.col<e+f?l=!0:q.push(u);else if(-1===a)for(h=0;h<r;h++)u=this[h],g<=u.row&&u.row<g+b?(l=new n(d+u.row-g,u.col,u.rowCount,u.colCount),m.push(l),l=!0):d<=u.row&&u.row<d+b?l=!0:q.push(u);else for(h=0;h<r;h++)u=this[h],g<=u.row&&u.row<
g+b&&a<=u.col&&u.col<a+f?(l=new n(d+u.row-g,e+u.col-a,u.rowCount,u.colCount),m.push(l),l=!0):d<=u.row&&u.row<d+b&&e<=u.col&&u.col<e+f?l=!0:q.push(u);if(l){if(0<m.length)for(h=0;h<m.length;h++){l=m[h];if(!this.isValid(q,0,q.length,l))throw Error("This operation will cause overlapping spans.");q.push(l)}for(h=this.length=0;h<q.length;h++)this.push(q[h])}};p.isEmpty=function(){return 0>=this.length?!0:!1};p.addRows=function(g,a){for(var d=this.length,e=k.Range,b=0;b<d;b++){var f=this[b];f.row>=g?this[b]=
new e(f.row+a,f.col,f.rowCount,f.colCount):f.row<g&&g<f.row+f.rowCount&&(this[b]=new e(f.row,f.col,f.rowCount+a,f.colCount))}};p.addColumns=function(g,a){for(var d=this.length,e=k.Range,b=0;b<d;b++){var f=this[b];f.col>=g?this[b]=new e(f.row,f.col+a,f.rowCount,f.colCount):f.col<g&&g<f.col+f.colCount&&(this[b]=new e(f.row,f.col,f.rowCount,f.colCount+a))}};p.removeRows=function(g,a){var d=[],e=this.length,b=k.Range,f;for(f=0;f<e;f++){var l=this[f];l.row>=g?l.row<g+a?d.push(f):this[f]=new b(l.row-a,
l.col,l.rowCount,l.colCount):l.row<g&&g<l.row+l.rowCount&&(this[f]=new b(l.row,l.col,l.rowCount-Math.min(l.row+l.rowCount-g,a),l.colCount),1===this[f].rowCount&&1===this[f].colCount&&d.push(f))}for(f=0;f<d.length;f++)this.splice(d[f],1)};p.removeColumns=function(g,a){var d=[],e=this.length,b=k.Range,f;for(f=0;f<e;f++){var l=this[f];l.col>=g?l.col<g+a?d.push(f):this[f]=new b(l.row,l.col-a,l.rowCount,l.colCount):l.col<g&&g<l.col+l.colCount&&(this[f]=new b(l.row,l.col,l.rowCount,l.colCount-Math.min(l.col+
l.colCount-g,a)),1===this[f].rowCount&&1===this[f].colCount&&d.push(f))}for(f=0;f<d.length;f++)this.splice(d[f],1)};p.toJSON=function(){return this};p.fromJSON=function(g){if(g)for(var a=0;a<g.length;a++){var d=g[a];this.push(new k.Range(d.row,d.col,d.rowCount,d.colCount))}};k._SpanEnumerator=function(g,a,d,e,b){this.model=g;this.row=a;this.column=d;this.rowCount=e;this.columnCount=b;this.currentIndex=-1;-1===a&&-1===d&&(this.all=!0)};k._SpanEnumerator.prototype={current:function(){return 0<=this.currentIndex&&
this.currentIndex<this.model.length?this.model[this.currentIndex]:null},moveNext:function(){this.currentIndex++;if(!this.all)for(;this.currentIndex<this.model.length&&!this.model[this.currentIndex].intersect(this.row,this.column,this.rowCount,this.columnCount);)this.currentIndex++;return this.currentIndex<this.model.length},reset:function(){this.currentIndex=-1}};k._CellOverflowLayoutModel=function(){};k._CellOverflowLayoutModel.prototype=[];k._CellOverflowLayoutModel.prototype.find=function(g){return l(this,
function(a){return a.contains(g)})};k._CellOverflowLayout=function(g,a,d,e,b,f,k){this.column=g;this.startCol=a;this.endCol=d;this.columnWidth=b;this.hAlign=f;this.columnPrevWidth=k};k._CellOverflowLayout.prototype.contains=function(g){return g>=this.startCol&&g<=this.endCol};k._CellOverflowValueLayoutModel=function(){};k._CellOverflowValueLayoutModel.prototype=[];k._CellOverflowValueLayoutModel.prototype.find=function(g){return l(this,function(a){return a.contains(g)})};k._CellOverflowValueLayout=
function(g,a,d,e,b,f,k,l,m){this.data=g;this.row=a;this.col=d;this.x=e;this.y=b;this.width=f;this.height=k;this.sheetArea=l;this.cellOverflowLayout=m};k._CellOverflowValueLayout.prototype.contains=function(g){return g===this.cellOverflowLayout.column};k._SelectionModel=function(){this.selectionPolicy=k.SelectionPolicy.MultiRange;this.selectionUnit=k.SelectionUnit.Cell};k._SelectionModel.prototype=[];p=k._SelectionModel.prototype;p.find=function(g,a){return l(this,function(d){return d.contains(g,a)})};
p.clear=function(){this.splice(0,this.length);this.activeSelectedRangeIndex=-1};p.add=function(g,a,d,e){this.selectionPolicy===k.SelectionPolicy.Single?(d=Math.min(d,1),e=Math.min(e,1),this.clear()):this.selectionPolicy===k.SelectionPolicy.Range&&this.clear();this.selectionUnit===k.SelectionUnit.Row?e=a=-1:this.selectionUnit===k.SelectionUnit.Column&&(d=g=-1);g=new k.Range(g,a,d,e);this.push(g);this.activeSelectedRangeIndex=this.length-1};p.toArray=function(){for(var g=[],a=0;a<this.length;a++)g.push(this[a]);
return g};p.toJSON=function(){return this};p.fromJSON=function(g){if(g){for(var a=g.length,d=0;d<a;d++){var e=g[d];this.push(new k.Range(e.row,e.col,e.rowCount,e.colCount))}void 0!==g.activeSelectedRangeIndex&&null!==g.activeSelectedRangeIndex&&(this.activeSelectedRangeIndex=g.activeSelectedRangeIndex)}};k._LayoutModel=function(){};k._LayoutModel.prototype=[];p=k._LayoutModel.prototype;p.findCell=function(g,a){return l(this,function(d){return d.contains(g,a)})};p.findRow=function(g){return l(this,
function(a){return a.row===g})};p.findCol=function(g){return l(this,function(a){return a.col===g})};k._Layout=function(g,a,d,e,b,f,k,l){this.rowCount=k;this.colCount=l;this.row=g;this.col=a;this.x=d;this.y=e;this.width=b;this.height=f};k._Layout.prototype.contains=function(g,a){return g<this.row+this.rowCount&&this.row<=g&&a<this.col+this.colCount&&this.col<=a};k._Layout.prototype.intersect=function(g){return(0>this.x||g.x<this.x+this.width&&this.x<g.x+g.width)&&(0>this.y||g.y<this.y+this.height&&
this.y<g.y+g.height)};k._GcSheetModel=function(g,a,d){this.rowCount=null!==g&&void 0!==g?g:200;this.colCount=null!==a&&void 0!==a?a:20;this.name=d;this.dataTable={};this._rowDataArray=[];this._columnDataArray=[];this._defaultDataNode=null;this.dirtyNodes={}};k._GcSheetModel.prototype={getRowCount:function(){return this.rowCount},getColumnCount:function(){return this.colCount},_updateDirty:function(g,a){if(0<=g&&0<=a){var d=this.dataTable[g];"n"!==d.rs&&(d.rs="e");this.dirtyNodes[g]=d}},getValue:function(g,
a){var d=this.getNode(g,a);return d&&void 0!==d.value&&null!==d.value?d.value:null},setValue:function(g,a,d){var e=this.getNode(g,a,!0);e.value!==d&&(e.value=d,this._updateDirty(g,a))},getBindingPath:function(g,a){var d=this.getNode(g,a);return d&&void 0!==d.bindingPath&&null!==d.bindingPath?d.bindingPath:null},setBindingPath:function(g,a,d){var e=this.getNode(g,a,!0);e.bindingPath!==d&&(e.bindingPath=d,this._updateDirty(g,a))},getSparkline:function(g,a){var d=this.getNode(g,a);return d&&d.sparkline?
d.sparkline:null},setSparkline:function(g,a,d){var e=this.getNode(g,a,!0);e.sparkline!==d&&(e.sparkline=d,this._updateDirty(g,a))},setFormula:function(g,a,d){var e=this.getNode(g,a,!0);e.formula!==d&&(e.formula=d,this._updateDirty(g,a))},getFormula:function(g,a){var d=this.getNode(g,a);if(d)return d.formula},getStyle:function(g,a){var d=this.getNode(g,a);if(d)return d.style},setStyle:function(g,a,d){var e=this.getNode(g,a,!0);e&&e.style!==d&&(e.style=d,this._updateDirty(g,a))},getVisualState:function(g,
a){var d=this.getNode(g,a);if(d)return d.visualState},setVisualState:function(g,a,d){var e=this.getNode(g,a,!0);e.visualState!==d&&(e.visualState=d,this._updateDirty(g,a))},addRows:function(g,a){if(!(0>g||g>this.rowCount||0>a)){this.addElements(this.dataTable,this.rowCount,g,a);this.addElements(this._rowDataArray,this.rowCount,g,a);this.addElements(this.dirtyNodes,this.rowCount,g,a);this.rowCount+=a;for(var d=0;d<a;d++)this.dataTable[g+d]={rs:"n"},this.dirtyNodes[g+d]=this.dataTable[g+d]}},deleteRows:function(g,
a){var d=this.rowCount;0>g||g>=d||0>=a||(g+a>d&&(a=d-g),this.deleteElements(this.dataTable,d,g,a),this.deleteElements(this._rowDataArray,d,g,a),this.deleteElements(this.dirtyNodes,d,g,a),this.rowCount-=a)},addElements:function(g,a,d,e){if(0<=d&&d<a){a=[];for(var b in g)g.hasOwnProperty(b)&&!isNaN(b)&&b>=d&&a.push(b);a.sort(function(a,b){return a-b});for(d=0;d<a.length;d++){b=a[a.length-d-1];var f=g[b];g[b]=null;g[parseInt(b,10)+e]=f}}},deleteElements:function(g,a,d,e){if(0<=d&&d<a){a=[];for(var b in g)g.hasOwnProperty(b)&&
!isNaN(b)&&(d<=b&&b<d+e?g[b]=null:b>=d+e&&a.push(b));a.sort(function(a,b){return a-b});for(d=0;d<a.length;d++){b=a[d];var f=g[b];g[b]=null;g[parseInt(b,10)-e]=f}}},addColumns:function(g,a){if(!(0>g||g>this.colCount||0>a)){for(var d=0;d<this.rowCount;d++){var e=this.dataTable[d];e&&g<this.colCount&&this.addElements(e,this.colCount,g,a)}this.addElements(this._columnDataArray,this.colCount,g,a);this.colCount+=a}},deleteColumns:function(g,a){var d=this.colCount;if(!(0>g||g>=d||0>a)){for(var e=0;e<this.rowCount;e++){var b=
this.dataTable[e];b&&g<this.colCount&&this.deleteElements(b,this.colCount,g,a)}this.deleteElements(this._columnDataArray,this.colCount,g,a);g+a>d&&(a=d-g);this.colCount-=a}},getNode:function(g,a,d){if(g>=this.rowCount||a>=this.colCount)return null;var e=null;if(0<=g&&0<=a){var b=this.dataTable[g];!b&&d&&(b=this.dataTable[g]={});b&&(e=b[a],!e&&d&&(e=b[a]={}))}else-1===g&&0<=a?(e=this._columnDataArray[a],!e&&d&&(e=this._columnDataArray[a]={})):0<=g&&-1===a?(e=this._rowDataArray[g],!e&&d&&(e=this._rowDataArray[g]=
{})):-1===g&&-1===a&&(e=this._defaultDataNode,!e&&d&&(e=this._defaultDataNode={}));return e},_setNode4Swap:function(g,a,d,e,b){0<=d&&0<=e?((g=this.dataTable[d])||(g=this.dataTable[d]={}),(g[e]=b)&&b.cellCalc&&delete b.cellCalc):0<=d&&-1===e&&0<=g&&-1===a?this._rowDataArray[d]=b:0<=e&&-1===d&&0<=a&&-1===g&&(this._columnDataArray[e]=b)},swapNode:function(g,a,d,e){var b=this.getNode(g,a),f=this.getNode(d,e);b?this._setNode4Swap(g,a,d,e,b):f&&this._setNode4Swap(g,a,d,e,null);f?this._setNode4Swap(d,e,
g,a,f):b&&this._setNode4Swap(d,e,g,a,null)},getDataRowIndex:function(g){return g},nextNonNullRow:function(g){for(g++;0<=g&&g<this.rowCount&&(!this.dataTable.hasOwnProperty(g)||!this.dataTable[g]);)g++;return g<this.rowCount?g:-1},nextNonNullColumn:function(g,a){var d=null;0<=g&&g<this.rowCount&&this.dataTable.hasOwnProperty(g)&&(d=this.dataTable[g]);if(!d)return-1;for(a++;0<=a&&a<this.colCount&&(!d.hasOwnProperty(a)||!d[a]);)a++;return a<this.colCount?a:-1},clear:function(g,a,d,e,b){var f=[],l,m,
t;if(0<=g&&0<=a){g+d>this.rowCount&&(d=this.rowCount-g);if(0>=d)return;a+e>this.columnCount&&(e=this.columnCount-a);if(0>=e)return;for(t=g;t<g+d;t++)for(m=a;m<a+e;m++)(l=this.getNode(t,m))&&f.push(l)}else if(0<=g&&-1===a){g+d>this.rowCount&&(d=this.rowCount-g);if(0>=d)return;for(t=g;t<g+d;t++)(l=this.getNode(t,-1))&&f.push(l)}else if(-1===g&&0<=a){a+e>this.columnCount&&(e=this.columnCount-a);if(0>=e)return;for(m=a;m<a+e;m++)(l=this.getNode(-1,m))&&f.push(l)}else-1===g&&-1===a&&(l=this._defaultDataNode)&&
f.push(l);for(g=0;g<f.length;g++)f[g]&&(0<(b&k.StorageType.Style)&&(f[g].style=null),0<(b&k.StorageType.Data)&&(f[g].value=null,f[g].formula=null),0<(b&k.StorageType.Sparkline)&&(f[g].sparkline=null),0<(b&k.StorageType.BindingPath)&&(f[g].bindingPath=null))},toJSON:function(){return{name:this.name,rowCount:this.rowCount,colCount:this.colCount,dataTable:this.dataTable,_rowDataArray:this._rowDataArray,_columnDataArray:this._columnDataArray,_defaultDataNode:this._defaultDataNode}},fromJSON:function(g){if(g){this.name=
g.name;this.rowCount=g.rowCount;this.colCount=g.colCount;var a=g.dataTable;if(a){var d=new m.UI._GcSheetModel(this.rowCount,this.colCount);d.dataTable=a;for(a=d.nextNonNullRow(-1);0<=a;){for(var e=d.nextNonNullColumn(a,-1);0<=e;){var b=d.getNode(a,e);b&&this._copyJSONNode(a,e,b);e=d.nextNonNullColumn(a,e)}a=d.nextNonNullRow(a)}}if(d=g._rowDataArray)for(a=0;a<this.rowCount;a++)d.hasOwnProperty(a)&&d[a]&&this._copyJSONNode(a,-1,d[a]);if(d=g._columnDataArray)for(e=0;e<this.colCount;e++)d.hasOwnProperty(e)&&
d[e]&&this._copyJSONNode(-1,e,d[e]);(g=g._defaultDataNode)&&this._copyJSONNode(-1,-1,g)}},_getCellTypeKinds:function(){if(!this._dict){var g={};g[k.CellTypeKind.BaseCellType]=k.BaseCellType;g[k.CellTypeKind.TextCellType]=k.TextCellType;g[k.CellTypeKind.ColumnHeaderCellType]=k.ColumnHeaderCellType;g[k.CellTypeKind.RowHeaderCellType]=k.RowHeaderCellType;g[k.CellTypeKind.CornerCellType]=k.CornerCellType;g[k.CellTypeKind.CheckBoxCellType]=k.CheckBoxCellType;g[k.CellTypeKind.ButtonCellType]=k.ButtonCellType;
g[k.CellTypeKind.ComboBoxCellType]=k.ComboBoxCellType;g[k.CellTypeKind.HyperLinkCellType]=k.HyperLinkCellType;this._dict=g}return this._dict},_copyJSONNode:function(g,a,d){if(d){"undefined"!==typeof d.value&&this.setValue(g,a,d.value);"undefined"!==typeof d.formula&&this.setFormula(g,a,d.formula);if("undefined"!==typeof d.style){var e=null;if(d.style){e=new k.Style;e.copyFrom(d.style);if("undefined"!==typeof d.style.validator){var b=new k.DefaultDataValidator;b.fromJSON(d.style.validator);e.validator=
b}if("undefined"!==typeof d.style.cellType){var b=null,f=this._getCellTypeKinds()[d.style.cellType.type];f&&(b=new f,b.fromJSON(d.style.cellType));e.cellType=b}}this.setStyle(g,a,e)}"undefined"!==typeof d.visualState&&this.setVisualState(g,a,d.visualState);"undefined"!==typeof d.bindingPath&&this.setBindingPath(g,a,d.bindingPath)}}};k._UndoManager=function(g,a,d){this._context=g;0>parseInt(a,10)&&(a=2147483647);this._maxLength=a;this._allowUndo=d;this._undoStack=[];this._redoStack=[]};k._UndoManager.prototype=
{changed:null,context:function(){return this._context},canUndo:function(){return 0<this._undoStack.length},canRedo:function(){return 0<this._redoStack.length},_shrinkUndoStack:function(g){for(var a=0;a<g;a++)this._undoStack.shift()},_raiseChanged:function(){this.changed&&"function"===typeof this.changed&&this.changed(this)},doAction:function(g){if(!g||!g.execute)return!1;var a=!0;try{g.execute(this._context)}catch(d){a=!1}this._allowUndo&&a&&g.canUndo()&&g.undo&&(0<this._maxLength&&this._undoStack.length>=
this._maxLength&&this._shrinkUndoStack(this._undoStack.length-this._maxLength+1),this._undoStack.push(g),this._redoStack=[],this._raiseChanged());return a},undo:function(){var g=!0;if(this._allowUndo&&this.canUndo()){var a=this._undoStack[this._undoStack.length-1];try{a&&a.canUndo&&a.canUndo()&&a.undo&&(g=a.undo(this._context))}catch(d){g=!1}g&&(this._redoStack.push(this._undoStack.pop()),this._raiseChanged())}return g},redo:function(){var g=!0;if(this._allowUndo&&this.canRedo()){var a=this._redoStack[this._redoStack.length-
1];try{a&&a.execute&&a.execute(this._context)}catch(d){g=!1}g&&(this._undoStack.push(this._redoStack.pop()),this._raiseChanged())}return g},getUndoList:function(){return this._undoStack.slice(0)},getRedoList:function(){return this._redoStack.slice(0)}}})(window);
(function(p){var l=p.GrapeCity;"undefined"===typeof l&&(l={});"undefined"===typeof l.UI&&(l.UI={});var m=p.document;l.UI._SheetRender=function(k){this._init(k)};l.UI._SheetRender.prototype={_init:function(k){this._sheet=k},_getCtx:function(){this.ctx=null;var k=this._sheet._getCanvas();if(k){if(!k.getContext&&l.UI._isSilverlightCanvas()&&!k.getContext)return;k.getContext||"undefined"===typeof p.FlashCanvas||p.FlashCanvas.initElement(k);k.getContext&&(this.ctx=k.getContext("2d"))}this.ctx&&(this.ctx.name=
"userContext");return this.ctx},_getBufferCtx:function(){var k=this._sheet._bounds,g=this.buffer;g&&g.width===k.width&&g.height===k.height||(this.buffer=g=m.createElement("canvas"),g.width=k.width,g.height=k.height);if(g.getContext)this.bufferCtx=g.getContext("2d");else if(l.UI._isSilverlightCanvas())if(g.getContext)this.bufferCtx=g.getContext("2d");else return;else if("undefined"!==typeof p.FlashCanvas){p.FlashCanvas.initElement(c);if(!g.getContext)return;this.bufferCtx=g.getContext("2d")}this.bufferCtx&&
(this.bufferCtx.beginPath(),this.bufferCtx.font=this._getZoomFont(this._getDefaultFont()),this.bufferCtx.name="bufferContext");return this.bufferCtx},_getBufferCtx2:function(){var k=this._sheet._bounds,g=this.buffer2;g&&g.width===k.width&&g.height===k.height||(this.buffer2=g=m.createElement("canvas"),g.width=k.width,g.height=k.height);if(g.getContext)this.bufferCtx2=g.getContext("2d");else if(l.UI._isSilverlightCanvas())if(g.getContext)this.bufferCtx2=g.getContext("2d");else return;else if("undefined"!==
typeof p.FlashCanvas){p.FlashCanvas.initElement(c);if(!g.getContext)return;this.bufferCtx2=g.getContext("2d")}this.bufferCtx2&&(this.bufferCtx2.beginPath(),this.bufferCtx2.font=this._getZoomFont(this._getDefaultFont()),this.bufferCtx2.name="bufferContext");return this.bufferCtx2},_getDefaultFont:function(k){return k&&k!==l.UI.SheetArea.viewport?"11pt "+this._sheet.currentTheme().bodyFont():"10pt Arial"},_getDefaultBackground:function(){return"white"},_scaleFont:function(k,g,a){if(1===g)return k;var d=
this._sheet._getEditingSpan();d.style.font=k;k=d.currentStyle;m.defaultView&&m.defaultView.getComputedStyle&&(k=m.defaultView.getComputedStyle(d,""));d=k.fontSize;-1!==d.indexOf("px")&&(g=Math.max(1,Math.floor(parseFloat(d.replace("px",""))*g)),a&&1===g&&(a.value=!0),d=""+g+"px");return d+" "+k.fontFamily},_getZoomFont:function(k){return this._scaleFont(k,this._sheet._zoomFactor)},_copyDoubleBuffer:function(k,g,a,d,e,b,f,m,q){if(l.UI._useDoubleBuffer()&&void 0!==k&&null!==k&&void 0!==g&&null!==g&&
0<a&&0<d){m=m?m:this._getBufferCtx();q=q?q:this._getCtx();var t=null;if(this._sheet._canvas)if(f)if(a=(new l.UI.Rect(k,g,a,d)).getIntersectRect(f))k=a.x,g=a.y,t=m.getImageData(a.x,a.y,a.width,a.height);else return;else t=m.getImageData(k,g,a,d);else t=m.getImageData(0,0,a,d);if(void 0===e||null===e)e=k;if(void 0===b||null===b)b=g;q.putImageData(t,e,b)}},_copyDoubleBufferRect:function(k,g,a,d,e,b){k&&this._copyDoubleBuffer(k.x,k.y,k.width,k.height,g,a,d,e,b)},translateScreen:function(k,g,a,d,e,b,f,
l){try{var m=this._getCtx(),t=m.getImageData(k,g,a,d);m.putImageData(t,e,b)}catch(r){}},repaintSelection:function(k,g,a){a||(a=this._getCtx());var d=!1,e=this._sheet,b=new l.UI.Range(-1,-1,-1,-1);if(k&&(b=e._allowCellOverflow?new l.UI.Range(k.row,0,k.rowCount,e.getColumnCount()):new l.UI.Range(k.row,k.col,k.rowCount,k.colCount),!e._isNavigateInSelection)){if(0<=b.col){for(var f=b.col,m=b.col+b.colCount-1,q=e.getRowCount(l.UI.SheetArea.colHeader),t=0;t<q;t++)(k=e._colHeaderSpanModel.find(t,b.col))&&
(f=Math.min(k.col,f)),(k=e._colHeaderSpanModel.find(t,b.col+b.colCount-1))&&(m=Math.max(k.col+k.colCount-1,m));b.col=f;b.colCount=m-f+1}if(0<=b.row){f=b.row;m=b.row+b.rowCount-1;q=e.getColumnCount(l.UI.SheetArea.rowHeader);for(t=0;t<q;t++)(k=e._rowHeaderSpanModel.find(b.row,t))&&(f=Math.min(k.row,f)),(k=e._rowHeaderSpanModel.find(b.row+b.rowCount-1,t))&&(m=Math.max(k.row+k.rowCount-1,m));b.row=f;b.rowCount=m-f+1}}k=this._getInViewportIndex(b);b=e._getRangeRect(k.rowViewportIndex,k.colViewportIndex,
b);if(0<=b.width&&0<=b.height){b.x-=2;b.y-=2;b.width+=4;b.height+=4;if(g)if(g=b.getIntersectRect(g))b=g;else return;l.UI._useDoubleBuffer()||(e._dirty=!0);4!=b.width&&4!=b.height&&this.paint(a,b);g=e._getSheetLayout();0<b.height&&!e._isNavigateInSelection&&(e._dirty=!0,this.paint(a,new l.UI.Rect(g.x,b.y,g.rowHeaderWidth,b.height)));0<b.width&&!e._isNavigateInSelection&&(e._dirty=!0,this.paint(a,new l.UI.Rect(b.x,g.y,b.width,g.colHeaderHeight)));d=!0}return d},_getInViewportIndex:function(k){var g=
this._sheet,a={rowViewportIndex:1,colViewportIndex:1},d=isNaN(g.frozenColCount)?0:Math.min(g.frozenColCount,g.getColumnCount()),g=isNaN(g.frozenRowCount)?0:Math.min(g.frozenRowCount,g.getRowCount());k.row<g&&(a.rowViewportIndex=0);k.col<d&&(a.colViewportIndex=0);return a},update:function(k,g,a,d,e){var b=this._sheet;if(!(0<b._layoutSuspended)){var f=this._getCtx();f&&(e||(b._dirty=!0),this.paint(f,new l.UI.Rect(k,g,a,d)))}},repaint:function(k){var g=this._sheet;if(!(0<g._layoutSuspended)){var a=this._getCtx();
a&&(g._dirty=!0,this.paint(a,k))}},paint:function(k,g){if(k){var a=this._sheet,d=a._bounds;g||(g=d);var e=l.UI._useDoubleBuffer(),b=e?this._getBufferCtx():k;b||(e=!1,b=k);a._dirty&&(a._dirty=!1,e&&(b.clearRect(g.x,g.y,g.width,g.height),b.translate(-d.x,-d.y)),this.paintSheet(b,g),e&&b.translate(d.x,d.y));if(e){e=k;if($.browser.chrome||$.browser.safari)e=this._getBufferCtx2();this._copyDoubleBufferRect(g,null,null,null,b,e);if(!a._hoverCell&&a._canvas){a=a._getSheetLayout();for(b=0;2>b;b++)for(var f=
0;2>f;f++)if(d=a.viewportRect(b,f),!g||d.intersectRect(g))e.save(),e.rect(d.x,d.y,d.width,d.height),e.clip(),e.beginPath(),this.paintSelection(e,b,f,g),e.beginPath(),e.restore();this.paintResizeLine(e,g)}e!==k&&this._copyDoubleBufferRect(g,null,null,null,e,k)}}},paintSheet:function(k,g){var a=this._sheet,d,e;if(k&&!(0<a._layoutSuspended)){var b=a._bounds;k.save();g?k.rect(g.x,g.y,g.width,g.height):k.rect(b.x,b.y,b.width,b.height);k.clip();k.beginPath();k.fillStyle=this._getThemeContentBackgroundColor("gray");
k.fillRect(b.x,b.y,b.width,b.height);var f=a._getSheetLayout();this.paintGroup(k,g);for(e=0;2>e;e++)g&&!f.colHeaderRect(e).intersectRect(g)||this.paintColHeader(k,e,g);for(d=0;2>d;d++)for(g&&!f.rowHeaderRect(d).intersectRect(g)||this.paintRowHeader(k,d,g),e=0;2>e;e++)g&&!f.viewportRect(d,e).intersectRect(g)||this.paintViewport(k,d,e,g);g&&!f.headerCornerRect().intersectRect(g)||this.paintColHeaderCorner(k,g);if(a._colFooterVisible)for(g&&!f.footerCornerRect().intersectRect(g)||this.paintColFooterCorner(k,
g),e=0;2>e;e++)g&&!f.footerRect(e).intersectRect(g)||this.paintColFooter(k,e,g);this.paintFrozenLine(k,g);0<a.borderWidth&&(k.strokeStyle=a.borderColor,k.lineWidth=a.borderWidth,k.strokeRect(b.x+k.lineWidth/2,b.y+k.lineWidth/2,Math.max(0,b.width-k.lineWidth),Math.max(0,b.height-k.lineWidth)));k.beginPath();k.restore()}},_getThemeContentBackgroundColor:function(k){var g=this._sheet;if(!0===(g.parent?g.parent.useWijmoTheme:g.useWijmoTheme)){var g=l.UI.Global.prototype._dummyContent,a=g.currentStyle;
m.defaultView&&m.defaultView.getComputedStyle&&(a=m.defaultView.getComputedStyle(g,""));a&&a.backgroundColor&&""!==a.backgroundColor&&(k=a.backgroundColor)}return k},refreshDragDropIndicator:function(){var k=this._sheet,g=k._currentTarget;if(g&&g.dragInfo){for(var g=this._getCtx(),a=k._getSheetLayout(),d=k._dragOldRect,e=k._actualDragRange,b=k._dragRect,f=0;2>f;f++)for(var m=0;2>m;m++){var q=a.viewportRect(f,m),t=k._getRangeRect(f,m,e);if(t&&q.intersectRect(new l.UI.Rect(t.x-2,t.y-2,t.width+4,t.height+
4))||d&&q.intersectRect(new l.UI.Rect(d.x-2,d.y-2,d.width+4,d.height+4)))b.x=t.x,b.y=t.y,b.width=t.width-1,b.height=t.height-1,this.paintDragDropIndicator(g,q)}k._oldDragRange=e;k._dragOldRect=!0===k._eventHandler._isDragInsert?k._insertDragRect:new l.UI.Rect(b.x,b.y,b.width,b.height)}},paintDragDropIndicator:function(k,g){var a=this._sheet,d=a._dragRect,e=a._eventHandler._isDragInsert,b=d.hitTarget;if(a&&d&&b){k.save();if(!0!==e||-1!==d.row&&-1!==d.col){if(b=a._dragOldRect)b=new l.UI.Rect(b.x-2,
b.y-2,b.width+4,b.height+4),this._copyDoubleBufferRect(b,null,null,g),this.repaintSelection(a._getActiveSelectedRange(),g);k.rect(g.x,g.y,g.width,g.height);k.clip();k.beginPath();this.paintDragRectangle(k,d)}else if(-1===d.row&&-1!==d.col){var f=a._getColumnLayout(0).findCol(d.hitCol);f||(f=a._getColumnLayout(1).findCol(d.hitCol));if(f){var e=f.x,m=f.width;d.col=d.hitCol;b.x>e+m/2&&(d.col<a._getLastFullyVisibleColumn()||d.col===a._getLastVisualColumn())&&(e=f.x+f.width,d.col++);b=a._dragOldRect;b&&
0===b.width||(b=a._dragRect);b&&(b=new l.UI.Rect(b.x-2,b.y-2,b.width+4,b.height+4),this._copyDoubleBufferRect(b,null,null,g),this.repaintSelection(a._getActiveSelectedRange(),g));a._insertDragRect=new l.UI.Rect(e,d.y,0,d.height);k.rect(g.x,g.y,g.width,g.height);k.clip();k.beginPath();this.paintDragLine(k,e,d.y,e,d.y+d.height)}}else-1!==d.row&&-1===d.col&&((f=a._getRowLayout(0).findRow(d.hitRow))||(f=a._getRowLayout(1).findRow(d.hitRow)),f&&(e=f.y,m=f.height,d.row=d.hitRow,b.y>e+m/2&&(d.row<a._getLastFullyVisibleRow()||
d.row===a._getLastVisualRow())&&(e=f.y+f.height,d.row++),b=a._dragOldRect,b&&0===b.height||(b=a._dragRect),b&&(b=new l.UI.Rect(b.x-2,b.y-2,b.width+4,b.height+4),this._copyDoubleBufferRect(b,null,null,g),this.repaintSelection(a._getActiveSelectedRange(),g)),a._insertDragRect=new l.UI.Rect(d.x,e,d.width,0),k.rect(g.x,g.y,g.width,g.height),k.clip(),k.beginPath(),this.paintDragLine(k,d.x,e,d.x+d.width,e)));k.beginPath();k.restore()}},_union:function(k,g){var a=Math.min(k.x,g.x),d=Math.min(k.y,g.y),e=
Math.max(k.x+k.width-1,g.x+g.width-1),b=Math.max(k.y+k.height-1,g.y+g.height-1);return new l.UI.Rect(a,d,e,b)},paintDragRectangle:function(k,g){this.paintDragLine(k,g.x,g.y,g.x+g.width,g.y);this.paintDragLine(k,g.x,g.y+g.height,g.x+g.width,g.y+g.height);this.paintDragLine(k,g.x,g.y,g.x,g.y+g.height);this.paintDragLine(k,g.x+g.width,g.y,g.x+g.width,g.y+g.height)},paintDragLine:function(k,g,a,d,e){k.save();var b,f,m;g===d?(k.rect(g-2,a,7,Math.abs(e-a)),k.clip(),k.beginPath(),a<e?(a-=3,e+=3):(a+=3,e-=
3),b=new l.UI.Line.Create(g-1,a-1,d-1,e+1,"black",l.UI.LineStyle.hair),f=new l.UI.Line.Create(g,a,d,e,"black",l.UI.LineStyle.hair),m=new l.UI.Line.Create(g+1,a-1,d+1,e+1,"black",l.UI.LineStyle.hair)):a===e&&(k.rect(g,a-2,Math.abs(d-g),7),k.clip(),k.beginPath(),g<d?(g-=3,d+=3):(g+=3,d-=3),b=new l.UI.Line.Create(g-1,a-1,d+1,e-1,"black",l.UI.LineStyle.hair),f=new l.UI.Line.Create(g,a,d,e,"black",l.UI.LineStyle.hair),m=new l.UI.Line.Create(g-1,a+1,d+1,e+1,"black",l.UI.LineStyle.hair));b.paintLine(k);
f.paintLine(k);m.paintLine(k);k.stroke();k.beginPath();k.restore()},paintResizeLine:function(k,g){var a,d;a=this._sheet;if(a._eventHandler.isMouseDown){var e=a._currentTarget;if(e&&(e=e.resizeInfo)){var b=a._getSheetLayout();k.save();k.strokeStyle="black";k.lineWidth=1;k.beginPath();if("sizeRow"===e.action)for(a=b.x;a<b.x+b.width;a+=2)d=Math.max(0,e.startY-0.5),k.moveTo(a,d),k.lineTo(a+1,d),k.moveTo(a,e.movingY-0.5),k.lineTo(a+1,e.movingY-0.5);else for(d=b.y;d<b.y+b.height;d+=2)a=Math.max(0,e.startX-
0.5),k.moveTo(a,d),k.lineTo(a,d+1),k.moveTo(e.movingX-0.5,d),k.lineTo(e.movingX-0.5,d+1);k.stroke();k.restore()}}},paintColHeaderCorner:function(k,g){var a=this._sheet;k.beginPath();var d=a._getSheetLayout().headerCornerRect(),e=a.getActualStyle(-1,-1,l.UI.SheetArea.corner);this.paintCell(k,null,-1,-1,d.x,d.y,d.width,d.height,e,l.UI.SheetArea.corner);a=new l.UI._GcBorders(a,0,0,l.UI.SheetArea.corner);a.addCellLines(0,0,d.x,d.y,d.width,d.height);a.paint(k,g)},paintFrozenLine:function(k,g){var a=this._sheet;
if(a.frozenRowCount||a.frozenColCount){var d=a._getSheetLayout();k.save();k.strokeStyle=(new l.UI._ThemeContext(a)).getColor(a._frozenlineColor);k.lineWidth=1;k.beginPath();a.frozenColCount&&(k.moveTo(d.viewportX-0.5,d.y),k.lineTo(d.viewportX-0.5,d.y+d.height));a.frozenRowCount&&(k.moveTo(d.x,d.viewportY-0.5),k.lineTo(d.x+d.width,d.viewportY-0.5));k.stroke();k.restore()}},paintColHeader:function(k,g,a){this.paintViewportImp(k,-1,g,l.UI.SheetArea.colHeader,a)},paintRowHeader:function(k,g,a){this.paintViewportImp(k,
g,-1,l.UI.SheetArea.rowHeader,a)},paintColFooterCorner:function(k,g){var a=this._sheet,d=a._getSheetLayout(),e=d.footerX,b=d.footerY,f=d.footerWidth,m=d.footerHeight,q=0,q=a._getColumnLayout(1,l.UI.SheetArea.viewport),q=(q=q.findCol(q[q.length-1].col,l.UI.SheetArea.viewport))?q.x+q.width:d.width;k.save();k.strokeStyle="#9EB6CE";k.beginPath();k.moveTo(e,b-0.5);k.lineTo(q,b-0.5);k.stroke();k.restore();k.fillStyle="white";k.fillRect(e,b,f,m);a=a.getActualStyle(-1,-1,l.UI.SheetArea.footerCorner);this.paintCell(k,
null,-1,-1,e,b,f,m,a,l.UI.SheetArea.footerCorner)},paintColFooter:function(k,g,a){var d=this._sheet._getSheetLayout();k.fillStyle="white";0===g?k.fillRect(d.frozenX,d.footerY,d.frozenWidth,d.footerHeight):k.fillRect(d.viewportX,d.footerY,d.viewportWidth,d.footerHeight);this.paintViewportImp(k,-1,g,l.UI.SheetArea.colFooter,a)},paintViewport:function(k,g,a,d){this.paintViewportImp(k,g,a,l.UI.SheetArea.viewport,d)},paintSelection:function(k,g,a,d){var e=this._sheet,b=null;k.save();d&&(k.rect(d.x,d.y,
d.width,d.height),k.clip(),k.beginPath());for(var f=0;f<e._selectionModel.length;f++){var b=e._selectionModel[f],l=e._spanModel.find(b.row,b.col);l&&l.containsRange(b)&&(b=l);(b=e._getRangeRect(g,a,b))&&0<b.width&&0<b.height&&(k.fillStyle="rgba(180,180,200, 0.2)",k.fillRect(b.x,b.y,b.width,b.height))}f=e.getCellRect(e._activeRowIndex,e._activeColIndex,g,a);l=e._getSheetLayout().viewportRect(g,a);l.intersectRect(f)&&(f.x=Math.max(f.x,l.x),f.y=Math.max(f.y,l.y));f&&null!==f.x&&void 0!==f.x&&null!==
f.y&&void 0!==f.y&&null!==f.width&&void 0!==f.width&&null!==f.height&&void 0!==f.height||(f=null);d&&f&&f.intersectRect(d)&&(this._copyDoubleBuffer(f.x+1,f.y+1,f.width-2,f.height-2,f.x+1,f.y+1,null,null,k),1<e._selectionModel.length&&(k.strokeStyle="black",k.lineWidth=1,k.strokeRect(f.x+1.5,f.y+1.5,f.width-4,f.height-4)));1===e._selectionModel.length&&(e._eventHandler.isDraggingFill&&e._eventHandler.isDragClear()&&!e._eventHandler._isDragAroundIndicator&&(f=e._eventHandler.getCurrentFillRange(),(e=
e._getRangeRect(g,a,f))&&0<e.width&&0<e.height&&(k.fillStyle="rgba(110,110,110, 0.5)",k.fillRect(e.x,e.y,e.width,e.height))),this.paintSelectionBorder(k,g,a,b,d));k.beginPath();k.restore()},paintSelectionBorder:function(k,g,a,d,e){var b=this._sheet;if(0<=d.width&&0<=d.height&&(!e||d.intersect(e.x-1,e.y-1,e.width+2,e.height+2))){k.save();k.beginPath();k.strokeStyle="black";k.lineWidth=2;if(0<d.width&&0<d.height){if(b._eventHandler.isDraggingFill)switch(b._eventHandler._currentFillDirection){case l.UI.DragFillDirection.Up:k.moveTo(d.x+
0.5,d.y-0.5);k.lineTo(d.x+d.width-1,d.y-0.5);break;case l.UI.DragFillDirection.Down:k.moveTo(d.x+0.5,d.y+d.height-0.5);k.lineTo(d.x+d.width-1,d.y+d.height-0.5);break;case l.UI.DragFillDirection.Left:k.moveTo(d.x-0.5,d.y+0.5);k.lineTo(d.x-0.5,d.y+d.height-1);break;case l.UI.DragFillDirection.Right:k.moveTo(d.x+d.width-0.5,d.y+0.5),k.lineTo(d.x+d.width-0.5,d.y+d.height-1)}else k.rect(d.x-0.5,d.y-0.5,d.width,d.height);k.stroke();b.canUserDragFill()&&this.paintDragFillIndicator(k,g,a,d,e)}else 0!==d.width&&
0!==d.height||k.strokeRect(d.x-1,d.y-1,d.width+1,d.height+1);k.beginPath();k.restore()}},getDragFillIndicatorRect:function(k){var g=this._sheet,a=g._getActiveSelectedRange(),d=g._getSheetLayout(),e=new l.UI.Rect(-4,-4,4,4);-1===a.col?(e.x=d.frozenX,e.y=k.y+k.height-0.5-2):-1===a.row?(e.x=k.x+k.width-0.5-2,e.y=d.frozenY):(e.x=k.x+k.width-0.5-2,e.y=k.y+k.height-0.5-2);return g._dragFillIndicatorRect=e},paintDragFillIndicator:function(k,g,a,d,e){var b=this._sheet._getSheetLayout();d=this.getDragFillIndicatorRect(d);
g=b.viewportRect(g,a);e&&!d.intersectRect(e)||!d.intersectRect(g)||(e=new l.UI.Rect(d.x-1.5,d.y-1.5,d.width+2,d.height+2),e.x=Math.max(e.x,g.x),e.y=Math.max(e.y,g.y),this._copyDoubleBufferRect(e,null,null,null,null,k),k.fillStyle="black",k.fillRect(d.x,d.y,d.width,d.height))},paintViewportImp:function(k,g,a,d,e){k.beginPath();var b=this._sheet;b._getSheetLayout();var f=b._getRowLayout(g,d),m=b._getColumnLayout(a,d),q=b._getCellLayout(g,a,d),t=l.UI._useDoubleBuffer(),r=new l.UI.Rect,u=!1;t&&f&&0<f.length&&
m&&0<m.length&&(r.x=m[0].x,r.y=f[0].y,r.width=m[m.length-1].x+m[m.length-1].width-r.x,r.height=f[f.length-1].y+f[f.length-1].height-r.y,k.save(),k.rect(r.x,r.y,r.width,r.height),k.clip(),k.beginPath(),u=!0,k.fillStyle=this._getDefaultBackground(),k.fillRect(r.x,r.y,r.width,r.height));var n=null,h=null,I=null,p,O,H=r=0,C=0,G=0,z,S,Q=f.length,aa=m.length,ka=new l.UI._GcBorders(b,g,a,d),J=[],K=[],A=[],L=new l.UI._CellOverflowValueLayoutModel,D=[];if(0<Q&&0<aa){for(var w=0;w<Q;w++)for(var n=f[w],M=this._buildCellOverflowLayoutModel(n.row,
d),T=0;T<aa;T++)if(h=m[T],!e||h.intersect(e)){(I=q.findCell(n.row,h.col))?(p=I.row,O=I.col,r=I.x,H=I.y,C=I.width,G=I.height):(p=n.row,O=h.col,r=h.x,H=n.y,C=h.width,G=n.height);0<=p&&0<=O&&(z=b.getValue(p,O,d),S=b.getActualStyle(p,O,d));var P=null;b._allowCellOverflow&&M&&(P=M.find(O));b.rowFilter()&&b.rowFilter().showFilterButton&&b.rowFilter().isFilterHeader(n.row,h.col,d)&&0<h.width&&0<n.height&&A.push({row:p,col:O,x:r,y:H,width:C,height:G,sheetArea:d});d===l.UI.SheetArea.viewport&&b.parent&&b.parent.highlightInvalidData()&&
!b.isValid(p,O,z)&&D.push({x:r,y:H,width:C,height:G});if(d!==l.UI.SheetArea.viewport||!I||!J.contains(I)||I.row===n.row&&I.col===h.col)I&&J.contains(I)||(h=S,this._isCellHidden(p,O,d)&&(h={_backColor:S.backColor}),ka.addCellLines(p,O,r,H,C,G,h,I,P)),0<C&&0<G&&!I&&(t||(k.fillStyle=this._getDefaultBackground(),k.fillRect(r,H,C,G)),this.paintCell(k,z,p,O,r,H,C,G,S,d,P)),I&&(J.push(I),K.push({row:p,col:O,x:r,y:H,width:C,height:G,data:z,style:S,cellOverflowLayout:P})),b._allowCellOverflow&&0<G&&this._buildCellOverflowValueLayoutModel(k,
z,p,O,r,H,C,G,d,P,L,m)}if(0<K.length)for(b=K.length,w=0;w<b;w++)f=K[w],t||(k.fillStyle=this._getDefaultBackground(),k.fillRect(r,H,C,G)),this.paintCell(k,f.data,f.row,f.col,f.x,f.y,f.width,f.height,f.style,d,f.cellOverflowLayout);0<L.length&&this._paintCellOverflowValue(k,L);0<A.length&&this._paintFilterButton(k,A,g,a)}ka.paint(k,e);this._paintValidationUI(k,D);u&&(k.restore(),k.beginPath())},_isHiddenByGroup:function(k,g){return k&&0!==k._getCount()?k.isCollapsed(g):!1},_isCellHiddenByGroup:function(k,
g,a){var d=this._sheet;if(void 0===a||null===a||a===l.UI.SheetArea.viewport)return this._isHiddenByGroup(d.rowRangeGroup,k)||this._isHiddenByGroup(d.colRangeGroup,g);if(a===l.UI.SheetArea.colHeader)return this._isHiddenByGroup(d.colRangeGroup,g);if(a===l.UI.SheetArea.rowHeader)return this._isHiddenByGroup(d.rowRangeGroup,k)},_isRowHiddenByFilter:function(k){var g=this._sheet;if(g.rowFilter())return!g.rowFilter().isRowFilteredOut(k)},_isCellHidden:function(k,g,a){var d=this._sheet;return d.getRowVisible(k,
a)&&d.getColumnVisible(g,a)?this._isCellHiddenByGroup(k,g,a):!1},_getFilterButtonRect:function(k){var g=this._sheet,a=1<g._zoomFactor?1:g._zoomFactor,g=parseInt(Math.min(20,g.defaults.rowHeight)*a,10);return{x:k.x+k.width-g,y:k.y+k.height-g,width:g,height:g}},_paintFilterButton:function(k,g,a,d){var e=this._sheet;k.save();k.lineWidth=1;k.fillStyle="#FFFFFF";k.strokeStyle="#CCCCCC";this._getCtx();for(a=0;a<g.length;a++){var b=g[a],f=this._getFilterButtonRect(new l.UI.Rect(b.x,b.y,b.width,b.height));
d=f.width;var m=f.height,q=f.x,f=f.y;k.save();k.rect(b.x,b.y,b.width,b.height);k.clip();k.beginPath();k.fillRect(q+1,f+1,d-3,m-3);k.strokeRect(q+1-0.5,f+2-0.5,d-3,m-4);b=this._getFilterButtonState(b.col);b=l.UI._GcFilterDialog.getImageSrc(b);e.imageLoader||(e.imageLoader=new l.UI._GcImageLoader(function(){e.repaint()}));try{e.imageLoader.getState(b)?k.drawImage(e.imageLoader.getImage(b),q,f+1,d-3,m-3):e.imageLoader.addImage(b)}catch(t){}k.beginPath();k.restore()}k.restore()},_paintValidationUI:function(k,
g){if(g)for(var a=g.length,d=0;d<a;d++){var e=g[d],b=e.x-4,f=e.y-4,l=e.width+8,m=e.height+8,e=0.5522848*(l/2),t=0.5522848*(m/2),r=b+l,u=f+m,l=b+l/2,m=f+m/2;k.save();k.lineWidth=2;k.strokeStyle="red";k.beginPath();k.moveTo(b,m);k.bezierCurveTo(b,m-t,l-e,f,l,f);k.bezierCurveTo(l+e,f,r,m-t,r,m);k.bezierCurveTo(r,m+t,l+e,u,l,u);k.bezierCurveTo(l-e,u,b,m+t,b,m);k.closePath();k.stroke();k.restore()}},paintCell:function(k,g,a,d,e,b,f,m,q,t,r){var u=this._sheet,n=this.getVisualState(a,d,t),h="";q.font=q.font?
this._getZoomFont(q.font):this._getZoomFont(this._getDefaultFont(t));h=q.font;if(!q.wordWrap&&q.shrinkToFit){var I=u.getText(a,d,t);if(I&&""!==I)for(var p={value:!1},O=0;3>O&&!1===p.value;O++){var H=u._getStringWidth(I,h),C=Math.max(0,f-4);q.hAlign!==l.UI.HorizontalAlign.center&&q.textIndent&&(C=Math.max(0,C-8*q.textIndent));if(C<H)h=this._scaleFont(h,C/H,p),q.font=h;else{q.font=h;break}}}0<f&&0<m&&(I=u.getCellType(a,d,t),e--,b--,f++,m++,r={visualState:n,cellOverflowLayout:r,useWijmoTheme:u.parent?
u.parent.useWijmoTheme:u.useWijmoTheme},t===l.UI.SheetArea.viewport&&(t=u.getSparkline(a,d))&&(r.sparkline=t),q.wordWrap&&(r.lineHeight=u._getFontHeight(h)),u.imageLoader||(u.imageLoader=new l.UI._GcImageLoader(function(){u.repaint()})),r.imageLoader=u.imageLoader,r.sheet=this._sheet,r.row=a,r.col=d,I.paint(k,g,e,b,f,m,q,r))},getVisualState:function(k,g,a){var d=this._sheet,e=d._getModel(a),b=null;e&&(b=e.getVisualState(k,g));if(void 0===b||null===b)b=l.UI.VisualState.Normal;void 0===a||null===a||
a===l.UI.SheetArea.viewport?!d.isEditing()&&d._isActiveCell(k,g)?b=l.UI.VisualState.Active:d._isSelected(k,g,a)&&(b=l.UI.VisualState.Selected):(d._isSelected(k,g,a)&&(b=l.UI.VisualState.Highlight,d._isAllSelected(k,g,a)&&(b=l.UI.VisualState.Selected)),d._isHover(k,g,a)&&(b=l.UI.VisualState.Hover));return b},paintLine:function(k,g,a,d,e,b){k.lineWidth=g.width();k.strokeStyle=g.color;k.moveTo(a,d);k.lineTo(e,b)},paintGroup:function(k,g){var a=this._sheet,d=a._getGroupLayout();if(0<d.width||0<d.height){k.save();
this.paintGroupHeader(k);this._rowGroups=[new l.UI._RangeGroupPresenter(a,!0,0),new l.UI._RangeGroupPresenter(a,!0,1)];for(d=0;2>d;d++)this._rowGroups[d].createGroupInfo(),this._rowGroups[d].paintGroups(k);this._columnGroups=[new l.UI._RangeGroupPresenter(a,!1,0),new l.UI._RangeGroupPresenter(a,!1,1)];for(d=0;2>d;d++)this._columnGroups[d].createGroupInfo(),this._columnGroups[d].paintGroups(k);k.beginPath();k.restore()}},paintGroupHeader:function(k){var g=this._sheet;(new l.UI._RangeGroupHeaderPresenter(g,
!1)).paintGroupHeader(k);(new l.UI._RangeGroupHeaderPresenter(g,!0)).paintGroupHeader(k)},groupHitTest:function(k,g){var a=this._sheet,d=a._getGroupLayout();if(!d)return null;var e=new l.UI.Rect(d.x,d.y,d.width,a._bounds.height);if(!e.contains(k,g)&&(e=new l.UI.Rect(d.x,d.y,a._bounds.width,d.height),!e.contains(k,g)))return null;d={what:"empty",info:null};(e=(new l.UI._RangeGroupHeaderPresenter(a,!0)).getGroupButton(k,g))&&(d={what:"rgh",info:e});"empty"===d.what&&(e=(new l.UI._RangeGroupHeaderPresenter(a,
!1)).getGroupButton(k,g))&&(d={what:"cgh",info:e});var b;if("empty"===d.what){var f=[new l.UI._RangeGroupPresenter(a,!0,0),new l.UI._RangeGroupPresenter(a,!0,1)];for(b=0;2>b;b++)if(f[b].createGroupInfo(),e=f[b].getRowGroupButton(k,g)){d={what:"rg",info:e};break}}if("empty"===d.what)for(a=[new l.UI._RangeGroupPresenter(a,!1,0),new l.UI._RangeGroupPresenter(a,!1,1)],b=0;2>b;b++)if(a[b].createGroupInfo(),e=a[b].getColGroupButton(k,g)){d={what:"cg",info:e};break}return d},_paintCellOverflowValue:function(k,
g){for(var a=0;a<g.length;a++){var d=g[a];this.paintCellOverflowValue(k,d.data,d.row,d.col,d.x,d.y,d.width,d.height,d.sheetArea,d.cellOverflowLayout)}},_buildCellOverflowValueLayoutModel:function(k,g,a,d,e,b,f,m,q,t,r,u){k=this._sheet;var n=isNaN(k.frozenColCount)?0:k.frozenColCount;if(t&&r){var h=!1;d<n&&(h=!0);if(t.column===d)u=d=e,t.hAlign===l.UI.HorizontalAlign.right?u=e+f-t.columnWidth:t.hAlign===l.UI.HorizontalAlign.center&&(u=e+f/2-t.columnPrevWidth),t.layout={x:u,y:b,width:t.columnWidth,height:m},
a=new l.UI._CellOverflowValueLayout(g,a,t.column,d,b,f,m,q,t),r.push(a);else if(!h&&t.column<k._scrollLeftCol){d=u[0].x;e=0;for(g=k._scrollLeftCol-1;g>=t.column;g--)e=k._getZoomColumnWidth(g,q),d-=e;u=d;t.hAlign===l.UI.HorizontalAlign.right?u=d+e-t.columnWidth:t.hAlign===l.UI.HorizontalAlign.center&&(u=d+e/2-t.columnPrevWidth);t.layout={x:u,y:b,width:t.columnWidth,height:m};g=k.getValue(a,t.column,q);a=new l.UI._CellOverflowValueLayout(g,a,t.column,d,b,e,m,q,t);r.push(a)}else if(!h&&t.column>k._getPageRightColumn()||
h&&t.column>=n){d=u[u.length-1].x+u[u.length-1].width;for(g=h?n:k._getPageRightColumn()+1;g<t.column;g++)e=k._getZoomColumnWidth(g,q),d+=e;e=k._getZoomColumnWidth(t.column,q);u=d;t.hAlign===l.UI.HorizontalAlign.right?u=d+e-t.columnWidth:t.hAlign===l.UI.HorizontalAlign.center&&(u=d+e/2-t.columnPrevWidth);t.layout={x:u,y:b,width:t.columnWidth,height:m};g=k.getValue(a,t.column,q);a=new l.UI._CellOverflowValueLayout(g,a,t.column,d,b,e,m,q,t);r.push(a)}}},_buildCellOverflowLayoutModel:function(k,g){if(void 0!==
g&&null!==g&&g!==l.UI.SheetArea.viewport)return null;var a=this._sheet;if(!a._allowCellOverflow||1===a.maxCellOverflowDistance)return null;var d=null;if(a._cellOverflowModelCache){if(d=a._cellOverflowModelCache[k])return d}else a._cellOverflowModelCache={};for(var d=new l.UI._CellOverflowLayoutModel,e=0;e<a.getColumnCount(g);e++){var b=a.getColumnVisible(e,g),f=a.getColumnWidth(e,g);if(!(!1===b||0>=f||(b=a.getActualStyle(k,e,l.UI.SheetArea.viewport),b&&(b.shrinkToFit||b.wordWrap))))if(f=l.UI._SheetRender.getHAlignByValueType(b.hAlign,
a.getValue(k,e)),void 0===f||null===f||f===l.UI.HorizontalAlign.left){if(b=this._buildCellOverflowLayoutModelForLeft(k,e,g,b))d.push(b),e=b.endCol}else if(f===l.UI.HorizontalAlign.right){if(b=this._buildCellOverflowLayoutModelForRight(k,e,g,b))d.push(b),e=b.endCol}else f===l.UI.HorizontalAlign.center&&(b=this._buildCellOverflowLayoutModelForCenter(k,e,g,b))&&(d.push(b),e=b.endCol)}return a._cellOverflowModelCache[k]=d},_buildCellOverflowLayoutModelForLeft:function(k,g,a,d){var e=this._sheet,b=e.getText(k,
g,a);if(!b||""===b||null!==e._spanModel.find(k,g)||null!==e.getValue(k,g+1,a)||null!==e._spanModel.find(k,g+1))return null;var f=e._getZoomColumnWidth(g,a),m=d&&d.font?this._getZoomFont(d.font):this._getZoomFont(this._getDefaultFont(a));d=e._getStringWidth(b,m)+(d.textIndent?8*d.textIndent:0);if(d<=f)return null;b=g;m=e.getColumnCount(a);if(e.maxCellOverflowDistance){var q=parseInt(e.maxCellOverflowDistance,10)+g;q<m&&(m=q)}for(q=g+1;q<m;q++){var t=e.getValue(k,q,a),r=e._spanModel.find(k,q);if(void 0!==
t&&null!==t||r||d<f)break;f+=e._getZoomColumnWidth(q,a);b=q}return b===g?null:new l.UI._CellOverflowLayout(g,g,b,d,f-1,l.UI.HorizontalAlign.left,null)},_buildCellOverflowLayoutModelForRight:function(k,g,a,d){var e=this._sheet,b=e.getText(k,g,a);if(!b||""===b||null!==e._spanModel.find(k,g)||null!==e.getValue(k,g-1,a)||null!==e._spanModel.find(k,g-1))return null;var f=e._getZoomColumnWidth(g,a);d=d&&d.font?this._getZoomFont(d.font):this._getZoomFont(this._getDefaultFont(a));b=e._getStringWidth(b,d);
if(b<=f)return null;d=g;var m=-1;if(e.maxCellOverflowDistance){var q=g-parseInt(e.maxCellOverflowDistance,10);q>m&&(m=q)}for(q=g-1;q>m;q--){var t=e.getValue(k,q,a),r=e._spanModel.find(k,q);if(void 0!==t&&null!==t||r||b<f)break;f+=e._getZoomColumnWidth(q,a);d=q}return d===g?null:new l.UI._CellOverflowLayout(g,d,g,b,f-1,l.UI.HorizontalAlign.right,null)},_buildCellOverflowLayoutModelForCenter:function(k,g,a,d){var e=this._sheet,b=e.getText(k,g,a);if(!b||""===b||null!==e._spanModel.find(k,g))return null;
var f=e._getZoomColumnWidth(g,a);d=d&&d.font?this._getZoomFont(d.font):this._getZoomFont(this._getDefaultFont(a));b=e._getStringWidth(b,d);if(b<=f)return null;d=f/2;var m=g,q=0,t=-1;if(e.maxCellOverflowDistance){var q=parseInt(parseInt(e.maxCellOverflowDistance,10)/2+0.5,10),r=g-q;r>t&&(t=r)}for(var u,n,r=g-1;r>t;r--){u=e.getValue(k,r,a);n=e._spanModel.find(k,r);if(void 0!==u&&null!==u||n||b/2<d)break;d+=e._getZoomColumnWidth(r,a);m=r}var f=f/2,h=g,t=e.getColumnCount(a);e.maxCellOverflowDistance&&
(q=parseInt(e.maxCellOverflowDistance,10)-q+1+g,q<t&&(t=q));for(r=g+1;r<t;r++){u=e.getValue(k,r,a);n=e._spanModel.find(k,r);if(void 0!==u&&null!==u||n||b/2<f)break;f+=e._getZoomColumnWidth(r,a);h=r}return m===h?null:new l.UI._CellOverflowLayout(g,m,h,b,d+f-1,l.UI.HorizontalAlign.center,d)},_getFilterButtonState:function(k){var g=l.UI._FilterButtonState.noSortFilter,a=this._sheet.rowFilter();if(!a)return g;var d=a.getSortState(k);a.isColumnFiltered(k)?d===l.UI.SortState.None?g=l.UI._FilterButtonState.filter:
d===l.UI.SortState.Ascending?g=l.UI._FilterButtonState.filterAscend:d===l.UI.SortState.Descending&&(g=l.UI._FilterButtonState.filterDescend):d===l.UI.SortState.None?g=l.UI._FilterButtonState.noSortFilter:d===l.UI.SortState.Ascending?g=l.UI._FilterButtonState.ascend:d===l.UI.SortState.Descending&&(g=l.UI._FilterButtonState.descend);return g},paintCellOverflowValue:function(k,g,a,d,e,b,f,l,m,t){var r=this._sheet,u=r.getActualStyle(a,d,m);u.font=u.font?this._getZoomFont(u.font):this._getZoomFont(this._getDefaultFont(m));
t={visualState:this.getVisualState(a,d,m),cellOverflowLayout:t,useWijmoTheme:r.parent?r.parent.useWijmoTheme:r.useWijmoTheme,sheet:r,row:a,col:d};0<f&&0<l&&(m=r.getCellType(a,d,m),r.isEditing()&&a===r._activeRowIndex&&d===r._activeColIndex||(e--,b--,f++,l++,m.paintValue&&m.paintValue(k,g,e,b,f,l,u,t)))}};l.UI._SheetRender.getHAlignByValueType=function(k,g){if(k===l.UI.HorizontalAlign.general){var a=("object"===typeof g?Object.prototype.toString.call(g).slice(8,-1):typeof g).toLowerCase();k="boolean"===
a?l.UI.HorizontalAlign.center:"number"===a||"date"===a?l.UI.HorizontalAlign.right:l.UI.HorizontalAlign.left}return k}})(window);
(function(p,l,m){function k(a){this._init(a)}function g(a){return a.split("\u00a0").join(" ").toUpperCase()}function a(a){for(var b=[],e=0,d=a.length;e<d;e++)b[e]=g(a[e]);return b}function d(a,b,e){a=g(a);b=(new f.UI._ArrayHelper(b)).indexOf(a);-1===b&&(b=(new f.UI._ArrayHelper(e)).indexOf(a));return b}function e(a,b,e){this.name=a;this.numberFormat=b;this.dateTimeFormat=e}function b(a){var b=a.dateTimeFormat;b&&!b.eras&&(b.eras=a.eras);return new e(a.name,a.numberFormat,b)}var f=p.GrapeCity;"undefined"===
typeof f&&(f=p.GrapeCity={});"undefined"===typeof f.UI&&(f.UI={});f.UI._ArrayHelper=function(){function a(b){this._array=b}a.prototype={add:function(a){var b=this._array;b[b.length]=a},insert:function(a,b){this._array.splice(a,0,b)},indexOf:function(a,b){var e;a:{e=this._array;var d;if("undefined"!==typeof a){var h=e.length;if(0!==h)for(d=b-0,isNaN(d)?d=0:(isFinite(d)&&(d-=d%1),0>d&&(d=Math.max(0,h+d)));d<h;d++)if("undefined"!==typeof e[d]&&e[d]===a){e=d;break a}}e=-1}return e},array:function(a){if(0===
arguments.length)return this._array;this._array=a;return this}};return a}();k.prototype={_init:function(a){this._parts="undefined"!==typeof a&&null!==a&&""!==a?[a.toString()]:[];this._value={};this._len=0},_insert:function(a){this._parts.splice(0,0,a)},insert:function(a,b){if(b===m||null===b)b=0;if(0===b)this._insert(a);else{var e=this.toString();if(b>=e.length)this.append(a);else{var d=e.substring(0,b),e=e.substr(b);this._init(d+a+e)}}},append:function(a){this._parts[this._parts.length]=a},appendLine:function(a){this._parts[this._parts.length]=
"undefined"===typeof a||null===a||""===a?"\r\n":a+"\r\n"},clear:function(){this._init()},isEmpty:function(){return 0===this._parts.length?!0:""===this.toString()},toString:function(a){a=a||"";var b=this._parts;this._len!==b.length&&(this._value={},this._len=b.length);var e=this._value;if("undefined"===typeof e[a]){if(""!==a)for(var d=0;d<b.length;)"undefined"===typeof b[d]||""===b[d]||null===b[d]?b.splice(d,1):d++;e[a]=this._parts.join(a)}return e[a]}};f.UI._StringBuilder=k;e.prototype={_getDateTimeFormats:function(){this._dateTimeFormats||
(this._dateTimeFormats="yy/MM/dd;yy/MM/d;yy/M/dd;yy/M/d;yyyy/MM/dd;yyyy/MM/d;yyyy/M/dd;yyyy/M/d;MM/dd/yyyy;MM/d/yyyy;M/dd/yyyy;M/d/yyyy;hh:mm:ss;hh:mm:s;hh:m:ss;hh:m:s;h:mm:ss;h:mm:s;h:m:ss;h:m:s;hh:mm:ss tt;hh:mm:s tt;hh:m:ss tt;hh:m:s tt;h:mm:ss tt;h:mm:s tt;h:m:ss tt;h:m:s tt;hh:mm;hh:m;h:mm;h:m;yy/MM/dd hh:mm:ss;yy/MM/dd hh:mm:s;yy/MM/dd hh:m:ss;yy/MM/dd hh:m:s;yy/MM/dd h:mm:ss;yy/MM/dd h:mm:s;yy/MM/dd h:m:ss;yy/MM/dd h:m:s;yy/MM/dd hh:mm:ss tt;yy/MM/dd hh:mm:s tt;yy/MM/dd hh:m:ss tt;yy/MM/dd hh:m:s tt;yy/MM/dd h:mm:ss tt;yy/MM/dd h:mm:s tt;yy/MM/dd h:m:ss tt;yy/MM/dd h:m:s tt;yy/MM/d hh:mm:ss;yy/MM/d hh:mm:s;yy/MM/d hh:m:ss;yy/MM/d hh:m:s;yy/MM/d hh:mm:ss;yy/MM/d h:mm:s;yy/MM/d h:m:ss;yy/MM/d h:m:s;yy/MM/d hh:mm:ss tt;yy/MM/d hh:mm:s tt;yy/MM/d hh:m:ss tt;yy/MM/d hh:m:s tt;yy/MM/d h:mm:ss tt;yy/MM/d h:mm:s tt;yy/MM/d h:m:ss tt;yy/MM/d h:m:s tt;yy/M/dd hh:mm:ss;yy/M/dd hh:mm:s;yy/M/dd hh:m:ss;yy/M/dd hh:m:s;yy/M/dd hh:mm:ss;yy/M/dd h:mm:s;yy/M/dd h:m:ss;yy/M/dd h:m:s;yy/M/dd hh:mm:ss tt;yy/M/dd hh:mm:s tt;yy/M/dd hh:m:ss tt;yy/M/dd hh:m:s tt;yy/M/dd h:mm:ss tt;yy/M/dd h:mm:s tt;yy/M/dd h:m:ss tt;yy/M/dd h:m:s tt;yy/M/d hh:mm:ss;yy/M/d hh:mm:s;yy/M/d hh:m:ss;yy/M/d hh:m:s;yy/M/d hh:mm:ss;yy/M/d h:mm:s;yy/M/d h:m:ss;yy/M/d h:m:s;yy/M/d hh:mm:ss tt;yy/M/d hh:mm:s tt;yy/M/d hh:m:ss tt;yy/M/d hh:m:s tt;yy/M/d h:mm:ss tt;yy/M/d h:mm:s tt;yy/M/d h:m:ss tt;yy/M/d h:m:s tt;yyyy/MM/dd hh:mm:ss;yyyy/MM/dd hh:mm:s;yyyy/MM/dd hh:m:ss;yyyy/MM/dd hh:m:s;yyyy/MM/dd hh:mm:ss;yyyy/MM/dd h:mm:s;yyyy/MM/dd h:m:ss;yyyy/MM/dd h:m:s;yyyy/MM/dd hh:mm:ss tt;yyyy/MM/dd hh:mm:s tt;yyyy/MM/dd hh:m:ss tt;yyyy/MM/dd hh:m:s tt;yyyy/MM/dd h:mm:ss tt;yyyy/MM/dd h:mm:s tt;yyyy/MM/dd h:m:ss tt;yyyy/MM/dd h:m:s tt;yyyy/MM/d hh:mm:ss;yyyy/MM/d hh:mm:s;yyyy/MM/d hh:m:ss;yyyy/MM/d hh:m:s;yyyy/MM/d hh:mm:ss;yyyy/MM/d h:mm:s;yyyy/MM/d h:m:ss;yyyy/MM/d h:m:s;yyyy/MM/d hh:mm:ss tt;yyyy/MM/d hh:mm:s tt;yyyy/MM/d hh:m:ss tt;yyyy/MM/d hh:m:s tt;yyyy/MM/d h:mm:ss tt;yyyy/MM/d h:mm:s tt;yyyy/MM/d h:m:ss tt;yyyy/MM/d h:m:s tt;yyyy/M/dd hh:mm:ss;yyyy/M/dd hh:mm:s;yyyy/M/dd hh:m:ss;yyyy/M/dd hh:m:s;yyyy/M/dd hh:mm:ss;yyyy/M/dd h:mm:s;yyyy/M/dd h:m:ss;yyyy/M/dd h:m:s;yyyy/M/dd hh:mm:ss tt;yyyy/M/dd hh:mm:s tt;yyyy/M/dd hh:m:ss tt;yyyy/M/dd hh:m:s tt;yyyy/M/dd h:mm:ss tt;yyyy/M/dd h:mm:s tt;yyyy/M/dd h:m:ss tt;yyyy/M/dd h:m:s tt;yyyy/M/d hh:mm:ss;yyyy/M/d hh:mm:s;yyyy/M/d hh:m:ss;yyyy/M/d hh:m:s;yyyy/M/d hh:mm:ss;yyyy/M/d h:mm:s;yyyy/M/d h:m:ss;yyyy/M/d h:m:s;yyyy/M/d hh:mm:ss tt;yyyy/M/d hh:mm:s tt;yyyy/M/d hh:m:ss tt;yyyy/M/d hh:m:s tt;yyyy/M/d h:mm:ss tt;yyyy/M/d h:mm:s tt;yyyy/M/d h:m:ss tt;yyyy/M/d h:m:s tt;MM/dd/yyyy hh:mm:ss;MM/dd/yyyy hh:mm:s;MM/dd/yyyy hh:m:ss;MM/dd/yyyy hh:m:s;MM/dd/yyyy hh:mm:ss;MM/dd/yyyy h:mm:s;MM/dd/yyyy h:m:ss;MM/dd/yyyy h:m:s;MM/dd/yyyy hh:mm:ss tt;MM/dd/yyyy hh:mm:s tt;MM/dd/yyyy hh:m:ss tt;MM/dd/yyyy hh:m:s tt;MM/dd/yyyy h:mm:ss tt;MM/dd/yyyy h:mm:s tt;MM/dd/yyyy h:m:ss tt;MM/dd/yyyy h:m:s tt;MM/d/yyyy hh:mm:ss;MM/d/yyyy hh:mm:s;MM/d/yyyy hh:m:ss;MM/d/yyyy hh:m:s;MM/d/yyyy hh:mm:ss;MM/d/yyyy h:mm:s;MM/d/yyyy h:m:ss;MM/d/yyyy h:m:s;MM/d/yyyy hh:mm:ss tt;MM/d/yyyy hh:mm:s tt;MM/d/yyyy hh:m:ss tt;MM/d/yyyy hh:m:s tt;MM/d/yyyy h:mm:ss tt;MM/d/yyyy h:mm:s tt;MM/d/yyyy h:m:ss tt;MM/d/yyyy h:m:s tt;M/dd/yyyy hh:mm:ss;M/dd/yyyy hh:mm:s;M/dd/yyyy hh:m:ss;M/dd/yyyy hh:m:s;M/dd/yyyy hh:mm:ss;M/dd/yyyy h:mm:s;M/dd/yyyy h:m:ss;M/dd/yyyy h:m:s;M/dd/yyyy hh:mm:ss tt;M/dd/yyyy hh:mm:s tt;M/dd/yyyy hh:m:ss tt;M/dd/yyyy hh:m:s tt;M/dd/yyyy h:mm:ss tt;M/dd/yyyy h:mm:s tt;M/dd/yyyy h:m:ss tt;M/dd/yyyy h:m:s tt;M/d/yyyy hh:mm:ss;M/d/yyyy hh:mm:s;M/d/yyyy hh:m:ss;M/d/yyyy hh:m:s;M/d/yyyy hh:mm:ss;M/d/yyyy h:mm:s;M/d/yyyy h:m:ss;M/d/yyyy h:m:s;M/d/yyyy hh:mm:ss tt;M/d/yyyy hh:mm:s tt;M/d/yyyy hh:m:ss tt;M/d/yyyy hh:m:s tt;M/d/yyyy h:mm:ss tt;M/d/yyyy h:mm:s tt;M/d/yyyy h:m:ss tt;M/d/yyyy h:m:s tt".split(";"));
return this._dateTimeFormats},_getMonthIndex:function(b){this._upperMonths||(this._upperMonths=a(this.dateTimeFormat.MonthNames),this._upperMonthsGenitive=a(this.dateTimeFormat.MonthGenitiveNames));return d(b,this._upperMonths,this._upperMonthsGenitive)},_getAbbrMonthIndex:function(b){this._upperAbbrMonths||(this._upperAbbrMonths=a(this.dateTimeFormat.AbbreviatedMonthNames),this._upperAbbrMonthsGenitive=a(this.dateTimeFormat.AbbreviatedMonthGenitiveNames));return d(b,this._upperAbbrMonths,this._upperAbbrMonthsGenitive)},
_getDayIndex:function(b){this._upperDays||(this._upperDays=a(this.dateTimeFormat.DayNames));return(new f.UI._ArrayHelper(this._upperDays)).indexOf(g(b))},_getAbbrDayIndex:function(b){this._upperAbbrDays||(this._upperAbbrDays=a(this.dateTimeFormat.AbbreviatedDayNames));return(new f.UI._ArrayHelper(this._upperAbbrDays)).indexOf(g(b))}};e._parse=b;e.invariantCulture=b({name:"",numberFormat:{CurrencyDecimalDigits:2,CurrencyDecimalSeparator:".",IsReadOnly:!0,CurrencyGroupSizes:[3],NumberGroupSizes:[3],
PercentGroupSizes:[3],CurrencyGroupSeparator:",",CurrencySymbol:"\u00a4",NaNSymbol:"NaN",CurrencyNegativePattern:0,NumberNegativePattern:1,PercentPositivePattern:0,PercentNegativePattern:0,NegativeInfinitySymbol:"-Infinity",NegativeSign:"-",NumberDecimalDigits:2,NumberDecimalSeparator:".",NumberGroupSeparator:",",CurrencyPositivePattern:0,PositiveInfinitySymbol:"Infinity",PositiveSign:"+",PercentDecimalDigits:2,PercentDecimalSeparator:".",PercentGroupSeparator:",",PercentSymbol:"%",PerMilleSymbol:"\u2030",
NativeDigits:"0123456789".split(""),DigitSubstitution:1},dateTimeFormat:{AMDesignator:"AM",Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,IsReadOnly:!0},DateSeparator:"/",FirstDayOfWeek:0,CalendarWeekRule:0,FullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",LongDatePattern:"dddd, dd MMMM yyyy",LongTimePattern:"HH:mm:ss",MonthDayPattern:"MMMM dd",PMDesignator:"PM",RFC1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",
ShortDatePattern:"MM/dd/yyyy",ShortTimePattern:"HH:mm",SortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",TimeSeparator:":",UniversalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",YearMonthPattern:"yyyy MMMM",AbbreviatedDayNames:"Sun Mon Tue Wed Thu Fri Sat".split(" "),ShortestDayNames:"Su Mo Tu We Th Fr Sa".split(" "),DayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),AbbreviatedMonthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec ".split(" "),MonthNames:"January February March April May June July August September October November December ".split(" "),
IsReadOnly:!0,NativeCalendarName:"Gregorian Calendar",AbbreviatedMonthGenitiveNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec ".split(" "),MonthGenitiveNames:"January February March April May June July August September October November December ".split(" ")},eras:[1,"A.D.",null,0]});e.currentCulture=b({name:"en-US",numberFormat:{CurrencyDecimalDigits:2,CurrencyDecimalSeparator:".",IsReadOnly:!1,CurrencyGroupSizes:[3],NumberGroupSizes:[3],PercentGroupSizes:[3],CurrencyGroupSeparator:",",CurrencySymbol:"$",
NaNSymbol:"NaN",CurrencyNegativePattern:0,NumberNegativePattern:1,PercentPositivePattern:0,PercentNegativePattern:0,NegativeInfinitySymbol:"-Infinity",NegativeSign:"-",NumberDecimalDigits:2,NumberDecimalSeparator:".",NumberGroupSeparator:",",CurrencyPositivePattern:0,PositiveInfinitySymbol:"Infinity",PositiveSign:"+",PercentDecimalDigits:2,PercentDecimalSeparator:".",PercentGroupSeparator:",",PercentSymbol:"%",PerMilleSymbol:"\u2030",NativeDigits:"0123456789".split(""),DigitSubstitution:1},dateTimeFormat:{AMDesignator:"AM",
Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,IsReadOnly:!1},DateSeparator:"/",FirstDayOfWeek:0,CalendarWeekRule:0,FullDateTimePattern:"dddd, MMMM dd, yyyy h:mm:ss tt",LongDatePattern:"dddd, MMMM dd, yyyy",LongTimePattern:"h:mm:ss tt",MonthDayPattern:"MMMM dd",PMDesignator:"PM",RFC1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",ShortDatePattern:"M/d/yyyy",ShortTimePattern:"h:mm tt",SortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",
TimeSeparator:":",UniversalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",YearMonthPattern:"MMMM, yyyy",AbbreviatedDayNames:"Sun Mon Tue Wed Thu Fri Sat".split(" "),ShortestDayNames:"Su Mo Tu We Th Fr Sa".split(" "),DayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),AbbreviatedMonthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec ".split(" "),MonthNames:"January February March April May June July August September October November December ".split(" "),IsReadOnly:!1,
NativeCalendarName:"Gregorian Calendar",AbbreviatedMonthGenitiveNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec ".split(" "),MonthGenitiveNames:"January February March April May June July August September October November December ".split(" ")},eras:[1,"A.D.",null,0]});f.UI._CultureInfo=e;var s=f.UI._StringHelper=function(){function a(b){this._str=b}a.prototype={startsWith:function(a){return this._str.substr(0,a.length)===a},endsWith:function(a){return-1!==this._str.indexOf(a,this._str.length-
a.length)},trim:function(){return this._str.replace(/^\s+|\s+$/g,"")},trimEnd:function(){return this._str.replace(/\s+$/,"")},trimStart:function(){return this._str.replace(/^\s+/,"")}};a.format=function(a,b){for(var e=arguments,d="",h=e[0],f=0;;){var g=h.indexOf("{",f),k=h.indexOf("}",f);if(0>g&&0>k){d+=h.slice(f);break}if(0<k&&(k<g||0>g)){if("}"!==h.charAt(k+1))throw Error("format: brace mis-match");d+=h.slice(f,k+1);f=k+2}else if(d+=h.slice(f,g),f=g+1,"{"===h.charAt(f))d+="{",f++;else{if(0>k)throw Error("format: brace mis-match");
var g=h.substring(f,k),l=g.indexOf(":"),f=parseInt(0>l?g:g.substring(0,l),10)+1;if(isNaN(f))throw Error("invalid format");g=0>l?"":g.substring(l+1);f=e[f];if("undefined"===typeof f||null===f)f="";d=f.toFormattedString?d+f.toFormattedString(g):f.format?d+f.format(g):d+f.toString();f=k+1}}return d};return a}();f.UI._DateTimeHelper=function(){function a(b,h){for(var e=0,d=!1,f=0,g=b.length;f<g;f++){var k=b.charAt(f);switch(k){case "'":case '"':d?h.append("'"):e++;d=!1;break;case "\\":d&&h.append("\\");
d=!d;break;default:h.append(k),d=!1}}return e}function b(a,h){h||(h="F");var e=h.length;if(1===e)switch(h){case "d":return a.ShortDatePattern;case "D":return a.LongDatePattern;case "t":return a.ShortTimePattern;case "T":return a.LongTimePattern;case "f":return a.LongDatePattern+" "+a.ShortTimePattern;case "F":return a.FullDateTimePattern;case "M":case "m":return a.MonthDayPattern;case "s":return a.SortableDateTimePattern;case "Y":case "y":return a.YearMonthPattern;case "g":return a.ShortDatePattern+
" "+a.ShortTimePattern;case "G":return a.ShortDatePattern+" "+a.LongTimePattern;case "R":case "r":return a.RFC1123Pattern;case "u":return a.UniversalSortableDateTimePattern;case "U":return a.FullDateTimePattern;case "o":case "O":return"yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fffffff";default:throw Error("InvalidString");}else 2===e&&"%"===h.charAt(0)&&(h=h.charAt(1));return h}function d(a,b){if(!b)return 0;for(var h,e=a.getTime(),f=0,g=b.length;f<g;f+=4)if(h=b[f+2],null===h||e>=h)return f;return 0}function g(a,
b,h,e){a=a.getFullYear();!e&&b.eras&&(a-=b.eras[h+3]);return a}function n(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g|\[h\]|\[mm\]|\[ss\]/g}function h(h,e,m){h=l.trim(h);var I=m.dateTimeFormat;a:{if(!I._parseRegExp)I._parseRegExp={};else if(I._parseRegExp[e]){e=I._parseRegExp[e];break a}for(var p=b(I,e),p=p.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),E=new k("^"),C=new f.UI._ArrayHelper([]),H=0,O=0,D=n(),w;null!==(w=D.exec(p));){var M=
p.slice(H,w.index),H=D.lastIndex,O=O+a(M,E);if(1===O%2)E.append(w[0]);else{switch(w[0]){case "dddd":case "ddd":case "MMMM":case "MMM":case "gg":case "g":E.append("(\\D+)");break;case "tt":case "t":E.append("(\\D*)");break;case "yyyy":E.append("(\\d{4})");break;case "fff":E.append("(\\d{3})");break;case "ff":E.append("(\\d{2})");break;case "f":E.append("(\\d)");break;case "dd":case "d":case "MM":case "M":case "yy":case "y":case "HH":case "H":case "hh":case "h":case "mm":case "m":case "ss":case "s":E.append("(\\d\\d?)");
break;case "zzz":E.append("([+-]?\\d\\d?:\\d{2})");break;case "zz":case "z":E.append("([+-]?\\d\\d?)");break;case "/":E.append("(\\"+I.DateSeparator+")");break;default:throw Error("Invalid date format pattern");}C.add(w[0])}}a(p.slice(H),E);E.append("$");p={regExp:E.toString().replace(/\s+/g,"\\s+"),groups:C.array()};e=I._parseRegExp[e]=p}var T=RegExp(e.regExp).exec(h);if(null===T)return null;var P=e.groups,G=e=null,C=E=p=null,H=0,v;w=D=O=0;v=null;M=!1;h=!0;for(var V=0,N=P.length;V<N;V++){var R=T[V+
1];if(R)switch(P[V]){case "dd":case "d":h=!1;E=parseInt(R,10);if(1>E||31<E)return null;break;case "MMMM":h=!1;p=m._getMonthIndex(R);if(0>p||11<p)return null;break;case "MMM":h=!1;p=m._getAbbrMonthIndex(R);if(0>p||11<p)return null;break;case "M":case "MM":h=!1;p=parseInt(R,10)-1;if(0>p||11<p)return null;break;case "y":case "yy":h=!1;var G=I,R=parseInt(R,10),ga=new Date,ba=d(ga);100>R&&(ga=g(ga,G,ba),R+=ga-ga%100,R>G.Calendar.TwoDigitYearMax&&(R-=100));G=R;if(0>G||9999<G)return null;break;case "yyyy":h=
!1;G=parseInt(R,10);if(0>G||9999<G)return null;break;case "h":case "hh":case "H":case "HH":H=parseInt(R,10);if(0>H||23<H)return null;break;case "m":case "mm":O=parseInt(R,10);if(0>O||59<O)return null;break;case "s":case "ss":D=parseInt(R,10);if(0>D||59<D)return null;break;case "tt":case "t":R=R.toUpperCase();M=R===I.PMDesignator.toUpperCase();if(!M&&R!==I.AMDesignator.toUpperCase())return null;break;case "f":w=100*parseInt(R,10);if(0>w||999<w)return null;break;case "ff":w=10*parseInt(R,10);if(0>w||
999<w)return null;break;case "fff":w=parseInt(R,10);if(0>w||999<w)return null;break;case "dddd":h=!1;C=m._getDayIndex(R);if(0>C||6<C)return null;break;case "ddd":h=!1;C=m._getAbbrDayIndex(R);if(0>C||6<C)return null;break;case "zzz":ga=R.split(/:/);if(2!==ga.length)return null;v=parseInt(ga[0],10);if(-12>v||13<v)return null;ga=parseInt(ga[1],10);if(0>ga||59<ga)return null;v=60*v+((new s(R)).startsWith("-")?-ga:ga);break;case "z":case "zz":v=parseInt(R,10);if(-12>v||13<v)return null;v*=60;break;case "g":case "gg":if(!R||
!I.eras)return null;R=R.toLowerCase().trim();ga=0;for(ba=I.eras.length;ga<ba;ga+=4)if(R===I.eras[ga+1].toLowerCase()){e=ga;break}if(null===e)return null}}m=new Date;var W;(T=I.Calendar.convert)&&(W=T.fromGregorian(m));T||(W=[m.getFullYear(),m.getMonth(),m.getDate()]);null===G?G=W[0]:I.eras&&(G+=I.eras[(e||0)+3]);null===p&&(p=W[1]);null===E&&(E=W[2]);if(T){if(m=T.toGregorian(G,p,E),null===m)return null}else if(m.setFullYear(G,p,E),m.getDate()!==E||null!==C&&m.getDay()!==C)return null;M&&12>H&&(H+=
12);m.setHours(H,O,D,w);null!==v&&(I=m.getMinutes()-(v+m.getTimezoneOffset()),m.setHours(m.getHours()+parseInt(I/60,10),I%60));m._classNames=[h?"TimeSpan":"DateTime"];return m}function I(a){return 10>a?"0"+a:a.toString()}function p(a){return 10>a?"00"+a:100>a?"0"+a:a.toString()}function O(a){return 10>a?"000"+a:100>a?"00"+a:1E3>a?"0"+a:a.toString()}function H(a,b,e){var d,f,g,k=!1;d=1;for(f=e.length;d<f;d++)if(g=e[d])if(k=!0,g=h(a,g,b))return g;if(!k)for(e=b._getDateTimeFormats(),d=0,f=e.length;d<
f;d++)if(g=h(a,e[d],b))return g;return null}function C(a){this._date=a}var G=new Date(1899,11,30);C.prototype={Hour:function(){return this._date.getHours()},Minute:function(){return this._date.getMinutes()},Second:function(){return this._date.getSeconds()},Millisecond:function(){return this._date.getMilliseconds()},TotalDays:function(){return Math.floor(this.toOADate())},toOADate:function(){var a;a=this._date;a=a===m||null===a?0:(a-G)/864E5;return a},format:function(a){return this._toFormattedString(a,
e.invariantCulture)},localeFormat:function(a){return this._toFormattedString(a,e.currentCulture)},_toFormattedString:function(h,e){function f(){if(D||w)return D;D=M.test(h);w=!0;return D}function l(a,b){if(ia)return ia[b];switch(b){case 0:return a.getFullYear();case 1:return a.getMonth();case 2:return a.getDate()}}var m=e.dateTimeFormat,s=m.Calendar.convert;if(!h||!h.length||"i"===h){if(e&&e.name.length){if(s)return this._toFormattedString(m.FullDateTimePattern,e);var C=new Date(this._date.getTime()),
H=d(this._date,m.eras);C.setFullYear(g(this._date,m,H));return C.toLocaleString()}return this._date.toString()}C=m.eras;H="s"===h;h=b(m,h);var G=new k,D,w,M=/([^d]|^)(d|dd)([^d]|$)/g,T=0,P=n(),ia;for(!H&&s&&(ia=s.fromGregorian(this._date));;){var v=P.lastIndex,s=P.exec(h),v=h.slice(v,s?s.index:h.length),T=T+a(v,G);if(!s)break;if(1===T%2)G.append(s[0]);else switch(s[0]){case "dddd":G.append(m.DayNames[this._date.getDay()]);break;case "ddd":G.append(m.AbbreviatedDayNames[this._date.getDay()]);break;
case "dd":D=!0;G.append(I(l(this._date,2)));break;case "d":D=!0;G.append(l(this._date,2));break;case "MMMM":G.append(m.MonthGenitiveNames&&f()?m.MonthGenitiveNames[l(this._date,1)]:m.MonthNames[l(this._date,1)]);break;case "MMM":G.append(m.AbbreviatedMonthGenitiveNames&&f()?m.AbbreviatedMonthGenitiveNames[l(this._date,1)]:m.AbbreviatedMonthNames[l(this._date,1)]);break;case "MM":G.append(I(l(this._date,1)+1));break;case "M":G.append(l(this._date,1)+1);break;case "yyyy":case "yyy":G.append(O(ia?ia[0]:
g(this._date,m,d(this._date,C),H)));break;case "yy":G.append(I((ia?ia[0]:g(this._date,m,d(this._date,C),H))%100));break;case "y":G.append((ia?ia[0]:g(this._date,m,d(this._date,C),H))%100);break;case "hh":s=this._date.getHours()%12;0===s&&(s=12);G.append(I(s));break;case "h":s=this._date.getHours()%12;0===s&&(s=12);G.append(s);break;case "HH":G.append(I(this._date.getHours()));break;case "H":G.append(this._date.getHours());break;case "mm":G.append(I(this._date.getMinutes()));break;case "m":G.append(this._date.getMinutes());
break;case "ss":G.append(I(this._date.getSeconds()));break;case "s":G.append(this._date.getSeconds());break;case "tt":G.append(12>this._date.getHours()?m.AMDesignator:m.PMDesignator);break;case "t":G.append((12>this._date.getHours()?m.AMDesignator:m.PMDesignator).charAt(0));break;case "f":G.append(p(this._date.getMilliseconds()).charAt(0));break;case "ff":G.append(p(this._date.getMilliseconds()).substr(0,2));break;case "fff":G.append(p(this._date.getMilliseconds()));break;case "z":s=this._date.getTimezoneOffset()/
60;G.append((0>=s?"+":"-")+Math.floor(Math.abs(s)));break;case "zz":s=this._date.getTimezoneOffset()/60;G.append((0>=s?"+":"-")+I(Math.floor(Math.abs(s))));break;case "zzz":s=this._date.getTimezoneOffset()/60;G.append((0>=s?"+":"-")+I(Math.floor(Math.abs(s)))+":"+I(Math.abs(this._date.getTimezoneOffset()%60)));break;case "g":case "gg":m.eras&&G.append(m.eras[d(this._date,C)+1]);break;case "/":G.append(m.DateSeparator);break;case "[h]":G.append("[h]");break;case "[mm]":G.append("[mm]");break;case "[ss]":G.append("[ss]");
break;default:throw Error("Invalid date format pattern");}}return G.toString()}};C.parseLocale=function(a,b){return H(a,e.currentCulture,arguments)};C.parseInvariant=function(a,b){return H(a,e.InvariantCulture,arguments)};C.parseExact=h;C.fromOADate=function(a){if(0>a)throw Error("invalid OADate");var b=new Date(G);b.setMilliseconds(864E5*a);return b};return C}();f.UI._NumberHelper=function(){function a(b){for(var h={symbol:b.charAt(0),sign:0},e="",d=1;d<b.length;d++)if(e=b.charAt(d),"+"===e)h.sign=
1;else if("-"===e)h.sign=-1;else if("0"===e){h.exp=b.length-d;break}else throw Error("invalid exponent format");return h}function b(a,h,e){for(var d=a.length;d<h;d++)a=e?"0"+a:a+"0";return a}function d(a,b,h,e){e=b[0];for(var f=1,g=a.length-1,l=new k(""),n=0,m=!1;0<=g;){if(1>e||9<e)throw Error("NumberGroupSize must be between 1 and 9.");/\d/ig.test(a[g])&&(m&&(l.insert(h,0),m=!1),n++);l.insert(a[g],0);n===e&&(m=!0,n=0,f<b.length&&(e=b[f],f++));g--}return l.toString()}function g(a,h,e,f,k,l,n){var m=
Math.pow(10,h),m=Math.round(a*m)/m;isFinite(m)||(m=a);a=m;var m=a.toString(),q,s;q=m.split(/e/i);m=q[0];s=1<q.length?parseInt(q[1],10):0;q=m.split(".");m=q[0];q=1<q.length?q[1]:"";0<s?(q=b(q,s,!1),m+=q.slice(0,s),q=q.substr(s)):0>s&&(s=-s,m=0>a?l+b(m.replace(l,""),s+1,!0):b(m,s+1,!0),q=m.slice(-s,m.length)+q,m=m.slice(0,-s));0<h?(q=q.length>h?q.slice(0,h):b(q,h,!1),q=k+q):q="";return!0===n?m+q:d(m,e,f,l)+q}function l(a,h,e){var f=new k("");a*=Math.pow(100,h.percent);a*=Math.pow(1E3,h.permile);a/=
Math.pow(10,3*h.scale);var n=h.intPart,m=h.decPart;if(!n&&!m)return"";var q=null,s=null,M,p,I,E;if(n)for(q="",M=0;M<n.length;M++)p=n[M],/^(0|#)+/g.test(p)&&(q+=p);if(m)for(s="",I=0;I<m.length;I++)E=m[I],/^(0|#)+/g.test(E)&&(s+=E);if(q||s)s||(s="");else return(n?n.join(""):"")+(m?m.join(""):"");var C=0;M=a;var z=e.NumberDecimalSeparator,G=Math.floor(Math.abs(M));I=1;for(E=0;10<=G;)G/=10,I++;M=M.toString();G=M.search(/e/ig);E=M.indexOf(z);-1!==G?(z=M.substr(0,G),G=M.substr(G+1),M=0,-1!==E&&(M=z.substr(E+
1).length),E=parseFloat(G),z=M-E,0>z&&(z=0)):(z=0,-1!==E&&(z=M.substr(E+1).length));E=z;if(h.exponent)if(z=Math.abs(a),M=q?q.length:1,1<=z)I>M?(I-=M,E+=M,a/=Math.pow(10,I),C=I):C=0,-1===h.exponent.sign&&(h.exponent.sign=0);else if(1>z&&0<z){h.exponent.sign=-1;E-=M;for(I=Math.pow(10,M);10*z<I;)z*=10,C++;a*=Math.pow(10,C)}I=s.lastIndexOf("0");0<=I&&(E=I+1);z=g(a,E,e.NumberGroupSizes,e.NumberGroupSeparator,e.NumberDecimalSeparator,e.NegativeSign,!0);if(""===z)return(n?n.join(""):"")+(m?m.join(""):"");
a=!1;if(n){var G=z.split(e.NumberDecimalSeparator)[0],O=G.substr(0,1);O===e.NegativeSign&&(G=G.substr(1));var S=0,ba="",W=q.indexOf("0"),ja=-1===W?G.length:q.length-W;for(M=n.length-1;0<=M;M--)if(p=n[M],/^(0|#)+/g.test(p))if(ba=p+ba,ba!==q){p=p.length;for(var fa=G.length-S-1;0<=fa&&0<p;fa--){var la=G.charAt(fa);f._insert(la);p--;S++}S>=G.length&&S<ja&&0<p&&(f._insert(Array(p+1).join("0")),S+=p)}else p=G.substr(0,G.length-S),0<=W&&W<q.length-S-p.length&&(p=Array(q.length-S-W-p.length+1).join("0")+
p),f._insert(p);else h.exponent&&!a&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(p)&&(a=!0,p="",p+=h.exponent.symbol,p+=H[h.exponent.sign],p+=b(C.toString(),h.exponent.exp,!0)),f._insert(p);O===e.NegativeSign&&f._insert(O);!0===h.group&&(f=new k(d(f.toString(),e.NumberGroupSizes,e.NumberGroupSeparator,e.NegativeSign)))}if(m)for(n="",0<E?(s=z.indexOf(e.NumberDecimalSeparator),-1!==s&&(n=z.substring(s+1),""===q&&f.append(z.substr(0,s)),f.append(e.NumberDecimalSeparator))):/^(#+)$/ig.test(s)&&m.join("").length===
s.length||(f.append(e.NumberDecimalSeparator),0<I&&(n=Array(I+1).join("0"))),I=e=0;I<m.length;I++)E=m[I],/^(0|#)+/g.test(E)?(f.append(n.substr(e,E.length)),e+=E.length):h.exponent&&!a&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(E)?(a=!0,p="",p+=h.exponent.symbol,p+=H[h.exponent.sign],p+=b(C.toString(),h.exponent.exp,!0),f.append(p)):f.append(E);return f.toString()}function h(a,b,h){var e=b.NegativeSign;b=b.PositiveSign;var d=new s(a);if(4===h||2===h)e=" "+e,b=" "+b;if(4===h||3===h){if(d.endsWith(e))return["-",
a.substr(0,a.length-e.length)];if(d.endsWith(b))return["+",a.substr(0,a.length-b.length)]}else if(2===h||1===h){if(d.startsWith(e))return["-",a.substr(e.length)];if(d.startsWith(b))return["+",a.substr(b.length)]}else if(0===h){if(d.startsWith("(")&&d.endsWith(")"))return["-",a.substr(1,a.length-2)]}else throw Error("");return["",a]}function I(a,b){a=a!==m&&null!==a?(new f.UI._StringHelper(a)).trim():"";if(a.match(/^[+-]?infinity$/i))return parseFloat(a);if(a.match(/^0x[a-f0-9]+$/i))return parseInt(a,
10);var e=b.numberFormat,d=h(a,e,e.NumberNegativePattern),g=d[0],d=d[1];""===g&&1!==e.NumberNegativePattern&&(d=h(a,e,1),g=d[0],d=d[1]);""===g&&(g="+");d[0]===e.CurrencySymbol&&(d=d.substr(1));var l,n=d.indexOf("e");0>n&&(n=d.indexOf("E"));0>n?(l=d,d=null):(l=d.substr(0,n),d=d.substr(n+1));var q=l.indexOf(e.NumberDecimalSeparator);0>q?(n=l,l=null):(n=l.substr(0,q),l=l.substr(q+e.NumberDecimalSeparator.length));n=n.split(e.NumberGroupSeparator).join("");q=e.NumberGroupSeparator.replace(/\u00A0/g," ");
e.NumberGroupSeparator!==q&&(n=n.split(q).join(""));g+=n;null!==l&&(g+="."+l);g[g.length-1]===e.PercentSymbol&&(g=g.substr(0,g.length-1),g=(new f.UI._StringHelper(g)).trimEnd(),l=g.indexOf(e.NumberDecimalSeparator),-1===l&&(l=g.length),n=new k(""),n.append(g.substr(0,l-2)),n.append(e.NumberDecimalSeparator),n.append(g.substr(l-2,2)),n.append(g.substr(l+1)),g=n.toString());null!==d&&(e=h(d,e,1),""===e[0]&&(e[0]="+"),g+="e"+e[0]+e[1]);return g.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?parseFloat(g):NaN}
function p(a,h,e,d,f,k,l){for(var n=0,m=1<=a||0===a,q=m?function(a,b){return 10>a/b}:function(a,b){return 1<=a*b};1E3>n;){var s=Math.pow(10,n);if(q(a,s))break;n++}a=m?Math.abs(a)/Math.pow(10,n):Math.abs(a)*Math.pow(10,n);a=g(a,e,d,f,k,l);return a+=h+(m?"+":"-")+b(n.toString(),3,!0)}function O(a){this._num=a}var H={1:"+",0:"","-1":"-"},C=["n %","n%","%n"],G=["-n %","-n%","-%n"],z=["(n)","-n","- n","n-","n -"],S=["$n","n$","$ n","n $"],Q="($n);-$n;$-n;$n-;(n$);-n$;n-$;n$-;-n $;-$ n;n $-;$ n-;$ -n;n- $;($ n);(n $)".split(";");
O.prototype={format:function(a){return this._toFormattedString(a,e.invariantCulture)},localeFormat:function(a){return this._toFormattedString(a,e.currentCulture)},_toFormattedString:function(a,b){return a&&0!==a.length&&"i"!==a?/^(C|c|D|d|E|e|F|f|G|g|N|n|P|p|R|r|X|x)(\d*)$/g.test(a)?this._toStandardFormattedString(a,b.numberFormat):this._toCustomFormattedString(a,b.numberFormat):b&&0<b.name.length?this._num.toLocaleString():this._num.toString()},_toStandardFormattedString:function(a,h){var e=Math.abs(this._num);
a||(a="D");var d=-1;1<a.length&&(d=parseInt(a.slice(1),10));var f;switch(a.charAt(0)){case "d":case "D":f="n";-1!==d&&(e=b(""+e,d,!0));0>this._num&&(e="-"+e);break;case "c":case "C":f=0>this._num?Q[h.CurrencyNegativePattern]:S[h.CurrencyPositivePattern];-1===d&&(d=h.CurrencyDecimalDigits);e=g(Math.abs(this._num),d,h.CurrencyGroupSizes,h.CurrencyGroupSeparator,h.CurrencyDecimalSeparator,h.NegativeSign);break;case "n":case "N":f=0>this._num?z[h.NumberNegativePattern]:"n";-1===d&&(d=h.NumberDecimalDigits);
e=g(Math.abs(this._num),d,h.NumberGroupSizes,h.NumberGroupSeparator,h.NumberDecimalSeparator,h.NegativeSign);break;case "p":case "P":f=0>this._num?G[h.PercentNegativePattern]:C[h.PercentPositivePattern];-1===d&&(d=h.PercentDecimalDigits);e=g(100*Math.abs(this._num),d,h.PercentGroupSizes,h.PercentGroupSeparator,h.PercentDecimalSeparator,h.NegativeSign);break;case "F":case "f":f=this._toFixedPoint(e,f,a,d,h);e=f[0];f=f[1];break;case "e":case "E":f=this._toScientificNotation(e,f,a,d,h);e=f[0];f=f[1];
break;case "x":case "X":f="n";var k=this._num,e="x"===a.charAt(0),d=-1===d?0:d;if(0!==Math.abs(Math.floor(k)-k))throw Error("Bad Format Specifier");k=0<=k?k.toString(16):(4294967295+k+1).toString(16);k=e?k.toLowerCase():k.toUpperCase();e=d!==m&&null!==d&&k.length<d?b(k,d,!0):k;break;case "g":case "G":k=this._num.toString();f=-1===k.indexOf("e")&&-1===k.indexOf("E")?this._toFixedPoint(e,f,a,d,h):this._toScientificNotation(e,f,a.replace("g","e").replace("G","E"),d,h);e=f[0];f=f[1];break;default:throw Error("Bad Format Specifier");
}d=/n|\$|-|%/g;for(k="";;){var l=d.lastIndex,n=d.exec(f),k=k+f.slice(l,n?n.index:f.length);if(!n)break;switch(n[0]){case "n":k+=e;break;case "$":k+=h.CurrencySymbol;break;case "-":/[1-9]/.test(e)&&(k+=h.NegativeSign);break;case "%":k+=h.PercentSymbol;break;default:throw Error("Invalid number format pattern");}}return k},_toScientificNotation:function(a,b,h,e,d){b="n";a=p(Math.abs(this._num),h.charAt(0),-1===e?6:e,d.NumberGroupSizes,d.NumberGroupSeparator,d.NumberDecimalSeparator,d.NegativeSign);0>
this._num&&(a="-"+a);return[a,b]},_toFixedPoint:function(a,b,h,e,d){b=0>this._num?z[d.NumberNegativePattern]:"n";-1===e&&(e=2);h=Math.floor(a);a=g(a-h,e,d.NumberGroupSizes,d.NumberGroupSeparator,d.NumberDecimalSeparator,d.NegativeSign);a=""+h+a.substring(1);return[a,b]},_toCustomFormattedString:function(b,h){for(var e=null,d=null,f=null,g={intPart:null,decPart:null,group:!1,scale:0,percent:0,permile:0,exponent:null},k="",s=!1,r=!1,t=!1,u=!1,p=!1,I=!1,E=!1,C=null,H=null,z=[],ba=0;ba<b.length;ba++){C=
b.charAt(ba);if(s)"'"!==C?k+=C:(z.push(k),k="",s=!1);else if(r)'"'!==C?k+=C:(z.push(k),k="",r=!1);else{if(t)if("E"===H||"e"===H)if("+"===C||"-"===C||"0"===C){k+=C;continue}else t=!1;else if("+"===H||"-"===H)if("0"===C){k+=C;continue}else t=!1,z.push(k),k="";else{if("0"===H)if("0"===C){k+=C;continue}else t=!1,I||(I=!0,g.exponent=a(k)),z.push(k),k=""}else if("0"===C||"#"===C)if(E=!0,"0"===H||"#"===H){k+=C;H=C;continue}else""!==k&&(z.push(k),k="");else"0"!==H&&"#"!==H||"0"===C||"#"===C||(z.push(k),k=
"");if(";"===C){""!==k&&(t&&!I&&(g.exponent=a(k)),z.push(k),k="");u?g.decPart=C:g.intPart=z;z=[];if(e===m||null===e)e=g;else if(d===m||null===d)d=g;else if(f===m||null===f)f=g;else throw Error("invalid format: too much semicolons");E=u=!1;p&&(g.group=!0,p=!1);g={intPart:null,decPart:null,group:!1,scale:0,percent:0,permile:0,exponent:null}}else if("."===C)""!==k&&(z.push(k),k=""),g.intPart=z,z=[],u=!0,E=!1,p&&(g.group=!0,p=!1);else if("'"===C)s=!0;else if('"'===C)r=!0;else if("%"===C)g.percent++,z.push(C);
else if("\u2030"===C)g.permile++,z.push(C);else if("0"===C||"#"===C)k+=C;else if(","===C)if(u)""!==k&&(z.push(k),k="");else{""!==k&&(z.push(k),k="");if(!E)continue;for(var H=!0,W="",ja=ba+1;ja<b.length;ja++){var G=b.charAt(ja);if(""!==W){if("'"===G||'"'===G)W=""}else if("'"===G||'"'===G)W=G;else if("0"===G||"#"===G){H=!1;break}else if("."===G||";"===G)break}H?g.scale++:p=!0}else"E"===C||"e"===C?(t=!0,""!==k&&z.push(k),k=C):k+=C}H=C}""!==k&&(t&&!I&&(g.exponent=a(k)),z.push(k));p&&(g.group=!0);u?g.decPart=
z:g.intPart=z;if(e===m||null===e)e=g;else if(d===m||null===d)d=g;else if(f===m||null===f)f=g;g=null;0===this._num?g=f:0>this._num&&(g=d);g||(g=e);e=l(this._num,g,h)+"";1===e.indexOf(h.NegativeSign)&&0===e.indexOf(h.CurrencySymbol)&&(e=e[1]+e[0]+e.substring(2));return e}};O.parseLocale=function(a){return I(a,e.currentCulture)};O.parseInvariant=function(a){return I(a,e.invariantCulture)};return O}()})(this,jQuery);
(function(p){function l(){this.strValue=""}function m(a,b){if(void 0===a||null===a)return"null"===b;if(!b)return!1;var h={undefined:"undefined",number:"number","boolean":"boolean",string:"string"};if(h[typeof a]===b||"function"===b&&/^\s*\bfunction\b/.test(""+a)||Object.prototype.toString.call(a).slice(8,-1).toLowerCase()===b.toLowerCase())return!0;if(a&&a._classNames){for(h=0;h<a._classNames.length;h++)if(a._classNames[h]===b)return!0;return!1}return void 0===a||null===a?!1:"DateTime"===b||"TimeSpan"===
b?a instanceof Date:"string"===typeof b&&h[b]?!1:a instanceof b}function k(a,b){return m(a,b)?a:null}function g(a){this.value=a}function a(a,b){this._classNames=["NumberFormatBase","IFormatter","IFormatProviderSupport"];this._initFileds();this.partLocaleID=a;this.partDbNumberFormat=b}function d(a){this._classNames=["StandardDateTimeFormatter","IFormatter"];this._formatString=a}function e(a){this._classNames=["StandardNumberFormatter","IFormatter"];this._formatString=a}function b(b,h,e){this._classNames=
["NumberFormatText","IFormatter"];b=a.TrimNotSupportSymbol(b,!1);h&&(b=J.ReplaceKeyword(b,this.PartLocaleID().OriginalToken(),this.PartLocaleID().CurrencySymbol()));b=J.Filter(b,J.LeftSquareBracket,J.RightSquareBracket);this._formatString=b=J.TrimEscape(b)}function f(b,h){this._classNames=["GeneralFormatter","IFormatter","INotifyPropertyChanged","IColorFormatter"];this._initFileds();G.IsNullOrEmpty(b)&&(b=a.General);h||(h=Q.CustomMode);this.formatCached=b;this.formatModeType=h;this.isDefault=this.formatCached.toLowerCase()===
a.General.toLowerCase();this.isConstructed=!1}function s(b,h,e){this.fullFormatString=this.exponentialDigitalFormat=this.digitalFormat=null;a.call(this,h,e);this._classNames.push("NumberFormatGeneral");if(0<arguments.length)if(s.EvaluateFormat(b)){if(b.Contains(J.Zero)||b.Contains(J.NumberSign)||b.Contains(J.DecimalSeparator)||b.Contains(J.CommercialAt))throw"format is illegal.";this.fullFormatString=b}else throw"format is illegal.";else this.fullFormatString=a.General}function q(b){this._classNames=
["CustomNumberFormat","IFormatter","IFormatProviderSupport"];this._initFileds();0===arguments.length?(this.formatCached=a.General,this.numberFormat=new s):this.Init(b)}function t(a,b,h,e){if(h&&0<h.length)for(var d in h)if(h.hasOwnProperty(d)){var f=C.UI._DateTimeHelper.parseLocale(a,h[d]);if(f&&0===f-b)return e.call()}return null}function r(a){this._classNames=["FormatPartBase"];this._initFileds();this.originalToken=a}function u(b,h,e,d){a.call(this,e,d);this._classNames.push("NumberFormatDateTime");
this._initFileds();this.ExactlyMatch=!1;this.formatString=this.FixFormat(a.TrimNotSupportSymbol(b));this.absTimeParts=h;this._init(b,h,e,d)}function n(b,h,e){this.fullFormatString=this.numberFormatString=null;this.isGeneralNumber=!1;this.fractionDenominatorFormat=this.fractionNumeratorFormat=this.fractionIntegerFormat=null;this.excelFormatString=G.Empty;a.call(this,h,e);this._classNames.push("NumberFormatDigital");e=a.TrimNotSupportSymbol(b);this.fullFormatString=J.Filter(b,J.LeftSquareBracket,J.RightSquareBracket);
this.excelFormatString=e;h&&(e=J.ReplaceKeyword(e,this.PartLocaleID().OriginalToken(),this.PartLocaleID().CurrencySymbol()));this.PartDBNumberFormat()&&(this.excelFormatString=J.ReplaceKeyword(this.excelFormatString,this.PartDBNumberFormat().OriginalToken(),this.PartDBNumberFormat().toString()));e=J.Filter(e,J.LeftSquareBracket,J.RightSquareBracket);-1<e.indexOf(J.SolidusSign)&&(e=z.Replace(e,"\\"+J.QuestionMark,J.Zero),(b=e.split(J.SolidusSign))&&2===b.length&&(this.fractionDenominatorFormat=b[1],
b=b[0]))&&(h=b.lastIndexOf(J.Space),-1<h?(this.fractionIntegerFormat=b.substr(0,h),this.fractionNumeratorFormat=b.substr(h+1,b.length-h-1)):this.fractionNumeratorFormat=b);this.numberFormatString=e}function h(a){r.call(this,a);this._classNames.push("ConditionFormatPart");this._initFileds();a=J.TrimSquareBracket(a);if(G.IsNullOrEmpty(a))throw Error("token is illegal.");for(var b=null,h=0,e=null;h<a.length;h++)if(e=a[h],J.IsOperator(e))b||(b=new l),b.Append(e);else break;if(!b)throw Error("token is illegal.");
e=b.toString();b=null;switch(e){case "<":this.compareOperator=K.LessThan;break;case "<=":this.compareOperator=K.LessThanOrEqualsTo;break;case "=":this.compareOperator=K.EqualsTo;break;case ">=":this.compareOperator=K.GreaterThanOrEqualsTo;break;case ">":this.compareOperator=K.GreaterThan;break;case "<>":this.compareOperator=K.NotEqualsTo;break;default:throw Error("token is illegal.");}for(;h<a.length;h++){e=a[h];if(J.IsOperator(e))throw Error("token is illegal.");b||(b=new l);b.Append(e)}if(!b)throw Error("token is illegal.");
a=parseFloat(b.toString());if(isNaN(a))throw Error("token is illegal.");this.value=a}function I(a){this.foreColor="black";this.index=-1;this.colorName=null;r.call(this,a);this._classNames.push("ColorFormatPart");a=J.TrimSquareBracket(a);if(!a||a===G.Empty)throw Error("token is illegal.");try{this.colorName=this.foreColor=a;return}catch(b){}if(5<a.length){a=z.Remove(a,0,5);var h=-1;a=parseInt(a,10);if(!isNaN(a)&&(h=a,1<=h&&56>=h))return}throw Error("token is illegal.");}function E(a){r.call(this,a);
this._classNames.push("ABSTimeFormatPart");this._initFileds();if(E.EvaluateFormat(a))if(this.token=a.toLowerCase(),this.token[1]===E.HoursABSContent)this.type=ka.Hour;else if(this.token[1]===E.MinuteABSContent)this.type=ka.Minute;else if(this.token[1]===E.SecondABSContent)this.type=ka.Second;else throw Error("token is illegal.");else throw Error("token is illegal.");a=new l;for(var b=0;b<this.token.length-2;b++)a.Append("0");this.formatString=a.toString()}function O(a){r.call(this,a);this._classNames.push("DBNumberFormatPart");
this._initFileds();if(O.EvaluateFormat(a)){if(this.token=a,a=J.TrimSquareBracket(a),a=z.Remove(a,0,5),this.type=parseInt(a,10),0>this.type||3<this.type)throw Error("token is illegal.");}else throw Error("token is illegal.");}function H(a){r.call(this,a);this._classNames.push("LocaleIDFormatPart");this._initFileds();if(!a)throw Error("token");if(a===G.Empty)throw Error("token is illegal.");a=this.content=J.TrimSquareBracket(a);if(!a||a===G.Empty)throw Error("token is illegal.");if(J.IsEquals(a[0],
J.Dollar,!1))a=z.Remove(a,0,1);else throw Error("token is illegal.");var b=a.indexOf(J.HyphenMinus);if(-1<b){this.currencySymbol=a.substr(0,b);a=z.Remove(a,0,b);if(J.IsEquals(a[0],J.HyphenMinus,!1))a=z.Remove(a,0,1);else throw Error("token is illegal.");if(0<a.length)this.locateID=w.ParseHexString(a);else throw Error("token is illegal.");}else this.currencySymbol=a}var C=p.GrapeCity;"undefined"===typeof C&&(C=p.GrapeCity={});"undefined"===typeof C.UI&&(C.UI={});var G={Empty:"",Format:function(){if(0===
arguments.length)return null;for(var a=arguments[0],b=1;b<arguments.length;b++)a=a.replace(RegExp("\\{"+(b-1)+"\\}","gm"),arguments[b]);return a},IsNullOrEmpty:function(a){return!a||a===G.Empty}},z={Contains:function(a,b){return""===b||0<=a.indexOf(b)},IndexOf:function(a,b,h){h&&1===h&&(a=a.toLowerCase(),b=b.toLowerCase());return a.indexOf(b)},TrimStart:function(a,b){if(!b)return a;for(var h=a;h.substr(0,b.length)===b;)h=h.substr(b.length);return h},TrimEnd:function(a,b){if(!b)return a;for(var h=
a;h.substr(h.length-b.length,b.length)===b;)h=h.substr(0,h.length-b.length);return h},Trim:function(a,b){var h=b;b||(h=" ");a=this.TrimStart(a,h);return a=this.TrimEnd(a,h)},Insert:function(a,b,h){if(0>b||b>a.length||null===h||void 0===h)throw Error();var e=a.substr(0,b);a=a.substr(b,a.length-b);return e+h+a},Remove:function(a,b,h){if(void 0===h||null===h)h=a.length-b;if(0>b||0>h||b+h>a.length)throw Error();var e=a.substr(0,b);a=a.substr(b+h,a.length-b-h);return e+a},StartsWith:function(a,b,h){if(!b)throw Error();
if(""===b)return!0;if(b.length>a.length)return!1;1===h&&(a=a.toLowerCase(),b=b.toLowerCase());return-1<a.search(RegExp("^"+b))},EndsWith:function(a,b,h){if(!b)throw Error();if(""===b)return!0;if(b.length>a.length)return!1;1===h&&(a=a.toLowerCase(),b=b.toLowerCase());return-1<a.search(RegExp(b+"$"))},Replace:function(a,b,h){if(!b||""===b)throw Error();return a.replace(RegExp(b,"g"),h)}};C.UI.StringHelper=z;l.prototype={Append:function(a){a&&(this.strValue+=a.toString())},toString:function(){return this.strValue.toString()},
Length:function(){return this.strValue.length},ToString:function(a,b){var h=this.toString();return 0===arguments.length?h:h.substr(a,b)},Remove:function(a,b){this.strValue=z.Remove(this.toString(),a,b)}};C.UI.StringBuilder=l;var S={IsDigit:function(a){a=a.charCodeAt(0);return 48<=a&&57>=a},IsWhiteSpace:function(a){a=a.charCodeAt(0);return 9<=a&&13>=a||32===a||133===a||160===a}},Q={CustomMode:0,StandardDateTimeMode:1,StandardNumericMode:2};C.UI.FormatMode=Q;var aa={General:0,Number:1,DateTime:2,Text:3};
C.UI.NumberFormatType=aa;var ka={Hour:0,Minute:1,Second:2},J={DoubleQuote:'"',SingleQuote:"'",Tab:"\t",LeftSquareBracket:"[",RightSquareBracket:"]",LessThanSign:"<",GreaterThanSign:">",EqualsThanSign:"=",PlusSign:"+",HyphenMinus:"-",UnderLine:"_",LeftParenthesis:"(",RightParenthesis:")",Dollar:"$",Comma:",",Space:" ",SolidusSign:"/",ReverseSolidusSign:"\\",Zero:"0",QuestionMark:"?",Colon:":",Semicolon:";",Sharp:"#",CommercialAt:"@",NumberSign:"#",Asterisk:"*",Exponential1:"E+",Exponential2:"E-",DecimalSeparator:".",
NumberGroupSeparator:",",PercentSymbol:"%",NaNSymbol:"NaN",FormatSeparator:";",NegativeSign:"-",ReplacePlaceholder:"@",ExponentialSymbol:"E",DateTimeFormatInfo:C.UI._CultureInfo.currentCulture.dateTimeFormat,NumberFormatInfo:{CurrencySymbol:"$",NegativeSign:"-",NaNSymbol:"NaN",CurrencyDecimalSeparator:".",CurrencyGroupSeparator:",",NegativeInfinitySymbol:"-Infinity",NumberDecimalSeparator:".",NumberGroupSeparator:",",PercentDecimalSeparator:".",PercentGroupSeparator:",",PercentSymbol:"%",PerMilleSymbol:"???",
PositiveInfinitySymbol:"Infinity",PositiveSign:"+"},Filter:function(a,b,h){if(void 0===a||null===a||""===a)return a;for(var e="",d=0,f=0;f<a.length;f++){var g=a[f];g===b?d++:g===h?(d--,0>d&&(d=0)):0===d&&(e+=g)}return e.toString()},TrimSquareBracket:function(a){if(!a||a===G.Empty)return a;a[0]===J.LeftSquareBracket&&(a=z.TrimStart(a,J.LeftSquareBracket));a[a.length-1]===J.RightSquareBracket&&(a=z.TrimEnd(a,J.RightSquareBracket));return a},IsOperator:function(a){return a===J.LessThanSign||a===J.GreaterThanSign||
a===J.EqualsThanSign},TrimEscape:function(a){for(var b=a.length,h=!1,e=new l,d=0;d<b;d++){var f=a.charAt(d);f===J.ReverseSolidusSign?(h=!h)||e.Append(f):(h=!1,e.Append(f))}return e.toString()},AddSquareBracket:function(a){if(!a)throw Error("token");if(0===a.length||a[0]!==J.LeftSquareBracket)a=z.Insert(a,0,J.LeftSquareBracket.toString());if(0===a.length||a[a.length-1]!==J.RightSquareBracket)a=z.Insert(a,a.length,J.RightSquareBracket.toString());return a},IsEquals:function(a,b,h){return a||b?a&&b?
h?a.toLowerCase()===b.toLowerCase():a===b:!1:!0},ReplaceKeyword:function(a,b,h){if(!a||a===G.Empty||this.IsEquals(b,h,!0))return a;for(;;){var e=z.IndexOf(a,b,1);if(-1<e)a=z.Remove(a,e,b.length),a=z.Insert(a,e,h);else break}return a},IsDecimal:function(a,b){var h=J.DecimalSeparator;b&&(h=b.NumberDecimalSeparator);return-1<a.indexOf(h)}},K={EqualsTo:0,NotEqualsTo:1,GreaterThan:2,GreaterThanOrEqualsTo:3,LessThan:4,LessThanOrEqualsTo:5},A={IsNumber:function(a){return m(a,"number")||m(a,"DateTime")||
m(a,"TimeSpan")||a&&!m(a,"boolean")&&!isNaN(a)},ToDouble:function(a){return a?m(a,"number")?a:m(a,"string")&&!isNaN(a)?C.UI._NumberHelper.parseLocale(a):m(a,"DateTime")?(new C.UI._DateTimeHelper(a)).toOADate():m(a,"TimeSpan")?(new C.UI._DateTimeHelper(a)).TotalDays():parseFloat(a):0}};C.UI.FormatConverter=A;a.prototype={_initFileds:function(){this.partDbNumberFormat=this.partLocaleID=this.dateTimeFormatInfo=this.numberFormatInfo=this.numberStringConverter=null},NumberStringConverter:function(a){if(0===
arguments.length)return this.numberStringConverter?this.numberStringConverter:null;this.numberStringConverter=a},PartLocaleID:function(){return k(this.partLocaleID,"LocaleIDFormatPart")},PartDBNumberFormat:function(){return k(this.partDbNumberFormat,"DBNumberFormatPart")},DateTimeFormatInfo:function(a){if(0===arguments.length)return this.dateTimeFormatInfo;this.dateTimeFormatInfo=a},NumberFormatInfo:function(a){if(0===arguments.length)return this.numberFormatInfo;this.numberFormatInfo=a},NumberGroupSeparator:function(){return this.NumberFormatInfo()?
this.NumberFormatInfo().NumberGroupSeparator():J.NumberGroupSeparator},PercentSymbol:function(){return this.NumberFormatInfo()?this.NumberFormatInfo().PercentSymbol():J.PercentSymbol},PositiveSign:function(){return this.NumberFormatInfo()?this.NumberFormatInfo().PositiveSign():J.PositiveSign},NegativeSign:function(){return this.NumberFormatInfo()?this.NumberFormatInfo().NegativeSign():J.NegativeSign},DecimalSeparator:function(){return this.NumberFormatInfo()?this.NumberFormatInfo().NumberDecimalSeparator():
J.DecimalSeparator},NaNSymbol:function(){return this.NumberFormatInfo()?this.NumberFormatInfo().NaNSymbol:J.NaNSymbol}};a.General="General";a.TrimNotSupportSymbol=function(b,h){h||(h=!0);for(var e=!1,d=new l,f=0;f<b.length;f++){var g=b[f],k=!0;'"'===g?e=!e:e||(h||("?"===g&&(a.IsTransform(b,f)||(k=!1)),"/"===g&&(a.IsTransform(b,f)||(k=!1))),"_"===g?a.IsTransform(b,f)||(k=!1,f++):"*"===g&&(a.IsTransform(b,f)||(k=!1)));k&&d.Append(g)}return d.toString()};a.IsTransform=function(a,b){if("\\"===a[b])throw Error("the '\\' can't be evaluated");
if(0<b-1&&b-1<a.length&&"\\"===a[b-1]){if(0>b-2)return!0;if(0<b-2&&b-2<a.length)return"\\"!==a[b-2]}return!1};a.ContainsKeywords=function(a,b){if(!a||a===G.Empty)return!1;for(var h=new l,e=!1,d=null,f=0;f<a.length;f++){var g=a[f];'"'===g?e=!e:e||g!==J.UnderLine&&d!==J.UnderLine&&h.Append(g);d=g}h=h.toString().toLowerCase();for(e=0;e<b.length;e++)if(z.Contains(h,b[e]))return!0;return!1};d.prototype={ShortDatePattern:"d",LongDatePattern:"D",FullDatePatternShortTime:"f",FullDatePatternLongTime:"F",GeneralDatePatternLongTimeShortTime:"g",
GeneralDatePatternLongTimeLongTime:"G",MonthDayPattern1:"m",MonthDayPattern2:"M",RoundTripDatePattern1:"o",RoundTripDatePattern2:"O",RFC1123Pattern1:"r",RFC1123Pattern2:"R",SortableDatePattern:"s",ShortTimePattern:"t",LongTimePattern:"T",UniversalSortableDatePattern:"u",UniversalFullDatePattern:"U",YearMonthPattern1:"y",YearMonthPattern2:"Y",EvaluateFormat:function(a){return a===this.ShortDatePattern||a===this.LongDatePattern||a===this.FullDatePatternShortTime||a===this.FullDatePatternLongTime||a===
this.GeneralDatePatternLongTimeShortTime||a===this.GeneralDatePatternLongTimeLongTime||a===this.MonthDayPattern1||a===this.MonthDayPattern2||a===this.RoundTripDatePattern1||a===this.RoundTripDatePattern2||a===this.RFC1123Pattern1||a===this.RFC1123Pattern2||a===this.SortableDatePattern||a===this.ShortTimePattern||a===this.LongTimePattern||a===this.UniversalSortableDatePattern||a===this.UniversalFullDatePattern||a===this.YearMonthPattern1||a===this.YearMonthPattern2?!0:!1},Format:function(a){try{return void 0===
a||null===a||""===a?"":(new C.UI._DateTimeHelper(a)).localeFormat(this._formatString)}catch(b){return a.toString()}},Parse:function(a){try{return a&&""!==a?C.UI._DateTimeHelper.parseLocale(a,this._formatString):null}catch(b){return new Date(a)}}};C.UI._StandardDateTimeFormatter=d;e.prototype={CurrencyPattern1:"c",CurrencyPattern2:"C",DecimalPattern1:"d",DecimalPattern2:"D",ScientificPattern1:"e",ScientificPattern2:"E",FixedPointPattern1:"f",FixedPointPattern2:"F",GeneralPattern1:"g",GeneralPattern2:"G",
NumberPattern1:"n",NumberPattern2:"N",PercentPattern1:"p",PercentPattern2:"P",RoundTripPattern1:"r",RoundTripPattern2:"R",HexadecimalPattern1:"x",HexadecimalPattern2:"X",EvaluateFormat:function(a){return a&&a!==G.Empty&&0<a.length&&(a=a.substr(0,1),a===this.CurrencyPattern1||a===this.CurrencyPattern2||a===this.DecimalPattern1||a===this.DecimalPattern2||a===this.ScientificPattern1||a===this.ScientificPattern2||a===this.FixedPointPattern1||a===this.FixedPointPattern2||a===this.GeneralPattern1||a===
this.GeneralPattern2||a===this.NumberPattern1||a===this.NumberPattern2||a===this.PercentPattern1||a===this.PercentPattern2||a===this.RoundTripPattern1||a===this.RoundTripPattern2||a===this.HexadecimalPattern1||a===this.HexadecimalPattern2)?!0:!1},Format:function(a){try{return a&&""!==a?(new C.UI._NumberHelper(a)).localeFormat(this._formatString):""}catch(b){return a.toString()}},Parse:function(a){try{return a&&""!==a?C.UI._NumberHelper.parseLocale(a):null}catch(b){return a=parseFloat(a),isNaN(a)||
!isFinite(a)?null:a}}};C.UI._StandardNumberFormatter=e;b.prototype=new a;b.prototype.Format=function(a){try{var b=C.Calc.Convert.toString(a),h=z.Replace(this._formatString,'"',"");h&&(b=z.Replace(h,"@",b));return b}catch(e){return""}};b.prototype.Parse=function(a){return a?a:""};b.prototype.FormatString=function(){return this._formatString};b.EvaluateFormat=function(a){return!0};C.UI.AutoFormatter=function(a){this._innerFormatter=a};C.UI.AutoFormatter.prototype={formatString:function(){return this._innerFormatter?
this._innerFormatter.formatString():""},innerFormatter:function(a){if(0===arguments.length)return this._innerFormatter;this._innerFormatter=a;return this},Parse:function(a){return this._innerFormatter?this._innerFormatter.Parse(a):a},Format:function(a){return this._innerFormatter?this._innerFormatter.Format(a):void 0===a||null===a?"":a.toString()},toJSON:function(){return null}};var L={defaultNumberFormatter:null,defaultGeneralFormatter:null,defaultShortDatePatternFormatter:null,defaultLongTimePatternFormatter:null,
defaultSXDatetimePatternFormatter:null,defaultDMMMFormatter:null,defaultMMMYYFormatter:null,defaultHMMFormatter:null,defaultHMMSSFormatter:null,defaultHMMSS0Formatter:null,defaultShortDatePatternHMMFormatter:null,defaultShortDatePatternHMMSSFormatter:null,defaultShortDatePatternHMMSS0Formatter:null,defaultComboNumberFormatter1:null,defaultComboNumberFormatter2:null,defaultStandardNumberFormatter:null,defaultStandardPercentFormatter1:null,defaultStandardPercentFormatter2:null,defaultStandardGroupNumberFormatter1:null,
defaultStandardGroupNumberFormatter2:null,DefaultNumberFormatter:function(){this.defaultNumberFormatter||(this.defaultNumberFormatter=new f("###################0.################"));return this.defaultNumberFormatter},DefaultGeneralFormatter:function(){this.defaultGeneralFormatter||(this.defaultGeneralFormatter=new f);return this.defaultGeneralFormatter},DefaultShortDatePatternFormatter:function(){this.defaultShortDatePatternFormatter||(this.defaultShortDatePatternFormatter=new f(J.DateTimeFormatInfo.ShortDatePattern));
return this.defaultShortDatePatternFormatter},DefaultSXDatetimePatternFormatter:function(){this.defaultSXDatetimePatternFormatter||(this.defaultSXDatetimePatternFormatter=new f("m/d/yyyy h:mm:ss tt"));return this.defaultSXDatetimePatternFormatter},DefaultLongTimePatternFormatter:function(){this.defaultLongTimePatternFormatter||(this.defaultLongTimePatternFormatter=new f(J.DateTimeFormatInfo.LongTimePattern));return this.defaultLongTimePatternFormatter},DefaultDMMMFormatter:function(){this.defaultDMMMFormatter||
(this.defaultDMMMFormatter=new f("d-mmm"));return this.defaultDMMMFormatter},DefaultMMMYYFormatter:function(){this.defaultMMMYYFormatter||(this.defaultMMMYYFormatter=new f("mmm-yy"));return this.defaultMMMYYFormatter},DefaultHMMFormatter:function(){this.defaultHMMFormatter||(this.defaultHMMFormatter=new f("h:mm"));return this.defaultHMMFormatter},DefaultHMMSSFormatter:function(){this.defaultHMMSSFormatter||(this.defaultHMMSSFormatter=new f("h:mm:ss"));return this.defaultHMMSSFormatter},DefaultHMMSS0Formatter:function(){this.defaultHMMSS0Formatter||
(this.defaultHMMSS0Formatter=new f("h:mm:ss.0"));return this.defaultHMMSS0Formatter},DefaultComboNumberFormatter1:function(){this.defaultComboNumberFormatter1||(this.defaultComboNumberFormatter1=new f(G.Format("{0}#,##0.00;[Red]({0}#,##0.00)",J.NumberFormatInfo.CurrencySymbol)));return this.defaultComboNumberFormatter1},DefaultComboNumberFormatter2:function(){this.defaultComboNumberFormatter2||(this.defaultComboNumberFormatter2=new f(G.Format("{0}#,##0;[Red]({0}#,##0)",J.NumberFormatInfo.CurrencySymbol)));
return this.defaultComboNumberFormatter2},DefaultStandardNumberFormatter:function(){this.defaultStandardNumberFormatter||(this.defaultStandardNumberFormatter=new f("0.00E+00"));return this.defaultStandardNumberFormatter},DefaultStandardPercentFormatter1:function(){this.defaultStandardPercentFormatter1||(this.defaultStandardPercentFormatter1=new f("0.00%"));return this.defaultStandardPercentFormatter1},DefaultStandardPercentFormatter2:function(){this.defaultStandardPercentFormatter2||(this.defaultStandardPercentFormatter2=
new f("0%"));return this.defaultStandardPercentFormatter2},DefaultStandardGroupNumberFormatter1:function(){this.defaultStandardGroupNumberFormatter1||(this.defaultStandardGroupNumberFormatter1=new f("#,##0.00"));return this.defaultStandardGroupNumberFormatter1},DefaultStandardGroupNumberFormatter2:function(){this.defaultStandardGroupNumberFormatter2||(this.defaultStandardGroupNumberFormatter2=new f("#,##0"));return this.defaultStandardGroupNumberFormatter2}};f.prototype={_initFileds:function(){this.formatters=
null;this.formatModeType=Q.CustomMode;this.numberFormatInfo=this.dateTimeFormatInfo=null;this.isDefault=this.isSingleFormatterInfo=!0;this.formatCached=null;this.isConstructed=!1;this.PropertyChanged=[]},toJSON:function(){return{formatters:this.formatters}},HasFormatedColor:function(){return this.isDefault?!1:this.PositiveExpression()&&this.PositiveExpression().ColorFormatPart()||this.NegativeExpression()&&this.NegativeExpression().ColorFormatPart()||this.ZeroExpression()&&this.ZeroExpression().ColorFormatPart()||
this.TextExpression()&&this.TextExpression().ColorFormatPart()?!0:!1},IsDefaultFormat:function(){return this.isDefault},FormatString:function(b){if(0===arguments.length){this.Init();var h=null;switch(this.FormatMode()){case Q.CustomMode:if(this.formatters)for(var e=0;e<this.formatters.length;e++){var d=this.formatters[e];m(d,"CustomNumberFormat")&&(h?h.Append(J.FormatSeparator):h=new l,d=d.FormatString(),h.Append(d))}break;case Q.StandardDateTimeMode:if(m(this.formatters[0],"StandardDateTimeFormatter"))return this.formatters[0].FormatString();
break;case Q.StandardNumericMode:if(m(this.formatters[0],"StandardNumberFormatter"))return this.formatters[0].FormatString()}return h?h.toString():G.Empty}if(!b)throw Error("value");this.formatters=null;this.formatCached=b;this.isDefault=this.formatCached.toLowerCase()===a.General.toLowerCase();this.isConstructed=!1;this.Init();this.RaisePropertyChanged("FormatString")},DateTimeFormatInfo:function(a){if(0===arguments.length)return this.Init(),this.dateTimeFormatInfo?this.dateTimeFormatInfo:J.DateTimeFormatInfo;
this.Init();this.dateTimeFormatInfo=a;if(this.formatters)for(var b=0;b<this.formatters.length;b++){var h=this.formatters[b];m(h,"IFormatProviderSupport")&&h.DateTimeFormatInfo(a)}this.RaisePropertyChanged("DateTimeFormatInfo")},NumberFormatInfo:function(a){if(0===arguments.length)return this.Init(),this.numberFormatInfo?this.numberFormatInfo:J.NumberFormatInfo;this.Init();this.numberFormatInfo=a;if(this.formatters)for(var b=0;b<this.formatters.length;b++){var h=this.formatters[b];m(h,"IFormatProviderSupport")&&
h.NumberFormatInfo(a)}this.RaisePropertyChanged("NumberFormatInfo")},FormatMode:function(a){if(0===arguments.length)return this.formatModeType;this.formatModeType=a;this.RaisePropertyChanged("FormatMode")},ExcelCompatibleFormatString:function(){this.Init();var a=null;switch(this.FormatMode()){case Q.CustomMode:if(this.formatters)for(var b=0;b<this.formatters.length;b++){var h=this.formatters[b];m(h,"CustomNumberFormat")&&(a?a.Append(J.FormatSeparator):a=new l,h=h.ExcelCompatibleFormatString(),a.Append(h))}break;
case Q.StandardDateTimeMode:if(m(this.formatters[0],"StandardDateTimeFormatter"))return this.formatters[0].ExcelCompatibleFormatString();break;case Q.StandardNumericMode:if(m(this.formatters[0],"StandardNumberFormatter"))return this.formatters[0].ExcelCompatibleFormatString()}return a?a.toString():G.Empty},PositiveExpression:function(){this.Init();return this.formatters&&0<this.formatters.length?k(this.formatters[0],"CustomNumberFormat"):null},NegativeExpression:function(){this.Init();return this.formatters&&
1<this.formatters.length?k(this.formatters[1],"CustomNumberFormat"):null},ZeroExpression:function(){this.Init();return this.formatters&&2<this.formatters.length?k(this.formatters[2],"CustomNumberFormat"):null},TextExpression:function(){this.Init();return this.formatters&&3<this.formatters.length?k(this.formatters[3],"CustomNumberFormat"):null},GetFormatType:function(a){this.Init();a=this.GetFormatInfo(a);if(m(a,"CustomNumberFormat")){if(m(a.Formatter(),"NumberFormatDigital"))return aa.Number;if(m(a.Formatter(),
"NumberFormatDateTime"))return aa.DateTime;if(m(a.Formatter(),"NumberFormatText"))return aa.Text}else{if(m(a,"NumberFormatDigital")||m(a,"StandardNumberFormatter"))return aa.Number;if(m(a,"NumberFormatDateTime")||m(a,"StandardDateTimeFormatter"))return aa.DateTime;if(m(a,"NumberFormatText"))return aa.Text}return aa.General},GetPreferredEditingFormatter:function(a){this.Init();if(m(a,"DateTime"))return a=new C.UI._DateTimeHelper(a),0===a.Hour()&&0===a.Minute()&&0===a.Second()&&0===a.Millisecond()?
L.DefaultShortDatePatternFormatter():L.DefaultSXDatetimePatternFormatter();if(m(a,"TimeSpan"))return L.DefaultLongTimePatternFormatter();if(A.IsNumber(a))return 1E20<A.ToDouble(a)?new f("0.##E+00"):L.DefaultNumberFormatter();m(a,"string");return L.DefaultGeneralFormatter()},GetPreferredDisplayFormatter:function(a,b){b||(b={});b.value=null;this.Init();if(G.IsNullOrEmpty(a))return new f;var h=b.value=this.Parse(a);if(m(h,"DateTime")||m(h,"TimeSpan")){var e;if((e=t(a,h,s.GeneralMonthDay(),function(){return L.DefaultDMMMFormatter()}))||
(e=t(a,h,s.GeneralYearMonth(),function(){return L.DefaultMMMYYFormatter()}))||(e=t(a,h,s.GeneralYearMonthDay(),function(){return L.DefaultShortDatePatternFormatter()}))||(e=t(a,h,s.GeneralHourMinute(),function(){return L.DefaultHMMFormatter()}))||(e=t(a,h,s.GeneralHourMinuteSecond(),function(){return L.DefaultHMMSSFormatter()}))||(e=t(a,h,s.GeneralHourMinuteSecondSubSecond(),function(){return L.DefaultHMMSS0Formatter()})))return e;var d=this;if((e=t(a,h,s.GeneralHourMinuteWithDate(),function(){L.defaultShortDatePatternHMMFormatter||
(L.defaultShortDatePatternHMMFormatter=new f(d.DateTimeFormatInfo().ShortDatePattern+" h:mm"));return L.defaultShortDatePatternHMMFormatter}))||(e=t(a,h,s.GeneralHourMinuteSecondWithDate(),function(){L.defaultShortDatePatternHMMSSFormatter||(L.defaultShortDatePatternHMMSSFormatter=new f(d.DateTimeFormatInfo().ShortDatePattern+" h:mm:ss"));return L.defaultShortDatePatternHMMSSFormatter}))||(e=t(a,h,s.GeneralHourMinuteSecondSubSecondWithDate(),function(){L.defaultShortDatePatternHMMSS0Formatter||(L.defaultShortDatePatternHMMSS0Formatter=
new f(d.DateTimeFormatInfo().ShortDatePattern+" h:mm:ss.0"));return L.defaultShortDatePatternHMMSS0Formatter})))return e}else if(A.IsNumber(h)){if(a[0]===J.NumberFormatInfo.CurrencySymbol[0])return z.Contains(a,J.DecimalSeparator)?L.DefaultComboNumberFormatter1():L.DefaultComboNumberFormatter2();if(-1<z.IndexOf(a,"e",1))return L.DefaultStandardNumberFormatter();if(a[0].toString()===J.PercentSymbol||a[a.length-1].toString()===J.PercentSymbol)return z.Contains(a,J.DecimalSeparator)?L.DefaultStandardPercentFormatter1():
L.DefaultStandardPercentFormatter2();if(z.Contains(a,J.NumberGroupSeparator))return z.Contains(a,J.DecimalSeparator)?L.DefaultStandardGroupNumberFormatter1():L.DefaultStandardGroupNumberFormatter2()}return L.DefaultGeneralFormatter()},Format:function(a,b){b&&(b.value=null);this.Init();var h=this.GetFormatInfo(a);m(h,"CustomNumberFormat")&&h.ColorFormatPart()&&b&&(b.value=h.ColorFormatPart().ForeColor());var e=0,d=A.IsNumber(a);d&&(e=A.ToDouble(a));if(h){var f=null;if(d&&h===this.NegativeExpression())f=
h.Format(Math.abs(e)),(h=k(h,"CustomNumberFormat"))&&h.ConditionFormatPart()&&0<h.ConditionFormatPart().value&&0>e&&(f=J.NegativeSign+f);else try{f=h.Format(a)}catch(g){m(a,"string")&&(f=a.toString())}return f?f:G.Empty}return d&&0>e?J.HyphenMinus.toString():m(a,"string")?a.toString():void 0===a||null===a?G.Empty:a.toString()},Parse:function(a){this.Init();return this.formatters&&0<this.formatters.length?this.formatters[0].Parse(a):null},Init:function(){if(!this.isConstructed)switch(this.isConstructed=
!0,this.formatModeType){case Q.CustomMode:this.InitExcelCompatibleMode(this.formatCached);break;case Q.StandardDateTimeMode:this.InitStandardDateTimeMode(this.formatCached);break;case Q.StandardNumericMode:this.InitStandardNumericMode(this.formatCached)}},InitStandardDateTimeMode:function(a){var b=new d(a);if(b.EvaluateFormat(a))this.formatters=[],this.formatters.push(b);else throw Error("format is illegal.");},InitStandardNumericMode:function(a){var b=new e(a);if(b.EvaluateFormat(a))this.formatters=
[],this.formatters.push(b);else throw Error("format is illegal.");},InitExcelCompatibleMode:function(a){if(G.IsNullOrEmpty(a))throw Error("format is illegal.");this.formatters=[];if(this.isDefault)this.formatters.push(new q);else{this.isSingleFormatterInfo=!z.Contains(a,J.FormatSeparator.toString());a=a.split(J.FormatSeparator);if(!a)throw Error("format is illegal.");if(1>a.length||5<a.length)throw Error("format is illegal.");for(var b=0,h=0;h<a.length;h++){b++;if(4<b)break;var e=new q(a[h]);e&&this.formatters.push(e)}if(!this.PositiveExpression())throw Error("format is illegal.");
}},GetFormatInfo:function(a){if(this.FormatMode()===Q.CustomMode){if("string"===typeof a&&isNaN(a))return this.TextExpression()?this.TextExpression():this.PositiveExpression();if(A.IsNumber(a)||m(a,"boolean")){var b=this.PositiveExpression(),h=this.NegativeExpression();a=A.ToDouble(a);var e=b&&b.ConditionFormatPart(),d=h&&h.ConditionFormatPart(),f=this.isSingleFormatterInfo?this.PositiveExpression():null;if(this.PositiveExpression())if(e)b.ConditionFormatPart().IsMeetCondition(a)&&(f=b);else if(0<
a||0===a&&!this.ZeroExpression())f=b;!f&&this.NegativeExpression()&&(d?h.ConditionFormatPart().IsMeetCondition(a)&&(f=h):0>a&&(f=h));!f&&this.ZeroExpression()&&0===a&&(f=this.ZeroExpression());!f&&this.ZeroExpression()&&(f=this.ZeroExpression());!f&&this.NegativeExpression()&&(f=this.NegativeExpression());return f}}else if((this.FormatMode()===Q.StandardDateTimeMode||this.FormatMode()===Q.StandardNumericMode)&&this.formatters&&1===this.formatters.length)return this.formatters[0];return null},RaisePropertyChanged:function(a){if(this.PropertyChanged)for(var b=
0;b<this.PropertyChanged.length;b++){var h=this.PropertyChanged[b];"function"===typeof h&&h(this,a)}}};C.UI.GeneralFormatter=f;r.prototype={_initFileds:function(){this.originalToken=null},OriginalToken:function(){return this.originalToken}};r.SupportedPartFormat=function(){r._supportedPartFormat||(r._supportedPartFormat=["ConditionFormatPart","ColorFormatPart","LocaleIDFormatPart"]);return r._supportedPartFormat};var D={defaultNumberStringConverter:null,YearTwoDigit:"yy",YearSingleDigit:"y",YearFourDigit:"yyyy",
MonthSingleDigit:"m",MonthTwoDigit:"mm",MonthAbbreviation:"mmm",MonthUnabbreviated:"mmmm",MonthJD:"mmmmm",DaySingleDigit:"d",DayTwoDigit:"dd",DayWeekDayAbbreviation:"aaa",DayWeekDayUnabbreviated:"aaaa",HoursSingleDigit:"h",HoursTwoDigit:"hh",MinuteSingleDigit:"m",MinuteTwoDigit:"mm",SecondSingleDigit:"s",SecondTwoDigit:"ss",SubSecondSingleDigit:".0",SubSecondTwoDigit:".00",SubSecondThreeDigit:".000",EraYear:"e",AMPMTwoDigit:"AM/PM",AMPMSingleDigit:"A/P",StandardYearSingleDigit:"%y",StandardMonthSingleDigit:"%M",
StandardMonthTwoDigit:"MM",StandardMonthAbbreviation:"MMM",StandardMonthUnabbreviated:"MMMM",StandardAMPMSingleDigit:"tt",StandardMinuteSingleDigit:"%m",StandardHourSingleDigit:"H",StandardHourTwoDigit:"HH",StandardSecondSingleDigit:"%s",StandardSubSecondSingleDigit:".f",StandardSubSecondTwoDigit:".ff",StandardSubSecondThreeDigit:".fff",StandardDayWeekDayAbbreviation:"ddd",StandardDayWeekDayUnabbreviated:"dddd",PlaceholderMonthJD:J.ReplacePlaceholder+"mmmmm",defaultAbsoluteTime:new Date(1899,11,30,
0,0,0,0),EvaluateFormat:function(b){return a.ContainsKeywords(b,u.keywords)}};q.prototype={_initFileds:function(){this.formatCached=this.numberFormatInfo=this.dateTimeFormatInfo=this.numberFormat=this.dbNumberFormatPart=this.localeIDFormatPart=this.colorFormatPart=this.conditionFormatPart=null},Init:function(a){if(null===a||void 0===a)throw Error("format is illegal.");this.dbNumberFormatPart=this.localeIDFormatPart=this.colorFormatPart=this.conditionFormatPart=null;this.formatCached=a;for(var h=null,
e=null,d=!1,f=[],g=0;g<a.length;g++){var q=a[g];if(q===J.LeftSquareBracket){if(d)throw Error("format is illegal.");e&&(h||(h=new l),h.Append(e.toString()));e=new l;e.Append(q);d=!0}else if(q===J.RightSquareBracket){if(d)if(e){e||(e=new l);e.Append(q);if((d=k(r.Create(e.toString()),"FormatPartBase"))&&!m(d,"ABSTimeFormatPart"))this.AddPart(d);else if(m(d,"ABSTimeFormatPart"))f.push(k(d,"ABSTimeFormatPart")),h||(h=new l),h.Append(e.toString());else throw Error("format is illegal.");e=null}else throw Error("format is illegal.");
else throw Error("format is illegal.");d=!1}else e||(e=new l),e.Append(q)}if(e){if(d)throw Error("format is illegal.");h||(h=new l);h.Append(e.toString())}h=h?h.toString():G.Empty;if(s.EvaluateFormat(h))this.numberFormat=new s(h,this.LocaleIDFormatPart(),this.dbNumberFormatPart);else if(D.EvaluateFormat(h))this.numberFormat=new u(h,0<f.length?f:null,this.LocaleIDFormatPart(),this.dbNumberFormatPart);else if(n.EvaluateFormat(h))this.numberFormat=new n(a,this.LocaleIDFormatPart(),this.dbNumberFormatPart);
else if(b.EvaluateFormat(h))this.numberFormat=new b(a,this.LocaleIDFormatPart(),this.dbNumberFormatPart);else throw Error("format is illegal.");},FormatString:function(){var a=new l;this.numberFormat&&this.numberFormat.FormatString()&&(this.ColorFormatPart()&&a.Append(this.ColorFormatPart().toString()),this.ConditionFormatPart()&&a.Append(this.ConditionFormatPart().toString()),this.DBNumberFormatPart()&&a.Append(this.DBNumberFormatPart().toString()),this.LocaleIDFormatPart()&&a.Append(this.LocaleIDFormatPart().toString()),
a.Append(this.numberFormat.FormatString()));return a.toString()},ConditionFormatPart:function(){return this.conditionFormatPart},ColorFormatPart:function(){return this.colorFormatPart},LocaleIDFormatPart:function(){return this.localeIDFormatPart},DBNumberFormatPart:function(){return this.dbNumberFormatPart},NumberStringConverter:function(a){if(0===arguments.length)return this.numberFormat?this.numberFormat.NumberStringConverter():null;this.numberFormat&&this.numberFormat.NumberStringConverter(a)},
ExcelCompatibleFormatString:function(){var a=new l;this.numberFormat&&this.numberFormat.ExcelCompatibleFormatString()&&(m(this.numberFormat,"NumberFormatDigital")||(this.DBNumberFormatPart()&&a.Append(this.DBNumberFormatPart().toString()),this.LocaleIDFormatPart()&&a.Append(this.LocaleIDFormatPart().toString()),this.ConditionFormatPart()&&a.Append(this.ConditionFormatPart().toString()),this.ColorFormatPart()&&a.Append(this.ColorFormatPart().toString())),a.Append(this.numberFormat.ExcelCompatibleFormatString()));
return a.toString()},Formatter:function(){return this.numberFormat},DateTimeFormatInfo:function(a){if(0===arguments.length)return this.Formatter().DateTimeFormatInfo();this.Formatter().DateTimeFormatInfo(a);this.dateTimeFormatInfo=a},NumberFormatInfo:function(a){if(0===arguments.length)return this.Formatter().NumberFormatInfo();this.Formatter().NumberFormatInfo(a);this.numberFormatInfo=a},AddPart:function(a){if(!a)throw Error("part");if(m(a,"ConditionFormatPart")){if(this.conditionFormatPart)throw Error("The type of descriptor was added.");
this.conditionFormatPart=k(a,"ConditionFormatPart")}else if(m(a,"ColorFormatPart")){if(this.colorFormatPart)throw Error("The type of descriptor was added.");this.colorFormatPart=k(a,"ColorFormatPart")}else if(m(a,"LocaleIDFormatPart")){if(this.localeIDFormatPart)throw Error("The type of descriptor was added.");this.localeIDFormatPart=k(a,"LocaleIDFormatPart")}else if(m(a,"DBNumberFormatPart")){if(this.dbNumberFormatPart)throw Error("The type of descriptor was added.");this.dbNumberFormatPart=k(a,
"DBNumberFormatPart")}},Format:function(a){return this.numberFormat.Format(a)},Parse:function(a){return this.numberFormat.Parse(a)}};h.prototype=new r;h.prototype._initFileds=function(){this.value=0;this.compareOperator=null};h.prototype.CompareOperator=function(){return this.compareOperator};h.prototype.Value=function(){return this.value};h.prototype.toString=function(){var a=new l;switch(this.compareOperator){case K.EqualsTo:a.Append("=");break;case K.GreaterThan:a.Append(">");break;case K.GreaterThanOrEqualsTo:a.Append(">=");
break;case K.LessThan:a.Append("<");break;case K.LessThanOrEqualsTo:a.Append("<=");break;case K.NotEqualsTo:a.Append("<>");break;default:throw Error();}a.Append(this.value);return J.AddSquareBracket(a.toString())};h.prototype.IsMeetCondition=function(a){switch(this.compareOperator){case K.EqualsTo:return a===this.value;case K.GreaterThan:return a>this.value;case K.GreaterThanOrEqualsTo:return a>=this.value;case K.LessThan:return a<this.value;case K.LessThanOrEqualsTo:return a<=this.value;case K.NotEqualsTo:return a!==
this.value}return!1};h.EvaluateFormat=function(a){return a&&a!==G.Empty?(a=J.TrimSquareBracket(a))&&a!==G.Empty?J.IsOperator(a[0]):!1:!1};I.prototype=new r;I.prototype.ForeColor=function(){return this.foreColor};I.prototype.toString=function(){if(-1<this.index)return J.AddSquareBracket("Color"+this.index);if(this.colorName)return J.AddSquareBracket(this.colorName);throw Error();};I.EvaluateFormat=function(a){if(!a||a===G.Empty)return!1;var b=J.TrimSquareBracket(a);return!b||b===G.Empty||3>b.length?
!1:isNaN(a[a.length-1])?a[0]!==a[1]:z.StartsWith(a,"Color",1)};E.prototype=new r;E.prototype._initFileds=function(){this.formatString=this.type=this.token=null};E.prototype.FormatString=function(){return this.formatString};E.prototype.TimePartType=function(){return this.type};E.prototype.Token=function(){return this.token};E.HoursABSContent="h";E.MinuteABSContent="m";E.SecondABSContent="s";E.EvaluateFormat=function(a){if(!a||a===G.Empty)return!1;a=J.TrimSquareBracket(a);if(!a||a===G.Empty)return!1;
a=a.toLowerCase();for(var b=null,h=0;h<a.length;h++){b||(b=a[h]);var e=E;if(b!==e.HoursABSContent&&b!==e.MinuteABSContent&&b!==e.SecondABSContent||b!==a[h])return!1}return!0};O.prototype=new r;O.prototype._initFileds=function(){this.token=null;this.type=0};O.prototype.Token=function(){return this.token?this.token:G.Empty};O.prototype.Type=function(){return this.type};O.prototype.ReplaceNumberString=function(a,b,h){if(!a||a===G.Empty)return a;for(var e=a,d=-1,f=-1,g=!1,k=null,l=null,k=null,n=a.length-
1;0<=n;n--)k=a[n],!isNaN(k)||J.IsEquals(k,J.DecimalSeparator,!1)&&!g?(J.IsEquals(k,J.DecimalSeparator,!1)&&(g=!0),-1===d&&(d=n),f=n):-1<f&&-1<d&&(k=a.substr(f,d-f+1),l=parseFloat(k),isNaN(l)||(k=this.NumberString(k,b,h),e=z.Remove(e,f,d-f+1),e=z.Insert(e,f,k)),f=d=-1,g=!1);-1<f&&-1<d&&(k=a.substr(f,d-f+1),l=parseFloat(k),isNaN(l)||(k=this.NumberString(k,b,h),e=z.Remove(e,f,d-f+1),e=z.Insert(e,f,k)));return e};O.prototype.NumberString=function(a,b,h){if(a=a.split(".")){if(1===a.length)return O.FormatNumberString(a[0],
h?b.Units():null,b.Numbers());if(2===a.length)return h=O.FormatNumberString(a[0],h?b.Units():null,b.Numbers()),b=O.FormatNumberString(a[1],b.Numbers()),h+"."+b}throw Error("value is illegal.");};O.prototype.toString=function(){if(-1<this.type)return J.AddSquareBracket("DBNum"+this.type);throw Error();};O.EvaluateFormat=function(a){return a&&a!==G.Empty?(a=J.TrimSquareBracket(a))&&a!==G.Empty?z.StartsWith(a,"DBNum",1)?!0:!1:!1:!1};O.FormatNumberString=function(a,b,h){var e=0,d=null,f=0;if(2===arguments.length){for(var g=
new l,e=0;e<a.length;e++)d=a.substr(e,1),f=parseInt(d,10),g.Append(h[f]);return g.toString()}if(3===arguments.length){if(!b)return O.FormatNumberString(a,h);for(var k=0,g=null,n=a.length,m=!1,q=[],e=0;e<n;e++)d=b.length-1-e,-1<d?z.Insert(q,0,b[d].toString()):z.Insert(q,0,G.Empty);for(var e=!1,s=0;s<n;s++){var d=a.substr(s,1),f=parseInt(d,10),r=G.Empty,t=G.Empty;0<n-s-16?(r=h[f],t="",e=!0):s!==n-1&&s!==n-5&&s!==n-9&&s!==n-13?"0"===d?(t=r="",k+=1):(r="0"!==d&&0!==k?h[0]+h[f]:h[f],t=q[s],k=0):"0"!==
d&&0!==k?(r=h[0]+h[f],t=q[s],k=0):"0"!==d&&0===k||e?(r=h[f],t=q[s],k=0,e=!1):("0"===d&&3<=k?t=r="":11<=n?r="":(r="",t=q[s]),k+=1);r+t!==G.Empty&&(m=!1);s!==n-13||m||(t=q[s],m=!0);s!==n-9||m||(t=q[s],m=!0);s===n-1&&(t=q[s],m=!0);g=g+r+t}d=parseInt(a,10);return isNaN(d)||0!==d?g:h[0]}};var w={ParseHexString:function(a){if(!a||a===G.Empty)throw Error("string is illegal.");return parseInt(a,16)},FixJapaneseChars:function(a){return a},GetFraction:function(a,b,h,e,d){h.value=Math.ceil(a)-1;e.value=0;d.value=
0;a=a-Math.ceil(a)+1;var f=2;h=9;f=Math.pow(10,b-1);h=Math.pow(10,b)-1;2>f&&(f=2);2>h&&(h=2);b=!1;for(var g=0;f<=h;f++){var k=Math.round(f*a),l=k/f,n=Math.abs(l-a);if(b?n<Math.abs(g-a):1)b=!0,g=l,e.value=k,d.value=f}return b}};H.prototype=new r;H.prototype._initFileds=function(){this.currencySymbol=null;this.locateID=-1;this.content=this.cultureInfo=null};H.prototype.CurrencySymbol=function(){return this.currencySymbol?this.EncodeSymbol(this.currencySymbol):G.Empty};H.prototype.AllowScience=function(){};
H.prototype.GetDBNumber=function(a){return null};H.prototype.toString=function(){return this.content?J.AddSquareBracket(this.content):G.Empty};H.prototype.EncodeSymbol=function(a){return z.Replace(a,".","'.'")};H.EvaluateFormat=function(a){return a&&a!==G.Empty?(a=J.TrimSquareBracket(a))&&a!==G.Empty?J.IsEquals(a[0],J.Dollar,!1):!1:!1};r.Create=function(a){return h.EvaluateFormat(a)?new h(a):O.EvaluateFormat(a)?new O(a):H.EvaluateFormat(a)?new H(a):E.EvaluateFormat(a)?new E(a):I.EvaluateFormat(a)?
new I(a):null};u.prototype=new a;u.prototype._initFileds=function(){this.formatString=this.validDateTimeFormatString=null;this.hasJD=!1;this.absTimeParts=this.absoluteTime=null;this.hasYearDelay=!1};u.prototype._init=function(a,b,h,e){a=new g(this.formatString);if(D.EvaluateFormat(a.value)){this.ProcessAMPM(a);this.hasJD=this.Replace(a.value,D.MonthJD,'"'+D.PlaceholderMonthJD+'"',!0,!1,a,!1,!1);this.Replace(a.value,D.MonthUnabbreviated,D.StandardMonthUnabbreviated,!0,!1,a,!1,!1);this.Replace(a.value,
D.MonthAbbreviation,D.StandardMonthAbbreviation,!0,!1,a,!1,!1);this.Replace(a.value,D.MonthTwoDigit,D.StandardMonthTwoDigit,!0,!1,a,!1,!1);this.Replace(a.value,D.MonthSingleDigit,D.StandardMonthSingleDigit,!0,!1,a,!1,!1);this.Replace(a.value,D.DayWeekDayAbbreviation,D.StandardDayWeekDayAbbreviation,!0,!0,a,!1,!0);this.Replace(a.value,D.DayWeekDayUnabbreviated,D.StandardDayWeekDayUnabbreviated,!0,!0,a,!1,!0);this.Replace(a.value,D.MinuteSingleDigit,D.StandardMinuteSingleDigit,!1,!0,a,!1,!1);this.Replace(a.value,
D.HoursSingleDigit,D.StandardHourSingleDigit,!0,!0,a,!1,!1);this.Replace(a.value,D.HoursTwoDigit,D.StandardHourTwoDigit,!0,!0,a,!1,!1);this.Replace(a.value,D.SecondSingleDigit,D.StandardSecondSingleDigit,!0,!0,a,!1,!0);this.PartDBNumberFormat()&&this.PartLocaleID()&&(this.hasYearDelay|=this.Replace(a.value,D.YearFourDigit,'"'+J.ReplacePlaceholder+D.YearFourDigit+'"',!0,!1,a,!1,!0),this.hasYearDelay|=this.Replace(a.value,D.YearTwoDigit,'"'+J.ReplacePlaceholder+D.YearTwoDigit+'"',!0,!1,a,!1,!0));this.Replace(a.value,
D.EraYear,D.YearFourDigit,!0,!1,a,!1,!0);this.Replace(a.value,D.EraYear+D.EraYear,D.YearFourDigit,!0,!1,a,!1,!0);this.Replace(a.value,D.EraYear+D.EraYear+D.EraYear,D.YearFourDigit,!0,!1,a,!1,!0);this.Replace(a.value,D.YearSingleDigit,D.StandardYearSingleDigit,!0,!1,a,!1,!0);if(this.absTimeParts)for(b=0;b<this.absTimeParts.length;b++)h=this.absTimeParts[b],this.Replace(a.value,h.token,J.ReplacePlaceholder+h.token,!0,!0,a,!1,!0);this.validDateTimeFormatString=a.value}else throw Error("format is illegal.");
};u.prototype.baseNumberStringConverter=a.prototype.NumberStringConverter;u.prototype.NumberStringConverter=function(a){if(0===arguments.length)return this.baseNumberStringConverter()?this.baseNumberStringConverter():D.defaultNumberStringConverter;this.baseNumberStringConverter(a)};u.prototype.AbsoluteTime=function(){return this.absoluteTime?this.absoluteTime:D.defaultAbsoluteTime};u.prototype.FormatString=function(){return this.formatString};u.prototype.baseDateTimeFormatInfo=a.prototype.DateTimeFormatInfo;
u.prototype.DateTimeFormatInfo=function(a){if(0===arguments.length)return this.baseDateTimeFormatInfo()?this.baseDateTimeFormatInfo():J.DateTimeFormatInfo;this.baseDateTimeFormatInfo(a)};u.prototype.ExactlyMatch=function(a){if(0===arguments.length)return this.exactlyMatch;this.exactlyMatch=a};u.prototype.ExcelCompatibleFormatString=function(){this.formatTemp=this.FormatString;this.Replace(this.formatTemp,D.StandardAMPMSingleDigit,this.CurrentAMPM(),!0,!0,this.formatTemp,!1,!0);this.Replace(this.formatTemp,
D.StandardMonthUnabbreviated,D.MonthUnabbreviated,!0,!1,this.formatTemp,!1,!0);this.Replace(this.formatTemp,D.StandardMonthAbbreviation,D.MonthAbbreviation,!0,!1,this.formatTemp,!1,!0);this.Replace(this.formatTemp,D.StandardMonthTwoDigit,D.MonthTwoDigit,!0,!1,this.formatTemp,!1,!0);this.Replace(this.formatTemp,D.StandardMonthSingleDigit,D.MonthSingleDigit,!0,!1,this.formatTemp,!1,!0);this.Replace(this.formatTemp,D.StandardDayWeekDayAbbreviation,D.DayWeekDayAbbreviation,!0,!0,this.formatTemp,!1,!0);
this.Replace(this.formatTemp,D.StandardDayWeekDayUnabbreviated,D.DayWeekDayUnabbreviated,!0,!0,this.formatTemp,!1,!0);this.Replace(this.formatTemp,D.StandardMinuteSingleDigit,D.MinuteSingleDigit,!1,!0,this.formatTemp,!1,!0);this.Replace(this.formatTemp,D.StandardHourSingleDigit,D.HoursSingleDigit,!0,!0,this.formatTemp,!1,!1);this.Replace(this.formatTemp,D.StandardHourTwoDigit,D.HoursTwoDigit,!0,!0,this.formatTemp,!1,!1);this.Replace(this.formatTemp,D.StandardSecondSingleDigit,D.SecondSingleDigit,
!0,!0,this.formatTemp,!1,!0);this.Replace(this.formatTemp,D.StandardSubSecondThreeDigit,D.SubSecondThreeDigit,!0,!0,this.formatTemp,!1,!0);this.Replace(this.formatTemp,D.StandardSubSecondTwoDigit,D.SubSecondTwoDigit,!0,!0,this.formatTemp,!1,!0);this.Replace(this.formatTemp,D.StandardSubSecondSingleDigit,D.SubSecondSingleDigit,!0,!0,this.formatTemp,!1,!0);this.Replace(this.formatTemp,D.YearFourDigit,D.EraYear,!0,!1,this.formatTemp,!1,!0);this.Replace(this.formatTemp,D.StandardYearSingleDigit,D.YearSingleDigit,
!0,!0,this.formatTemp,!1,!0);return this.formatTemp};u.prototype.CurrentAMPM=function(){var a=null;return(a=this.DateTimeFormatInfo()?this.DateTimeFormatInfo():J.DateTimeFormatInfo)&&a.AMDesignator&&a.AMDesignator!==G.Empty&&a.PMDesignator&&a.PMDesignator!==G.Empty?G.Format("{0}/{1}",a.AMDesignator,a.PMDesignator):D.AMPMTwoDigit};u.prototype.Format=function(a){if(m(a,"boolean"))return a.toString().toUpperCase();var b=G.Empty,h=new Date;try{try{if(h=C.Calc.Convert.toDateTime(a),!h||isNaN(h))return a.toString()}catch(e){return a.toString()}var d=
this.validDateTimeFormatString,f=this.validDateTimeFormatString.replace(/%/g,"");"H"===f||"h"===f||"m"===f||"M"===f||"d"===f||"s"===f||"y"===f?this.validDateTimeFormatString=d="%"+f:d=f;b=(new C.UI._DateTimeHelper(h)).localeFormat(d);if(this.hasJD)var g=this._getMonthName(h.getMonth()),b=z.Replace(b,D.PlaceholderMonthJD,g.substr(0,1));if(this.absTimeParts)for(var k=h-this.AbsoluteTime(),d=0;d<this.absTimeParts.length;d++){var l=this.absTimeParts[d],f=null;switch(l.TimePartType()){case ka.Hour:f=Math.floor(k/
1E3/3600);break;case ka.Minute:f=Math.floor(k/1E3/60);break;case ka.Second:f=Math.floor(k/1E3)}if(f)var n=l.token.replace("[","\\[").replace("]","\\]"),b=z.Replace(b,J.ReplacePlaceholder+n,f)}}catch(q){b=A.toString(a)}this.NumberStringConverter()&&this.hasYearDelay&&(b=z.Replace(b,J.ReplacePlaceholder+D.YearFourDigit,h.toString(D.YearFourDigit)),b=z.Replace(b,J.ReplacePlaceholder+D.YearTwoDigit,h.toString(D.YearTwoDigit)));return b};u.prototype._getMonthName=function(a){return"January February March April May June July August September October November December".split(" ")[a]};
u.prototype.Parse=function(a){if(!a||a===G.Empty)return null;a=w.FixJapaneseChars(a);var b=a.toLowerCase();if("true"===b)return!0;if("false"===b)return!1;if(this.validDateTimeFormatString&&(b=C.UI._DateTimeHelper.parseExact(a,this.validDateTimeFormatString,C.UI._CultureInfo.currentCulture)))return b;if(!this.ExactlyMatch)try{var h=C.Calc.Convert.toDateTime(a);return h&&!isNaN(h)?h:a}catch(e){return a}return null};u.prototype.FixFormat=function(a){var b=new l,h=!1;-1<z.IndexOf(a,D.HoursSingleDigit[0],
1)||z.IndexOf(a,D.SecondSingleDigit[0],1);-1<z.IndexOf(a,D.YearTwoDigit[0],1)||z.IndexOf(a,D.DaySingleDigit[0],1);for(var e=0;e<a.length;e++){var d=a[e];'"'===d?h=!h:h||("Y"===d||"D"===d||"S"===d||"E"===d||"G"===d?d=d.toLowerCase():"M"===d&&(1<e?J.IsEquals("A",a[e-1],!0)||J.IsEquals("P",a[e-1],!0)||(d=d.toLowerCase()):d=d.toLowerCase()));b.Append(d)}return b.toString()};u.prototype.ProcessAMPM=function(a){var b=!1;z.Contains(a.value,D.AMPMTwoDigit)&&(a.value=z.Replace(a.value,D.AMPMTwoDigit,D.StandardAMPMSingleDigit),
b=!0);z.Contains(a.value,D.AMPMSingleDigit)&&(a.value=z.Replace(a.value,D.AMPMSingleDigit,D.StandardAMPMSingleDigit),this.DateTimeFormatInfo()&&(this.DateTimeFormatInfo().AMDesignator=D.AMPMSingleDigit.substr(0,1),this.DateTimeFormatInfo().PMDesignator=D.AMPMSingleDigit.substr(2,1)),b=!0);z.Contains(a.value,D.CurrentAMPM)&&(a.value=z.Replace(a.value,D.CurrentAMPM,D.StandardAMPMSingleDigit),(a=D.CurrentAMPM.split("/"))&&2===a.length&&(this.DateTimeFormatInfo().AMDesignator=a[0],this.DateTimeFormatInfo().PMDesignator=
a[1]),b=!0);return b};u.prototype.Replace=function(a,b,h,e,d,f,g,k){f.value=a;if(e||d){var l=[],n=!0,m=-1<z.IndexOf(f.value,D.HoursSingleDigit[0],1)||-1<z.IndexOf(f.value,D.SecondSingleDigit[0],1);-1<z.IndexOf(f.value,D.YearTwoDigit[0],1)||-1<z.IndexOf(f.value,D.DaySingleDigit[0],1)||!m||(n=!1);for(var q=!1,m=0;m<f.value.length;m++){var s=f.value[m];if(J.IsEquals(s,D.HoursSingleDigit[0],!0)||J.IsEquals(s,D.SecondSingleDigit[0],!0))n=!1;else if(J.IsEquals(s,D.YearTwoDigit[0],!0)||J.IsEquals(s,D.DaySingleDigit[0],
!0))n=!0;if(e&&J.IsEquals(s,b[0],k)&&n||d&&J.IsEquals(s,b[0],k)&&!n){for(var r=!0,t=0;t<b.length;t++)if(t+m>=a.length||!J.IsEquals(b[t],f.value[t+m],k)){r=!1;break}t=m+b.length-1;if(r&&t+1<f.value.length){for(var u=f.value[t],p=-1,p=t+1;p<f.value.length&&J.IsEquals(u,f.value[p],k);p++);p>t+1&&(m=p,r=!1)}r&&!q&&(new C.UI._ArrayHelper(l)).insert(0,m)}'"'===s&&(q=!q)}if(0<l.length){if(!g)for(m=0;m<l.length;m++)a=l[m],f.value=z.Remove(f.value,a,b.length),f.value=z.Insert(f.value,a,h);return!0}}return!1};
u.keywords=[D.YearTwoDigit,D.YearFourDigit,D.MonthSingleDigit,D.MonthTwoDigit,D.MonthAbbreviation,D.MonthUnabbreviated,D.MonthJD,D.DaySingleDigit,D.DayTwoDigit,D.DayWeekDayAbbreviation,D.DayWeekDayUnabbreviated,D.HoursSingleDigit,D.HoursTwoDigit,D.MinuteSingleDigit,D.MinuteTwoDigit,D.SecondSingleDigit,D.SecondTwoDigit];n.prototype=new a;n.prototype.baseNumberStringConverter=a.prototype.NumberStringConverter;n.prototype.NumberStringConverter=function(a){if(0===arguments.length)return this.baseNumberStringConverter()?
this.baseNumberStringConverter():this.defaultNumberStringConverter;this.baseNumberStringConverter(a)};n.prototype.FormatString=function(){return this.fullFormatString};n.prototype.baseNumberFormatInfo=a.prototype.NumberFormatInfo;n.prototype.NumberFormatInfo=function(a){if(0===arguments.length)return this.baseNumberFormatInfo()?this.baseNumberFormatInfo():this.PartLocaleID()&&this.PartLocaleID().CultureInfo()?this.PartLocaleID().CultureInfo().NumberFormat():J.NumberFormatInfo;this.baseNumberFormatInfo(a)};
n.prototype.IsGeneralNumber=function(a){if(0===arguments.length)return this.isGeneralNumber;this.isGeneralNumber=a};n.prototype.ExcelCompatibleFormatString=function(){return this.excelFormatString};n.prototype.Format=function(a){if(m(a,"boolean"))return a.toString().toUpperCase();var b=A.ToDouble(a);if(isNaN(b)||!isFinite(b)||isNaN(a))return"string"===typeof a?a:null;var h=this.NaNSymbol(),h=null;if(this.fractionNumeratorFormat&&this.fractionDenominatorFormat){var e=new g(0);a=new g(0);var d=new g(0);
if(this.GetFraction(b,this.fractionDenominatorFormat.length,e,a,d)){if(this.fractionIntegerFormat){h=new l;0!==e.value&&(h.Append(e.value.toString(this.fractionIntegerFormat,this.NumberFormatInfo())),h.Append(J.Space));b=this.fractionDenominatorFormat;e=parseFloat(b);!isNaN(e)&&0<e&&(a.value*=e/d.value,b=G.Empty,d.value=e,e=Math.ceil(a.value)-a.value,a.value=0.5>=e&&0<e?parseFloat(parseInt(a.value,10)+1):parseFloat(parseInt(a.value,10)));var e=this.fractionNumeratorFormat,f=parseFloat(e);if(!isNaN(f)&&
0===f){var f=e.length,k=a.value.toString(),n=k.length;f>n?e=e.substr(0,e.length-(f-n)):f<n&&(k=k.substr(0,n-(n-f)),a.value=parseInt(k,10))}0!==a.value&&(h.Append(a.value.toString(e,this.NumberFormatInfo())),h.Append(J.SolidusSign),h.Append(d.value.toString(b,this.NumberFormatInfo())))}else h=new l,h.Append((e.value*d.value+a.value).toString(this.fractionNumeratorFormat,this.NumberFormatInfo())),h.Append(J.SolidusSign),h.Append(d.value.toString(this.fractionDenominatorFormat,this.NumberFormatInfo()));
return h.toString()}return b.toString(this.NumberFormatInfo())}h=(new C.UI._NumberHelper(b)).localeFormat(this.EncodeNumberFormat(this.numberFormatString));this.NumberStringConverter()&&(h=this.NumberStringConverter().ConvertTo(h,a,this.isGeneralNumber,this.PartLocaleID(),this.PartDBNumberFormat()));return h};n.prototype.Parse=function(a){a=this.TrimSpecialSymbol(a);a=this.TrimCurrencySymbol(a);if(!a||a===G.Empty)return null;if(z.EndsWith(a,J.NumberGroupSeparator))return a;var b=w.FixJapaneseChars(a);
if("true"===a.toLowerCase())return!0;if("false"===a.toLowerCase())return!1;var h=J.IsDecimal(b,this.NumberFormatInfo()),e=z.IndexOf(b,J.ExponentialSymbol,1),b=-1<e;if(this.numberFormatString){var d=new g(0),k=a=this.TrimPercentSign(a,d);b&&(k=a.substr(0,e));k[0]===J.NumberFormatInfo.PositiveSign&&(k=k.substr(1),a=a.substr(1));var l=z.Replace(k,J.NumberGroupSeparator,""),n=l.indexOf(J.DecimalSeparator);if(n===l.lastIndexOf(J.DecimalSeparator)){var m=new C.UI._StringBuilder("#,##0");if(-1!==n){m.append(".");
for(var n=l.length-n-1,q=0;q<n;q++)m.append("0")}(new f(m.toString())).Format(l)===k&&(a=b?l+a.substr(e):l)}e=parseFloat(a);k=null;e.toString()!==a&&(l=this.NumberFormatInfo(),m=J.DecimalSeparator,l&&(m=l.NumberDecimalSeparator),h||b?h&&!b?k=RegExp("^((\\+|-)?\\d*)"+m+"(\\d*)$","ig"):!h&&b?k=RegExp("^((\\+|-)?\\d+)((E(\\+|-)?|e(\\+|-)?)\\d+)$","ig"):h&&b&&(k=RegExp("^((\\+|-)?\\d*)"+m+"(\\d*)((E(\\+|-)?|e(\\+|-)?)\\d+)$","ig")):k=RegExp("^((\\+|-)?\\d+)$","ig"));if(!isNaN(e)&&isFinite(e)&&(!k||k.test(a)))return 0<
d.value&&(e/=parseFloat(100*d.value)),0!==e&&0!==Math.abs(e-Math.floor(e))&&(h=!0),b&&(h=!0),this.ToObject(e,h)}return null};n.prototype.EncodeNumberFormat=function(a){if(a){a=a.split("");for(var b=new C.UI._StringBuilder,h=0;h<a.length-1;)"\\"===a[h]?(b.append(a[h+1]),h+=2):(b.append(a[h]),h++);h===a.length-1&&"\\"!==a[h]&&b.append(a[h]);a=b.toString()}return a};n.prototype.ToObject=function(a,b){return!b&&1E22>=a?parseInt(a,10):a};n.prototype.TrimPercentSign=function(a,b){b.value=0;if(!a||a===G.Empty)return a;
var h=a,e=J.PercentSymbol,d=a.indexOf(e);d===a.length-1&&d===a.lastIndexOf(e)&&(h=z.Replace(h,e,""),b.value+=(a.length-h.length)/e.length);return h};n.prototype.TrimSpecialSymbol=function(a){if(!a||a===G.Empty)return a;for(var b=-1,h=0;h<a.length;h++)if(S.IsDigit(a[h])){b=h;break}for(var h=-1,e=a.length-1;-1<e;e--)if(S.IsDigit(a[e])){h=e;break}for(e=a.length-1;-1<e;e--){var d=a[e];if(this.IsSpecialSymbol(d))if(S.IsWhiteSpace(d)){if(e<b||h<e)a=z.Remove(a,e,1)}else a=z.Remove(a,e,1);else if(("-"===
d||"+"===d)&&0<e&&"e"!==a[e-1]&&"E"!==a[e-1]&&"("!==a[e-1]&&a[e-1].toString()!==J.NumberFormatInfo.CurrencySymbol)break}return a};n.prototype.IsStandardNumberSymbol=function(a){var b=this.NumberFormatInfo()?this.NumberFormatInfo():J.NumberFormatInfo;return b&&(a=a.toString(),a===b.CurrencyDecimalSeparator||a===b.CurrencyGroupSeparator||a===b.CurrencySymbol||a===b.NaNSymbol||a===b.NegativeInfinitySymbol||a===b.NegativeSign||a===b.NumberDecimalSeparator||a===b.NumberGroupSeparator||a===b.PercentDecimalSeparator||
a===b.PercentGroupSeparator||a===b.PercentSymbol||a===b.PerMilleSymbol||a===b.PositiveInfinitySymbol||a===b.PositiveSign)?!0:!1};n.prototype.IsSpecialSymbol=function(a){return this.IsStandardNumberSymbol(a)?!1:S.IsWhiteSpace(a)?!0:!1};n.prototype.TrimCurrencySymbol=function(a){var b=this.NumberFormatInfo()?this.NumberFormatInfo():J.NumberFormatInfo;if(b){var b=b.CurrencySymbol,h=a.indexOf(b);0===h&&h===a.lastIndexOf(b)&&(a=a.substr(1))}return a};n.keywords=[J.Exponential1,J.Exponential2,J.NumberSign,
J.DecimalSeparator,J.NumberGroupSeparator,J.PercentSymbol,J.Zero,J.SolidusSign];n.EvaluateFormat=function(b){return a.ContainsKeywords(b,n.keywords)};n.GetFraction=function(a,b,h,e,d){return w.GetFraction(a,b,h,e,d)};s.prototype=new a;s.prototype.DigitalFormat=function(){if(!this.digitalFormat){var b=this.fullFormatString,b=J.ReplaceKeyword(b,a.General,s.GeneralNumber);this.digitalFormat=new n(b,this.PartLocaleID(),this.PartDBNumberFormat());this.digitalFormat.IsGeneralNumber(!0)}return this.digitalFormat};
s.prototype.ExponentialDigitalFormat=function(){this.exponentialDigitalFormat||(this.exponentialDigitalFormat=new n("0.#####E+00",this.PartLocaleID(),this.PartDBNumberFormat()),this.exponentialDigitalFormat.IsGeneralNumber(!0));return this.exponentialDigitalFormat};s.prototype.FormatString=function(){return z.Replace(this.fullFormatString,s.GeneralPlaceholder,a.General)};s.prototype.Format=function(a){if(A.IsNumber(a)){var b=this.partLocaleID?this.partLocaleID.AllowScience():!0,h=A.ToDouble(a);if(void 0!==
h&&null!==h)return 99999999999<Math.abs(h)&&b||1E-11>Math.abs(h)&&0!==h?this.ExponentialDigitalFormat().Format(a):this.DigitalFormat().Format(a)}else{if(m(a,"string"))return b=z.Replace(this.FormatString(),'"',""),(b=J.TrimEscape(b))?z.Replace(b,"General",a):a;if(m(a,"boolean"))return a.toString().toUpperCase()}return""};s.prototype.Parse=function(a){if(G.IsNullOrEmpty(a))return null;var b=!1,h=z.IndexOf(a,"-");0<h&&(J.IsEquals(a.charAt(h-1),J.ExponentialSymbol,!0)||(b=!0));if((z.Contains(a,"/")||
b||z.Contains(a,":"))&&(b=C.UI._DateTimeHelper.parseLocale(a))&&!isNaN(b))return b;b=h=null;a.charAt(0)===J.NegativeSign?b=!0:a.charAt(0)===J.PositiveSign&&(b=!1);h=!1;b&&3<a.length&&a.charAt(1)===J.LeftParenthesis&&a.charAt(a.length-1)===J.RightParenthesis&&(h=!0);if(b&&h){if(h=this.DigitalFormat().Parse(z.Remove(a,0,1)))return m(h,"number")?Math.abs(h)*(b?-1:1):h}else if(h=this.DigitalFormat().Parse(a),void 0!==h&&null!==h)return h;return a};s.GeneralPlaceholder="@NumberFormat";s.GeneralNumber=
"##################0.################";s.GeneralMonthDay=function(){return"M/d MMM/d MMMM/d d/M d/MMM d/MMMM M-d MMM-d MMMM-d d-M d-MMM d-MMMM".split(" ")};s.GeneralYearMonth=function(){return"M/y MMM/y M/yyyy MMM/yyyy M-y MMM-y M-yyyy MMM-yyyy".split(" ")};s.GeneralYearMonthDay=function(){return"M/d/y MMM/d/y MMMM/d/y M/d/yyyy MMM/d/yyyy MMMM/d/yyyy d/M/y d/MMM/y d/MMMM/y d/M/yyyy d/MMM/yyyy d/MMMM/yyyy yyyy/M/d M-d-y MMM-d-y MMMM-d-y M-d-yyyy MMM-d-yyyy MMMM-d-yyyy d-M-y d-MMM-y d-MMMM-y d-M-yyyy d-MMM-yyyy d-MMMM-yyyy yyyy-M-d".split(" ")};
s.GeneralHourMinute=function(){return["H:m","h:m tt"]};s.GeneralHourMinuteWithDate=function(){return"M/d H:m;MMM/d H:m;MMMM/d H:m;d/M H:m;d/MMM H:m;d/MMMM H:m;M/y H:m;MMM/y H:m;M/yyyy H:m;MMM/yyyy H:m;M/d/y H:m;MMM/d/y H:m;MMMM/d/y H:m;M/d/yyyy H:m;MMM/d/yyyy H:m;MMMM/d/yyyy H:m;M-d H:m;MMM-d H:m;MMMM-d H:m;d-M H:m;d-MMM H:m;d-MMMM H:m;M-y H:m;MMM-y H:m;M-yyyy H:m;MMM-yyyy H:m;M-d-y H:m;MMM-d-y H:m;MMMM-d-y H:m;M-d-yyyy H:m;MMM-d-yyyy H:m;MMMM-d-yyyy H:m;M/d h:m tt;MMM/d h:m tt;MMMM/d h:m tt;d/M h:m tt;d/MMM h:m tt;d/MMMM h:m tt;M/y h:m tt;MMM/y h:m tt;M/yyyy h:m tt;MMM/yyyy h:m tt;M/d/y h:m tt;MMM/d/y h:m tt;MMMM/d/y h:m tt;M/d/yyyy h:m tt;MMM/d/yyyy h:m tt;MMMM/d/yyyy h:m tt;M-d h:m tt;MMM-d h:m tt;MMMM-d h:m tt;d-M h:m tt;d-MMM h:m tt;d-MMMM h:m tt;M-y h:m tt;MMM-y h:m tt;M-yyyy h:m tt;MMM-yyyy h:m tt;M-d-y h:m tt;MMM-d-y h:m tt;MMMM-d-y h:m tt;M-d-yyyy h:m tt;MMM-d-yyyy h:m tt;MMMM-d-yyyy h:m tt".split(";")};
s.GeneralHourMinuteSecond=function(){return["H:m:s","h:m:s tt","H:m:s","h:mm:ss tt"]};s.GeneralHourMinuteSecondSubSecond=function(){return["H:m:s.FFF","h:m:s.FFF tt"]};s.GeneralHourMinuteSecondWithDate=function(){return"M/d H:m:s;MMM/d H:m:s;MMMM/d H:m:s;d/M H:m:s;d/MMM H:m:s;d/MMMM H:m:s;M/y H:m:s;MMM/y H:m:s;M/yyyy H:m:s;MMM/yyyy H:m:s;M/d/y H:m:s;MMM/d/y H:m:s;MMMM/d/y H:m:s;M/d/yyyy H:m:s;MMM/d/yyyy H:m:s;MMMM/d/yyyy H:m:s;d/M/y H:m:s;d/MMM/y H:m:s;d/MMMM/y H:m:s;d/M/yyyy H:m:s;d/MMM/yyyy H:m:s;d/MMMM/yyyy H:m:s;yyyy/M/d H:m:s;M-d H:m:s;MMM-d H:m:s;MMMM-d H:m:s;d-M H:m:s;d-MMM H:m:s;d-MMMM H:m:s;M-y H:m:s;MMM-y H:m:s;M-yyyy H:m:s;MMM-yyyy H:m:s;M-d-y H:m:s;MMM-d-y H:m:s;MMMM-d-y H:m:s;M-d-yyyy H:m:s;MMM-d-yyyy H:m:s;MMMM-d-yyyy H:m:s;d-M-y H:m:s;d-MMM-y H:m:s;d-MMMM-y H:m:s;d-M-yyyy H:m:s;d-MMM-yyyy H:m:s;d-MMMM-yyyy H:m:s;yyyy-M-d H:m:s;M/d h:m:s tt;MMM/d h:m:s tt;MMMM/d h:m:s tt;d/M h:m:s tt;d/MMM h:m:s tt;d/MMMM h:m:s tt;M/y h:m:s tt;MMM/y h:m:s tt;M/yyyy h:m:s tt;MMM/yyyy h:m:s tt;M/d/y h:m:s tt;MMM/d/y h:m:s tt;MMMM/d/y h:m:s tt;M/d/yyyy h:m:s tt;MMM/d/yyyy h:m:s tt;MMMM/d/yyyy h:m:s tt;d/M/y h:m:s tt;d/MMM/y h:m:s tt;d/MMMM/y h:m:s tt;d/M/yyyy h:m:s tt;d/MMM/yyyy h:m:s tt;d/MMMM/yyyy h:m:s tt;yyyy/M/d h:m:s tt;M/d/yyyy h:mm:ss tt;M-d h:m:s tt;MMM-d h:m:s tt;MMMM-d h:m:s tt;d-M h:m:s tt;d-MMM h:m:s tt;d-MMMM h:m:s tt;M-y h:m:s tt;MMM-y h:m:s tt;M-yyyy h:m:s tt;MMM-yyyy h:m:s tt;M-d-y h:m:s tt;MMM-d-y h:m:s tt;MMMM-d-y h:m:s tt;M-d-yyyy h:m:s tt;MMM-d-yyyy h:m:s tt;MMMM-d-yyyy h:m:s tt;d-M-y h:m:s tt;d-MMM-y h:m:s tt;d-MMMM-y h:m:s tt;d-M-yyyy h:m:s tt;d-MMM-yyyy h:m:s tt;d-MMMM-yyyy h:m:s tt;yyyy-M-d h:m:s tt".split(";")};
s.GeneralHourMinuteSecondSubSecondWithDate=function(){return"M/d H:m:s.FFF;MMM/d H:m:s.FFF;MMMM/d H:m:s.FFF;d/M H:m:s.FFF;d/MMM H:m:s.FFF;d/MMMM H:m:s.FFF;M/y H:m:s.FFF;MMM/y H:m:s.FFF;M/yyyy H:m:s.FFF;MMM/yyyy H:m:s.FFF;d/M/y H:m;d/MMM/y H:m;d/MMMM/y H:m;d/M/yyyy H:m;d/mmm/yyyy H:m;d/MMMM/yyyy H:m;yyyy/M/d H:m;M/d/y H:m:s.FFF;MMM/d/y H:m:s.FFF;MMMM/d/y H:m:s.FFF;M/d/yyyy H:m:s;MMM/d/yyyy H:m:s.FFF;MMMM/d/yyyy H:m:s.FFF;d/M/y H:m:s.FFF;d/MMM/y H:m:s.FFF;d/MMMM/y H:m:s.FFF;d/M/yyyy H:m:s.FFF;d/MMM/yyyy H:m:s.FFF;d/MMMM/yyyy H:m:s.FFF;yyyy/M/d H:m:s.FFF;M-d H:m:s.FFF;MMM-d H:m:s.FFF;MMMM-d H:m:s.FFF;d-M H:m:s.FFF;d-MMM H:m:s.FFF;d-MMMM H:m:s.FFF;M-y H:m:s.FFF;MMM-y H:m:s.FFF;M-yyyy H:m:s.FFF;MMM-Yyyy H:m:s.FFF;d-M-y H:m;d-MMM-y H:m;d-MMMM-y H:m;d-M-yyyy H:m;d-MMM-yyyy H:m;d-MMMM-yyyy H:m;yyyy-M-d H:m;M-d-y H:m:s.FFF;MMM-d-y H:m:s.FFF;MMMM-d-y H:m:s.FFF;M-d-yyyy H:m:s;MMM-d-yyyy H:m:s.FFF;MMMM-d-yyyy H:m:s.FFF;D-M-y H:m:s.FFF;d-MMM-y H:m:s.FFF;d-MMMM-y H:m:s.FFF;D-M-yyyy H:m:s.FFF;d-MMM-yyyy H:m:s.FFF;d-MMMM-yyyy H:m:s.FFF;yyyy-M-d H:m:s.FFF;M/d h:m:s.FFF tt;MMM/d h:m:s.FFF tt;MMMM/d h:m:s.FFF tt;d/M h:m:s.FFF tt;d/MMM h:m:s.FFF tt;d/MMMM h:m:s.FFF tt;M/y h:m:s.FFF tt;MMM/y h:m:s.FFF tt;M/yyyy h:m:s.FFF tt;MMM/yyyy h:m:s.FFF tt;d/M/y h:m tt;d/MMM/y h:m tt;d/MMMM/y h:m tt;d/M/yyyy h:m tt;d/mmm/yyyy h:m tt;d/MMMM/yyyy h:m tt;yyyy/M/d h:m tt;M/d/y h:m:s.FFF tt;MMM/d/y h:m:s.FFF tt;MMMM/d/y h:m:s.FFF tt;M/d/yyyy h:m:s tt;MMM/d/yyyy h:m:s.FFF tt;MMMM/d/yyyy h:m:s.FFF tt;d/M/y h:m:s.FFF tt;d/MMM/y h:m:s.FFF tt;d/MMMM/y h:m:s.FFF tt;d/M/yyyy h:m:s.FFF tt;d/MMM/yyyy h:m:s.FFF tt;d/MMMM/yyyy h:m:s.FFF tt;yyyy/M/d h:m:s.FFF tt;M-d h:m:s.FFF tt;MMM-d h:m:s.FFF tt;MMMM-d h:m:s.FFF tt;d-M h:m:s.FFF tt;d-MMM h:m:s.FFF tt;d-MMMM h:m:s.FFF tt;M-y h:m:s.FFF tt;MMM-y h:m:s.FFF tt;M-yyyy h:m:s.FFF tt;MMM-Yyyy h:m:s.FFF tt;d-M-y h:m tt;d-MMM-y h:m tt;d-MMMM-y h:m tt;d-M-yyyy h:m tt;d-MMM-yyyy h:m tt;d-MMMM-yyyy h:m tt;yyyy-M-d h:m tt;M-d-y h:m:s.FFF tt;MMM-d-y h:m:s.FFF tt;MMMM-d-y h:m:s.FFF tt;M-d-yyyy H:m:s tt;MMM-d-yyyy H:m:s.FFF tt;MMMM-d-yyyy h:m:s.FFF tt;d-M-y h:m:s.FFF tt;d-MMM-y h:m:s.FFF tt;d-MMMM-y h:m:s.FFF tt;d-M-yyyy h:m:s.FFF tt;d-MMM-yyyy h:m:s.FFF tt;d-MMMM-yyyy h:m:s.FFF tt;yyyy-M-d h:m:s.FFF tt".split(";")};
s.EvaluateFormat=function(b){return b&&b!==G.Empty?a.ContainsKeywords(b,[a.General.toLowerCase()]):!1}})(window);
(function(p,l){function m(){}function k(){}function g(){}function a(){}function d(){}function e(){this._checkboxSize=12;this._textFalse=this._textIndeterminate=this._textTrue=this._caption="";this._textAlign=r.CheckBoxTextAlign.right;this._isThreeState=!1}function b(){this._marginLeft=this._marginBottom=this._marginRight=this._marginTop=2;this._text="";this._buttonBackColor=null;this._buttonBorderColor="#707070"}function f(){this._editorValueType=r.EditorValueType.Text;this._items=null;this._hasInPlaceEditor=
!1}function s(){this._link="";this._linkColor="#0066CC";this._visitedLinkColor="#3399FF";this._linkToolTip=this._text="";this._id=s._getUniqueId()}function q(){}var t=p.GrapeCity;"undefined"===typeof t&&(t=p.GrapeCity={});"undefined"===typeof t.UI&&(t.UI={});var r=t.UI,u=p.document,n=p.Image;r.CheckBoxTextAlign={top:0,bottom:1,left:2,right:3};r.EditorValueType={Text:0,Index:1,Value:2};r.CellTypeKind={BaseCellType:0,TextCellType:1,ColumnHeaderCellType:2,RowHeaderCellType:3,CornerCellType:4,CheckBoxCellType:5,
ButtonCellType:6,ComboBoxCellType:7,HyperLinkCellType:8};m.prototype={paint:function(a,b,e,d,f,g,k,l){},createEditorElement:function(){return null},_getLocator:function(){var a=u.createElement("span");l(a).css("position","absolute");l(a).css("visibility","hidden");l(a).css("background-color","#68E");l(a).css("margin","0");l(a).css("padding","2px");l(a).css("font","normal 12px Arial");l(a).css("color","white");l(a).css("border-width","0");l(a).attr("class","gc-input-locator");a.setAttribute("gcUIElement",
"gcEditingLocator");return a},getEditorValue:function(a){return null},_formatEditorValue:function(a,b,e){return e},setEditorValue:function(a,b){},parse:function(a,b){if(void 0===b||null===b||void 0===a||null===a)return void 0===a||null===a?"":a.toString();try{return(new r.GeneralFormatter(b)).Parse(a)}catch(e){return a.toString()}},format:function(a,b,e){if(void 0===b||null===b||void 0===a||null===a)return void 0===a||null===a?"":"boolean"===typeof a||a instanceof Boolean?a.toString().toUpperCase():
a instanceof Date?(new r._DateTimeHelper(a)).localeFormat("M/d/yyyy h:mm:ss"):a.toString();try{var d=null,d=b instanceof r.AutoFormatter||b instanceof r.GeneralFormatter?b:new r.GeneralFormatter(b);return d.Format(a,e)}catch(f){return a.toString()}},focus:function(a){a&&a.focus&&a.focus()},getThemeStyle:function(a){return r.Global.prototype.getWijmoThemeStyle(a)},activateEditor:function(a,b,e){},deactivateEditor:function(a){},selectAll:function(a){a&&a.select&&a.select()},updateEditor:function(a,
b,e){},_updateEditorLocator:function(a){if(a&&a.sheet){var b=a.sheet;b.isEditing()&&b.showEditingLocator&&a._editingLocator&&(b=a._editingLocator,l(b).css("top",parseInt(l(a).css("top"),10)-18),l(b).css("left",parseInt(l(a).css("left"),10)))}},getHitInfo:function(a,b,e,d,f,g,k){return null},processMouseDown:function(a){return!1},processMouseMove:function(a){return!1},processMouseUp:function(a){return!1},processMouseEnter:function(a){},processMouseLeave:function(a){},isReservedKey:function(a){return!1},
isEditingValueChanged:function(a,b){return a!==b},_getAutoFitWidth:function(a,b,e,d,f){return 0},_getAutoFitHeight:function(a,b,e,d){return 0},toJSON:function(){return{type:r.CellTypeKind.BaseCellType}},fromJSON:function(a){}};r.BaseCellType=m;k.prototype=new m;k.prototype.paint=function(a,b,e,d,f,g,k,l){if(a){a.save();a.rect(e,d,f,g);a.clip();a.beginPath();k&&k.backColor?(a.fillStyle=k.backColor,a.fillRect(e,d,f,g)):t.UI._useDoubleBuffer()||(k&&l.visualState===t.UI.VisualState.Selected?(a.fillStyle=
"#9fa9c5",a.fillRect(e,d,f,g)):k&&l.visualState===t.UI.VisualState.Active&&(a.fillStyle="#9fafc5",a.fillRect(e,d,f,g)));try{k&&k.backgroundImage&&"none"!==k.backgroundImage&&l.imageLoader&&(l.imageLoader.getState(k.backgroundImage)?a.drawImage(l.imageLoader.getImage(k.backgroundImage),e,d,f,g):l.imageLoader.addImage(k.backgroundImage))}catch(n){}var m=l.sheet,q=l.row,s=l.col;if(m&&null!==q&&void 0!==q&&null!==s&&void 0!==s){var u=m._conditionalFormats;if(u&&0<u.count())for(var u=u.getRules(q,s),p=
0;p<u.length;p++){var A=u[u.length-1-p];if(A instanceof r.DataBarRule){if(A=A.evaluate(m,q,s,b)){var L=new r.Rect(e+2,d+2,f-4,g-4),D=L.x,w=L.y,M=parseInt(Math.abs(L.width*A.scale)),T=L.height;if(0===A.axisLocation)0>=A.scale&&(M=0);else if(1===A.axisLocation)0>A.scale?D=D+L.width-M:M=0;else{var P=parseInt(L.width*A.axisLocation+D)+0.5,L=L.y,ia=g-1;a.lineWidth=1;a.strokeStyle=A.axisColor;a.beginPath();for(var v=0;v<=ia;v+=2)A.direction===r.BarDirection.RightToLeft?(a.moveTo(2*e+f-P,L+v),a.lineTo(2*
e+f-P,L+v+1)):(a.moveTo(P,L+v),a.lineTo(P,L+v+1));a.stroke();0<A.scale?D=P+1:0>A.scale?D=P-M:M=0}A.showBorder&&(D=parseInt(D)+0.5,M-=1,w+=0.5,T-=1);if(0<=M&&0<=T){P=A.fillColor;if(A.isGradient){var P=A.direction===r.BarDirection.RightToLeft?a.createLinearGradient(2*e+f-D-M,w,2*e+f-D,w+T):a.createLinearGradient(D,w,D+M,w+T),L=r._Color.parse(A.fillColor),L=(new r._Color(L.a,parseInt(229.5+L.r*(1-0.9)),parseInt(229.5+L.g*(1-0.9)),parseInt(229.5+L.b*(1-0.9)))).toString(),ia=0>A.scale?1-0.9:0.9,v=A.fillColor,
V=0>A.scale?1:0;A.direction===r.BarDirection.RightToLeft?(P.addColorStop(ia,v),P.addColorStop(V,L)):(P.addColorStop(ia,L),P.addColorStop(V,v))}a.fillStyle=P;A.direction===r.BarDirection.RightToLeft?a.fillRect(2*e+f-D-M,w,M,T):a.fillRect(D,w,M,T);A.showBorder&&0<M&&0<T&&(a.strokeStyle=A.borderColor,A.direction===r.BarDirection.RightToLeft?a.strokeRect(2*e+f-D-M,w,M,T):a.strokeRect(D,w,M,T))}this._showBarOnly=A.showBarOnly}}else if(A instanceof r.IconSetRule&&(D=e+1,w=d+2,T=M=16,A=A.evaluate(m,q,s,
b))){A.showIconOnly&&(P=r._SheetRender.getHAlignByValueType(k.hAlign,b),P==r.HorizontalAlign.center?D=e+f/2-M/2:P==r.HorizontalAlign.right&&(D=e+f-M-2));k.vAlign==r.VerticalAlign.center?w=d+g/2-T/2:k.vAlign==r.VerticalAlign.bottom&&(w=d+g-T-2);P=r.IconSetRule.getIcon(A.iconSetType,A.iconIndex);try{P&&l.imageLoader&&("string"===typeof P?l.imageLoader.getState(P)?a.drawImage(l.imageLoader.getImage(P),D,w,M,T):l.imageLoader.addImage(P):l.imageLoader.getState(P.image)?a.drawImage(l.imageLoader.getImage(P.image),
P.x,P.y,P.w,P.h,D,w,M,T):l.imageLoader.addImage(P.image))}catch(N){}this._showIconOnly=A.showIconOnly}}}l.sparkline&&l.sparkline.paintSparkline(a,e,d,f,g);l.cellOverflowLayout||this._showBarOnly||this._showIconOnly||this.paintValue(a,b,e,d,f,g,k,l);this._showIconOnly=this._showBarOnly=!1;a.restore()}};k.prototype.paintValue=function(a,b,e,d,f,g,k,l){if(a){a.save();if(l.cellOverflowLayout){var n=l.cellOverflowLayout.layout;n&&(a.rect(n.x,n.y,n.width,n.height),a.clip(),a.beginPath())}else a.rect(e,
d,f,g),a.clip(),a.beginPath();var m={value:null},n=this.format(b,k.formatter?k.formatter:k._autoFormatter,m);if(void 0!==n&&null!==n&&0<n.length){k.foreColor&&(a.fillStyle=k.foreColor);m.value&&(a.fillStyle=m.value);k.font&&(a.font=k.font);m=0;0<k.textIndent&&(m=8*k.textIndent);var q=this._getHAlignByValueType(k.hAlign,b,n);b=2+m;a.textAlign="left";q===r.HorizontalAlign.center?(b=f/2,a.textAlign="center"):q===r.HorizontalAlign.right&&(b=f-1-2-m,a.textAlign="right");f=n.split(/\r\n|\r|\n/);m=0;k.wordWrap&&
1<f.length&&k.vAlign!==r.VerticalAlign.top&&(m=(f.length-1)*l.lineHeight);q=2;a.textBaseline="top";k.vAlign===r.VerticalAlign.center?(q=(g-m)/2,a.textBaseline="middle"):k.vAlign===r.VerticalAlign.bottom&&(q=g-m-2,a.textBaseline="bottom");if(k.wordWrap)for(d+=q,g=0;g<f.length;g++)a.fillText(f[g],e+b,d),d+=l.lineHeight;else a.fillText(n,e+b,d+q)}a.restore()}};k.prototype._getHAlignByValueType=function(a,b,e){return r._SheetRender.getHAlignByValueType(a,b)};k.prototype.createEditorElement=function(){var a=
u.createElement("textarea"),b=l(a);b.css("position","absolute");b.css("margin","0");b.css("font","normal 10pt Arial");b.css("padding","1px");b.css("word-wrap","normal");b.css("overflow","hidden");b.css("resize","none");b.css("border","2px #5292f7 solid");b.css("outline","none");b.css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)");b.css("box-sizing","content-box");b.css("z-index","2000");b.attr("class","gc-input-box");b.attr("autocomplete","off");b.attr("gcUIElement","gcEditingInput");return a};k.prototype.getEditorValue=
function(a){a=a?a.value:null;return void 0!==a&&null!==a&&0<a.length?a:null};k.prototype.setEditorValue=function(a,b){var e=a&&a.sheet&&a.sheet._startEditByKeydown?!0:!1;a&&void 0!==b&&null!==b&&!e&&(a.value=b)};k.prototype.focus=function(a){a&&(a.focus(),a.selectionStart=a.value.length)};k.prototype._formatEditorValue=function(a,b,e){if(a&&a.sheet){a=a.sheet;var d=a._activeRowIndex,f=a._activeColIndex;b=b.formatter?b.formatter:b._autoFormatter;if(null!==e&&void 0!==e)if(b instanceof r.AutoFormatter&&
b._innerFormatter instanceof r.GeneralFormatter)e=b._innerFormatter.GetPreferredEditingFormatter(e).Format(e);else{var g=null;"string"===typeof b&&(g=b,b=new r.GeneralFormatter(b));if(b)try{var k=b.GetFormatType(e);k===r.NumberFormatType.Number||k===r.NumberFormatType.Text?b=new r.GeneralFormatter("General"):k===r.NumberFormatType.DateTime&&g&&0>g.indexOf("y")&&0>g.indexOf("d")&&0>g.indexOf("mmm")&&(b=new r.GeneralFormatter("yyyy/mm/dd hh:mm:ss"),a._editingTimeValue=!0);e=b.Format(e)}catch(l){e=a.getText(d,
f)}else e=a.getText(d,f)}}return e};k.prototype.activateEditor=function(a,b,e){if(a&&a.sheet){var d=l(a),f=a.sheet,g=f._eventHandler._getCanvasOffset(),k=g.left+f._bounds.x+e.x-2;d.css("top",g.top+f._bounds.y+e.y-2);d.css("left",k);var n=this;d.bind("keydown.gcEditingInput",function(d){n._updateEditorImp(a,b,e,d);if(!n._processEditingWrap(d)){var g=0===a.selectionStart&&d.keyCode===r.Key.left&&!d.ctrlKey&&!d.shiftKey&&!d.altKey,k=a.selectionStart===a.value.length&&d.keyCode===r.Key.right&&!d.ctrlKey&&
!d.shiftKey&&!d.altKey;a.selectionStart===a.selectionEnd&&(g||k)&&f._editorStatus===r.EditorStatus.Edit&&r.cancelDefault(d)}});d.bind("keyup.gcEditingInput",function(d){d.keyCode!==r.Key.del&&d.keyCode!==r.Key.backspace&&(d.keyCode!==r.Key.z&&d.keyCode!==r.Key.y||!d.ctrlKey||d.altKey)||n._updateEditorImp(a,b,e,d);(d.keyCode!==r.Key.enter&&d.keyCode!==r.Key.tab||d.ctrlKey||d.altKey)&&f._trigger(r.Events.EditChange,{sheet:f,sheetName:f._name,row:f._activeRowIndex,col:f._activeColIndex,editingText:n.getEditorValue(a)})});
d.bind("paste.gcEditingInput",function(d){n._pasteInputSizingToken=p.setTimeout(function(){n._updateEditorImp(a,b,e,d);n._pasteInputSizingToken&&(p.clearTimeout(n._pasteInputSizingToken),delete n._pasteInputSizingToken)},10)});d.bind("mousedown.gcEditingInput",function(a){f._editorStatus===r.EditorStatus.Enter&&(f._editorStatus=r.EditorStatus.Edit,f._trigger(r.Events.EditorStatusChanged,{sheet:f,sheetName:f._name,oldStatus:r.EditorStatus.Enter,newStatus:r.EditorStatus.Edit}))});u.body.insertBefore(a,
null)}};k.prototype.deactivateEditor=function(a){a&&(l(a).unbind(".gcEditingInput"),a._editingLocator&&u.body.removeChild(a._editingLocator),u.body.removeChild(a))};k.prototype._updateEditorImp=function(a,b,e,d){if(a&&a.sheet){var f=a.sheet;if(f.isEditing()){var g=null,k=null,n=r.HorizontalAlign;b&&(g=r._SheetRender.getHAlignByValueType(b.hAlign,a._originalValue),g===n.left?l(a).css("text-align","left"):g===n.center?l(a).css("text-align","center"):g===n.right?l(a).css("text-align","right"):l(a).css("text-align",
"left"),b.backColor&&l(a).css("background-color",b.backColor),b.foreColor&&l(a).css("color",b.foreColor),k=b.font?b.font:f._render._getDefaultFont())&&(1<f._zoomFactor&&(k=f._render._getZoomFont(k)),l(a).css("font",k));if(e){var m=f._getSheetLayout(),q,s=1;q=1+parseInt(l(a).css("padding-left"),10)+parseInt(l(a).css("padding-right"),10);s=s+parseInt(l(a).css("padding-top"),10)+parseInt(l(a).css("padding-bottom"),10);k=e.width;e.x+e.width>m.width&&(k=m.width-e.x);l(a).css("width",k-q);l(a).css("height",
e.height-s);void 0===g||null===g||g===n.left?a.maxWidth=m.width-e.x-q:g===n.center?a.maxWidth=2*Math.max(0,Math.min(m.width-e.x-e.width-q,e.x-m.rowHeaderWidth-q))+e.width:g===n.right&&(a.maxWidth=e.x+e.width-m.rowHeaderWidth-q);a.maxHeight=m.height-e.y-s;a.minWidth=parseInt(a.style.width,10);a.minHeight=parseInt(a.style.height,10)}e=a.value;(k=a.style.font)||(k=f._render._getZoomFont(f._render._getDefaultFont()));g=f._getFontHeight(k);d&&f._eventHandler.allowEnterEditing(d)&&(m=a.selectionStart,n=
e.substr(0,m),e=e.substr(m,e.length-m),e=n+String.fromCharCode(d.keyCode)+e);d=e.split(/\r\n|\r|\n/);a.maxWidth<a.minWidth&&(a.minWidth=a.maxWidth);a.maxHeight<a.minHeight&&(a.minHeight=a.maxHeight);if(b&&b.wordWrap||0<d.length){m=0;e=[];for(b=0;b<d.length;b++)n=f._getStringWidth(d[b],k),e.push(n),m=Math.max(m,n);f=d.length*g;if(m<=a.minWidth)l(a).css("width",a.minWidth),l(a).css("word-wrap","normal"),l(a).css("overflow","hidden");else if(m>a.minWidth&&m<=a.maxWidth)l(a).css("width",m),l(a).css("word-wrap",
"normal"),l(a).css("overflow","hidden");else if(m>a.maxWidth)for(l(a).css("width",a.maxWidth),l(a).css("word-wrap","break-word"),l(a).css("overflow","hidden"),b=f=0;b<e.length;b++)n=e[b],n<=a.maxWidth?f+=g:n>a.maxWidth&&(k=Math.ceil(n/a.maxWidth),f+=g*k);f<=a.minHeight?l(a).css("height",a.minHeight):f>a.minHeight&&f<=a.maxHeight?l(a).css("height",f):f>a.maxHeight&&(l(a).css("height",a.maxHeight),l(a).css("overflow-y","scroll"))}else k=f._getStringWidth(e,k),k>a.minWidth&&k<=a.maxWidth?(l(a).css("width",
k),l(a).css("height",a.minHeight),l(a).css("word-wrap","normal"),l(a).css("overflow","hidden")):k<=a.minWidth?(l(a).css("width",a.minWidth),l(a).css("height",a.minHeight),l(a).css("word-wrap","normal"),l(a).css("overflow","hidden")):k>a.maxWidth&&(l(a).css("width",a.maxWidth),l(a).css("word-wrap","break-word"),k=Math.ceil(k/a.maxWidth),f=g*k,f<=a.minHeight?(l(a).css("height",a.minHeight),l(a).css("overflow","hidden")):f<=a.maxHeight?(l(a).css("height",f),l(a).css("overflow","hidden")):f>a.maxHeight&&
(l(a).css("height",a.maxHeight),l(a).css("overflow-y","scroll")));g=l(a).css("text-align");f=l(a).width()-a.minWidth;void 0!==g&&null!==g&&"left"!==g&&("center"===g?l(a).css("left",a.originalLeft-f/2):"right"===g&&l(a).css("left",a.originalLeft-f));this._updateEditorLocator(a)}}};k.prototype.updateEditor=function(a,b,e){this._updateEditorImp(a,b,e,null)};k.prototype.isReservedKey=function(a){var b=a.srcElement||a.target;return b&&"gcEditingInput"===b.getAttribute("gcUIElement")?a.keyCode===r.Key.enter&&
(a.ctrlKey||a.altKey)||a.keyCode===r.Key.z&&a.ctrlKey&&!a.altKey||a.keyCode===r.Key.y&&a.ctrlKey&&!a.altKey:!1};k.prototype._processEditingWrap=function(a){var b=a.srcElement||a.target;if(b&&"gcEditingInput"===b.getAttribute("gcUIElement")&&a.keyCode===r.Key.enter&&(a.ctrlKey||a.altKey)){var e=b.selectionStart,d=b.value,f=d.substr(0,e),d=d.substr(e,d.length-e);b.value=f+"\n"+d;b.selectionStart=e+1;b.selectionEnd=e+1;b=p.gcGlobal.activeElement;b instanceof r.GcSheet&&(e=b.getCellType(b._activeRowIndex,
b._activeColIndex))&&e.updateEditor(b._editor,null,null);r.cancelDefault(a);return!0}return!1};k.prototype._getAutoFitWidth=function(a,b,e,d,f){b=0;if("string"===typeof e&&""!==e){if(d.wordWrap){e=e.split(/\r\n|\r|\n/);for(var g=0;g<e.length;g++)b=Math.max(b,a._getStringWidth(e[g],d.font)/a._zoomFactor)}else b=a._getStringWidth(e,d.font)/a._zoomFactor;d.hAlign!==r.HorizontalAlign.center&&0<d.textIndent&&(b+=8*d.textIndent/a._zoomFactor);f&&(a=parseInt(a.defaults.rowHeight*(1<a._zoomFactor?1:a._zoomFactor),
10),b+=a)}return b};k.prototype._getAutoFitHeight=function(a,b,e,d){b=0;"string"===typeof e&&""!==e&&(a=a._getFontHeight(d.font)/a._zoomFactor,b=d.wordWrap?e.split(/\r\n|\r|\n/).length*a:a);return b};k.prototype.toJSON=function(){return{type:r.CellTypeKind.TextCellType}};r.TextCellType=k;g.prototype=new m;g.prototype.paint=function(a,b,e,d,f,g,k,l){if(a){a.save();a.rect(e,d,f,g);a.clip();a.beginPath();var m=null;if(l&&void 0!==l.visualState)if(l.useWijmoTheme)try{if((m=this.getThemeStyle(l.visualState))&&
m.backgroundColor&&""!==m.backgroundColor)a.fillStyle=m.backgroundColor,a.fillRect(e,d,f,g);else if(m&&m.backgroundImage&&"none"!==m.backgroundImage&&""!==m.backgroundImage){var q=new n,s=m.backgroundImage,s=s.replace('url("',""),s=s.replace('")',"");q.src=s;a.drawImage(q,e,d,f,g)}}catch(t){}else q=r.VisualState,s=a.createLinearGradient(e+f/2,d,e+f/2,d+g),l.visualState===q.Normal&&(k.backColor?a.fillStyle=k.backColor:(s.addColorStop(0.125,"#F6FAFB"),s.addColorStop(1,"#D2DBEB"),a.fillStyle=s)),l.visualState===
q.Highlight&&(s.addColorStop(0.125,"#ffd45a"),s.addColorStop(1,"#ffef72"),a.fillStyle=s),l.visualState===q.Selected&&(a.fillStyle="#9fa9c5"),l.visualState===q.Hover&&(s.addColorStop(0.125,"#ffe165"),s.addColorStop(1,"#fff9a3"),a.fillStyle=s),a.fillRect(e,d,f,g);b=this.format(b,k.formatter);void 0!==b&&null!==b&&0<b.length&&(l&&l.useWijmoTheme&&m?a.fillStyle=m.color:k.foreColor&&(a.fillStyle=k.foreColor),k.font&&(a.font=k.font),q=0,0<k.textIndent&&(q=8*k.textIndent),s=r.HorizontalAlign,l=r.VerticalAlign,
m=2+q,a.textAlign="left",k.hAlign===s.center?(m=f/2,a.textAlign="center"):k.hAlign===s.right&&(m=f-1-q,a.textAlign="right"),f=3,a.textBaseline="top",k.vAlign===l.center?(f=g/2+1,a.textBaseline="middle"):k.vAlign===l.bottom&&(f=g-1,a.textBaseline="bottom"),a.fillText(b,e+m,d+f));a.restore()}};g.prototype.toJSON=function(){return{type:r.CellTypeKind.ColumnHeaderCellType}};r.ColumnHeaderCellType=g;a.prototype=new m;a.prototype.paint=function(a,b,e,d,f,g,k,l){if(a){a.save();a.rect(e,d,f,g);a.clip();a.beginPath();
var m=null;if(l&&void 0!==l.visualState)if(l.useWijmoTheme)try{if((m=this.getThemeStyle(l.visualState))&&m.backgroundColor&&""!==m.backgroundColor)a.fillStyle=m.backgroundColor,a.fillRect(e,d,f,g);else if(m&&m.backgroundImage&&"none"!==m.backgroundImage&&""!==m.backgroundImage){var q=new n,s=m.backgroundImage,s=s.replace('url("',""),s=s.replace('")',"");q.src=s;a.drawImage(q,e,d,f,g)}}catch(t){}else q=r.VisualState,l.visualState===q.Normal&&(a.fillStyle=k.backColor?k.backColor:"#E4ECF7"),l.visualState===
q.Highlight&&(a.fillStyle="#ffdc61"),l.visualState===q.Selected&&(a.fillStyle="#9fa9c5"),l.visualState===q.Hover&&(a.fillStyle="#fde47b"),a.fillRect(e,d,f,g);b=this.format(b,k.formatter);void 0!==b&&null!==b&&0<b.length&&(l&&l.useWijmoTheme&&m?a.fillStyle=m.color:k.foreColor&&(a.fillStyle=k.foreColor),k.font&&(a.font=k.font),q=0,0<k.textIndent&&(q=8*k.textIndent),s=r.HorizontalAlign,l=r.VerticalAlign,m=2+q,a.textAlign="left",k.hAlign===s.center?(m=f/2,a.textAlign="center"):k.hAlign===s.right&&(m=
f-1-q,a.textAlign="right"),f=3,a.textBaseline="top",k.vAlign===l.center?(f=g/2+1,a.textBaseline="middle"):k.vAlign===l.bottom&&(f=g-1,a.textBaseline="bottom"),a.fillText(b,e+m,d+f));a.restore()}};a.prototype.toJSON=function(){return{type:r.CellTypeKind.RowHeaderCellType}};r.RowHeaderCellType=a;d.prototype=new m;d.prototype.paint=function(a,b,e,d,f,g,k,l){if(a){a.save();a.rect(e,d,f,g);a.clip();a.beginPath();if(l&&void 0!==l.visualState){b=r.VisualState;if(l.useWijmoTheme)try{var m=this.getThemeStyle(l.visualState);
if(m&&m.backgroundColor&&""!==m.backgroundColor)a.fillStyle=m.backgroundColor,a.fillRect(e,d,f,g);else if(m&&m.backgroundImage&&"none"!==m.backgroundImage){var q=new n,s=m.backgroundImage,s=s.replace('url("',""),s=s.replace('")',"");q.src=s;a.drawImage(q,e,d,f,g)}}catch(t){}else l.visualState===b.Normal&&(a.fillStyle="#A9C4E9"),l.visualState===b.Selected&&(a.fillStyle="#9fa9c5"),l.visualState===b.Hover&&(a.fillStyle="#a1b0c8"),a.fillRect(e,d,f,g);m=a.createLinearGradient(e+f/2,d,e+f/2,d+g);m.addColorStop(0.125,
"#F6FAFB");l&&l.useWijmoTheme?(l=this.getThemeStyle(b.Hover),m.addColorStop(1,l.backgroundColor)):m.addColorStop(1,"#D2DBEB");a.fillStyle=m;a.beginPath();l=g;f<g&&(l=f);a.moveTo(e+f-l+3,d+g-3);a.lineTo(e+f-3,d+g-3);a.lineTo(e+f-3,d+g-l+3);a.fill()}a.restore()}};d.prototype.toJSON=function(){return{type:r.CellTypeKind.CornerCellType}};r.CornerCellType=d;e.prototype=new k;e.prototype.paintValue=function(a,b,e,d,f,g,k,l){if(a){a.save();var n=this._getDisplayText(b),m=0,q=0;l.sheet&&(m=l.sheet._getStringWidth(n,
k.font),q=l.sheet._getFontHeight(k.font),n&&(l=n.split(/\r\n|\r|\n/),q*=l.length));l=this._checkboxSize/2;f=new r.Rect(++e,++d,--f,--g);e=parseInt(e+this._getCheckBoxLeft(k,f,m));d=parseInt(d+this._getCheckBoxTop(k,f,q));q="left";m=e+1;k.hAlign===r.HorizontalAlign.center?(q="center",m+=l):k.hAlign===r.HorizontalAlign.right&&(q="right",m+=2*l);k.font&&(a.font=k.font);k.foreColor&&(a.fillStyle=k.foreColor);this._textAlign===r.CheckBoxTextAlign.left?(a.textAlign="right",a.textBaseline="middle",a.fillText(n,
e+1-2,d+l)):this._textAlign===r.CheckBoxTextAlign.top&&(a.textAlign=q,a.textBaseline="bottom",a.fillText(n,m,d-2));a.strokeStyle="black";a.strokeRect(e+0.5,d+0.5,2*l+0.05,2*l+0.05);a.fillStyle="white";a.fillRect(e+1,d+1,2*l-1,2*l-1);!this._isThreeState||null!==b&&void 0!==b?!0===!!b&&(a.beginPath(),a.lineWidth=2.5,a.moveTo(e+3,d+l),a.lineTo(e+l,d+2*l-3.5),a.lineTo(e+2*l-1.5,d+3),a.stroke()):(a.beginPath(),a.fillStyle="green",a.rect(e+3,d+3,2*(l-2.5),2*(l-2.5)),a.fill());k.foreColor&&(a.fillStyle=
k.foreColor);this._textAlign===r.CheckBoxTextAlign.right?(a.textAlign="left",a.textBaseline="middle",a.fillText(n,e+1+2*l+2,d+l)):this._textAlign===r.CheckBoxTextAlign.bottom&&(a.textAlign=q,a.textBaseline="top",a.fillText(n,m,d+2*l+2));a.restore()}};e.prototype.focus=function(a){a&&a.focus()};e.prototype._formatEditorValue=function(a,b,e){return e};e.prototype._getCheckBoxLeft=function(a,b,e,d){var f=b.x-1;b=b.width+1;var g=0,k=0;this._textAlign===r.CheckBoxTextAlign.top||this._textAlign===r.CheckBoxTextAlign.bottom?
(k=f+5,a.hAlign===r.HorizontalAlign.center?k=f+b/2-this._checkboxSize/2:a.hAlign===r.HorizontalAlign.right&&(k=f+b-5-this._checkboxSize)):this._textAlign===r.CheckBoxTextAlign.left?(g=this._checkboxSize+e,k=f+5+e,a.hAlign===r.HorizontalAlign.center?k=f+b/2-g/2+e:a.hAlign===r.HorizontalAlign.right&&(k=f+b-5-g+e)):(g=this._checkboxSize+e,k=f+5,a.hAlign===r.HorizontalAlign.center?k=f+b/2-g/2:a.hAlign===r.HorizontalAlign.right&&(k=f+b-5-g));a=k-f;d&&l.browser.msie&&(a-=3);return a};e.prototype._getCheckBoxTop=
function(a,b,e,d){var f=b.y-1;b=b.height+1;var g=0,k=0;this._textAlign===r.CheckBoxTextAlign.top?(g=this._checkboxSize+e,k=f+5+e,a.vAlign===r.VerticalAlign.center?k=f+b/2-g/2+e:a.vAlign===r.VerticalAlign.bottom&&(k=f+b-5-g+e)):this._textAlign===r.CheckBoxTextAlign.bottom?(g=this._checkboxSize+e,k=f+5,a.vAlign===r.VerticalAlign.center?k=f+b/2-g/2:a.vAlign===r.VerticalAlign.bottom&&(k=f+b-5-g)):(k=f+5,a.vAlign===r.VerticalAlign.center?k=f+b/2-this._checkboxSize/2:a.vAlign===r.VerticalAlign.bottom&&
(k=f+b-5-this._checkboxSize));a=k-f;d&&l.browser.msie&&(a-=3);return a};e.prototype.createEditorElement=function(){var a=u.createElement("div"),b=l(a);b.css("position","absolute");b.css("margin","0");b.css("padding","0");b.css("overflow","hidden");b.css("resize","none");b.css("border","2px #5292f7 solid");b.css("outline","none");b.css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)");b.css("box-sizing","content-box");b.attr("tabindex",1);b.attr("gcUIElement","gcEditingInput");var e=l("<input/>");e.attr("type",
"checkbox");b.append(e);e=l("<span></span>");e.css("position","absolute");e.css("font","normal 10pt Arial");e.css("cursor","default");e.css("white-space","nowrap");b.append(e);e=l("<div></div>");e.css("position","absolute");e.css("background-color","green");e.css("width",2*(this._checkboxSize/2-2.5));e.css("height",2*(this._checkboxSize/2-2.5));b.append(e);return a};e.prototype._getNextState=function(a){return this._isThreeState?null===a||void 0===a?!1:!0===!!a?null:!0:!a};e.prototype.setEditorValue=
function(a,b){a&&3===a.children.length&&(a.sheet&&a.sheet._startEditByKeydown&&!this._isSpaceKeyDown||(b=this._getNextState(b)),this._isThreeState?null===b||void 0===b?(a.children[0].checked=!1,l(a.children[2]).show()):(a.children[0].checked=!!b,l(a.children[2]).hide()):a.children[0].checked=!!b,l(a.children[1]).text(this._getDisplayText(b)))};e.prototype.getEditorValue=function(a){if(a&&3===a.children.length)if(this._isThreeState){if(!l(a.children[2]).is(":visible"))return a.children[0].checked}else return a.children[0].checked;
return null};e.prototype._triggerButtonClicked=function(a,b,e){a.parent&&a.parent._trigger(r.Events.ButtonClicked,{sheet:a,sheetName:a._name,row:b,col:e})};e.prototype.activateEditor=function(a,b,e){if(a&&a.sheet){var d=a.sheet,f=l(a),g=d._eventHandler._getCanvasOffset(),k=g.left+d._bounds.x+e.x-2;f.css("top",g.top+d._bounds.y+e.y-2);f.css("left",k);f.css("background-color",b.backColor?b.backColor:"white");var n=this;f.bind("mousedown.gcEditingInput",function(a){r.cancelDefault(a)});f.bind("mouseup.gcEditingInput",
function(f){f=n.getEditorValue(a);n.setEditorValue(a,f);n.updateEditor(a,b,e);n._triggerButtonClicked(d,d._activeRowIndex,d._activeColIndex)});f.bind("keydown.gcEditingInput",function(a){if(a.keyCode!==r.Key.space||a.ctrlKey||a.shiftKey||a.altKey)a.keyCode!==r.Key.backspace||a.ctrlKey||a.shiftKey||a.altKey||r.cancelDefault(a);else return n._isKeyDown=!0,r.cancelDefault(a),!1});f.bind("keyup.gcEditingInput",function(f){!n._isKeyDown||f.keyCode!==r.Key.space||f.ctrlKey||f.shiftKey||f.altKey||(n._isKeyDown=
!1,f=n.getEditorValue(a),n.setEditorValue(a,f),n.updateEditor(a,b,e),n._triggerButtonClicked(d,d._activeRowIndex,d._activeColIndex))});3===f.children().length&&l(f.children()[0]).bind("click",function(a){r.cancelDefault(a)});u.body.insertBefore(a,null)}};e.prototype.updateEditor=function(a,b,e){if(a&&a.sheet){l(a).width(e.width).height(e.height);var d=a.sheet;a=l(a);if(3===a.children().length){var f=l(a.children()[1]),g=f.text();b.foreColor&&f.css("color",b.foreColor);var k=null,k=b.font?b.font:d._render._getDefaultFont();
1<d._zoomFactor&&(k=d._render._getZoomFont(k));f.css("font",k);var n=d._getStringWidth(g,k),d=d._getFontHeight(k);g&&(g=g.split(/\r\n|\r|\n/),d*=g.length);g=this._getCheckBoxLeft(b,e,n,!0);k=this._getCheckBoxTop(b,e,d,!0);e=a.children()[0];l(e).css("margin-left",g).css("margin-top",k);k=g=0;this._textAlign===r.CheckBoxTextAlign.top?(g=e.offsetLeft,b.hAlign===r.HorizontalAlign.center?g=e.offsetLeft+this._checkboxSize/2-n/2:b.hAlign===r.HorizontalAlign.right&&(g=e.offsetLeft+this._checkboxSize-n),k=
e.offsetTop-d):this._textAlign===r.CheckBoxTextAlign.bottom?(g=e.offsetLeft,b.hAlign===r.HorizontalAlign.center?g=e.offsetLeft+this._checkboxSize/2-n/2:b.hAlign===r.HorizontalAlign.right&&(g=e.offsetLeft+this._checkboxSize-n),k=e.offsetTop+e.offsetHeight):(g=this._textAlign===r.CheckBoxTextAlign.left?e.offsetLeft-n-2:e.offsetLeft+e.offsetWidth+2,k=e.offsetTop+this._checkboxSize/2-d/2);l.browser.msie&&(g+=3,k+=3);f.css("left",g).css("top",k);this._isThreeState?(b=a.children()[2],a=e.offsetLeft+(e.offsetWidth-
b.offsetWidth)/2,f=e.offsetTop+(e.offsetHeight-b.offsetHeight)/2,l(b).css("left",a).css("top",f).toggle().toggle()):l(a.children()[2]).hide()}}};e.prototype.caption=function(a){if(0===arguments.length)return this._caption;this._caption=a;return this};e.prototype.textTrue=function(a){if(0===arguments.length)return this._textTrue;this._textTrue=a;return this};e.prototype.textIndeterminate=function(a){if(0===arguments.length)return this._textIndeterminate;this._textIndeterminate=a;return this};e.prototype.textFalse=
function(a){if(0===arguments.length)return this._textFalse;this._textFalse=a;return this};e.prototype._getDisplayText=function(a){return!this._isThreeState||null!==a&&void 0!==a?!0===!!a?this._textTrue||this._caption:this._textFalse||this._caption:this._textIndeterminate||this._caption};e.prototype.textAlign=function(a){if(0===arguments.length)return this._textAlign;this._textAlign=a;return this};e.prototype.isThreeState=function(a){if(0===arguments.length)return this._isThreeState;this._isThreeState=
a;return this};e.prototype.getHitInfo=function(a,b,e,d,f,g,k){return{x:a,y:b,row:e,col:d,cellRect:g,sheetArea:k,isReservedLocation:!0}};e.prototype.processMouseDown=function(a){if(!a)return!1;a.isReservedLocation&&(this._isMouseDownReservedLocation=!0)};e.prototype.processMouseUp=function(a){if(!a)return!1;var b=a.sheet;if(this._isMouseDownReservedLocation&&b&&a.isReservedLocation){this._isMouseDownReservedLocation=!1;var e=a.row,d=a.col;a=a.sheetArea;var f=b._getModel(a).getNode(e,d,!0);if(f._isFirstMouseUp)delete f._isFirstMouseUp,
f._mouseupToken&&(p.clearTimeout(f._mouseupToken),delete f._mouseupToken);else return a=b.getValue(e,d,a),a=this._getNextState(a),a=new r.UndoRedo.CellEditUndoAction(b,{row:e,col:d,newValue:a,autoFormat:!0}),b._doCommand(a),this._triggerButtonClicked(b,e,d),f._isFirstMouseUp=!0,f._mouseupToken=p.setTimeout(function(){delete f._isFirstMouseUp;f._mouseupToken&&(p.clearTimeout(f._mouseupToken),delete f._mouseupToken)},250),!0}return!1};e.prototype.processMouseLeave=function(a){if(!a)return!1;this._isMouseDownReservedLocation=
!1};e.prototype.isReservedKey=function(a){this._isSpaceKeyDown=a.keyCode===r.Key.space&&!a.ctrlKey&&!a.shiftKey&&!a.altKey;return!1};e.prototype._getAutoFitWidth=function(a,b,e,d,f){a=k.prototype._getAutoFitWidth.apply(this,[a,b,this._getDisplayText(b),d,f]);a=this._textAlign===r.CheckBoxTextAlign.top||this._textAlign===r.CheckBoxTextAlign.bottom?Math.max(a,this._checkboxSize):a+this._checkboxSize;return a+5};e.prototype._getAutoFitHeight=function(a,b,e,d){a=k.prototype._getAutoFitHeight.apply(this,
[a,b,this._getDisplayText(b),d]);a=this._textAlign===r.CheckBoxTextAlign.top||this._textAlign===r.CheckBoxTextAlign.bottom?a+this._checkboxSize:Math.max(a,this._checkboxSize);return a+5};e.prototype._cancelDefaultKeydown=function(a){a.keyCode!==r.Key.space||a.ctrlKey||a.shiftKey||a.altKey||r.cancelDefault(a)};e.prototype.toJSON=function(){return{type:r.CellTypeKind.CheckBoxCellType,caption:this.caption(),textTrue:this.textTrue(),textIndeterminate:this.textIndeterminate(),textFalse:this.textFalse(),
textAlign:this.textAlign(),isThreeState:this.isThreeState()}};e.prototype.fromJSON=function(a){a&&(a.caption&&this.caption(a.caption),a.textTrue&&this.textTrue(a.textTrue),a.textIndeterminate&&this.textIndeterminate(a.textIndeterminate),a.textFalse&&this.textFalse(a.textFalse),null!==a.textAlign&&void 0!==a.textAlign&&this.textAlign(a.textAlign),null!==a.isThreeState&&void 0!==a.isThreeState&&this.isThreeState(a.isThreeState))};r.CheckBoxCellType=e;b.prototype=new k;b.prototype.paintValue=function(a,
b,e,d,f,g,l,n){if(a){a.save();b=e+this._marginLeft;var m=d+this._marginTop,q=f-this._marginLeft-this._marginRight,s=g-this._marginTop-this._marginBottom;0<q-2&&0<s-2&&(a.strokeStyle=this._buttonBorderColor,a.strokeRect(b+0.5,m+0.5,q-1,s-1),this._buttonBackColor?a.fillStyle=this._buttonBackColor:(e=a.createLinearGradient(e+f/2,d,e+f/2,d+g),e.addColorStop(0.125,"#F6FAFB"),e.addColorStop(1,"#D2DBEB"),a.fillStyle=e),a.fillRect(b+1,m+1,q-2,s-2),k.prototype.paintValue.apply(this,[a,this._text,b,m,q,s,l,
n]));a.restore()}};b.prototype.focus=function(a){a&&a.focus()};b.prototype._formatEditorValue=function(a,b,e){return e};b.prototype.createEditorElement=function(){var a=u.createElement("div"),b=l(a);b.css("position","absolute");b.css("margin","0");b.css("padding","0");b.css("overflow","hidden");b.css("resize","none");b.css("border","2px #5292f7 solid");b.css("outline","none");b.css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)");b.css("box-sizing","content-box");b.css("user-select","none");b.attr("tabindex",
1);b.attr("gcUIElement","gcEditingInput");var e=l("<div></div>");e.css("position","absolute");e.css("overflow","hidden");e.css("border","1px "+this._buttonBorderColor+" solid");b.append(e);b=l("<span></span>");b.css("position","absolute");b.css("white-space","nowrap");b.css("font","normal 10pt Arial");b.css("cursor","default");e.append(b);return a};b.prototype.setEditorValue=function(a,b){a&&a.children[0]&&a.children[0].children[0]&&l(a.children[0].children[0]).html(this._text)};b.prototype.getEditorValue=
function(a){return a?a._oldValue:null};b.prototype._triggerButtonClicked=function(a,b,e){a.parent&&a.parent._trigger(r.Events.ButtonClicked,{sheet:a,sheetName:a._name,row:b,col:e})};b.prototype._setButtonBackgroundColor=function(a,b){a.removeClass("gradientButton");b?a.css("background-color",b):a.addClass("gradientButton")};b.prototype.activateEditor=function(a,b,e){if(a&&a.sheet){var d=a.sheet,f=l(a),g=d._eventHandler._getCanvasOffset(),k=g.left+d._bounds.x+e.x-2;f.css("top",g.top+d._bounds.y+e.y-
2);f.css("left",k);f.css("background-color",b.backColor?b.backColor:"white");var n=this,m=a.children[0];if(m){var q=l(m);f.bind("keydown.gcEditingInput",function(a){if(a.keyCode!==r.Key.space||a.ctrlKey||a.shiftKey||a.altKey)a.keyCode!==r.Key.backspace||a.ctrlKey||a.shiftKey||a.altKey||r.cancelDefault(a);else return n._isKeyDown||n._setButtonBackgroundColor(q,"#34B4E3"),n._isKeyDown=!0,r.cancelDefault(a),!1});f.bind("keyup.gcEditingInput",function(a){!n._isKeyDown||a.keyCode!==r.Key.space||a.ctrlKey||
a.shiftKey||a.altKey||(n._isKeyDown=!1,n._setButtonBackgroundColor(q,n._buttonBackColor),n._triggerButtonClicked(d,d._activeRowIndex,d._activeColIndex))});q.bind("mousedown.gcEditingInput",function(a){2!==a.button&&(n._isMouseDown=!0,n._setButtonBackgroundColor(q,"#34B4E3"))});q.bind("mouseup.gcEditingInput",function(a){2!==a.button&&(n._isMouseDown=!1,n._setButtonBackgroundColor(q,"#A6F4FF"))});q.bind("click.gcEditingInput",function(a){n._triggerButtonClicked(d,d._activeRowIndex,d._activeColIndex)});
q.bind("mousemove.gcEditingInput",function(a){n._isMouseDown?n._setButtonBackgroundColor(q,"#34B4E3"):n._setButtonBackgroundColor(q,"#A6F4FF")});q.bind("mouseout.gcEditingInput",function(a){a=a.relatedTarget;a!==m&&a!==m.children[0]&&n._setButtonBackgroundColor(q,n._buttonBackColor)})}u.body.insertBefore(a,null)}};b.prototype.updateEditor=function(a,b,e){if(a&&a.sheet){var d=a.sheet;l(a).width(e.width).height(e.height);if(a.children[0]){var f=l(a.children[0]);f.width(e.width-this._marginLeft-this._marginRight).height(e.height-
this._marginTop-this._marginBottom).css("margin-top",this._marginTop-1).css("margin-left",this._marginLeft-1);this._setButtonBackgroundColor(f,this._buttonBackColor);if(a.children[0].children[0]){a=l(a.children[0].children[0]);b.foreColor&&a.css("color",b.foreColor);var g=null,g=b.font?b.font:d._render._getDefaultFont();1<d._zoomFactor&&(g=d._render._getZoomFont(g));a.css("font",g);e=d._getStringWidth(this._text,g);d=d._getFontHeight(g);this._text&&(g=this._text.split(/\r\n|\r|\n/),d*=g.length);g=
0;b.vAlign===r.VerticalAlign.center?g=f.height()/2-d/2:b.vAlign===r.VerticalAlign.bottom&&(g=f.height()-d);d=0;b.hAlign===r.HorizontalAlign.center?d=f.width()/2-e/2:b.hAlign===r.HorizontalAlign.right&&(d=f.width()-e);a.css("top",g).css("left",d)}}}};b.prototype.marginTop=function(a){if(0===arguments.length)return this._marginTop;this._marginTop=a;return this};b.prototype.marginRight=function(a){if(0===arguments.length)return this._marginRight;this._marginRight=a;return this};b.prototype.marginBottom=
function(a){if(0===arguments.length)return this._marginBottom;this._marginBottom=a;return this};b.prototype.marginLeft=function(a){if(0===arguments.length)return this._marginLeft;this._marginLeft=a;return this};b.prototype.text=function(a){if(0===arguments.length)return this._text;this._text=a;return this};b.prototype.buttonBackColor=function(a){if(0===arguments.length)return this._buttonBackColor;this._buttonBackColor=a;return this};b.prototype.getHitInfo=function(a,b,e,d,f,g,k){if(g){f=g.x+g.width-
this._marginRight;var l=g.y+this._marginTop,n=g.y+g.height-this._marginBottom;e={x:a,y:b,row:e,col:d,cellRect:g,sheetArea:k};g.x+this._marginLeft<=a&&a<=f&&l<=b&&b<=n&&(e.isReservedLocation=!0);return e}return null};b.prototype.processMouseDown=function(a){if(!a)return!1;var b=a.sheet;return b&&a.isReservedLocation?(this._originButtonBackColor=this._buttonBackColor,this._isMouseDownReservedLocation=!0,this._buttonBackColor="#34B4E3",b.repaint(a.cellRect),!0):!1};b.prototype.processMouseUp=function(a){if(!a)return!1;
var b=a.sheet;if(this._isMouseDownReservedLocation&&b&&a.isReservedLocation){this._buttonBackColor=this._originButtonBackColor;b.repaint(a.cellRect);this._isMouseDownReservedLocation=!1;var e=a.row,d=a.col,f=b._getModel(a.sheetArea).getNode(e,d,!0);if(f._isFirstMouseUp)delete f._isFirstMouseUp,f._mouseupToken&&(p.clearTimeout(f._mouseupToken),delete f._mouseupToken);else return this._triggerButtonClicked(b,e,d),f._isFirstMouseUp=!0,f._mouseupToken=p.setTimeout(function(){delete f._isFirstMouseUp;
f._mouseupToken&&(p.clearTimeout(f._mouseupToken),delete f._mouseupToken)},250),!0}return!1};b.prototype.processMouseLeave=function(a){if(!a)return!1;var b=a.sheet;b&&this._isMouseDownReservedLocation&&(this._buttonBackColor=this._originButtonBackColor,b.repaint(a.cellRect),this._isMouseDownReservedLocation=!1)};b.prototype._getAutoFitWidth=function(a,b,e,d,f){return k.prototype._getAutoFitWidth.apply(this,[a,b,this._text,d,f])+this._marginLeft+this._marginRight};b.prototype._getAutoFitHeight=function(a,
b,e,d){return k.prototype._getAutoFitHeight.apply(this,[a,b,this._text,d])+this._marginTop+this._marginBottom};b.prototype._cancelDefaultKeydown=function(a){a.keyCode!==r.Key.space||a.ctrlKey||a.shiftKey||a.altKey||r.cancelDefault(a)};b.prototype.toJSON=function(){return{type:r.CellTypeKind.ButtonCellType,marginTop:this.marginTop(),marginRight:this.marginRight(),marginBottom:this.marginBottom(),marginLeft:this.marginLeft(),text:this.text(),buttonBackColor:this.buttonBackColor()}};b.prototype.fromJSON=
function(a){a&&(null!==a.marginTop&&void 0!==a.marginTop&&this.marginTop(a.marginTop),null!==a.marginRight&&void 0!==a.marginRight&&this.marginRight(a.marginRight),null!==a.marginBottom&&void 0!==a.marginBottom&&this.marginBottom(a.marginBottom),null!==a.marginLeft&&void 0!==a.marginLeft&&this.marginLeft(a.marginLeft),a.text&&this.text(a.text),a.buttonBackColor&&this.buttonBackColor(a.buttonBackColor))};r.ButtonCellType=b;f.prototype=new k;f.prototype._basePaintValue=k.prototype.paintValue;f.prototype._baseFormat=
k.prototype.format;f.prototype._baseParse=k.prototype.parse;f.prototype._baseDeactivateEditor=k.prototype.deactivateEditor;f.prototype.getHitInfo=function(a,b,e,d,f,g,k){if(this._hasInPlaceEditor)return null;if(g){var l=g.x+g.width;b={x:a,y:b,row:e,col:d,cellStyle:f,cellRect:g,sheetArea:k};l-17<=a&&a<l&&(b.isReservedLocation=!0);return b}return null};f.prototype.processMouseDown=function(a){a&&a.sheet&&!this._hasInPlaceEditor&&a.isReservedLocation&&this._expandItems(a)};f.prototype.isReservedKey=
function(a){return this._hasInPlaceEditor?a.ctrlKey||a.shiftKey||a.altKey||a.which!==r.Key.enter&&a.which!==r.Key.esc&&a.which!==r.Key.tab&&a.which!==r.Key.left&&a.which!==r.Key.right?!0:!1:!1};f.prototype._expandItems=function(a,b){if(a&&a.sheet){"undefined"===typeof b&&(b=20);var e=a.sheet,d=a.row,f=a.col,g=a.cellRect,k=a.sheetArea,n=a.cellStyle,m=this.createEditorElement(),q=l(m),s=e._eventHandler._getCanvasOffset(),t=s.left+e._bounds.x+g.x-1;q.css("top",s.top+e._bounds.y+g.y+g.height);q.css("left",
t);q.css("box-sizing","content-box");q.css("width",g.width-2);q.css("outline","none");n.backColor&&q.css("background-color",n.backColor);n.foreColor&&q.css("color",n.foreColor);n=n&&n.font?n.font:e._render._getDefaultFont();1<e._zoomFactor&&(n=e._render._getZoomFont(n));q.css("font",n);var p=this;p._renderItems(m,p._items);m.length>b?q.prop("size",b):q.prop("size",Math.max(2,m.length));p.setEditorValue(m,e.getValue(d,f,k));var K=function(a){q.unbind("blur");q.unbind("click");q.unbind("keydown");u.body.removeChild(m);
p._hasInPlaceEditor=!1;a?e.repaint(g):(a=p.getEditorValue(m),a=new r.UndoRedo.CellEditUndoAction(e,{row:d,col:f,newValue:a,autoFormat:!1}),e._doCommand(a))};q.bind("keydown",function(a){a.ctrlKey||a.shiftKey||a.altKey||(a.which===r.Key.esc?K(!0):a.which===r.Key.enter?K():a.which===r.Key.left?(a.preventDefault(),K(),r.SpreadActions.navigationLeft.apply(e)):a.which===r.Key.right&&(a.preventDefault(),K(),r.SpreadActions.navigationRight.apply(e)))});q.bind("click",function(a){"SELECT"!==a.target.tagName&&
"OPTION"!==a.target.tagName||K()});q.bind("blur",function(){K()});u.body.insertBefore(m,null);q.focus();p._hasInPlaceEditor=!0;e.repaint(g)}};f.prototype.paintValue=function(a,b,e,d,f,g,k,l){var n=Math.max(0,f-17-1);this._basePaintValue(a,b,e,d,n,g,k,l);a.save();this._hasInPlaceEditor&&l.sheet.getActiveRowIndex()===l.row&&l.sheet.getActiveColumnIndex()===l.col?(a.beginPath(),a.rect(e+f-17-0.5,d+1.5+0.05,16,g-3+0.05),a.fillStyle="#DDEDFC",a.fill(),a.lineWidth=1,a.strokeStyle="#7EB4EA",a.stroke(),a.beginPath(),
a.lineWidth=2,a.strokeStyle="black",a.moveTo(e+f-17+5,d+1+(g-2)/2-1.5),a.lineTo(e+f-17+8.5,d+1+(g-2)/2+2),a.lineTo(e+f-17+12,d+1+(g-2)/2-1.5),a.stroke()):(a.beginPath(),a.lineWidth=2,a.fillStyle="#B2B2B2",a.moveTo(e+f-17+5,d+1+(g-2)/2-2),a.lineTo(e+f-17+8.5,d+1+(g-2)/2+2),a.lineTo(e+f-17+12,d+1+(g-2)/2-2),a.fill());a.restore()};f.prototype._getHAlignByValueType=function(a,b,e){b={};try{(new r.GeneralFormatter).GetPreferredDisplayFormatter(e,b)}catch(d){}return r._SheetRender.getHAlignByValueType(a,
null!==b.value?b.value:e)};f.prototype.createEditorElement=function(){var a=u.createElement("select"),b=l(a);b.css("position","absolute");b.css("margin","0");b.attr("gcUIElement","gcEditor");return a};f.prototype.setEditorValue=function(a,b){if(a&&this._items)if(this._editorValueType===r.EditorValueType.Text){for(var e=void 0!==b&&null!==b?b.toString().toLowerCase():null,d=-1,f=this._items.length,g=0;g<f;g++){var k=this._items[g],k=k&&k.hasOwnProperty("text")?k.text:k,k=void 0!==k&&null!==k?k.toString().toLowerCase():
null;if(k===e){d=g;break}}a.selectedIndex=d}else if(this._editorValueType===r.EditorValueType.Index)d=parseInt(b,10),isNaN(d)?a.selectedIndex=-1:a.selectedIndex=d;else if(this._editorValueType===r.EditorValueType.Value){d=-1;f=this._items.length;for(g=0;g<f;g++)if((k=this._items[g])&&k.hasOwnProperty("value")&&k.value===b){d=g;break}a.selectedIndex=d}};f.prototype.getEditorValue=function(a){if(!a||!this._items)return null;var b=a.sheet;b&&b.isEditing()&&b._eventHandler._setFocus();a=a.selectedIndex;
if(0<=a){if(this._editorValueType===r.EditorValueType.Text)return(a=this._items[a])&&a.hasOwnProperty("text")?a.text:a;if(this._editorValueType===r.EditorValueType.Index)return a;if(this._editorValueType===r.EditorValueType.Value&&(a=this._items[a])&&a.hasOwnProperty("value"))return a.value}return null};f.prototype.activateEditor=function(a,b,e){if(a&&a.sheet){var d=a.sheet;b=l(a);var f=d._eventHandler._getCanvasOffset(),g=f.left+d._bounds.x+e.x-1;b.css("top",f.top+d._bounds.y+e.y-1);b.css("left",
g);b.css("box-sizing","content-box");b.css("border","1px solid black");b.css("outline","none");this._renderItems(a,this._items);b.bind("keydown",function(a){a.keyCode!==r.Key.backspace||a.ctrlKey||a.shiftKey||a.altKey||r.cancelDefault(a);a.ctrlKey||a.shiftKey||a.altKey||!d.isEditing()||d.editorStatus()!==r.EditorStatus.Enter||(a.which===r.Key.left?(a.preventDefault(),d.endEdit(),r.SpreadActions.navigationLeft.apply(d)):a.which===r.Key.right&&(a.preventDefault(),d.endEdit(),r.SpreadActions.navigationRight.apply(d)))});
u.body.insertBefore(a,null);b.focus();this._hasInPlaceEditor=!0}};f.prototype.deactivateEditor=function(a){a&&l(a).unbind("keydown");this._hasInPlaceEditor=!1;this._baseDeactivateEditor(a);a&&a.sheet&&a.sheet.repaint()};f.prototype.updateEditor=function(a,b,e){if(a&&a.sheet){var d=a.sheet;a=l(a);b&&(b.backColor&&a.css("background-color",b.backColor),b.foreColor&&a.css("color",b.foreColor),b=b.font?b.font:d._render._getDefaultFont(),1<d._zoomFactor&&(b=d._render._getZoomFont(b)),a.css("font",b));e&&
(a.css("width",e.width-1),a.css("height",e.height-1))}};f.prototype._formatEditorValue=function(a,b,e){return e};f.prototype.format=function(a,b,e){if(this._editorValueType!==r.EditorValueType.Text)if(this._editorValueType===r.EditorValueType.Index){var d=this._items?this._items.length:0,f=parseInt(a);0<=f&&f<d&&(f=this._items[f],void 0!==f&&null!==f&&(a=f.hasOwnProperty("text")?f.text:f))}else if(this._editorValueType===r.EditorValueType.Value)for(var d=this._items?this._items.length:0,g=0;g<d;g++)if((f=
this._items[g])&&f.hasOwnProperty("value")&&f.value===a){a=f.hasOwnProperty("text")?f.text:f;break}return this._baseFormat(a,b,e)};f.prototype.parse=function(a,b){a=this._baseParse(a,b);if(this._editorValueType!==r.EditorValueType.Text)if(this._editorValueType===r.EditorValueType.Index)for(var e=this._items?this._items.length:0,d=0;d<e;d++){var f=this._items[d];if(f&&f.hasOwnProperty("text")&&f.text===a||f===a)return d}else if(this._editorValueType===r.EditorValueType.Value)for(e=this._items?this._items.length:
0,d=0;d<e;d++)if((f=this._items[d])&&f.hasOwnProperty("text")&&f.text===a||f===a)return f.value;return a};f.prototype.editorValueType=function(a){if(0===arguments.length)return this._editorValueType;this._editorValueType=a;return this};f.prototype.items=function(a){if(0===arguments.length)return this._items;this._items=a;return this};f.prototype._renderItems=function(a,b){if(b&&a)for(var e=b.length,d=0;d<e;d++){var f=new p.Option,g=b[d];void 0!==g&&null!==g&&(g.hasOwnProperty("text")?f.text=g.text:
f.text=g);a.add(f)}};f.prototype._getAutoFitWidth=function(a,b,e,d,f){return k.prototype._getAutoFitWidth.apply(this,arguments)+17};f.prototype._getAutoFitHeight=function(a,b,e,d){return k.prototype._getAutoFitHeight.apply(this,arguments)};f.prototype.toJSON=function(){return{type:r.CellTypeKind.ComboBoxCellType,editorValueType:this.editorValueType(),items:this.items()}};f.prototype.fromJSON=function(a){a&&(null!==a.editorValueType&&void 0!==a.editorValueType&&this.editorValueType(a.editorValueType),
null!==a.items&&void 0!==a.items&&this.items(a.items))};r.ComboBoxCellType=f;s.prototype=new k;s.prototype._baseDeactivateEditor=k.prototype.deactivateEditor;s.prototype.paintValue=function(a,b,e,d,f,g,k,n){if(!this._actived&&a){var m=this._text||b;if(m){var m=m.toString(),m=m.replace(/\s+/g," "),q=!1,s=n.sheet._getModel().getNode(n.row,n.col);s&&s.hyperlinkInfo&&(this._id===s.hyperlinkInfo.id?q=s.hyperlinkInfo.visited:delete s.hyperlinkInfo);a.save();if(n.cellOverflowLayout){if(n=n.cellOverflowLayout.layout)a.rect(n.x,
n.y,n.width,n.height),a.clip(),a.beginPath()}else a.rect(e,d,f,g),a.clip(),a.beginPath();a.fillStyle=q?this._visitedLinkColor:this._linkColor;k.font&&(a.font=k.font);n=this._getLinkRect(m,k.hAlign,k.vAlign,k.font,new r.Rect(e,d,f,g));s=2;a.textAlign="left";k.hAlign===r.HorizontalAlign.center?n.width<f-3&&(s=f/2,a.textAlign="center"):k.hAlign===r.HorizontalAlign.right&&n.width<f-3&&(s=f-2,a.textAlign="right");f=l.browser.mozilla?5:2;a.textBaseline="top";k.vAlign===r.VerticalAlign.center?n.height<g&&
(f=l.browser.mozilla?g/2+1:l.browser.msie?g/2+0.5:g/2,parseInt(f,10)!==f&&(f+=0.5),a.textBaseline="middle"):k.vAlign===r.VerticalAlign.bottom&&(f=g-2.5,a.textBaseline="bottom");a.fillText(m,e+s,d+f);b&&(b=e+n.x,e=e+n.x+n.width,k.hAlign!==r.HorizontalAlign.right&&(b+=1,e+=1),d=d+n.y+n.height,k.vAlign===r.VerticalAlign.bottom&&(d-=0.5),d-=Math.max(0,Math.round(n.height/9)-1),parseInt(d,10)===d&&(d+=0.5),k=d,a.beginPath(),a.strokeStyle=q?this._visitedLinkColor:this._linkColor,a.lineWidth=1,a.moveTo(b,
d),a.lineTo(e,k),a.stroke());a.restore()}}};s.prototype.createEditorElement=function(){var a=u.createElement("div"),b=l(a);b.css("margin","0");b.css("padding","0");b.css("border","none");b.css("position","absolute");b.css("overflow","hidden");b.css("box-sizing","content-box");b.css("white-space","nowrap");b.attr("gcUIElement","gcEditor");var e=u.createElement("a"),e=l(e);e.css("margin","0");e.attr("target","_blank");e.css("outline","none");e.css("display","block");e.appendTo(b);return a};s.prototype._triggerButtonClicked=
function(a,b,e){a.parent&&(a._startEditByKeydown||a.parent._trigger(r.Events.ButtonClicked,{sheet:a,sheetName:a._name,row:b,col:e}))};s.prototype.activateEditor=function(a,b,e){if(a&&e){var d=a.sheet;b=l(a);if(d){var f=d._eventHandler._getCanvasOffset(),g=f.left+d._bounds.x+e.x;b.css("top",f.top+d._bounds.y+e.y).css("left",g)}b.bind("keydown",function(a){a.keyCode!==r.Key.backspace||a.ctrlKey||a.shiftKey||a.altKey||r.cancelDefault(a)});if(e=b.children()[0]){var k=this,n=l(e);n.bind("click",function(){n.css("color",
k._visitedLinkColor);if(d){var a=d._activeRowIndex,b=d._activeColIndex;d._getModel().getNode(a,b,!0).hyperlinkInfo={id:k._id,visited:!0};k._triggerButtonClicked(d,a,b)}})}e=u.createElement("div");b=l(e);b.css("margin","0");b.css("position","absolute");b.css("overflow","hidden");b.css("box-sizing","content-box");b.attr("gcUIElement","gcEditingInput");b.css("border-width","1px");b.css("border-style","solid");b.css("background-color","transparent");u.body.insertBefore(e,null);this._clip=e;u.body.insertBefore(a,
null);this._actived=!0}};s.prototype.deactivateEditor=function(a){this._clip&&u.body.removeChild(this._clip);if(a){l(a).unbind("keydown");var b=l(a).children()[0];b&&l(b).unbind("click")}this._baseDeactivateEditor(a);this._actived=!1;a&&a.sheet&&a.sheet.repaint()};s.prototype.focus=function(a){a&&a.focus()};s.prototype.updateEditor=function(a,b,e){if(a&&e){var d=a.sheet;a=l(a);var f=a.children()[0];if(f){f=l(f);this._link&&f.attr("href",this._link);var g=this._text||this._link;g&&f.text(g);f.attr("title",
this._linkToolTip);var g=!1,k=d?d._getModel().getNode(d._activeRowIndex,d._activeColIndex):null;k&&k.hyperlinkInfo&&(this._id===k.hyperlinkInfo.id?g=k.hyperlinkInfo.visited:delete k.hyperlinkInfo);g?f.css("color",this._visitedLinkColor):f.css("color",this._linkColor);g=b&&b.font?b.font:null;!g&&d&&(g=d._render._getDefaultFont());d&&1<d._zoomFactor&&(g=d._render._getZoomFont(g));g&&f.css("font",g)}b&&d&&(a.css("max-width",e.width-2),a.css("max-height",e.height-2),g=d._eventHandler._getCanvasOffset(),
f=g.top+d._bounds.y+e.y,d=g.left+d._bounds.x+e.x,g=this._calcPosition(e,a.width(),a.height(),b.hAlign,b.vAlign),a.css("top",f+g.y).css("left",d+g.x),this._clip&&(a=l(this._clip),a.css("top",f).css("left",d),a.height(e.height-3).width(e.width-3),b.backColor?a.css("border-color",b.backColor):a.css("border-color",r._SheetRender.prototype._getDefaultBackground())))}};s.prototype.getEditorValue=function(a){return this._link};s.prototype.setEditorValue=function(a,b){this._link=b};s.prototype._formatEditorValue=
function(a,b,e){return e};s.prototype.getHitInfo=function(a,b,e,d,f,g,k){return f&&g?{x:a,y:b,row:e,col:d,cellStyle:f,cellRect:g,sheetArea:k}:null};s.prototype.processMouseDown=function(a){if(a){var b=a.sheet;b&&!b.isEditing()&&(this._isHitHyperlink(a,b)?a.isReservedLocation=!0:a.isReservedLocation=!1,a.isReservedLocation&&(this._isMouseDownLink=!0))}};s.prototype.processMouseUp=function(a){if(a){var b=a.sheet;if(b&&!b.isEditing()){this._isHitHyperlink(a,b)?a.isReservedLocation=!0:a.isReservedLocation=
!1;if(a.isReservedLocation&&this._isMouseDownLink){var e=b.getValue(a.row,a.col,a.sheetArea);e&&p.open(e);b._getModel(a.sheetArea).getNode(a.row,a.col,!0).hyperlinkInfo={id:this._id,visited:!0};b.repaint(a.cellRect);this._triggerButtonClicked(b,a.row,a.col)}this._isMouseDownLink=!1}}};s.prototype.processMouseMove=function(a){if(a){var b=a.sheet;if(b&&(!b.isEditing()||b.getActiveRowIndex()!==a.row||b.getActiveColumnIndex()!==a.col))if(this._isHitHyperlink(a,b)?a.isReservedLocation=!0:a.isReservedLocation=
!1,a.isReservedLocation){this._showLinkToolTip(b,a);var e=b._getCanvas();e&&(b.getValue(a.row,a.col,a.sheetArea)?e.style.cursor="pointer":e.style.cursor="text")}else if(this._hideLinkToolTip(),e=b._getCanvas())e.style.cursor="default"}};s.prototype.processMouseLeave=function(a){this._isMouseDownLink=!1;this._hideLinkToolTip();if(a=a.sheet)if(a=a._getCanvas())a.style.cursor="default"};s.prototype._isHitHyperlink=function(a,b){var e=a.cellStyle,d=a.cellRect,f=a.x,g=a.y,k=this._text||this._link;k||(k=
b.getValue(a.row,a.col,a.sheetArea));var l=e&&e.font?e.font:b._render._getDefaultFont();1<b._zoomFactor&&(l=b._render._getZoomFont(l));var n=this._getLinkRect(k,e.hAlign,e.vAlign,l,d),e=d.x+n.x,k=Math.min(d.x+n.x+n.width,d.x+d.width),l=d.y+n.y,d=Math.min(d.y+n.y+n.height,d.y+d.height);return e<=f&&f<k&&l<=g&&g<d?!0:!1};s.prototype._showLinkToolTip=function(a,b){if(this._linkToolTip){var e=this._getLinkToolTipElement(),d=l(e);d.text(this._linkToolTip);var f=a._eventHandler._getCanvasOffset(),g=f.left+
b.x,f=f.top+b.y+20;0===d.parent().length&&(u.body.insertBefore(e,null),d.css("top",f).css("left",g))}};s.prototype._hideLinkToolTip=function(){this._linkToolTipElement&&(u.body.removeChild(this._linkToolTipElement),this._linkToolTipElement=null)};s.prototype._getLinkToolTipElement=function(){if(!this._linkToolTipElement){var a=u.createElement("div"),b=l(a);a.className="gcHyperLinkCellTypeToolTip";b.css("position","absolute");b.css("margin","0");b.css("padding",2);b.css("border","1px #C0C0C0 solid");
b.css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)");b.css("box-sizing","content-box");b.css("background-color","#FFFFFF");b.css("font","9pt Arial");this._linkToolTipElement=a}return this._linkToolTipElement};s.prototype._getLinkRect=function(a,b,e,d,f){var g=s._getEditorElement(),g=l(g),k=g.children()[0];k&&(k=l(k),k.text(a?a:""),d&&k.css("font",d));a=g.width();g=g.height();d={x:0,y:0,width:a,height:g};f&&(b=this._calcPosition(f,a,g,b,e),d.x=b.x,d.y=b.y);return d};s.prototype._calcPosition=function(a,
b,e,d,f){var g=1,k=1,l=a.width-3;a=a.height-3;d===r.HorizontalAlign.center?g+=Math.max(0,(l-b)/2):d===r.HorizontalAlign.right&&(g+=Math.max(0,l-b));f===r.VerticalAlign.center?k+=Math.max(0,(a-e)/2):f===r.VerticalAlign.bottom&&(k+=Math.max(0,a-e));return{x:g,y:k}};s.prototype.linkColor=function(a){if(0===arguments.length)return this._linkColor;this._linkColor=a;return this};s.prototype.visitedLinkColor=function(a){if(0===arguments.length)return this._visitedLinkColor;this._visitedLinkColor=a;return this};
s.prototype.text=function(a){if(0===arguments.length)return this._text;this._text=a;return this};s.prototype.linkToolTip=function(a){if(0===arguments.length)return this._linkToolTip;this._linkToolTip=a;return this};s.prototype._getAutoFitWidth=function(a,b,e,d,f){e=this._text||b;b=d&&d.font?d.font:a._render._getDefaultFont();1<a._zoomFactor&&(b=a._render._getZoomFont(b));return this._getLinkRect(e,d.hAlign,d.vAlign,b).width};s.prototype._getAutoFitHeight=function(a,b,e,d){e=this._text||b;b=d&&d.font?
d.font:a._render._getDefaultFont();1<a._zoomFactor&&(b=a._render._getZoomFont(b));return this._getLinkRect(e,d.hAlign,d.vAlign,b).height};s.prototype.toJSON=function(){return{type:r.CellTypeKind.HyperLinkCellType,linkColor:this._linkColor,visitedLinkColor:this._visitedLinkColor,text:this._text,linkToolTip:this._linkToolTip}};s.prototype.fromJSON=function(a){a&&(void 0!==a.linkColor&&null!==a.linkColor&&(this._linkColor=a.linkColor),void 0!==a.visitedLinkColor&&null!==a.visitedLinkColor&&(this._visitedLinkColor=
a.visitedLinkColor),void 0!==a.text&&null!==a.text&&(this._text=a.text),void 0!==a.linkToolTip&&null!==a.linkToolTip&&(this._linkToolTip=a.linkToolTip))};s._getUniqueId=function(){if(void 0===this._id||null===this._id)this._id=0;return"id_"+this._id++};s._getEditorElement=function(){if(!this._editorElement){var a=s.prototype.createEditorElement();u.body.insertBefore(a,null);a.style.visibility="hidden";a.style.top="-10000px";a.style.left="-10000px";a.className="gcHyperLinkCellTypeEditor";this._editorElement=
a}return this._editorElement};r.HyperLinkCellType=s;q.prototype=new m;q.prototype.paintValue=k.prototype.paintValue;q.prototype._getHAlignByValueType=k.prototype._getHAlignByValueType;q.prototype.paint=function(a,b,e,d,f,g,l,n){k.prototype.paint.apply(this,arguments)};q.prototype.createEditorElement=function(){};q.prototype.getEditorValue=function(a){};q.prototype.setEditorValue=function(a,b){};q.prototype.activateEditor=function(a,b,e){if(a&&a.sheet){b=l(a);var d=a.sheet,f=d._eventHandler._getCanvasOffset(),
g=f.left+d._bounds.x+e.x-2;b.css("top",f.top+d._bounds.y+e.y-2);b.css("left",g);u.body.insertBefore(a,null)}};q.prototype.deactivateEditor=function(a){a&&(a._editingLocator&&u.body.removeChild(a._editingLocator),u.body.removeChild(a))};q.prototype.updateEditor=function(a,b,e){a&&l(a).width(e.width).height(e.height)};q.prototype.getHitInfo=function(a,b,e,d,f,g,k){};q.prototype.processMouseDown=function(a){};q.prototype.processMouseMove=function(a){};q.prototype.processMouseUp=function(a){};q.prototype.processMouseEnter=
function(a){};q.prototype.processMouseLeave=function(a){};q.prototype.isReservedKey=function(a){};q.prototype.isEditingValueChanged=function(a,b){return a!==b};q.prototype._getAutoFitWidth=function(a,b,e,d,f){b=this.getAutoFitWidth(b,e,d,a._zoomFactor);f&&(a=parseInt(a.defaults.rowHeight*(1<a._zoomFactor?1:a._zoomFactor),10),b+=a);return b};q.prototype._getAutoFitHeight=function(a,b,e,d){return this.getAutoFitHeight(b,e,d,a._zoomFactor)};q.prototype.getAutoFitWidth=function(a,b,e,d){return 0};q.prototype.getAutoFitHeight=
function(a,b,e,d){return 0};r.CustomCellType=q})(window,jQuery);
(function(p,l,m){function k(a,b){this._error=a;this._code=b}function g(){}function a(a,b){this._value=a;this._rowCount=a.length;if(2>arguments.length)for(var e=b=0;e<a.length;e++)b=Math.max(a[e].length,b);this._columnCount=b}function d(a,b,e,d,f){this._array=a;this._row=b;this._column=e;this._rowCount=d;this._columnCount=f}function e(a){this._value=a}function b(a){this._value=a}function f(a){this.values=a}function s(){}function q(a){if(!a||0===a.length)throw Va;for(var b=null,e=0;e<a.length;e++){var d=
a[e];if(b){if(d.getRangeCount()!==b.getRangeCount())throw Va;for(var f=0;f<d.getRangeCount();f++)if(d.getColumn(f)!==b.getColumn(f)||d.getColumnCount(f)!==b.getColumnCount(f)||d.getRow(f)!==b.getRow(f)||d.getRowCount(f)!==b.getRowCount(f))throw Va;}else b=d}this._references=a.slice(0)}function t(a,b){this._source=a;this._ranges=b}function r(a){this._sheet=a}function u(a){this._values=a}function n(a,b,e,d,f,h,g,k){ea._ConcreteReference.call(a,new Ea.Range(b,e,d,f));this.Action=h;this.Operand1=g;this.Operand2=
k}function h(a,b,e,d,f,h){ea._ConcreteReference.call(a,b,e,d,f);this.Action=h}function I(a,b,e,d,f,h,g,k){ea._ConcreteReference.call(a,new Ea.Range(b,e,d,f));this.Action=h;this.Operand1=g;this.SwithOrder=k}function E(a,b,e,d,f){if(e===m||null===e)e=0;return!f&&b instanceof g?a.call(b):b instanceof s?a.call(b,e):d}function O(a){a=a.charCodeAt(0);return 255>=a?48<=a&&57>=a:!1}function H(a){a=a.charCodeAt(0);if(!(255>=a))return!1;if(!(127>=a))return Fa[a]===Ga.UppercaseLetter||Fa[a]===Ga.LowercaseLetter;
a|=32;return 96<=a&&122>=a}function C(a){a=a.charCodeAt(0);if(!(255>=a))return!1;if(!(127>=a))return Fa[a]===Ga.UppercaseLetter||Fa[a]===Ga.LowercaseLetter;if(57>=a)return 48<=a;a|=32;return 96<=a&&122>=a}function G(a){a=a.charCodeAt(0);return 255>=a?Fa[a]===Ga.MathSymbol||Fa[a]===Ga.CurrencySymbol||Fa[a]===Ga.ModifierSymbol||Fa[a]===Ga.OtherSymbol:!1}function z(a){a=a.charCodeAt(0);return 255>=a?127>=a?48<=a&&57>=a:Fa[a]===Ga.DecimalDigitNumber||Fa[a]===Ga.OtherNumber:!1}function S(a,b,e){for(var d=
a.length,f=ua.None;b<d;b++){var h=a.charAt(b);if(O(h))if(f===ua.None)f=ua.Int;else if(f===ua.Dot)f=ua.Decimal;else if(f===ua.Sign)f=ua.Int;else{if(f===ua.Exponent||f===ua.SignExponent)f=ua.ScientificNotation}else if(h===e)if(f===ua.Int)f=ua.Decimal;else if(f===ua.None||f===ua.Sign)f=ua.Dot;else return{result:!1};else if("+"===h||"-"===h)if(f===ua.None)f=ua.Sign;else if(f===ua.Exponent)f=ua.SignExponent;else return{result:!0,endIndex:b-1};else if("E"===h||"e"===h)if(f===ua.Int||f===ua.Decimal)f=ua.Exponent;
else return{result:!1};else if(f===ua.Int||f===ua.Decimal||f===ua.ScientificNotation)return{result:!0,endIndex:b-1}}return f===ua.Int||f===ua.Decimal||f===ua.ScientificNotation?{result:!0,endIndex:d-1}:{result:!1}}function Q(a){this._init(a)}function aa(a,b){var e={row:this.row,column:this.column,rowCount:1,columnCount:1};this.rowRelative&&(e.row+=a);this.columnRelative&&(e.column+=b);return e}function ka(a,b){var e={},d,f,h,g;this.isFullRow&&this.isFullColumn?(e.row=-1,e.column=-1,e.rowCount=-1,
e.columnCount=-1):this.isFullRow?(e.column=-1,e.columnCount=-1,d=this.startRowRelative?this.startRow+a:this.startRow,f=this.endRowRelative?this.endRow+a:this.endRow,e.row=Math.min(d,f),e.rowCount=Math.abs(d-f)+1):(this.isFullColumn?(e.row=-1,e.rowCount=-1,h=this.startColumnRelative?this.startColumn+b:this.startColumn,g=this.endColumnRelative?this.endColumn+b:this.endColumn):(d=this.startRowRelative?this.startRow+a:this.startRow,f=this.endRowRelative?this.endRow+a:this.endRow,h=this.startColumnRelative?
this.startColumn+b:this.startColumn,g=this.endColumnRelative?this.endColumn+b:this.endColumn,e.row=Math.min(d,f),e.rowCount=Math.abs(d-f)+1),e.column=Math.min(h,g),e.columnCount=Math.abs(h-g)+1);return e}function J(){}function K(a){this.argument=a}function A(a,b){this.fn=a;this.args=b}function L(a){this.name=a}function D(a){this.name=a}function w(a,b){this.source=a;this.name=b}function M(a){this.value=a}function T(a){this.value=a}function P(a,b){this.value=a;this.originalValue=b}function ia(a){this.value=
a}function v(a){this.value=a}function V(a,b){this.source=a;this.value=b}function N(a,b,e){this.startSource=a;this.endSource=b;this.value=e}function R(a){this.value=a}function ga(b){this.value=new a(b)}function ba(){this.value=ea.missingArgument}function W(){}function ja(a,b){this.operator=a;this.operand=b}function fa(a,b,e){this.operator=a;this.left=b;this.right=e}function la(){}function ra(a){this.source=a}function da(a,b,e,d){this.row=a;this.column=b;this.rowRelative=e;this.columnRelative=d}function oa(a,
b,e,d){this.row=a;this.column=b;this.rowRelative=e;this.columnRelative=d}function ha(a,b,e,d,f){this.source=a;this.row=b;this.column=e;this.rowRelative=d;this.columnRelative=f}function X(a,b,e,d,f,h,g,k){0===arguments.length?this._initDefault():this.init(a,b,e,d,f,h,g,k)}function na(a,b,e,d,f,h,g,k){0===arguments.length?this._initDefault():this.init(a,b,e,d,f,h,g,k)}function ca(a,b,e,d,f,h,g,k,l){1===arguments.length?this._initDefault(a):this.init(a,b,e,d,f,h,g,k,l)}function x(a,b,e,d,f,h,g,k,l,n){this.init(a,
b,e,d,f,h,g,k,l,n)}function qa(a){this.structReference=a}function B(a,b){return a!==m&&null!==a||b!==m&&null!==b?(a===m||null===a)&&b!==m&&null!==b||a!==m&&null!==a&&(b===m||null===b)?!1:a.toLowerCase()===b.toLowerCase():!0}function sa(a){this.name=a}function U(a){this.name=a}function Ba(a,b){return a===b?!0:Math.abs(a-b)<Math.abs(a)/281474976710656}function wa(a,b){this.name=a;this.acceptsReference=b}function Aa(a,b,e){this.name=a;this.minArgs=b;this.maxArgs=e}function y(a,b,e,d){if(d===m||null===
d)d=Y.Nothing;this.value=a;this.type=b;this.index=e;this.subType=d;this.children=[]}function va(){this._index=-1;this._tokens=[]}function F(){this._stack=[]}function Ka(a,b,e,d){var f=a.length,h=e===d?0:1,g="";for(b+=1;b<f;b++){var k=a.charAt(b);k===e&&h++;if(k===d)if(h--,e===d&&b+2<f&&a.charAt(b+1)===e)g+=e,b++;else if(0!==h)g+=k;else return{result:g,endIndex:b};else g+=k}throw"no syntax '"+d+"'to match the syntax '"+e+"'.";}function jb(a,b){for(var e=a.length,d=e-b,f=0;f<Wa.length;f++){var h=Wa[f];
if(!(b+h.length>e)){var g=a.slice(b,b+h.length);if(h.length<=d&&(h===g||h===g.toUpperCase()))return{result:h,endIndex:b+h.length-1}}}throw"'"+a.slice(b)+"' is invalid.";}function Ra(a){return"^"===a||":"===a?1:"*"===a||"/"===a||" "===a?2:"+"===a||"-"===a||","===a?3:"&"===a?4:5}function kb(a){if(a.subType===Y.RangeOp)return ma.range;if(a.subType===Y.Union)return ma.union;if(a.subType===Y.Intersection)return ma.intersection;a=a.value;if("^"===a)return ma.exponent;if("*"===a)return ma.multiply;if("/"===
a)return ma.divide;if("+"!==a){if("-"===a)return ma.subtract;if("&"===a)return ma.concatenate;if("<"===a)return ma.lessThan;if("="===a)return ma.equal;if(">"===a)return ma.greaterThan;if(">="===a)return ma.greaterThanOrEqual;if("<="===a)return ma.lessThanOrEqual;if("<>"===a)return ma.notEqual;if(":"===a||"!"===a)return ma.range;if(" "===a||","===a)return ma.intersection}return ma.add}function lb(a,b){var e=b+1;return 0>a?a%e+e:a>b?a%e:a}function ab(a,b,e,d){this.useR1C1=a;this.row=b;this.column=e;
this.option=d}function Sa(a,b,e,d,f,h){this.source=a;this.arrayFormulaMode=2<=arguments.length?b:!1;this.row=3<=arguments.length?e:0;this.column=4<=arguments.length?d:0;this.rowCount=5<=arguments.length?f:1;this.columnCount=6<=arguments.length?h:1}function bb(){}function La(a,b,e){a.hasOwnProperty(b)&&a[b]||(a[b]=[]);a[b].push(e)}function Ma(a,b,e){if(a=a[b])for(b=0;b<a.length;b++)if(a[b]===e){a.splice(b,1);break}}function Ta(a,b,e){l(b).each(function(b,d){a[d]&&l(a[d]).each(function(a,b){b[e]()})})}
function Xa(a,b,e,d){l(b).each(function(b,f){a[f]&&l(a[f]).each(function(a,b){var f;f=e.action===cb?(-1===b.row||-1===e.row||b.row<e.row+e.rowCount&&e.row<b.row+b.rowCount)&&(-1===b.column||-1===e.column||b.column<e.column+e.columnCount&&e.column<b.column+b.columnCount):e.action===db?(-1===b.row||b.row<=e.row&&e.row<b.row+b.rowCount)&&(-1===b.column||b.column<=e.column&&e.column<b.column+b.columnCount):!1;if(f)b.listener[d]()})})}function Ua(){}function Na(a,b,e){this.sheetSource=a;this.row=b;this.column=
e;this.delay=0;this._listeners=[Ha,Ia,Ja]}function Ca(a,b){this.sheetSource=a;this.row=b;this._listeners=[Ha,Ia,eb,Ja]}function Da(a,b){this.sheetSource=a;this.column=b;this._listeners=[Ha,Ia,Ja,fb]}function Pa(a){this.name=a;this._listeners=[Ha,Ia,Ja]}function mb(a){this.sheetSource=a;this._listeners=[Ha,Ia,Ja]}function nb(a,b){var e=Math.max(a.row,b.row),d=Math.max(a.column,b.column),f=Math.min(a.row+a.rowCount,b.row+b.rowCount),h=Math.min(a.column+a.columnCount,b.column+b.columnCount);return e>=
f||d>=h?null:{row:e,column:d,rowCount:f-e,columnCount:h-d,intersectWith:nb}}function gb(a,b,e,d,f,h,g,k){this._fromModel=a;this._fromRow=b;this._fromColumn=e;this._toModel=d;this._toRow=f;this._toColumn=h;this._rowCount=g;this._columnCount=k}function Ya(){this._dataModels=[];this._customFunctions=[];this._customNames=[];this.clearDirties()}function ob(a,b){this._sheet=a;this._sheetArea=b;this._controller=new Ya;this._controller.attachDataModel(this)}function pb(a){this.context=a;this.parser=new Q;
this.evaluator=new bb;this.useR1C1=!1;this._suspended=0}var Oa=p.GrapeCity;"undefined"===typeof Oa&&(Oa={});"undefined"===typeof Oa.UI&&(Oa.UI={});var Ea=Oa.UI;"undefined"===typeof Oa.Calc&&(Oa.Calc={});var ea=Oa.Calc;"undefined"===typeof ea.Expressions&&(ea.Expressions={});"undefined"===typeof ea.Operators&&(ea.Operators={});"undefined"===typeof ea.Functions&&(ea.Functions={});var ta=ea.Expressions,ma=ea.Operators,xa=ea.Functions,Va="InvalidArgument",Wa="#NULL! #DIV/0! #VALUE! #REF! #NAME? #N/A #NUM!".split(" "),
tb=[0,7,15,23,29,42,36],Za=[1,26,676];ea.missingArgument={};k.prototype={toString:function(){return this._error}};k.parse=function(a){if(a!==m&&null!==a&&""!==a)for(var b=0;b<Wa.length;b++){var e=Wa[b];if(e===a||e===a.toUpperCase())return new k(e,tb[b])}};ea.Error=k;var ub=new k("#NULL!",0),$a=new k("#DIV/0!",7),ya=new k("#VALUE!",15),pa=new k("#REF!",23),Qa=new k("#NAME?",29),hb=new k("#N/A",42),ib=new k("#NUM!",36);ea.Errors={Null:ub,DivideByZero:$a,Value:ya,Reference:pa,Name:Qa,NotAvailable:hb,
Number:ib};g.prototype={getRowCount:function(){return 1},getColumnCount:function(){return 1},length:function(){return this.getRowCount()*this.getColumnCount()},getValueByIndex:function(a){return this.getValue(parseInt(a/this.getColumnCount(),10),a%this.getColumnCount())},getValue:function(a,b){}};ea.Array=g;a.prototype=new g;a.prototype.getRowCount=function(){return this._rowCount};a.prototype.getColumnCount=function(){return this._columnCount};a.prototype.getValue=function(a,b){return this._value[a][b]};
ea._ConcreteArray=a;d.prototype=new g;d.prototype.getRowCount=function(){return this._rowCount};d.prototype.getColumnCount=function(){return this._columnCount};d.prototype.getValue=function(a,b){return ea._ArrayHelper.getValue(this._array,this._row+a,this._column+b)};ea._SliceArray=d;e.prototype=new g;e.prototype.getRowCount=function(){return this._value.getRowCount(0)};e.prototype.getColumnCount=function(){return this._value.getColumnCount(0)};e.prototype.getValue=function(a,b){return this._value.getValue(0,
a,b)};ea._ArrayWrappingRange=e;b.prototype=new g;b.prototype.getRowCount=function(){return 1};b.prototype.getColumnCount=function(){return 1};b.prototype.getValue=function(a,b){return this._value};ea._ArrayWrappingScalar=b;f.prototype=new g;f.prototype.getRowCount=function(){return this.values.length};f.prototype.getColumnCount=function(){return 1};f.prototype.getValue=function(a,b){return this.values[a]};ea._OneDimensionalArray=f;s.prototype={getRangeCount:function(){return 1},getRow:function(a){},
getColumn:function(a){},getRowCount:function(a){},getColumnCount:function(a){},getValue:function(a,b,e){},isSubtotal:function(a,b,e){},getSource:function(){}};ea.Reference=s;q.prototype=new s;q.prototype.getSheetCount=function(){return this._references.length};q.prototype.getRangeCount=function(){return this._references[0].getRangeCount()};q.prototype.getRow=function(a){return this._references[0].getRow(a)};q.prototype.getColumn=function(a){return this._references[0].getColumn(a)};q.prototype.getRowCount=
function(a){return this._references[0].getRowCount(a)};q.prototype.getColumnCount=function(a){return this._references[0].getColumnCount(a)};q.prototype.getSource=function(a){return this._references[a].getSource()};q.prototype.getValue=function(a,b,e,d){if(a===m||null===a)a=0;return this._references[a].getValue(b,e,d)};q.prototype.isSubtotal=function(a,b,e,d){if(a===m||null===a)a=0;return this._references[a].isSubtotal(b,e,d)};ea._SheetRangeReference=q;t.prototype=new s;t.prototype.getRangeCount=function(){return this._ranges.length};
t.prototype.getRow=function(a){return this._ranges[a].row};t.prototype.getColumn=function(a){return this._ranges[a].col};t.prototype.getRowCount=function(a){return this._ranges[a].rowCount};t.prototype.getColumnCount=function(a){return this._ranges[a].colCount};t.prototype.getSource=function(){return this._source};t.prototype.getValue=function(a,b,e){return this.getActualValue(a,b,e)};t.prototype.getActualValue=function(a,b,e){var d=this._source;return d.getValue(a,this.getRow(a)-d.getRow(a)+b,this.getColumn(a)-
d.getColumn(a)+e)};t.prototype.isSubtotal=function(a,b,e){var d=this._source;return d.isSubtotal(a,this.getRow(a)-d.getRow(a)+b,this.getColumn(a)-d.getColumn(a)+e)};ea._ConcreteReference=t;r.prototype=new s;r.prototype.getRangeCount=function(){return 1};r.prototype.getRow=function(a){return 0};r.prototype.getColumn=function(a){return 0};r.prototype.getRowCount=function(a){return this._sheet.getRowCount()};r.prototype.getColumnCount=function(a){return this._sheet.getColumnCount()};r.prototype.getValue=
function(a,b,e){return 0<=b&&b<this._sheet.getRowCount()||0<=e&&e<this._sheet.getColumnCount()?this._sheet.getValue(b,e):pa};r.prototype.getSource=function(){return new r(this._sheet)};r.prototype.isSubtotal=function(a,b,e){var d=this._sheet;return 0===a&&b<d.getRowCount()&&e<d.getColumnCount()?(a=d.getExpression(b,e))&&a instanceof ta.FunctionExpression&&"SUBTOTAL"===a.getFunctionName().toUpperCase():!1};ea._SheetReference=r;u.prototype=new g;u.prototype.getRowCount=function(){return this._values.length*
this._values[0].getRowCount(0)};u.prototype.getColumnCount=function(){return this._values[0].getColumnCount(0)};u.prototype.getValue=function(a,b){var e=b/this._values[0].getRowCount(0),d=a/this._values[0].getRowCount(0);return this._values[e].getValue(0,d,b)};ea._CalcSheetRangeWrappingCalcRange=u;n.prototype=new ea._ConcreteReference(null,null);n.prototype.getValue=function(a,b,e){return this.Action(this.getActualValue(a,b,e),this.Operand1,this.Operand2)};ea._TernaryCompositeConcreteReference=n;
h.prototype=new ea._ConcreteReference(null,null);h.prototype.getValue=function(a,b,e){return this.Action(this.getActualValue(a,b,e))};ea._UnaryCompositeConcreteReference=h;I.prototype=new ea._ConcreteReference(null,null);I.prototype.getValue=function(a,b,e){a=this.getActualValue(a,b,e);return this.SwithOrder?this.Action(this.Operand1,a):this.Action(a,this.Operand1)};ea._BinaryCompositeConcreteReference=I;var Z={isNumber:function(a){return"number"===typeof a||!isNaN(a)&&!isNaN(parseFloat(a))||a instanceof
Date},isError:function(a){return a instanceof k},_isCalcArray:function(a){return a instanceof g},_isCalcReference:function(a){return a instanceof s},toResult:function(a){return isNaN(a)||!isFinite(a)?ib:a},_toArray:function(a){if(a instanceof g)return a;if(a instanceof s){if(1===a.getRangeCount())return new e(a)}else return new b(a)},_isNaNOrInfinite:function(a){return isNaN(a)||!isFinite(a)},toInt:function(a){a=Z.toDouble(a);if(1E21>Math.abs(a))return parseInt(a,10);throw"InvalidCastException";},
toDouble:function(a){var b=null;if(a===m||null===a)b=0;else if(b=typeof a,"number"===b){if(b=(new Number(a)).valueOf(),Z._isNaNOrInfinite(b))throw"InvalidCastException";}else if("string"===b)if(b=Ea._DateTimeHelper.parseLocale(a),b!==m&&null!==b)b=(new Ea._DateTimeHelper(b)).toOADate();else{if(b=(new Number(a)).valueOf(),Z._isNaNOrInfinite(b))throw"InvalidCastException";}else if("boolean"===b)b=a?1:0;else if(a instanceof Date)b=(new Ea._DateTimeHelper(a)).toOADate();else throw"InvalidCastException";
return b},toBool:function(a){if(a===m||null===a)return!1;if("boolean"===typeof a)return a;if(a instanceof Date)return 0!==(new Ea._DateTimeHelper(a)).toOADate();if(Z.isNumber(a))return 0!==a;throw"InvalidCastException";},toString:function(a){try{if(a===m||null===a)return"";if("boolean"===typeof a)return a?"TRUE":"FALSE";if("string"===typeof a)return a;if(a instanceof Date)return(new Ea._DateTimeHelper(a)).localeFormat("M/d/yyyy h:mm:ss");if(a instanceof g)throw"InvalidCastException";return a.toString()}catch(b){throw"InvalidCastException";
}},toDateTime:function(a){var b=Ea._DateTimeHelper;if(a===m||null===a)return Ea._DateTimeHelper.fromOADate(0);if(a instanceof Date)return new Date(a);if("string"===typeof a){var e=b.parseLocale(a);e!==m&&null!==e||isNaN(a)||(e=b.fromOADate(parseFloat(a)));if(e===m||null===e)throw Va;return e}if("number"===typeof a)return b.fromOADate(a);throw"InvalidCastException";}};ea.Convert=Z;var za={_argumentExists:function(a,b){return a&&b<a.length&&a[b]!==ea.missingArgument},getArrayValue:function(a,b,e){return a===
m||null===a?ya:b<a.getRowCount()&&e<a.getColumnCount()?a.getValue(b,e):e>=a.getColumnCount()&&1===a.getColumnCount()&&b<a.getRowCount()?a.getValue(b,0):b>=a.getRowCount()&&1===a.getColumnCount()&&e<a.getColumnCount()?a.getValue(0,e):ya},tryExtractToSingleValue:function(a){a instanceof s&&(a=Z._toArray(a),a=1===a.getRowCount()&&1===a.getColumnCount()?a.getValue(0,0):a);a instanceof g&&1===a.getRowCount()&&1===a.getColumnCount()&&(a=a.getValue(0,0));return{value:a,success:!(a instanceof g)}}};ea._Helper=
za;ea._ArrayHelper={isArrayOrReference:function(a){return a instanceof g||a instanceof s},getRangeCount:function(a){return a instanceof s?a.getRangeCount():1},getLength:function(a,b){return E(function(){return 0===arguments.length?a.getRowCount()*a.getColumnCount():a.getRowCount(arguments[0])*a.getColumnCount(arguments[0])},a,b,1)},getRowCount:function(a,b){return E(a.getRowCount,a,b,1)},getColumnCount:function(a,b){return E(a.getColumnCount,a,b,1)},getValueByIndex:function(a,b,e){return E(function(){if(0===
arguments.length)return a.getValueByIndex(b);var e=a.getColumnCount(arguments[0]);return a.getValue(arguments[0],parseInt(b/e,10),b%e)},a,e,a)},getValue:function(a,b,e,d){return E(function(){return 0===arguments.length?a.getValue(b,e):a.getValue(arguments[0],b,e)},a,d,a)},isSubtotalByIndex:function(a,b,e){return E(function(e){var d=a.getColumnCount(e);return a.isSubtotal(e,b/d,b%d)},a,e,!1,!0)},isSubtotal:function(a,b,e,d){return E(function(d){return a.isSubtotal(d,b,e)},a,d,!1,!0)}};var ua={None:0,
Sign:1,Int:2,Dot:3,Decimal:4,Exponent:5,SignExponent:6,ScientificNotation:7,Number:8},Ga={UppercaseLetter:0,LowercaseLetter:1,DecimalDigitNumber:8,OtherNumber:10,SpaceSeparator:11,Control:14,ConnectorPunctuation:18,DashPunctuation:19,OpenPunctuation:20,ClosePunctuation:21,InitialQuotePunctuation:22,FinalQuotePunctuation:23,OtherPunctuation:24,MathSymbol:25,CurrencySymbol:26,ModifierSymbol:27,OtherSymbol:28},Fa=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,
14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,
1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1];Q.BAND_INDEX_CONST=-2147483648;Q.maxRowCount=1048576;Q.maxColumnCount=16384;Q._isLetter=H;Q._isLetterOrDigit=C;ta.Expression=J;K.prototype=new J;ta.ParenthesesExpression=K;A.prototype=new J;A.prototype.argCount=function(){return this.args?this.args.length:0};A.prototype.getArg=function(a){return this.args?this.args[a]:null};A.prototype.getFunctionName=function(){return"string"===typeof this.fn?this.fn:this.fn.name};ta.FunctionExpression=A;L.prototype=
new J;ta.NameExpression=L;D.prototype=new L;ta.BangNameExpression=D;w.prototype=new J;ta.ExternalNameExpression=w;M.prototype=new J;ta.ConstantExpression=M;T.prototype=new M;ta.BooleanExpression=T;P.prototype=new M;ta.DoubleExpression=P;ia.prototype=new M;ta.StringExpression=ia;v.prototype=new M;ta.ErrorExpression=v;V.prototype=new v;ta.ExternalErrorExpression=V;N.prototype=new v;ta.SheetRangeErrorExpression=N;R.prototype=new v;ta.BangErrorExpression=R;ga.prototype=new M;ta.ArrayExpression=ga;ba.prototype=
new M;ta.MissingArgumentExpression=ba;W.prototype=new J;ta.OperatorExpression=W;ja.prototype=new W;ta.UnaryOperatorExpression=ja;fa.prototype=new W;ta.BinaryOperatorExpression=fa;la.prototype=new J;la.prototype.getRange=function(a,b){};ta.ReferenceExpression=la;ra.prototype=new la;ta.ExternalReferenceExpression=ra;da.prototype=new la;da.prototype.getRange=function(a,b){return aa.call(this,a,b)};ta.CellExpression=da;oa.prototype=new da;ta.BangCellExpression=oa;ha.prototype=new ra;ha.prototype.getRange=
function(a,b){return aa.call(this,a,b)};ta.ExternalCellExpression=ha;X.prototype=new la;X.prototype._initDefault=function(){var a=Q.BAND_INDEX_CONST;this.init(a,a,a,a,!1,!1,!1,!1);this.isFullColumn=this.isFullRow=!0};X.prototype.init=function(a,b,e,d,f,h,g,k){a>e?(this.startRow=e,this.endRow=a,this.startRowRelative=g,this.endRowRelative=f):(this.startRow=a,this.endRow=e,this.startRowRelative=f,this.endRowRelative=g);b>d?(this.startColumn=d,this.endColumn=b,this.startColumnRelative=k,this.endColumnRelative=
h):(this.startColumn=b,this.endColumn=d,this.startColumnRelative=h,this.endColumnRelative=k);this.isFullColumn=this.isFullRow=!1};X.prototype.initBand=function(a,b,e,d,f){if(a>b){var h=a;a=b;b=h;h=e;e=d;d=h}f?(this.startRow=a,this.startColumn=Q.BAND_INDEX_CONST,this.endRow=b,this.endColumn=Q.BAND_INDEX_CONST,this.startRowRelative=e,this.startColumnRelative=!1,this.endRowRelative=d,this.endColumnRelative=!1,this.isFullRow=!0,this.isFullColumn=!1):(this.startRow=Q.BAND_INDEX_CONST,this.startColumn=
a,this.endRow=Q.BAND_INDEX_CONST,this.endColumn=b,this.startRowRelative=!1,this.startColumnRelative=e,this.endRowRelative=!1,this.endColumnRelative=d,this.isFullRow=!1,this.isFullColumn=!0)};X.prototype._getRangeType=function(){return this.isFullRow&&this.isFullColumn?3:this.isFullRow?1:this.isFullColumn?2:0};X.prototype.getRange=function(a,b){return ka.call(this,a,b)};ta.RangeExpression=X;na.prototype=new X;ta.BangRangeExpression=na;ca.prototype=new ra;ca.prototype._initDefault=function(a){var b=
Q.BAND_INDEX_CONST;this.init(a,b,b,b,b,!1,!1,!1,!1);this.isFullColumn=this.isFullRow=!0};ca.prototype.init=function(a,b,e,d,f,h,g,k,l){this.source=a;b>d?(this.startRow=d,this.endRow=b,this.startRowRelative=k,this.endRowRelative=h):(this.startRow=b,this.endRow=d,this.startRowRelative=h,this.endRowRelative=k);e>f?(this.startColumn=f,this.endColumn=e,this.startColumnRelative=l,this.endColumnRelative=g):(this.startColumn=e,this.endColumn=f,this.startColumnRelative=g,this.endColumnRelative=l)};ca.prototype.initBand=
function(a,b,e,d,f,h){this.source=a;b>e&&(a=b,b=e,e=a,a=d,d=f,f=a);h?(this.startRow=b,this.startColumn=Q.BAND_INDEX_CONST,this.endRow=e,this.endColumn=Q.BAND_INDEX_CONST,this.startRowRelative=d,this.startColumnRelative=!1,this.endRowRelative=f,this.endColumnRelative=!1,this.isFullRow=!0):(this.startRow=Q.BAND_INDEX_CONST,this.startColumn=b,this.endRow=Q.BAND_INDEX_CONST,this.endColumn=e,this.startRowRelative=!1,this.startColumnRelative=d,this.endRowRelative=!1,this.endColumnRelative=f,this.isFullColumn=
!0)};ca.prototype._getRangeType=function(){return this.isFullRow&&this.isFullColumn?3:this.isFullRow?1:this.isFullColumn?2:0};ca.prototype.getRange=function(a,b){return ka.call(this,a,b)};ta.ExternalRangeExpression=ca;x.prototype=new la;x.prototype.init=function(a,b,e,d,f,h,g,k,l,n){this.startSource=a;this.endSource=b;e>f?(this.startRow=f,this.endRow=e,this.startRowRelative=l,this.endRowRelative=g):(this.startRow=e,this.endRow=f,this.startRowRelative=g,this.endRowRelative=l);d>h?(this.startColumn=
h,this.endColumn=d,this.startColumnRelative=n,this.endColumnRelative=k):(this.startColumn=d,this.endColumn=h,this.startColumnRelative=k,this.endColumnRelative=n)};x.prototype.initBand=function(a,b,e,d,f,h,g){this.startSource=a;this.endSource=b;e>d&&(a=e,e=d,d=a,a=f,f=h,h=a);g?(this.startRow=e,this.startColumn=Q.BAND_INDEX_CONST,this.endRow=d,this.endColumn=Q.BAND_INDEX_CONST,this.startRowRelative=f,this.startColumnRelative=!1,this.endRowRelative=h,this.endColumnRelative=!1,this.isFullRow=!0):(this.startRow=
Q.BAND_INDEX_CONST,this.startColumn=e,this.endRow=Q.BAND_INDEX_CONST,this.endColumn=d,this.startRowRelative=!1,this.startColumnRelative=f,this.endRowRelative=!1,this.endColumnRelative=h,this.isFullColumn=!0)};ta.SheetRangeExpression=x;qa.prototype=new la;ta.StructReferenceExpression=qa;sa.prototype={getName:function(){return this.name},compareTo:function(a){return B(this.name,a.name)},toString:function(){return this.getName()}};ma.Operator=sa;U.prototype=new sa;U.prototype._evaluateSingle=function(a,
b){};U.prototype._evaluateImp=function(b,e){var d=null;b instanceof g&&(d=b);b instanceof s&&(d=Z._toArray(b));if(d===m||null===d)return this._evaluateSingle(b,e);if(1>d.length())return ib;for(var f=[],h=0;h<d.getRowCount();h++){f[h]=[];for(var k=0;k<d.getColumnCount();k++)f[h][k]=this._evaluateSingle(d.getValue(h,k),e)}return new a(f,d.getColumnCount())};U.prototype.evaluate=function(a,b){};ma.UnaryOperator=U;var qb=ma.plus=new U("+");qb.evaluate=function(a,b){return this._evaluateImp(a,b)};qb._evaluateSingle=
function(a,b){return a===m||null===a?0:Z.toDouble(a)};var rb=ma.negate=new U("-");rb.evaluate=function(a,b){return this._evaluateImp(a,b)};rb._evaluateSingle=function(a,b){return a===m||null===a?0:-Z.toDouble(a)};var sb=ma.percent=new U("%");sb.evaluate=function(a,b){return this._evaluateImp(a,b)};sb._evaluateSingle=function(a,b){return a===m||null===a?0:Z.toDouble(a)/100};wa.prototype=new sa;wa.prototype._evaluateSingle=function(a,b,e){};wa.prototype.evaluate=function(b,e,d){d=za.tryExtractToSingleValue(b);
var f=za.tryExtractToSingleValue(e);if(d.success&&f.success)return this._evaluateSingle(d.value,f.value);b=d.value;e=f.value;var h=d.success?-1:b.getRowCount(),g=d.success?-1:b.getColumnCount(),k=f.success?-1:e.getRowCount(),l=f.success?-1:e.getColumnCount(),n=-1,m=-1;d.success||(n=h,m=g);f.success||(n=-1===n?k:1<k?1<n?Math.min(k,n):k:n,m=-1===m?l:1<l?1<m?Math.min(l,m):l:m);h=[];for(g=0;g<n;g++)for(h[g]=[],k=0;k<m;k++)h[g][k]=this._evaluateSingle(d.success?b:za.getArrayValue(b,g,k),f.success?e:za.getArrayValue(e,
g,k));return new a(h,m)};ma.BinaryOperator=wa;(ma.add=new wa("+",!1))._evaluateSingle=function(a,b,e){if(Z.isError(a))return a;if(Z.isError(b))return b;if(a===m||null===a)a=0;if(b===m||null===b)b=0;return Z.toDouble(a)+Z.toDouble(b)};(ma.subtract=new wa("-",!1))._evaluateSingle=function(a,b,e){if(Z.isError(a))return a;if(Z.isError(b))return b;if(a===m||null===a)a=0;if(b===m||null===b)b=0;return Z.toDouble(a)-Z.toDouble(b)};(ma.multiply=new wa("*",!1))._evaluateSingle=function(a,b,e){if(Z.isError(a))return a;
if(Z.isError(b))return b;if(a===m||null===a)a=0;if(b===m||null===b)b=0;return Z.toDouble(a)*Z.toDouble(b)};(ma.divide=new wa("/",!1))._evaluateSingle=function(a,b,e){if(b===m||null===b||""===b||0===b)return $a;if(Z.isError(a))return a;if(Z.isError(b))return b;if(a===m||null===a)a=0;return 0===(b=Z.toDouble(b))?$a:Z.toDouble(a)/b};(ma.exponent=new wa("^",!1))._evaluateSingle=function(a,b,e){if(Z.isError(a))return a;if(Z.isError(b))return b;if(a===m||null===a)a=0;if(b===m||null===b)b=0;return 0===a&&
0>b?$a:Math.pow(Z.toDouble(a),Z.toDouble(b))};(ma.concatenate=new wa("&",!1))._evaluateSingle=function(a,b,e){if(Z.isError(a))return a;if(Z.isError(b))return b;if(a===m||null===a)a="";if(b===m||null===b)b="";return a.toString()+b.toString()};(ma.equal=new wa("=",!1))._evaluateSingle=function(a,b,e){if(Z.isError(a))return a;if(Z.isError(b))return b;if(a===m||null===a)a=0;if(b===m||null===b)b=0;if("string"===typeof a||"string"===typeof b)return a.toString().toUpperCase()===b.toString().toUpperCase();
a=Z.toDouble(a);b=Z.toDouble(b);return Ba(a,b)};(ma.notEqual=new wa("<>",!1))._evaluateSingle=function(a,b,e){if(Z.isError(a))return a;if(Z.isError(b))return b;if(a===m||null===a)a=0;if(b===m||null===b)b=0;if("string"===typeof a||"string"===typeof b)return a.toString().toUpperCase()!==b.toString().toUpperCase();a=Z.toDouble(a);b=Z.toDouble(b);return!Ba(a,b)};(ma.lessThan=new wa("<",!1))._evaluateSingle=function(a,b,e){if(Z.isError(a))return a;if(Z.isError(b))return b;if(a===m||null===a)a=0;if(b===
m||null===b)b=0;if("string"===typeof a||"string"===typeof b)return a.toString().toUpperCase()<b.toString().toUpperCase();a=Z.toDouble(a);b=Z.toDouble(b);return a<b&&!Ba(a,b)};(ma.greaterThan=new wa(">",!1))._evaluateSingle=function(a,b,e){if(Z.isError(a))return a;if(Z.isError(b))return b;if(a===m||null===a)a=0;if(b===m||null===b)b=0;if("string"===typeof a||"string"===typeof b)return a.toString().toUpperCase()>b.toString().toUpperCase();a=Z.toDouble(a);b=Z.toDouble(b);return a>b&&!Ba(a,b)};(ma.lessThanOrEqual=
new wa("<=",!1))._evaluateSingle=function(a,b,e){if(Z.isError(a))return a;if(Z.isError(b))return b;if(a===m||null===a)a=0;if(b===m||null===b)b=0;if("string"===typeof a||"string"===typeof b)return a.toString().toUpperCase()<=b.toString().toUpperCase();a=Z.toDouble(a);b=Z.toDouble(b);return a<b||Ba(a,b)};(ma.greaterThanOrEqual=new wa(">=",!1))._evaluateSingle=function(a,b,e){if(Z.isError(a))return a;if(Z.isError(b))return b;if(a===m||null===a)a=0;if(b===m||null===b)b=0;if("string"===typeof a||"string"===
typeof b)return a.toString().toUpperCase()>=b.toString().toUpperCase();a=Z.toDouble(a);b=Z.toDouble(b);return a>b||Ba(a,b)};(ma.range=new wa(":",!0)).evaluate=function(a,b,e){if(a===m||null===a||b===m||null===b||1!==a.getRangeCount()||1!==b.getRangeCount())return ya;e=a.getSource();if(!e||e!==b.getSource())return ya;var d=a.getRow(0),f=a.getColumn(0),h=b.getRow(0),g=b.getColumn(0),k=Math.min(d,h),l=Math.min(f,g),d=Math.max(d+a.getRowCount(0),h+b.getRowCount(0))-k;a=Math.max(f+a.getColumnCount(0),
g+b.getColumnCount(0))-l;return new t(e,[{row:k,col:l,rowCount:d,colCount:a}])};(ma.union=new wa(",",!0)).evaluate=function(a,b,e){if(a===m||null===a||b===m||null===b||1!==a.getRangeCount()||1!==b.getRangeCount())return ya;e=[];for(var d=0,d=0;d<a.getRangeCount();d++)e.push({row:a.getRow(d),col:a.getColumn(d),rowCount:a.getRowCount(d),colCount:a.getColumnCount(d)});for(d=0;d<b.getRangeCount();d++)e.push({row:b.getRow(d),col:b.getColumn(d),rowCount:b.getRowCount(d),colCount:b.getColumnCount(d)});return new t(a.getSource(),
e)};(ma.intersection=new wa(" ",!0)).evaluate=function(a,b,e){if(a===m||null===a||b===m||null===b||1!==a.getRangeCount()||1!==b.getRangeCount())return ya;e=a.getSource();if(!e||e!==b.getSource())return ya;var d=a.getRow(0),f=a.getColumn(0),h=b.getRow(0),g=b.getColumn(0),k=Math.max(d,h),l=Math.max(f,g),d=Math.min(d+a.getRowCount(0),h+b.getRowCount(0))-k;a=Math.min(f+a.getColumnCount(0),g+b.getColumnCount(0))-l;return new t(e,[{row:k,col:l,rowCount:d,colCount:a}])};Aa.prototype={_init:function(a,b,
e){this.name=a;this.minArgs=b;this.maxArgs=e},acceptsArray:function(a){return!1},acceptsReference:function(a){return!1},acceptsError:function(a){return!1},acceptsMissingArgument:function(a){return!1},isVolatile:function(){return!1},isContextSensitive:function(){return!1},isBranch:function(){return!1},findTestArgument:function(){return-1},findBranchArgument:function(a){return-1},evaluate:function(a){},evaluateWithContext:function(a,b){return this.evaluate(a)},toString:function(){return this.name}};
Aa._create=function(a,b,e){a=new xa.Function(a,0,255);b&&"function"===typeof b&&(a.evaluate=b);if(e)for(var d in e)e.hasOwnProperty(d)&&"override"!==d&&(a[d]=e[d]);return a};xa.Function=Aa;xa._customFunctions={};xa.defineGlobalCustomFunction=function(a,b,e){if(a===m||null===a)throw"Invalid function name";var d;a=a.toUpperCase();if(xa._builtInFunctions.hasOwnProperty(a))throw"Can not override built-in function";if(xa._customFunctions.hasOwnProperty(a))if(d=xa._customFunctions[a],!d)xa._customFunctions[a]=
new xa.Function(a,0,255),d=xa[a.toUpperCase()];else{if(!e||!e.override)throw"Attempt to override function while override is not allowed";}else d=new xa.Function(a,0,255),xa._customFunctions[a]=d;b&&"function"===typeof b&&(d.evaluate=b);if(e)for(var f in e)e.hasOwnProperty(f)&&"override"!==f&&(d[f]=e[f]);return d};xa.findGlobalFunction=function(a){if(a===m||null===a)return null;a=a.toUpperCase();return xa._builtInFunctions&&xa._builtInFunctions.hasOwnProperty(a)?xa._builtInFunctions[a]:xa._customFunctions.hasOwnProperty(a)?
xa._customFunctions[a]:null};l.extend({ce:{createFunction:function(a,b,e){return xa.Function._create(a,b,e)},defineGlobalCustomFunction:function(a,b,e){return xa.defineGlobalCustomFunction(a,b,e)},findGlobalFunction:function(a){return xa.findGlobalFunction(a)}}});var Y={Nothing:0,Start:1,Stop:2,Text:3,Number:4,Logical:5,Error:6,RangeOrName:7,Concatenation:8,Intersection:9,Union:10,RangeOp:11};va.prototype={count:function(){return this._tokens.length},BOF:function(){return 0>=this._index},EOF:function(){return this._index>=
this._tokens.length-1},current:function(){return-1===this._index?null:this._tokens[this._index]},next:function(){return this.EOF()?null:this._tokens[this._index+1]},previous:function(){return 1>this._index?null:this._tokens[this._index-1]},add:function(a){this._tokens.push(a);return a},removeAt:function(a){this._tokens.splice(a,1)},moveNext:function(){if(this.EOF())return!1;this._index++;return!0},reset:function(){this._index=-1},getItem:function(a){return 0>a||a>=this.count()?null:this._tokens[a]}};
F.prototype={push:function(a){this._stack.push(a)},pop:function(){if(0===this._stack.length)return null;var a=this._stack.pop();return new y("",a.type,a.index,Y.Stop)},current:function(){return 0<this._stack.length?this._stack[this._stack.length-1]:null}};ab.prototype={getExternalSource:function(a,b){},getExternalSourceToken:function(a){}};ea.ParserContext=ab;Q.prototype={_init:function(a){this.listSeparator=a&&a.hasOwnProperty("listSeparator")?a.listSeparator:",";this.numberDecimalSeparator=a&&a.hasOwnProperty("numberDecimalSeparator")?
a.numberDecimalSeparator:".";this.arrayGroupSeparator=a&&a.hasOwnProperty("arrayGroupSeparator")?a.arrayGroupSeparator:";";this._arrayArgumentSepatator=this.listSeparator===this.arrayGroupSeparator?"\\":this.listSeparator;this._operatorInfix="\\+-*/^&=><: "+this.listSeparator},parse:function(a,b){b||(b={useR1C1:!1,row:0,column:0,option:null});b.option&&this._init(b.option);var e=this._parseToToken(a);return this._buildExpressionTree(b,e)},unparse:function(a,b){if(!a)return"";b||(b={useR1C1:!1,row:0,
column:0,option:null});b.option&&this._init(b.option);var e={content:""};this._unparseExpression(a,b,e);return e.content},_unparseExpression:function(a,b,e){if(a instanceof M)this._unparseConstantExpression(a,b,e);else if(a instanceof W)this._unParseOperatorExpressions(a,b,e);else if(a instanceof la)this._unParseRefenceExpressions(a,b,e);else if(a instanceof D)e.content+="!",e.content+=a.name;else if(a instanceof L)e.content+=a.name;else if(a instanceof w)this._unparseSource(a.source,b,e),e.content+=
"!",e.content+=a.name;else if(a instanceof K)e.content+="(",this._unparseExpression(a.argument,b,e),e.content+=")";else if(a instanceof A){e.content+=a.getFunctionName();e.content+="(";for(var d=0;d<a.argCount();d++)0!==d&&(e.content+=this.listSeparator),this._unparseExpression(a.getArg(d),b,e);e.content+=")"}else throw"Not supported";},_unparseSource:function(a,b,e){b.getExternalSourceToken&&(e.content+=this._getValidSource(b.getExternalSourceToken(a),b.useR1C1))},_unparseSource2:function(a,b,e,
d){var f={content:""};this._unparseSource(a,e,f);a=this._removeApostrophe(f);var h=this._removeWorkbook(f),g=h.success,h=h.workBookName,k={content:""};this._unparseSource(b,e,k);a|=this._removeApostrophe(k);h=this._removeWorkbook(k).workBookName;a?(d.content+="'",g&&(d.content+=h),d.content+=f.content,d.content+=":",d.content+=k.content,d.content+="'"):(g&&(d.content+=h),d.content+=f.content,d.content+=":",d.content+=k.content)},_getValidSource:function(a,b){if(a===m||null===a||""===a)return"";var e=
this._readSheetReference(a,b,!0);if(e.success)return"'"===a.charAt(0)&&"'"===a.charAt(a.length-1)&&(a=a.substr(1,a.length-2),a=a.replace("'","''"),a="'"+a+"'"),a;e=this._readSheetReference("'"+a+"'",b,!0);return e.success?(a=a.replace("'","''"),"'"+a+"'"):""},_unParseRefenceExpressions:function(a,b,e){var d=b.row,f=b.column;if(a instanceof oa)e.content+="!",this._unParseCell(b.useR1C1,d,f,a.row,a.column,a.rowRelative,a.columnRelative,e);else if(a instanceof da)this._unParseCell(b.useR1C1,d,f,a.row,
a.column,a.rowRelative,a.columnRelative,e);else if(a instanceof ha)this._unparseSource(a.source,b,e),e.content+="!",this._unParseCell(b.useR1C1,d,f,a.row,a.column,a.rowRelative,a.columnRelative,e);else if(a instanceof na)e.content+="!",this._unParseRange(b.useR1C1,d,f,a.startRow,a.startColumn,a.endRow,a.endColumn,a.startRowRelative,a.startColumnRelative,a.endRowRelative,a.endColumnRelative,e,a._getRangeType());else if(a instanceof X)this._unParseRange(b.useR1C1,d,f,a.startRow,a.startColumn,a.endRow,
a.endColumn,a.startRowRelative,a.startColumnRelative,a.endRowRelative,a.endColumnRelative,e,a._getRangeType());else if(a instanceof ca)this._unparseSource(a.source,b,e),e.content+="!",this._unParseRange(b.useR1C1,d,f,a.startRow,a.startColumn,a.endRow,a.endColumn,a.startRowRelative,a.startColumnRelative,a.endRowRelative,a.endColumnRelative,e,a._getRangeType());else if(a instanceof x)this._unparseSource2(a.startSource,a.endSource,b,e),e.content+="!",this._unParseRange(b.useR1C1,d,f,a.startRow,a.startColumn,
a.endRow,a.endColumn,a.startRowRelative,a.startColumnRelative,a.endRowRelative,a.endColumnRelative,e,a._getRangeType());else if(a instanceof qa)e.content+=a.structReference;else throw"Not supported";},_removeApostrophe:function(a){return"'"===a.content.charAt(a.content.length-1)?(a.content=a.content.substr(1,a.content.length-2),!0):!1},_removeWorkbook:function(a){if("["!==a.content.charAt(0))return{success:!1,workBookName:""};var b=a.content.indexOf("]"),e=a.content.substr(0,b+1);a.content=a.content.substr(b);
return{success:!0,workBookName:e}},_unParseCell:function(a,b,e,d,f,h,g,k,l){if(l===m||null===l)l=0;var n=Q.BAND_INDEX_CONST,F=Q.maxRowCount-1;(0===l||1===l)&&d!==n&&d>-F&&d<=2*F&&(d=lb(d+(h?b:0),F));F=Q.maxColumnCount-1;(0===l||2===l)&&f!==n&&f>-F&&f<=2*F&&(f=lb(f+(g?e:0),F));if(this._isCellIndexsError(b,e,d,f,h,g,l))k.content+=pa.toString();else if(n=l="",a)l="R",0<=d&&(b!==d||!h)&&(h?l=l+"["+(d-b)+"]":(d++,l+=d)),0>f?k.content+=l:(n="C",e===f&&g||(g?n=n+"["+(f-e)+"]":(f++,n+=f)),h&&0>d||!h&&0>=
d||(k.content+=l),k.content+=n);else if(d++,l=""+d,h||(l="$"+d),0>f)k.content+=l;else{a=f;for(b=1;b<Za.length;b++)e=Za[Za.length-b],f=parseInt(a/e,10),a%=e,0!==f&&(n+=String.fromCharCode(f+65-1));n+=String.fromCharCode(a+65);g||(n="$"+n);0>=d?k.content+=n:(k.content+=n,k.content+=l)}},_isCellIndexsError:function(a,b,e,d,f,h,g){a=!1;switch(g){case 0:a=a|0>e|0>d;break;case 1:a|=0>e;break;case 2:a|=0>d}return a},_unParseRange:function(a,b,e,d,f,h,g,k,l,n,F,B,q){if(q===m||null===q)q=0;this._unParseCell(a,
b,e,d,f,k,l,B,q);k=Q.BAND_INDEX_CONST;if(!a||d!==h||f!==g||h!==k&&g!==k)if(h!==k||g!==k)B.content+=":",this._unParseCell(a,b,e,h,g,n,F,B,q)},_unParseOperatorExpressions:function(a,b,e){if(a instanceof ja){var d=a.operator;d===ma.percent?(this._unparseExpression(a.operand,b,e),e.content+=d.name):(e.content+=d.name,this._unparseExpression(a.operand,b,e))}else if(a instanceof fa){var d={content:""},f={content:""};this._unparseExpression(a.right,b,f);var h=a.left instanceof fa,g=a.right instanceof fa,
k=Ra(a.operator.name);h&&Ra(a.left.operator.name)>k?(d.content+="(",this._unparseExpression(a.left,b,d),d.content+=")"):this._unparseExpression(a.left,b,d);g&&Ra(a.right.operator.name)>k&&(f.content+="(",this._unparseExpression(a.right,b,f),f.content+="(");e.content+=d.content;e.content+=a.operator instanceof ma.UnaryOperator?this.listSeparator:a.operator.name;e.content+=f.content}else throw"Not supported";},_unparseConstantExpression:function(a,b,e){if(a instanceof ia)e.content+='"',e.content+=a.value,
e.content+='"';else if(a instanceof P)e.content+=a.originalValue;else if(a instanceof T)e.content+=a.value?"TRUE":"FALSE";else if(a instanceof ga){e.content+="{";a=a.value;if(0>=a.getRowCount())throw"Invalid array";for(var d=Q.BAND_INDEX_CONST,f=0;f<a.getRowCount();f++){1<=f&&(e.content+=this.arrayGroupSeparator);for(var h=0;h<a.getColumnCount();h++){if(d!==d&&(d!==a.getColumnCount()||0===a.getColumnCount()))throw"Invalid array";0!==h&&(e.content+=this._arrayArgumentSepatator);var g=a.getValue(f,
h);if(g===m||null===g)throw"Invalid array";g instanceof J?this._unparseExpression(g,b,e):g instanceof String?(e.content+='"',e.content+=g,e.content+='"'):e.content=g instanceof Boolean?e.content+(g?"TRUE":"FALSE"):e.content+g.toString()}}e.content+="}"}else if(a instanceof V)this._unparseSource(a.source,b,e),e.content+="!",e.content+=a.value.toString();else if(a instanceof N)this._unparseSource2(a.startSource,a.endSource,b,e),e.content+="!",e.content+=a.value.toString();else if(a instanceof R)e.content+=
"!",e.content+=a.value.toString();else if(a instanceof v)e.content+=a.value.toString();else if(!(a instanceof ba))throw"Not supported";},_parseToToken:function(a){for(var b=a.length,e=new va,d=new F,f="",h=0,g=0;g<b&&" "===a.charAt(g);)g++;for("="===a.charAt(g)&&g++;g<b;g++){var k=a.charAt(g);if('"'===k)k=Ka(a,g,'"','"'),e.add(new y(k.result,0,g,Y.Text)),g=k.endIndex,h=g+1;else if("'"===k)k=Ka(a,g,"'","'"),f+="'",f+=k.result,f+="'",g=k.endIndex;else if("["===k)k=Ka(a,g,"[","]"),f+="[",f+=k.result,
f+="]",g=k.endIndex;else if("\r"!==k&&"\n"!==k)if("#"===k){var k=jb(a,g),l=g<b?a.charAt(g+1):"\x00";0<g&&"!"===a.charAt(g-1)?f+=k.result:"#REF!"===k.result.toUpperCase()&&g<b&&(C(l)||"$"===l)?f+=k.result:(e.add(new y(k.result,0,g,Y.Error)),h=g+1);g=k.endIndex}else if("+"===k||"-"===k)l=e.getItem(e.count()-1),0!==f.length?(e.add(new y(f,0,h)),e.add(new y(k,5,g)),f=""):(l&&7===l.type&&(e.removeAt(e.count()-1),l=e.getItem(e.count()-1)),l&&(1===l.type&&l.subType===Y.Stop||2===l.type&&l.subType===Y.Stop||
6===l.type||0===l.type)?e.add(new y(k,5,g)):e.add(new y(k,4,g))),h=g+1;else if(k===this.numberDecimalSeparator||O(k))if(0<f.length)f+=k;else if((l=S(a,g,this.numberDecimalSeparator)).result){k=l.endIndex;for(h=a.slice(g,k+1);k<=b-2&&" "===a.charAt(k+1);)k++;k<=b-2&&":"===a.charAt(k+1)?(f+=h,f+=":",k++):e.add(new y(h,0,g,Y.Number));h=g+1;g=k}else f+=k;else if("{"===k){if(0<f.length)throw"The formula you typed contains an invalid char: '{' at index on "+g+".";d.push(e.add(new y("ARRAY",1,g,Y.Start)));
d.push(e.add(new y("ARRAYROW",1,g,Y.Start)));h=g+1}else if(k!==this.arrayGroupSeparator||!d.current()||"ARRAY"!==d.current().value&&"ARRAYROW"!==d.current().value)if("}"===k){0<f.length&&(e.add(new y(f,0,h)),f="");if(!d.current())throw"The formula you typed contains an invalid char: '"+k+"' at index on "+g+".";e.add(d.pop());e.add(d.pop());h=g+1}else if(" "===k){k=g;for(g++;g<b&&" "===f.charAt(f.length-1);)g++;0<f.length&&":"!==f.charAt(f.length-1)&&g<b&&":"!==a.charAt(g)&&(e.add(new y(f,0,h)),f=
"",e.add(new y("",7,k)),h=g);g--}else if(g+2<=b&&"<"===k&&"="===a.charAt(g+1)||">"===k&&"="===a.charAt(g+1)||"<"===k&&">"===a.charAt(g+1))0<f.length&&(e.add(new y(f,0,h)),f=""),e.add(new y(a.slice(g,g+2),5,g,Y.Logical)),g++,h=g+1;else if("%"===k)0<f.length&&(e.add(new y(f,0,h)),f=""),e.add(new y(a.charAt(g),6,g)),h=g+1;else if("+"===k||"-"===k||"*"===k||"/"===k||"="===k||">"===k||"<"===k||"&"===k||"^"===k)0<f.length&&(e.add(new y(f,0,h)),f=""),e.add(new y(k,5,g)),h=g+1;else if("("===k)0<f.length?
(k=f.charAt(f.length-1),":"===k||k===this.listSeparator||" "===k?(f=f.slice(0,f.length-1),e.add(new y(f,0,h,Y.RangeOrName)),e.add(new y(k,5,g-1,Y.Nothing)),d.push(e.add(new y("",2,g,Y.Start)))):(k=f.indexOf(":"),l=":",-1===k&&(k=f.indexOf(this.listSeparator),l=this.listSeparator),-1===k&&(k=f.indexOf(" "),l=" "),-1!==k&&0<k&&(e.add(new y(f.substr(0,k),0,h,Y.RangeOrName)),e.add(new y(l,5,k,Y.Nothing)),f=f.slice(k+1)),d.push(e.add(new y(f.toUpperCase(),1,g,Y.Start)))),f=""):d.push(e.add(new y("",2,
g,Y.Start))),h=g+1;else if(k===this.listSeparator||k===this.arrayGroupSeparator)0<f.length&&(e.add(new y(f,0,h)),f=""),d.current()&&1===d.current().type?e.add(new y(this._arrayArgumentSepatator,3,g)):e.add(new y(this.listSeparator,5,g,Y.Union)),h=g+1;else if(")"===k){0<f.length&&(e.add(new y(f,0,h)),f="");if(!d.current())throw"The formula you typed contains an invalid char: '"+k+"' at index on "+g+".";e.add(d.pop());h=g+1}else":"===k?0===f.length&&e.getItem(e.count()-1).subType===Y.Stop?(e.add(new y(":",
5,g,Y.RangeOp)),h=g+1):f+=":":f+=k;else{0<f.length&&(e.add(new y(f,0,h)),f="");if(!d.current())throw"The formula you typed contains an invalid char: '"+k+"' at index on "+g+".";e.add(d.pop());e.add(new y(this.listSeparator,3,g));d.push(e.add(new y("ARRAYROW",1,g+1,Y.Start)));h=g+1}}0<f.length&&e.add(new y(f,0,h));return this._processTokens(e)},_processTokens:function(a){a=this._removeWhiteSpace(a);var b=[],e=new y("",8,0,Y.Start);b.push(e);for(var d;a.moveNext();){var f=a.current();if(f){var h=a.previous(),
g=a.next();0===f.type&&f.subType===Y.Nothing?(d=f.value.toUpperCase(),"TRUE"===d||"FALSE"===d?(f.subType=Y.Logical,f.value=d):f.subType=Y.RangeOrName):1===f.type&&0<f.value.length&&"@"===f.value.charAt(0)&&(f.value=f.value.substr(1));if(0===b.length)throw"invalid token at "+f.index+".";d=b[b.length-1];if("ARRAYROW"===d.value&&3!==f.type&&f.subType!==Y.Error&&f.subType!==Y.Stop&&f.subType!==Y.Logical&&f.subType!==Y.Number&&f.subType!==Y.Text&&4!==f.type)throw"Invalid array at"+f.index+".";switch(f.type){case 0:if(h&&
(0===h.type||6===h.type||1===h.type&&h.subType===Y.Stop||2===h.type&&h.subType===Y.Stop))throw"invalid token at "+f.index+".";break;case 1:case 2:if("ARRAY"===f.value&&1===f.type&&f.subType===Y.Start&&!h)break;else if(f.subType===Y.Stop&&(!h||4===h.type||5===h.type)||f.subType===Y.Start&&h&&(!g||6===h.type||h.subType===Y.Stop))throw"invalid token at "+f.index+".";if(f.subType===Y.Stop&&2===f.type&&h.subType===Y.Start)throw"invalid token at "+f.index+".";if(f.subType===Y.Stop&&1===f.type&&2===h.type&&
h.subType===Y.Start)throw"invalid token at "+f.index+".";break;case 3:if(!g||!h||5===h.type||4===h.type)throw"invalid token at "+f.index+".";break;case 4:if(!g||h&&6===h.type)throw"invalid token at "+f.index+".";break;case 5:if(!g||!h||5===h.type||4===h.type||3===h.type||1===h.type&&h.subType===Y.Start||2===h.type&&h.subType===Y.Start)throw"invalid token at "+f.index+".";break;case 6:if(!h||4===h.type||5===h.type||1===h.type&&h.subType===Y.Start||2===h.type&&h.subType===Y.Start)throw"invalid token at "+
f.index+".";break;default:throw"invalid token at "+f.index+".";}if(f.subType===Y.Start)b.push(f),d.children.push(f);else if(f.subType===Y.Stop){if(0===b.length)throw"The formula you typed contains an invalid char: '"+("ARRAY"===f.value||"ARRAYROW"===f.value?"}":")")+"' at "+f.index+".";b.pop()}else d.children.push(f)}}return e.children},_removeWhiteSpace:function(a){for(var b=new va;a.moveNext();){var e=a.current();if(e)if(7!==e.type)b.add(e);else if(!a.BOF()&&!a.EOF()){var d=a.previous(),f=a.next();
d&&f&&(1===d.type&&d.subType===Y.Stop||2===d.type&&d.subType===Y.Stop||0===d.type)&&(1===f.type&&f.subType===Y.Start||2===f.type&&f.subType===Y.Start||0===f.type)&&b.add(new y(" ",5,e.index,Y.Intersection))}}return b},_buildExpressionNode:function(a,b){var e;1===b.type?e="ARRAY"===b.value?this._buildArraryExpression(a,b):this._buildFunctionExpression(a,b):2===b.type?e=this._buildSubExpression(a,b):0===b.type&&(b.subType===Y.Number?e=new P(parseFloat(b.value),b.value):b.subType===Y.Error?e=new v(k.parse(b.value)):
b.subType===Y.Logical?B(b.value,"TRUE")?e=new T(!0):B(b.value,"FALSE")&&(e=new T(!1)):e=b.subType===Y.RangeOrName?this._buildCellReferenceOrNameExpressions(a,b):new ia(b.value));return e},_buildExpressionTree:function(a,b){var e=this._parseToBinaryOperatorList(a,b),d,f,h;for(h=3;h<e.length;){var g=e[h],k=e[h-2];if(g&&5===g.type){for(;3<=h&&Ra(g.value)>=Ra(k.value);)d=e[h-3],f=e[h-1],d=new fa(kb(k),d,f),e.splice(h-3,1),e.splice(h-3,1),e.splice(h-3,1),e.splice(h-3,0,d),h-=2,3<=h&&(k=e[h-2]);h+=2}else h++}if(1===
e.length)return e[0];for(h=e.length-2;0<h;h-=2)d=e[h-1],f=e[h+1],d=new fa(kb(e[h]),d,f),e.splice(h-1,1),e.splice(h-1,1),e.splice(h-1,1),e.push(d);return d},_parseToBinaryOperatorList:function(a,b){for(var e=[],d,f=0;f<b.length;f++){d=b[f];if(4===d.type){for(var h=[];4===d.type;)h.push("+"===d.value?ma.plus:ma.negate),f++,d=b[f];d=b[f];for(d=new ja(h.pop(),this._buildExpressionNode(a,d));0<h.length;)d=new ja(h.pop(),d)}else 6===d.type?(d=new ja(ma.percent,e[e.length-1]),e.pop()):5!==d.type&&(d=this._buildExpressionNode(a,
d));e.push(d)}return e},_buildFunctionExpression:function(a,b){for(var e=[],d=[],f=0;f<b.children.length;f++){var h=b.children[f];3!==h.type?d.push(h):0===d.length?e.push(new ba):(e.push(this._buildExpressionTree(a,d)),d=[])}0!==d.length?e.push(this._buildExpressionTree(a,d)):0!==b.children.length&&e.push(new ba);if(d=xa.findGlobalFunction(b.value)){if(e.length<d.minArgs||e.length>d.maxArgs)throw"Invalid function parameters at "+b.index;return new A(d,e)}return new A(b.value,e)},_buildSubExpression:function(a,
b){return new K(this._buildExpressionTree(a,b.children))},_buildArraryExpression:function(a,b){for(var e=[],d=-1,f,h=0;h<b.children.length;h++){f=b.children[h];var g=0===h?null:b.children[h-1];if(3===f.type){if(!g||3===g.type||h===b.children.length-1)throw"Invalid array at "+f.index;}else{if(g&&3!==g.type)throw"Invalid array at "+f.index;if(1!==f.type||"ARRAYROW"!==f.value)throw"Invalid array at "+f.index;if(-1!==d&&f.children.length!==d)throw"The length of array columns are unequal at "+f.index;
d=f.children.length;g=[];e.push(g);for(var k=f.children.length,l=null,n=0;n<k;n++){var F=f.children[n];if(3===F.type)l&&3!==l.type&&n!==k-1||g.push(ea.missingArgument);else{if(l&&3!==l.type)throw"Invalid array at "+f.index;if(4===F.type){if(n+1>=k)throw"Invalid array at "+f.index;l=f.children[n+1];l.value=""+F.value+l.value;F=l;n++}else n+1<k&&6===f.children[n+1].type&&(l=f.children[n+1],F.value=""+F.value+l.value,n++);(l=this._buildExpressionNode(a,F))&&g.push(l.value)}l=F}}}if(0===e.length||e[0]===
m||null===e[0]||0===e[0].length)throw"Invalid array at "+f.index;return new ga(e)},_buildCellReferenceOrNameExpressions:function(a,b){var e=b.value,d=this._buildCellReferenceOrNameExpressions2(a,e),f=d.endIndex,d=d.expression;if(!d)throw"Invalid cell reference or name at "+b.index+".";if(0>=f||f>=e.length)return d;if(":"!==e.charAt(f))throw"Invalid cell reference or name at "+b.index+".";f++;var h=[];for(h.push(d);f++&&f<e.length;){var g=f,d=this._buildCellReferenceOrNameExpressions2(a,e.substr(f)),
f=d.endIndex,d=d.expression;if(!d)throw"Invalid cell reference or name at "+b.index+".";h.push(d);f+=g;if(f<e.length&&":"!==e.charAt(f))throw"Invalid cell reference or name at "+b.index+".";f++}d=h[0];for(e=1;e<h.length;e++)d=new fa(ma.range,d,h[e]);return d},_buildCellReferenceOrNameExpressions2:function(a,b){if(b===m||null===b||""===b)return{endIndex:0,expression:null};var e=b.length;if(b.match("^#REF"))return{endIndex:e,expression:new v(pa)};var d="!"===b.charAt(0),f=d?1:0;if(1>e)return{endIndex:0,
expression:null};var h=-1,g="",k=0;if(d)h=f;else if("'"===b.charAt(0))h=b.indexOf("!")+1,g=b.substr(0,h-1);else{var l=b.indexOf("!"),n=b.indexOf(":");if(-1!==l){var F=b.substr(f,l-f);if(0>n||l<n)l<e-1&&(g=F,h=l+1);else{k=this._parseToCellReference(a,F,d);if(k.expression)return k;l<e-1&&(g=F,h=l+1);k=k.endIndex}}}n=F=l="";if(-1!==h&&g&&""!==g){f=this._readSheetReference(g,a.useR1C1,!1);if(!f.success)return{endIndex:k,expression:null};l=f.workBookName;F=f.startSheetName;n=f.endSheetName}else h=f;var B,
q,f=!1;if(l&&""!==l||F&&""!==F)if(f=!0,a.getExternalSource&&(B=a.getExternalSource(l,F),!B))return{endIndex:k,expression:new v(pa)};if(n&&""!==n&&(f=!0,a.getExternalSource&&(q=a.getExternalSource(l,n),!q)))return{endIndex:k,expression:new v(pa)};h=b.substr(h);k=this._parseToCellReference(a,h,d,B,q);B=k.expression;k=k.endIndex;if(B)if(!f||B instanceof x||B instanceof ra||B instanceof V||B instanceof N||B instanceof w)if(k<h.length-1){if(k=e-(h.length-1),":"!==b.charAt(k)){if(F&&""!==F){if(n&&""!==
n)return{endIndex:k,expression:null};if(!a.getExternalSource)return{endIndex:k,expression:new v(pa)};d=a.getExternalSource(l,F);if(!d)return{endIndex:k,expression:new v(pa)};B=new w(d,h)}else B=new L(h);k=e}}else k=e;else return{endIndex:e,expression:new v(pa)};else{if(d)B=new D(h);else if(F&&""!==F){if(n&&""!==n)return{endIndex:k,expression:null};if(!a.getExternalSource)return{endIndex:k,expression:new v(pa)};d=a.getExternalSource(l,F);if(!d)return{endIndex:k,expression:new v(pa)};B=new w(d,h)}else B=
new L(h);k=e}if(B instanceof L||B instanceof w)if(e=this._createStructExpression(h))B=e;else if(!this._validateName(h))return{endIndex:k,expression:null};return{endIndex:k,expression:B}},_parseToCellReference:function(a,b,e,d,f){var h=0;if("#"===b.charAt(0)){var g=jb(b,0),h=g.endIndex+1;if(g=k.parse(g.result))return{endIndex:h,expression:this._createExternalErrorExpression(g,e,d,f)}}b=a.useR1C1?this._isR1C1CellReferance(b,a.row,a.column):this._isA1CellReferance(b);h=Q.BAND_INDEX_CONST;if(b.success&&
a.useR1C1&&b.startRow!==h&&b.startColumn===h&&b.endRow===h&&b.endColumn===h)b.endRow=b.startRow,b.endRowRelative=b.startRowRelative;else if(b.success&&a.useR1C1&&b.startColumn!==h&&b.startRow===h&&b.endRow===h&&b.endColumn===h)b.endColumn=b.startColumn,b.endColumnRelative=b.startColumnRelative;else if(!b.success||b.startRow===h&&(b.startColumn===h||b.endColumn===h)||b.startColumn===h&&b.endRow===h)return{endIndex:b.endIndex,expression:null};a=this._createCellReferenceExpression(a,a.row,a.column,b.startRow,
b.startColumn,b.endRow,b.endColumn,b.startRowRelative,b.startColumnRelative,b.endRowRelative,b.endColumnRelative,e,d,f);return{endIndex:b.endIndex,expression:a}},_createExternalErrorExpression:function(a,b,e,d){return b?new R(a):e&&d?new N(e,d,a):e?new V(e,a):new v(a)},_createCellReferenceExpression:function(a,b,e,d,f,h,g,k,l,n,F,m,B,q){a=Q.BAND_INDEX_CONST;if(B&&q)return m=new x,d===a?m.initBand(B,q,f-(l?e:0),g-(F?e:0),l,F,!1):f===a?m.initBand(B,q,d-(k?b:0),h-(n?b:0),k,n,!0):(d-=k?b:0,f-=l?e:0,h-=
n?b:0,g-=F?e:0,m.init(B,q,d,f,h,g,k,l,n,F)),m;if(h===a&&g===a)return d-=k?b:0,f-=l?e:0,m?B||q?null:new oa(d,f,k,l):B?new ha(B,d,f,k,l):new da(d,f,k,l);if(m){if(B&&q)return null;m=new na;d===a?(f-=l?e:0,g-=F?e:0,m.initBand(f,g,l,F,!1)):f===a?(d-=k?b:0,h-=n?b:0,m.initBand(d,h,k,n,!0)):(d-=k?b:0,f-=l?e:0,h-=n?b:0,g-=F?e:0,m.init(d,f,h,g,k,l,n,F))}else B?(m=new ca,d===a?(f-=l?e:0,g-=F?e:0,m.initBand(B,f,g,l,F,!1)):f===a?(d-=k?b:0,h-=n?b:0,m.initBand(B,d,h,k,n,!0)):(d-=k?b:0,f-=l?e:0,h-=n?b:0,g-=F?e:0,
m.init(B,d,f,h,g,k,l,n,F))):(m=new X,d===a?(f-=l?e:0,g-=F?e:0,m.initBand(f,g,l,F,!1)):f===a?(d-=k?b:0,h-=n?b:0,m.initBand(d,h,k,n,!0)):(d-=k?b:0,f-=l?e:0,h-=n?b:0,g-=F?e:0,m.init(d,f,h,g,k,l,n,F)));return m},_readSheetReference:function(a,b,e){var d={},f=!1;"'"===a.charAt(0)&&"'"===a.charAt(a.length-1)&&(f=!0,a=a.substr(1,a.length-2));var h=a.indexOf("[");-1!==h&&(0!==h&&(d.workBookName=a.substr(0,h),"\\"!==d.workBookName.charAt(h-1)&&(d.workBookName+="\\")),h=Ka(a,h,"[","]"),d.workBookName+=h.result,
a=a.substr(h.endIndex+1));h=a.indexOf(":");-1===h?d.startSheetName=a:(d.startSheetName=a.substr(0,h),d.endSheetName=a.substr(h+1));if(!d.startSheetName||""===d.startSheetName)return d.success=!1,d;a=this._validateWorkbook(d.workBookName,f);a=this._validateSheetName(d.startSheetName,b,f);a&=this._validateSheetName(d.endSheetName,b,f);e&&(d.startSheetName&&(d.startSheetName=d.startSheetName.replace("'","''")),d.endSheetName&&(d.endSheetName=d.endSheetName.replace("'","''")));d.success=a;return d},_isStartWithCellReference:function(a,
b){return b?this._isR1C1CellReferance(a):this._isA1CellReferance(a)},_isA1CellReferance:function(a){var b=Q.BAND_INDEX_CONST,b={startRow:b,startColumn:b,endRow:b,endColumn:b,startRowRelative:!0,startColumnRelative:!0,endRowRelative:!0,endColumnRelative:!0,success:!1,endIndex:0};a=a.replace(" ","");var e=a.length,d=this._readOneA1Element(a,0);b.endIndex=d.endIndex;if(!d.success||b.endIndex>e)return b;if(d.isRow){b.startRow=d.elementIndex;b.startRowRelative=d.isRelative;if(":"===a.charAt(b.endIndex)){b.endIndex++;
d=this._readOneA1Element(a,b.endIndex);b.endIndex=d.endIndex;if(!d.success||!d.isRow)return b;b.endRow=d.elementIndex;b.endRowRelative=d.isRelative;b.success=!0}return b}b.startColumn=d.elementIndex;b.startColumnRelative=d.isRelative;if(":"===a.charAt(b.endIndex)){b.endIndex++;d=this._readOneA1Element(a,b.endIndex);b.endIndex=d.endIndex;if(!d.success||d.isRow)return b;b.endColumn=d.elementIndex;b.endColumnRelative=d.isRelative;b.success=!0;return b}if(z(a.charAt(b.endIndex))||"$"===a.charAt(b.endIndex)){d=
this._readOneA1Element(a,b.endIndex);b.endIndex=d.endIndex;if(!d.success||!d.isRow)return b;b.startRow=d.elementIndex;b.startRowRelative=d.isRelative;d=b.endIndex;if(b.endIndex<e-1&&":"===a.charAt(b.endIndex)){if("'"===a.charAt(b.endIndex+1))return b.success=!0,b;var e=a.indexOf("!",b.endIndex+1),f=a.indexOf(":",b.endIndex+1);if(-1!==e&&(-1===f||f>e))return b.success=!0,b;b.endIndex++;e=this._readOneA1Element(a,b.endIndex);if(!e.success||e.isRow)return b.endIndex=d,b.success=!0,b;b.endIndex=e.endIndex;
b.endColumn=e.elementIndex;b.endColumnRelative=e.isRelative;a=this._readOneA1Element(a,b.endIndex);if(a.success&&a.isRow)b.endIndex=a.endIndex;else return b.endIndex=d,b.success=!0,b;b.endRow=a.elementIndex;b.endRowRelative=a.isRelative}b.success=!0}return b},_isR1C1CellReferance:function(a,b,e){var d=Q.BAND_INDEX_CONST,d={startRow:d,startColumn:d,endRow:d,endColumn:d,startRowRelative:!0,startColumnRelative:!0,endRowRelative:!0,endColumnRelative:!0,success:!1,endIndex:0};a=a.replace(" ","");var f=
a.length,h=this._readOneR1C1Element(a,b,e,0);d.endIndex=h.endIndex;if(!h.success)return d;if(h.isRow){d.startRow=h.elementIndex;d.startRowRelative=h.isRelative;if(d.endIndex>=f)return d.success=!0,d;if(":"===a.charAt(d.endIndex)){d.endIndex++;h=this._readOneR1C1Element(a,b,e,d.endIndex);d.endIndex=h.endIndex;if(!h.success||!h.isRow)return d;d.endRow=h.elementIndex;d.endRowRelative=h.isRelative;d.success=!0;return d}}else{d.startColumn=h.elementIndex;d.startColumnRelative=h.isRelative;if(d.endIndex>=
f)return d.success=!0,d;if(":"===a.charAt(d.endIndex)){d.endIndex++;h=this._readOneR1C1Element(a,b,e,d.endIndex);d.endIndex=h.endIndex;if(!h.success||h.isRow)return d;d.endColumn=h.elementIndex;d.endColumnRelative=h.isRelative;d.success=!0}return d}if("C"===a.charAt(d.endIndex)||"c"===a.charAt(d.endIndex)){h=this._readOneR1C1Element(a,b,e,d.endIndex);d.endIndex=h.endIndex;if(!h.success||h.isRow)return d;d.startColumn=h.elementIndex;d.startColumnRelative=h.isRelative;h=d.endIndex;if(d.endIndex<f-1&&
":"===a.charAt(d.endIndex)){if("'"===a.charAt(d.endIndex+1))return d.success=!0,d;var f=a.indexOf("!",d.endIndex+1),g=a.indexOf(":",d.endIndex+1);if(-1!==f&&(-1===g||g>f))return d.success=!0,d;d.endIndex++;f=this._readOneR1C1Element(a,b,e,d.endIndex);if(f.success&&f.isRow)d.endIndex=f.endIndex;else return d.endIndex=h,d.success=!0,d;d.endRow=f.elementIndex;d.endRowRelative=f.isRelative;a=this._readOneR1C1Element(a,b,e,d.endIndex);if(!a.success||a.isRow)return d.endIndex=h,d.success=!0,d;d.endIndex=
a.endIndex;d.endColumn=a.elementIndex;d.endColumnRelative=a.isRelative}d.success=!0}return d},_readOneA1Element:function(a,b){var e={endIndex:b,elementIndex:Q.BAND_INDEX_CONST,isRow:!0,isRelative:!0,success:!1},d=a.length;if(b>=d)return e;"$"===a.charAt(b)&&(e.isRelative=!1,b++);if(b>=d)return e;var f=b,h=a.charAt(f);if(z(h)&&"0"!==h){for(e.isRow=!0;f<d&&z(h);)f++,f<d&&(h=a.charAt(f));d=parseInt(a.substr(b,f-b),10);1<=d&&d<=Q.maxRowCount&&(e.elementIndex=d-1,e.endIndex=f,e.success=!0)}else if(H(h)){for(e.isRow=
!1;f<d&&H(h);)f++,f<d&&(h=a.charAt(f));h=a.substr(b,f-b);if(3<h.length)return e;for(var h=h.toUpperCase(),d=0,g=h.length-1;0<=g;g--)d+=(h.charCodeAt(g)-65+1)*Za[h.length-g-1];d<=Q.maxColumnCount&&(e.elementIndex=d-1,e.endIndex=f,e.success=!0)}return e},_readOneR1C1Element:function(a,b,e,d){var f={endIndex:d,elementIndex:Q.BAND_INDEX_CONST,isRow:!0,isRelative:!1,success:!1},h=a.length;if(d>=h)return f;var g=d,k=a.charAt(g);if("R"===k||"r"===k)f.isRow=!0;else if("C"===k||"c"===k)f.isRow=!1,b=e;else return f;
d++;g++;if(d>=h)return f.endIndex=d,f.elementIndex=b,f.isRelative=!0,f.success=!0,f;k=a.charAt(g);"["===k&&(d++,g++,f.isRelative=!0);if(d>=h)return f;e=!1;k=a.charAt(g);f.isRelative&&"-"===k&&(d++,g++,e=!0);if(d>=h)return f;k=a.charAt(g);if(z(k)){for(;g<h&&z(k);)g++,g<h&&(k=a.charAt(g));d=parseInt(a.substr(d,g-d),10);if(f.isRelative){if(g>=h||"]"!==a.charAt(g))return f;g++}if(d<(f.isRow?Q.maxRowCount:Q.maxColumnCount))return f.elementIndex=f.isRelative?(e?-d:d)+b:d-1,f.endIndex=g,f.success=!0,f}else return f.isRelative||
(f.endIndex=d,f.elementIndex=b,f.isRelative=!0,f.success=!0),f},_validateWorkbook:function(a,b){if(a===m||null===a||""===a)return!0;for(var e,d=0;d<a.length;d++)if(e=a[d],b){if("*"===e||":"===e||"["===e||"]"===e||"?"===e||"'"===e&&(0===d||d>=a.length-1||"'"!==a.charAt(d+1)))return!1}else if("'"===e||"["===e||"]"===e||"?"===e||"%"===e||-1!==this._operatorInfix.indexOf(e))return!1;return!0},_validateSheetName:function(a,b,e){if(a===m||null===a||""===a)return!0;if(!e&&O(a.charAt(0)))return!1;b=this._isStartWithCellReference(a,
b);if(!e&&b.success&&b.endIndex===a.length)return!1;for(var d=0;d<a.length;d++)if(b=a.charAt(d),e){if("*"===b||":"===b||"["===b||"]"===b||"?"===b||"\\"===b||"/"===b)return!1}else if("'"===b||"["===b||"]"===b||"?"===b||"\\"===b||"%"===b||'"'===b||-1!==this._operatorInfix.indexOf(b))return!1;return!0},_createStructExpression:function(a){return"]"===a.charAt(a.length-1)?new qa(a):null},_validateName:function(a){if(a===m||null===a||""===a||1===a.length&&("R"===a||"r"===a||"C"===a||"c"===a))return!1;var b=
a.charAt(0);if("_"!==b&&"\\"!==b&&!H(b)&&!G(b))return!1;for(var e=1;e<a.length;e++)if(b=a.charAt(e),"_"!==b&&"\\"!==b&&"?"!==b&&"."!==b&&!C(b)&&!G(b))return!1;return!0}};ea.Parser=Q;Sa.prototype={getValue:function(a,b,e){return a?a.getValue(b,e):pa},getReference:function(a,b,e,d,f){return a?a.getReference(b,e,d,f):pa},getFunction:function(a){return this.source&&this.source.getFunction?this.source.getFunction(a):null},getName:function(a){return this.source&&this.source.getName?this.source.getName(a,
this.row,this.column):null},_expandArrayToMultiCallCount:0,_isExpandArrayToMultiCall:function(){return 0<this._expandArrayToMultiCallCount},_beginExpandArrayToMultiCall:function(){this._expandArrayToMultiCallCount++},_endExpandArrayToMultiCall:function(){this._expandArrayToMultiCallCount--},_offset:function(a,b){return new Sa(this.source,this.arrayFormulaMode,this.row+a,this.column+b,this.rowCount,this.columnCount)}};ea.EvaluateContext=Sa;var vb=new Q;bb.prototype={evaluateFormula:function(a,b,e){return this.evaluateExpression(vb.parse(a,
b),e)},evaluateExpression:function(a,b){return this._evaluate(a,b,!1,!1)},_evaluate:function(a,b,e,d){if(!a)throw"Argument expr is null";for(;a instanceof K;)a=a.argument;if(a instanceof M)return this._evaluateConst(a,b,e);if(a instanceof la)return this._evaluateReference(a,b,d);if(a instanceof w){var f,h=null;if(f=a.source.getCalcService())h=f._getEvaluatorContext4Cell(a.source._sheet,b.row,b.column,b.arrayFormulaMode);return h?this._evaluateName(a.name,h,b,e,d):Qa}if(a instanceof L)return this._evaluateName(a.name,
b,b,e,d);if(a instanceof ja)return this._evaluateUnaryOperation(a,b,e);if(a instanceof fa)return this._evaluateBinaryOperation(a,b,e);if(a instanceof A)return this._evaluateFunction(a,b,e,d);throw"Not supported";},_extractValueFromReference:function(a,b,e){if(a instanceof q&&1!==a.getSheetCount())return pa;var d=a.getRowCount(0),f=a.getColumnCount(0);if(0>=a.getRangeCount()||0>=d||0>=f)return pa;try{if(1!==a.getRangeCount()||1<d&&1<f)return ya;var h=b-a.getRow(0),g=e-a.getColumn(0);return 1===d&&
1===f?a.getValue(0,0,0):1===d&&1===f&&0<=g&&g<f?a.getValue(0,0,g):1<d&&1===f&&0<=d&&h<d?a.getValue(0,h,0):ya}catch(k){return ya}},_evaluateConst:function(a,b,e){a=a.value;return a instanceof g?e||b&&(b.arrayFormulaMode||b._isExpandArrayToMultiCall())?a:za.getArrayValue(a,0,0):a},_evaluateReference:function(a,b,e){if(!b)return ya;if(a instanceof qa)return pa;var d=b.source;a instanceof ra&&(d=a.source);var f=a.getRange(b.row,b.column);if(e||b.arrayFormulaMode)return b.getReference(d,f.row,f.column,
f.rowCount,f.columnCount);e=f.row;var h=f.column;if(1<f.rowCount&&a.startRowRelative&&a.endRowRelative||1<f.columnCount&&a.startColumnRelative&&a.endColumnRelative){a=b.row>=f.row&&b.row<f.row+f.rowCount;var g=b.column>=f.column&&b.column<f.column+f.columnCount;if(a||g)if(a&&!g&&1===f.columnCount)e=b.row;else if(!a&&g&&1===f.rowCount)h=b.column;else if(1===f.rowCount||1===f.columnCount)e=b.row,h=b.column;else return pa;else return pa}else if(-1===f.row&&-1===f.rowCount){if(1!==f.columnCount)return pa;
e=b.row}else if(-1===f.column&&-1===f.columnCount){if(1!==f.rowCount)return pa;h=b.column}return b.getValue(d,e,h)},_evaluateName:function(a,b,e,d,f){return b&&e?(a=b.getName(a))?this._evaluate(a,e,d,f):Qa:Qa},_evaluateOperationArg:function(a,b,e,d){a=this._evaluate(a,b,e,d);return a instanceof k?a:a===ea.missingArgument?hb:a},_evaluateUnaryOperation:function(a,b,e){e=this._evaluateOperationArg(a.operand,b,e,!1);try{return a.operator.evaluate(e,b)}catch(d){return ya}},_evaluateBinaryOperation:function(a,
b,e){var d=this._evaluateOperationArg(a.left,b,e,a.operator.acceptsReference);if(d instanceof k)return d;e=this._evaluateOperationArg(a.right,b,e,a.operator.acceptsReference);if(e instanceof k)return e;try{return a.operator.evaluate(d,e,b)}catch(f){return ya}},_evaluateFunction:function(a,b,e,d){var f=this._prepareFunctionArguments(a,b);if(!(f&&f.success&&f.fn&&f.args))return f.error;a=a.argCount();var h=f.args,k=f.fn;if(b&&b.arrayFormulaMode)return 0<a?this._evaluateFunctionWithArrayFormulaMode(k,
h,b,e,d):this._evaluateFunctionImp(k,h,b,e,d,0,0);f=f.arrayIndex;if(b&&b._isExpandArrayToMultiCall()&&f&&0<f.length){var l=[],n;for(n=0;n<a;n++)if(f.contains(n)){var F=h[n];F instanceof g?1===F.length()?l[n]=F.getValueByIndex(0):l[n]=F:l[n]=null}for(n=0;n<f.length;n++)h[f[n]]=l[f[n]]}return this._evaluateFunctionImp(k,h,b,e,d,0,0)},_tryGetFunction:function(a,b){var e=a.argCount(),d=a.fn;if(!(d instanceof xa.Function)){if(!b)return{success:!1,error:Qa};d=b.getFunction(d);if(!(d&&d instanceof xa.Function))return{success:!1,
error:Qa};if(e<d.minArgs||d.maxArgs<e)return{success:!1,error:ya}}return{success:!0,fn:d}},_evaluateFunctionWithArrayFormulaMode:function(a,b,e,d,f){return b&&0!==b.length?1===a.maxArgs?this._evaluateFunctionOneArg(a,b[0],e,d,f):this._evaluateFunctionTwoOrMoreArgs(a,b,e,d,f):this._evaluateFunctionImp(a,b,e,d,f,0,0)},_evaluateFunctionTwoOrMoreArgs:function(b,e,d,f,h){var k=e.length,l=[],n=!0,F,B;for(F=0;F<k;F++){var q=b.acceptsReference&&b.acceptsReference(F),s=za.tryExtractToSingleValue(e[F]);B=q||
s.success;n=n&&B;l[F]=B;q||(e[F]=s.value)}if(n)return this._evaluateFunctionImp(b,e,d,f,h,0,0);q=[];s=[];for(F=0;F<k;F++)n=e[F]instanceof g,q[F]=l||!n?-1:e[F].getRowCount(),s[F]=l||!B?-1:e[F].getColumnCount();n=B=-1;for(F=0;F<k;F++)if(!l[F]){var r=q[F],U=s[F];B=-1===B?r:1<r?1<B?Math.min(r,B):r:B;n=-1===n?U:1<U?1<n?Math.min(U,n):U:n}q=[];d._beginExpandArrayToMultiCall();for(F=0;F<B;F++){s=q[F];if(s===m||null===s)q[F]=s=[];for(r=0;r<n;r++){for(var U=[],t=0;t<k;t++)U[t]=l[t]?e[t]:za.getArrayValue(e[t],
F,r);s[r]=this._evaluateFunctionImp(b,U,d,f,h,F,r)}}d._endExpandArrayToMultiCall();return new a(q,B,n)},_evaluateFunctionOneArg:function(b,e,d,f,h){if(b.acceptsReference(0))return this._evaluateFunctionImp(b,[e],d,f,h,0,0);e=za.tryExtractToSingleValue(e);if(e.success)return this._evaluateFunctionImp(b,[e.value],d,f,h,0,0);e=e.value;for(var g=[],k=e.getRowCount(),l=e.getColumnCount(),n=0;n<k;n++){var F=g[n];if(F===m||null===F)g[n]=F=[];for(var B=0;B<l;B++)F[B]=this._evaluateFunctionImp(b,[e.getValue(n,
B)],d,f,h,B,B)}return new a(g,k,l)},_evaluateFunctionImp:function(a,b,e,d,f,h,k){try{var l=0!==h&&0!==k?e?e._offset(h,k):null:e,n=a.isContextSensitive()?a.evaluate(b,l):a.evaluate(b);n instanceof s?l&&(l.arrayFormulaMode?e._isExpandArrayToMultiCall()&&(n=za.getArrayValue(Z._toArray(n),h,k)):f||(n=this._extractValueFromReference(n,l.row,l.column))):n instanceof g&&(e?e.arrayFormulaMode?e._isExpandArrayToMultiCall()&&(n=za.getArrayValue(n,h,k)):!d&&e._isExpandArrayToMultiCall()&&(n=za.getArrayValue(n,
h,k)):n=za.getArrayValue(n,h,k));return n}catch(F){return ya}},_prepareFunctionArguments:function(a,b){var e=this._tryGetFunction(a,b);if(!e.success)return e;var e=e.fn,d=[],f=a.argCount(),h=[],l,n,F;if(e.isBranch()){l=e.findTestArgument();if(0<=l&&l<f){F=this._evaluateFunctionArgument(a.getArg(l),b,e.acceptsArray(l),e.acceptsReference(l),e.acceptsError(l),e.acceptsMissingArgument(l));n=F.value;if(!F.success)return{success:!1,error:n};if(b&&!b.arrayFormulaMode)if(n instanceof s){n=this._extractValueFromReference(n,
b.row,b.column);if(!e.acceptsError(l)&&n instanceof k)return{success:!1,error:n};e.acceptsMissingArgument(l)||n!==ea.missingArgument||(n=null)}else if(n instanceof g&&!e.acceptsArray(l))if(b._isExpandArrayToMultiCall())d.push(l);else{n=za.getArrayValue(n,0,0);if(!e.acceptsError(l)&&n instanceof k)return{success:!1,error:n};e.acceptsMissingArgument(l)||n!==ea.missingArgument||(n=null)}h[l]=n}var m=[];l=Z._toArray(h[l]);n=l.getRowCount();F=l.getColumnCount();for(var B=0;B<n;B++)for(var q=0;q<F;q++){var r=
e.findBranchArgument(l.getValue(B,q));if(-1!==r&&(m.contains(r)||m.push(r),m.length>=e.maxArgs-1))break}if(0===m.length)return{success:!1,error:ya};for(l=0;l<m.length;l++)if(B=m[l],0<=B&&B<f){F=this._evaluateFunctionArgument(a.getArg(B),b,e.acceptsArray(B),e.acceptsReference(B),e.acceptsError(B),e.acceptsMissingArgument(B));n=F.value;if(!F.success)return{success:!1,error:n};if(b&&b.arrayFormulaMode&&n instanceof g&&!e.acceptsArray(B))if(b._isExpandArrayToMultiCall())d.push(B);else{n=za.getArrayValue(n,
0,0);if(!e.acceptsError(B)&&n instanceof k)return{success:!1,error:n};e.acceptsMissingArgument(B)||n!==ea.missingArgument||(n=null)}h[B]=n}0<d.length&&d.sort(function(a,b){return a-b})}else for(l=0;l<f;l++){F=this._evaluateFunctionArgument(a.getArg(l),b,e.acceptsArray(l),e.acceptsReference(l),e.acceptsError(l),e.acceptsMissingArgument(l));n=F.value;if(!F.success)return{success:!1,error:n};if(b&&b.arrayFormulaMode&&n instanceof g&&!e.acceptsArray(l))if(b._isExpandArrayToMultiCall())d.push(l);else{n=
za.getArrayValue(n,0,0);if(!e.acceptsError(l)&&n instanceof k)return{success:!1,error:n};e.acceptsMissingArgument(l)||n!==ea.missingArgument||(n=null)}h[l]=n}return{success:!0,args:h,fn:e,arrayIndex:d}},_evaluateFunctionArgumentImp:function(a,b,e,d,f,h){a=this._evaluate(a,b,e,d);if(!f&&a instanceof k)return{success:!1,value:a};if(!h&&a===ea.missingArgument)return{success:!0,value:null};if(b&&b.arrayFormulaMode){if(a instanceof g&&!e&&!b._isExpandArrayToMultiCall())return 0<a.length()?{success:!0,
value:a.getValueByIndex(0)}:{success:!1,value:hb};if(a instanceof s&&!d){a=this._extractValueFromReference(a,0,0);if(a===m||null===a)a=0;if(!f&&a instanceof k)return{success:!1,value:a};if(!h&&a===ea.missingArgument)return{success:!0,value:null}}}return{success:!0,value:a}},_evaluateFunctionArgument:function(a,b,e,d,f,h){return b&&(e||b._isExpandArrayToMultiCall())&&!b.arrayFormulaMode?(b._beginExpandArrayToMultiCall(),a=this._evaluateFunctionArgumentImp(a,b,e,d,f,h),b._endExpandArrayToMultiCall(),
a):this._evaluateFunctionArgumentImp(a,b,e,d,f,h)}};ea.Evaluator=bb;var cb="intersects",db="contains",Ha="cellListeners",Ia="rowListeners",Ja="columnListeners",eb="rowSliceListeners",fb="columnSliceListeners";Ua.prototype={hasListeners:function(){var a;a:{a=this._listeners;for(var b=0;b<a.length;b++)if(this.hasOwnProperty(a[b])&&0<this[a[b]].length){a=!0;break a}a=!1}return a},addCellListener:function(a){La(this,Ha,a)},removeCellListener:function(a){Ma(this,Ha,a)},addRowListener:function(a){La(this,
Ia,a)},removeRowListener:function(a){Ma(this,Ia,a)},addColumnListener:function(a){La(this,Ja,a)},removeColumnListener:function(a){Ma(this,Ja,a)},addListenersToAdjust:function(){Ta(this,this._listeners,"addToAdjust")},addListenersToDirty:function(){Ta(this,this._listeners,"addToDirty")},incrementDelayOfListeners:function(){Ta(this,this._listeners,"incrementDelay")},decrementDelayOfListeners:function(){Ta(this,this._listeners,"decrementDelay")}};Na.prototype=new Ua;Na.prototype.incrementDelay=function(){this.delay+=
1};Na.prototype.decrementDelay=function(){this.delay-=1};Na.prototype.startListening=function(){this.sheetSource.linkCellExpression(this.row,this.column,1,1)};Na.prototype.stopListening=function(){this.sheetSource.unlinkCellExpression(this.row,this.column,1,1)};Na.prototype.addToAdjust=function(){this.sheetSource._controller.addAdjustCell(this)};Na.prototype.addToDirty=function(){this.sheetSource._controller.addDirtyCell(this)};Ca.prototype=new Ua;Ca.prototype.incrementDelay=function(){this.sheetSource.incrementDelay(this.row,
-1,1,-1)};Ca.prototype.incrementDelay2=function(a,b){this.sheetSource.incrementDelay(this.row,a,1,b)};Ca.prototype.decrementDelay=function(){this.sheetSource.decrementDelay(this.row,-1,1,-1)};Ca.prototype.decrementDelay2=function(a,b){this.sheetSource.decrementDelay(this.row,a,1,b)};Ca.prototype.startListening=function(){this.sheetSource.linkRowExpression(this.row,1)};Ca.prototype.stopListening=function(){this.sheetSource.unlinkRowExpression(this.row,1)};Ca.prototype.addRowListener2=function(a,b){La(this,
eb,{row:a,columnOffset:b,columnCount:1})};Ca.prototype.removeRowListenser2=function(a,b){Ma(this,eb,{row:a,columnOffset:b,columnCount:1})};Ca.prototype.addToAdjust=function(){this.sheetSource._controller.addAdjustRow(this)};Ca.prototype.addToDirty=function(){this.sheetSource._controller.addDirtyRow(this)};Da.prototype=new Ua;Da.prototype.incrementDelay=function(){this.sheetSource.incrementDelay(-1,this.column,-1,1)};Da.prototype.incrementDelay2=function(a,b){this.sheetSource.incrementDelay(a,this.column,
b,1)};Da.prototype.decrementDelay=function(){this.sheetSource.decrementDelay(-1,this.column,-1,1)};Da.prototype.decrementDelay2=function(a,b){this.sheetSource.decrementDelay(a,this.column,b,1)};Da.prototype.startListening=function(){this.sheetSource.linkColumnExpression(this.column,1)};Da.prototype.stopListening=function(){this.sheetSource.unlinkColumnExpression(this.column,1)};Da.prototype.addColumnListener2=function(a,b){La(this,fb,{column:a,rowOffset:b,rowCount:1})};Da.prototype.removeColumnListenser2=
function(a,b){Ma(this,fb,{column:a,rowOffset:b,rowCount:1})};Da.prototype.addToAdjust=function(){this.sheetSource._controller.addAdjustColumn(this)};Da.prototype.addToDirty=function(){this.sheetSource._controller.addDirtyColumn(this)};Pa.prototype=new Ua;Pa.prototype.incrementDelay=function(){this.delay+=1};Pa.prototype.decrementDelay=function(){this.delay-=1};Pa.prototype.updateListening=function(a,b){var e=this;l(this._listeners).each(function(d,f){e[f]&&l(e[f]).each(function(e,d){a&&d.stopListening();
b&&d.startListening()})})};Pa.prototype.addToDirty=function(){Ta(this,this._listeners,"addToDirty")};mb.prototype={addCellListener:function(a,b,e,d,f){La(this,Ha,{type:"cell",row:a,column:b,rowCount:e,columnCount:d,listener:f})},removeCellListener:function(a,b,e,d,f){Ma(this,Ha,{type:"cell",row:a,column:b,rowCount:e,columnCount:d,listener:f})},addRowListener:function(a,b,e,d,f,h,g,k){La(this,Ia,{type:"row",row:a,column:b,rowCount:e,columnCount:d,listener:f})},removeRowListener:function(a,b,e,d,f,
h,g,k){Ma(this,Ia,{type:"row",row:a,column:b,rowCount:e,columnCount:d,listener:f})},addColumnListener:function(a,b,e,d,f,h,g,k){La(this,Ja,{type:"column",row:a,column:b,rowCount:e,columnCount:d,listener:f})},removeColumnListener:function(a,b,e,d,f,h,g,k){Ma(this,Ja,{type:"column",row:a,column:b,rowCount:e,columnCount:d,listener:f})},addListenersToAdjust:function(a,b,e,d){Xa(this,this._listeners,{action:cb,row:a,column:b,rowCount:e,columnCount:d},"addToAdjust")},addListenersToDirty:function(a,b,e,
d){Xa(this,this._listeners,{action:cb,row:a,column:b,rowCount:e,columnCount:d},"addToDirty")},incrementDelayOfListeners:function(a,b){Xa(this,this._listeners,{action:db,row:a,column:b},"incrementDelay")},decrementDelayOfListeners:function(a,b){Xa(this,this._listeners,{action:db,row:a,column:b},"decrementDelay")}};gb.prototype={getRowOffset:function(){return this._toRow-this._fromRow},getColumnOffset:function(){return this._toColumn-this._fromColumn},sourceContains:function(a,b,e,d,f){return this._fromModel===
a&&(-1===this._fromRow||this._fromRow<=b&&b+d<=this._fromRow+this._rowCount)&&(-1===this._fromColumn||this._fromColumn<=e&&e+f<=this._fromColumn+this._columnCount)},destinationContains:function(a,b,e,d,f){return this._toModel===a&&(-1===this._toRow||this._toRow<=b&&b+d<=this._toRow+this._rowCount)&&(-1===this._toColumn||this._toColumn<=e&&e+f<=this._toColumn+this._columnCount)},sourceIntersectWith:function(a,b,e,d,f){if(this._toModel!==a)return null;b=this._createValidCellRange(a,b,e,d,f);return this._createValidCellRange(a,
this._fromRow,this._fromColumn,d,f).intersectWith(b)},_createValidCellRange:function(a,b,e,d,f){return{row:-1===b?0:b,column:-1===e?0:e,rowCount:-1===b||-1===d?a.rowCount:d,columnCount:-1===e||-1===f?a.columnCount:f,intersectWith:nb}}};Ya.prototype={autoCalculation:!0,iteration:!1,maximumIterations:1,maximumChange:0.01,attachDataModel:function(a){this._dataModels.contains(a)||this._dataModels.push(a)},detachDataModel:function(a){for(var b=null,e=this._headDirtyCells;e;e=b)b=e.nextDirty,e.sheetSource===
a&&this.removeDirtyCell(e);b=null;for(e=this._headDirtyRows;e;e=b)b=e.nextDirty,e.sheetSource===a&&this.removeDirtyRow(e);b=null;for(e=this._headDirtyColumns;e;e=b)b=e.nextDirty,e.sheetSource===a&&this.removeDirtyColumn(e);for(b=0;b<this._dataModels.length;b++)if(this._dataModels[b]===a){this._dataModels.splice(b,1);break}},addCustomFunctions:function(a){if(!(a===m||null===a||0>=a.length))for(var b=0;b<a.length;b++)this._customFunctions.push(a[b])},addCustomNames:function(a){if(!(a===m||null===a||
0>=a.length))for(var b=0;b<a.length;b++)this._customNames.push(a[b])},isDirtyCell:function(a){return a.previousDirty||a===this._headDirtyCells},addDirtyCell:function(a){a&&!this.isDirtyCell(a)&&a.row<a.sheetSource.getRowCount()&&a.column<a.sheetSource.getColumnCount()&&(this._headDirtyCells?this._tailDirtyCells.nextDirty=a:this._headDirtyCells=a,a.previousDirty=this._tailDirtyCells,a.nextDirty=null,this._tailDirtyCells=a)},removeDirtyCell:function(a){if(this.isDirtyCell(a)){var b=a.previousDirty,
e=a.nextDirty;b?b.nextDirty=e:this._headDirtyCells=e;e?e.previousDirty=b:this._tailDirtyCells=b;a.previousDirty=null;a.nextDirty=null}},isDirtyRow:function(a){return a.previousDirty||a===this._headDirtyRows},addDirtyRow:function(a){a&&!this.isDirtyRow(a)&&a.row<a.sheetSource.getRowCount()&&(this._headDirtyRows?this._tailDirtyRows.nextDirty=a:this._headDirtyRows=a,a.previousDirty=this._tailDirtyRows,a.nextDirty=null,this._tailDirtyRows=a)},removeDirtyRow:function(a){if(this.isDirtyRow(a)){var b=a.previousDirty,
e=a.nextDirty;b?b.nextDirty=e:this._headDirtyRows=e;e?e.previousDirty=b:this._tailDirtyRows=b;a.previousDirty=null;a.nextDirty=null}},isDirtyColumn:function(a){return a.previousDirty||a===this._headDirtyColumns},addDirtyColumn:function(a){a&&!this.isDirtyColumn(a)&&a.column<a.sheetSource.getColumnCount()&&(this._headDirtyColumns?this._tailDirtyColumns.nextDirty=a:this._headDirtyColumns=a,a.previousDirty=this._tailDirtyColumns,a.nextDirty=null,this._tailDirtyColumns=a)},removeDirtyColumn:function(a){if(this.isDirtyColumn(a)){var b=
a.previousDirty,e=a.nextDirty;b?b.nextDirty=e:this._headDirtyColumns=e;e?e.previousDirty=b:this._tailDirtyColumns=b;a.previousDirty=null;a.nextDirty=null}},isVolatileCell:function(a){return a.previousVolatile||a===this._headVolatileCells},addVolatileCell:function(a){a&&!this.isVolatileCell(a)&&a.row<a.sheetSource.getRowCount()&&a.column<a.sheetSource.getColumnCount()&&(this._headVolatileCells?this._tailVolatileCells.nextDirty=a:this._headVolatileCells=a,a.previousDirty=this._tailVolatileCells,a.nextDirty=
null,this._tailVolatileCells=a)},removeVolatileCell:function(a){if(this.isVolatileCell(a)){var b=a.previousDirty,e=a.nextDirty;b?b.nextDirty=e:this._headVolatileCells=e;e?e.previousDirty=b:this._tailVolatileCells=b;a.previousDirty=null;a.nextDirty=null}},isAdjustCell:function(a){return a.previousAdjust||a===this._headAdjustCells},addAdjustCell:function(a){a&&!this.isAdjustCell(a)&&a.row<a.sheetSource.getRowCount()&&a.column<a.sheetSource.getColumnCount()&&(this._headAdjustCells?this._tailAdjustCells.nextAdjust=
a:this._headAdjustCells=a,a.previousAdjust=this._tailAdjustCells,a.nextAdjust=null,this._tailAdjustCells=a)},removeAdjustCell:function(a){if(this.isAdjustCell(a)){var b=a.previousAdjust,e=a.nextAdjust;b?b.nextAdjust=e:this._headAdjustCells=e;e?e.previousAdjust=b:this._tailAdjustCells=b;a.previousAdjust=null;a.nextAdjust=null}},isAdjustRow:function(a){return a.previousAdjust||a===this._headAdjustRows},addAdjustRow:function(a){a&&!this.isAdjustRow(a)&&a.row<a.sheetSource.getRowCount()&&(this._headAdjustRows?
this._tailAdjustRows.nextAdjust=a:this._headAdjustRows=a,a.previousAdjust=this._tailAdjustRows,a.nextAdjust=null,this._tailAdjustRows=a)},removeAdjustRow:function(a){if(this.isAdjustRow(a)){var b=a.previousAdjust,e=a.nextAdjust;b?b.nextAdjust=e:this._headAdjustRows=e;e?e.previousAdjust=b:this._tailAdjustRows=b;a.previousAdjust=null;a.nextAdjust=null}},isAdjustColumn:function(a){return a.previousAdjust||a===this._headAdjustColumns},addAdjustColumn:function(a){a&&!this.isAdjustColumn(a)&&a.column<a.sheetSource.getColumnCount()&&
(this._headAdjustColumns?this._tailAdjustColumns.nextAdjust=a:this._headAdjustColumns=a,a.previousAdjust=this._tailAdjustColumns,a.nextAdjust=null,this._tailAdjustColumns=a)},removeAdjustColumn:function(a){if(this.isAdjustColumn(a)){var b=a.previousAdjust,e=a.nextAdjust;b?b.nextAdjust=e:this._headAdjustColumns=e;e?e.previousAdjust=b:this._tailAdjustColumns=b;a.previousAdjust=null;a.nextAdjust=null}},recalculate:function(){for(var a=null,b=!1,e,d,f,h,g,k;this._headVolatileCells;)this.addDirtyCell(this._headVolatileCells),
this.removeVolatileCell(this._headVolatileCells);for(;this._headDirtyRows;){e=this._headDirtyRows.sheetSource;b=e.getColumnCount();for(d=0;d<b;d++)this.addDirtyCell(e._getCellCalc(this._headDirtyRows.row,d,!0));this.removeDirtyRow(this._headDirtyRows)}for(;this._headDirtyColumns;){e=this._headDirtyColumns.sheetSource;d=e.getRowCount();for(b=0;b<d;b++)this.addDirtyCell(e._getCellCalc(b,this._headDirtyColumns.column,!0));this.removeDirtyColumn(this._headDirtyColumns)}for(f=this._headDirtyCells;f;f=
f.nextDirty){e=f.sheetSource;b=f.row;d=f.column;h=e._getRowCalc(b,!1);g=e._getColumnCalc(d,!1);k=e._getRangeCalc(!1);f.addListenersToDirty();h&&h.addListenersToDirty(d);g&&g.addListenersToDirty(b);for(k&&k.addListenersToDirty(b,d,1,1);this._headDirtyRows;){e=this._headDirtyRows.sheetSource;b=e.getColumnCount();for(d=0;d<b;d++)this.addDirtyCell(e._getCellCalc(this._headDirtyRows.row,d,!0));this.removeDirtyRow(this._headDirtyRows)}for(;this._headDirtyColumns;){e=this._headDirtyColumns.sheetSource;d=
e.getRowCount();for(b=0;b<d;b++)this.addDirtyCell(e._getCellCalc(b,this._headDirtyColumns.column,!0));this.removeDirtyColumn(this._headDirtyColumns)}}for(f=this._headDirtyCells;f;f=a)e=f.sheetSource,a=f.nextDirty,f.row<e.getRowCount()&&f.column<e.getColumnCount()?f.delay=0:this.removeDirtyCell(f);for(f=this._headDirtyCells;f;f=f.nextDirty)e=f.sheetSource,b=f.row,d=f.column,h=e._getRowCalc(b,!1),g=e._getColumnCalc(d,!1),k=e._getRangeCalc(!1),f.incrementDelayOfListeners(),h&&h.incrementDelayOfListeners(d),
g&&g.incrementDelayOfListeners(b),k&&k.incrementDelayOfListeners(b,d);do for(b=!1,f=this._headDirtyCells;f;f=a)a=f.nextDirty,0===f.delay&&(e=f.sheetSource,b=f.row,d=f.column,h=e._getRowCalc(b,!1),g=e._getColumnCalc(d,!1),k=e._getRangeCalc(!1),e.recalculateCell(b,d),this.removeDirtyCell(f),f.decrementDelayOfListeners(),h&&h.decrementDelayOfListeners(d),g&&g.decrementDelayOfListeners(b),k&&k.decrementDelayOfListeners(b,d),b=!0);while(b);if(this.iteration&&this._headDirtyCells)for(e=!0,h=0;e&&h<this.maximumIterations;h++)for(e=
!1,f=this._headDirtyCells;f;f=f.nextDirty)k=f.sheetSource,b=f.row,d=f.column,g=k.getValue(b,d),k.recalculateCell(b,d),b=k.getValue(b,d),this._iterationChange(g,b)>=this.maximumChange&&(e=!0)},_iterationChange:function(a,b){var e=parseFloat(a),d=parseFloat(b);return Math.abs(d-e)},clearDirties:function(){this._tailVolatileCells=this._headVolatileCells=this._tailDirtyColumns=this._headDirtyColumns=this._tailDirtyRows=this._headDirtyRows=this._tailDirtyCells=this._headDirtyCells=this._tailAdjustColumns=
this._headAdjustColumns=this._tailAdjustRows=this._headAdjustRows=this._tailAdjustCells=this._headAdjustCells=null},_adjustIndexOnAdd:function(a,b,e,d,f,h,g,k){return 0<=e||!f?(d+=f?e:0,h===a&&g+k<=e&&(d-=f?k:0),h===b&&g<=d&&(d+=k),d-(f?e:0)):d},_adjustCellExpressionOnAddRow:function(a,b,e,d,f,h,g,k){return b&&(d=f.rowRelative,0<=e||!d)&&(e=this._adjustIndexOnAdd(a,b,e,f.row,f.rowRelative,h,g,k),e!==f.row)?a===b?new da(e,f.column,d,f.columnRelative):new ha(b,e,f.column,d,f.columnRelative):f},_adjustRangeExpressionOnAddRow:function(a,
b,e,d,f,h,g,k){if(b){var l=f._getRangeType();if(3===l||2===l)return f;d=f.startRowRelative;var n=f.endRowRelative;if(0<=e||!d||!n){var F=this._adjustIndexOnAdd(a,b,e,f.startRow,d,h,g,k);e=this._adjustIndexOnAdd(a,b,e,f.endRow,n,h,g,k);return 1===l?(a===b?(a=new X,a.initBand(F,e,d,n,!0)):(a=new ca,a.initBand(b,F,e,d,n,!0)),a):a===b?new X(F,f.startColumn,e,f.endColumn,d,f.startColumnRelative,n,f.endColumnRelative):new ca(b,F,f.startColumn,e,f.endColumn,d,f.startColumnRelative,n,f.endColumnRelative)}}return f},
_adjustCellExpressionOnAddColumn:function(a,b,e,d,f,h,g,k){return b&&(e=f.columnRelative,0<=d||!e)&&(d=this._adjustIndexOnAdd(a,b,d,f.column,f.columnRelative,h,g,k),d!==f.column)?a===b?new da(f.row,d,f.rowRelative,e):new ha(b,f.row,d,f.rowRelative,e):f},_adjustRangeExpressionOnAddColumn:function(a,b,e,d,f,h,g,k){if(b){var l=f._getRangeType();if(3===l||1===l)return f;e=f.startColumnRelative;var n=f.endColumnRelative;if(0<=d||!e||!n){var F=this._adjustIndexOnAdd(a,b,d,f.startColumn,e,h,g,k);d=this._adjustIndexOnAdd(a,
b,d,f.endColumn,n,h,g,k);return 2===l?(a===b?(a=new X,a.initBand(F,d,e,n,!1)):(a=new ca,a.initBand(b,F,d,e,n,!1)),a):a===b?new X(f.startRow,F,f.endRow,d,f.startRowRelative,e,f.endRowRelative,n):new ca(b,f.startRow,F,f.endRow,d,f.startRowRelative,e,f.endRowRelative,n)}}return f},adjustFormulaOnAddRows:function(a,b,e,d,f,h,g){var k=d,l;if(d instanceof da)k=this._adjustCellExpressionOnAddRow(a,a,b,e,d,f,h,g);else if(d instanceof X)k=this._adjustRangeExpressionOnAddRow(a,a,b,e,d,f,h,g);else if(d instanceof
ha)k=this._adjustCellExpressionOnAddRow(a,d.source,b,e,d,f,h,g);else if(d instanceof ca)k=this._adjustRangeExpressionOnAddRow(a,d.source,b,e,d,f,h,g);else if(d instanceof K)l=this.adjustFormulaOnAddRows(a,b,e,d.argument,f,h,g),l!==d.argument&&(k=new K(l));else if(d instanceof ja)l=this.adjustFormulaOnAddRows(a,b,e,d.operand,f,h,g),l!==d.operand&&(k=new ja(d.operator,l));else if(d instanceof fa){if(l=this.adjustFormulaOnAddRows(a,b,e,d.left,f,h,g),a=this.adjustFormulaOnAddRows(a,b,e,d.right,f,h,g),
l!==d.left||a!==d.right)k=new fa(d.operator,l,a)}else if(d instanceof A){var n=null,F,B,q=d.argCount();for(B=0;B<q;B++)if(F=d.getArg(B),l=this.adjustFormulaOnAddRows(a,b,e,F,f,h,g),l!==F){n=[];n[B]=l;break}if(n){for(B=0;B<q;B++)if(F=d.getArg(B),n[B]===m||null===n[B])n[B]=this.adjustFormulaOnAddRows(a,b,e,F,f,h,g);k=new A(d.fn,n)}}return k},adjustFormulasOnAddRows:function(a,b,e){for(var d=0;d<this._customNames.length;d++){var f=this._customNames[d].value;f.expression=this.adjustFormulaOnAddRows(null,
-1,-1,f.expression,a,b,e)}for(var h,g;this._headAdjustCells;)d=this._headAdjustCells.sheetSource,f=this._headAdjustCells.row,h=this._headAdjustCells.column,(g=d.getExpression(f,h))?d.setExpression(f,h,this.adjustFormulaOnAddRows(d,f,h,g,a,b,e)):(d.getRowExpression&&d.getRowExpression(f)||d.getColumnExpression&&d.getColumnExpression(h))&&d._addCellsToDirty(f,h,1,1),this.removeAdjustCell(this._headAdjustCells);for(;this._headAdjustRows;)d=this._headAdjustRows.sheetSource,f=this._headAdjustRows.row,
d.getExpression&&(g=d.getRowExpression(f))&&d.setRowExpression&&d.setRowExpression(f,this.adjustFormulaOnAddRows(d,f,-1,g,a,b,e)),this.removeAdjustRow(this._headAdjustRows);for(;this._headAdjustColumns;)d=this._headAdjustColumns.sheetSource,h=this._headAdjustColumns.column,d.getColumnExpression&&(g=d.getColumnExpression(h))&&d._setColumnExpression&&d._setColumnExpression(h,this.adjustFormulaOnAddRows(d,-1,h,g,a,b,e)),this.removeAdjustRow(this._headAdjustColumns)},adjustFormulaOnAddColumns:function(a,
b,e,d,f,h,g){var k=d,l;if(d instanceof da)k=this._adjustCellExpressionOnAddColumn(a,a,b,e,d,f,h,g);else if(d instanceof X)k=this._adjustRangeExpressionOnAddColumn(a,a,b,e,d,f,h,g);else if(d instanceof ha)k=this._adjustCellExpressionOnAddColumn(a,d.source,b,e,d,f,h,g);else if(d instanceof ca)k=this._adjustRangeExpressionOnAddColumn(a,d.source,b,e,d,f,h,g);else if(d instanceof K)l=this.adjustFormulaOnAddColumns(a,b,e,d.argument,f,h,g),l!==d.argument&&(k=new K(l));else if(d instanceof ja)l=this.adjustFormulaOnAddColumns(a,
b,e,d.operand,f,h,g),l!==d.operand&&(k=new ja(d.operator,l));else if(d instanceof fa){if(l=this.adjustFormulaOnAddColumns(a,b,e,d.left,f,h,g),a=this.adjustFormulaOnAddColumns(a,b,e,d.right,f,h,g),l!==d.left||a!==d.right)k=new fa(d.operator,l,a)}else if(d instanceof A){var n=null,F,B,q=d.argCount();for(B=0;B<q;B++)if(F=d.getArg(B),l=this.adjustFormulaOnAddColumns(a,b,e,F,f,h,g),l!==F){n=[];n[B]=l;break}if(n){for(B=0;B<q;B++)if(F=d.getArg(B),n[B]===m||null===n[B])n[B]=this.adjustFormulaOnAddColumns(a,
b,e,F,f,h,g);k=new A(d.fn,n)}}return k},adjustFormulasOnAddColumns:function(a,b,e){for(var d=0;d<this._customNames.length;d++){var f=this._customNames[d].value;f.expression=this.adjustFormulaOnAddColumns(null,-1,-1,f.expression,a,b,e)}for(var h,g;this._headAdjustCells;)d=this._headAdjustCells.sheetSource,f=this._headAdjustCells.row,h=this._headAdjustCells.column,(g=d.getExpression(f,h))?d.setExpression(f,h,this.adjustFormulaOnAddColumns(d,f,h,g,a,b,e)):(d.getRowExpression&&d.getRowExpression(f)||
d.getColumnExpression&&d.getColumnExpression(h))&&d._addCellsToDirty(f,h,1,1),this.removeAdjustCell(this._headAdjustCells);for(;this._headAdjustRows;)d=this._headAdjustRows.sheetSource,f=this._headAdjustRows.row,d.getRowExpression&&(g=d.getRowExpression(f))&&d._setRowExpression&&d._setRowExpression(f,this.adjustFormulaOnAddColumns(d,f,-1,g,a,b,e)),this.removeAdjustRow(this._headAdjustRows);for(;this._headAdjustColumns;)d=this._headAdjustColumns.sheetSource,h=this._headAdjustColumns.column,d.getColumnExpression&&
(g=d.getColumnExpression(h))&&d._setColumnExpression&&d._setColumnExpression(h,this.adjustFormulaOnAddColumns(d,-1,h,g,a,b,e)),this.removeAdjustColumn(this._headAdjustColumns)},_adjustIndexOnRemove:function(a,b,e,d,f,h,g,k){if(0<=e||!f){d+=f?e:0;h===a&&g<=e&&(d+=f?k:0);if(h===b)if(g+k<=d)d-=k;else if(g<=d)return pa;return d-(f?e:0)}return d},_adjustCellExpressionOnRemoveRow:function(a,b,e,d,f,h,g,l){if(b&&(d=f.rowRelative,0<=e||!d)){e=this._adjustIndexOnRemove(a,b,e,f.row,f.rowRelative,h,g,l);if(e instanceof
k)return new v(e);if(e!==f.row)return a===b?new da(e,f.column,d,f.columnRelative):new ha(b,e,f.column,d,f.columnRelative)}return f},_adjustRangeExpressionOnRemoveRow:function(a,b,e,d,f,h,g,l){if(b){var n=f._getRangeType();if(3===n||2===n)return f;d=f.startRowRelative;var F=f.endRowRelative;if(0<=e||!d||!F){var m=this._adjustIndexOnRemove(a,b,e,f.startRow,d,h,g,l);if(m instanceof k)return new v(m);e=this._adjustIndexOnAdd(a,b,e,f.endRow,F,h,g,l);return e instanceof k?new v(e):2===n?(a===b?(a=new X,
a.initBand(m,e,d,F,!1)):(a=new ca,a.initBand(b,m,e,d,F,!1)),a):a===b?new X(m,f.startColumn,e,f.endColumn,d,f.startColumnRelative,F,f.endColumnRelative):new ca(b,m,f.startColumn,e,f.endColumn,d,f.startColumnRelative,F,f.endColumnRelative)}}return f},_adjustCellExpressionOnRemoveColumn:function(a,b,e,d,f,h,g,l){if(b&&(e=f.columnRelative,0<=d||!e)){d=this._adjustIndexOnRemove(a,b,d,f.column,f.columnRelative,h,g,l);if(d instanceof k)return new v(d);if(d!==f.column)return a===b?new da(f.row,d,f.rowRelative,
e):new ha(b,f.row,d,f.rowRelative,e)}return f},_adjustRangeExpressionOnRemoveColumn:function(a,b,e,d,f,h,g,l){if(b){var n=f._getRangeType();if(3===n||1===n)return f;e=f.startColumnRelative;var F=f.endColumnRelative;if(0<=d||!e||!F){var m=this._adjustIndexOnRemove(a,b,d,f.startColumn,e,h,g,l);if(m instanceof k)return new v(m);d=this._adjustIndexOnRemove(a,b,d,f.endColumn,F,h,g,l);return d instanceof k?new v(d):2===n?(a===b?(a=new X,a.initBand(m,d,e,F,!1)):(a=new ca,a.initBand(b,m,d,e,F,!1)),a):a===
b?new X(f.startRow,m,f.endRow,d,f.startRowRelative,e,f.endRowRelative,F):new ca(b,f.startRow,m,f.endRow,d,f.startRowRelative,e,f.endRowRelative,F)}}return f},adjustFormulaOnRemoveRows:function(a,b,e,d,f,h,g){var k=d,l,n,F;if(d instanceof da)k=this._adjustCellExpressionOnRemoveRow(a,a,b,e,d,f,h,g);else if(d instanceof X)k=this._adjustRangeExpressionOnRemoveRow(a,a,b,e,d,f,h,g);else if(d instanceof ha)k=this._adjustCellExpressionOnRemoveRow(a,d.source,b,e,d,f,h,g);else if(d instanceof ca)k=this._adjustRangeExpressionOnRemoveRow(a,
d.source,b,e,d,f,h,g);else if(d instanceof K)l=this.adjustFormulaOnRemoveRows(a,b,e,d.argument,f,h,g),l!==d.argument&&(k=new K(l));else if(d instanceof ja)l=this.adjustFormulaOnRemoveRows(a,b,e,d.operand,f,h,g),l!==d.operand&&(k=new ja(d.operator,l));else if(d instanceof fa){if(l=this.adjustFormulaOnRemoveRows(a,b,e,d.left,f,h,g),a=this.adjustFormulaOnRemoveRows(a,b,e,d.right,f,h,g),l!==d.left||a!==d.right)k=new fa(d.operator,l,a)}else if(d instanceof A){var B=null,q=d.argCount();for(F=0;F<q;F++)if(n=
d.getArg(F),l=this.adjustFormulaOnRemoveRows(a,b,e,n,f,h,g),l!==n){B=[];B[F]=l;break}if(B){for(F=0;F<q;F++)if(n=d.getArg(F),B[F]===m||null===B[F])B[F]=this.adjustFormulaOnRemoveRows(a,b,e,n,f,h,g);k=new A(d.fn,B)}}return k},adjustFormulasOnRemoveRows:function(a,b,e){for(var d=0;d<this._customNames.length;d++){var f=this._customNames[d].value;f.expression=this.adjustFormulaOnRemoveRows(null,-1,-1,f.expression,a,b,e)}for(var h,g;this._headAdjustCells;)d=this._headAdjustCells.sheetSource,f=this._headAdjustCells.row,
h=this._headAdjustCells.column,(g=d.getExpression(f,h))?d.setExpression(f,h,this.adjustFormulaOnRemoveRows(d,f,h,g,a,b,e)):(d.getRowExpression&&d.getRowExpression(f)||d.getColumnExpression&&d.getColumnExpression(h))&&d._addCellsToDirty(f,h,1,1),this.removeAdjustCell(this._headAdjustCells);for(;this._headAdjustRows;)d=this._headAdjustRows.sheetSource,f=this._headAdjustRows.row,d.getRowExpression&&(g=d.getRowExpression(f))&&d.setRowExpression&&d.setRowExpression(f,this.adjustFormulaOnRemoveRows(d,f,
-1,g,a,b,e)),this.removeAdjustRow(this._headAdjustRows);for(;this._headAdjustColumns;)d=this._headAdjustColumns.sheetSource,h=this._headAdjustColumns.column,d.getColumnExpression&&(g=d.getColumnExpression(h))&&d.setColumnExpression&&d.setColumnExpression(h,this.adjustFormulaOnRemoveRows(d,-1,h,g,a,b,e)),this.removeAdjustRow(this._headAdjustColumns)},adjustFormulaOnRemoveColumns:function(a,b,e,d,f,h,g){var k=d,l,n,F;if(d instanceof da)k=this._adjustCellExpressionOnRemoveColumn(a,a,b,e,d,f,h,g);else if(d instanceof
X)k=this._adjustRangeExpressionOnRemoveColumn(a,a,b,e,d,f,h,g);else if(d instanceof ha)k=this._adjustCellExpressionOnRemoveColumn(a,d.source,b,e,d,f,h,g);else if(d instanceof ca)k=this._adjustRangeExpressionOnRemoveColumn(a,d.source,b,e,d,f,h,g);else if(d instanceof K)l=this.adjustFormulaOnRemoveColumns(a,b,e,d.argument,f,h,g),l!==d.argument&&(k=new K(l));else if(d instanceof ja)l=this.adjustFormulaOnRemoveColumns(a,b,e,d.operand,f,h,g),l!==d.operand&&(k=new ja(d.operator,l));else if(d instanceof
fa){if(l=this.adjustFormulaOnRemoveColumns(a,b,e,d.left,f,h,g),a=this.adjustFormulaOnRemoveColumns(a,b,e,d.right,f,h,g),l!==d.left||a!==d.right)k=new fa(d.operator,l,a)}else if(d instanceof A){var B=null,q=d.argCount();for(F=0;F<q;F++)if(n=d.getArg(F),l=this.adjustFormulaOnRemoveColumns(a,b,e,n,f,h,g),l!==n){B=[];B[F]=l;break}if(B){for(F=0;F<q;F++)if(n=d.getArg(F),B[F]===m||null===B[F])B[F]=this.adjustFormulaOnRemoveColumns(a,b,e,n,f,h,g);k=new A(d.fn,B)}}return k},adjustFormulasOnRemoveColumns:function(a,
b,e){var d,f,h,g;for(d=0;d<this._customNames.length;d++)f=this._customNames[d].value,f.expression=this.adjustFormulaOnRemoveColumns(null,-1,-1,f.expression,a,b,e);for(;this._headAdjustCells;)d=this._headAdjustCells.sheetSource,f=this._headAdjustCells.row,h=this._headAdjustCells.column,(g=d.getExpression(f,h))?d.setExpression(f,h,this.adjustFormulaOnRemoveColumns(d,f,h,g,a,b,e)):(d.getRowExpression&&d.getRowExpression(f)||d.getColumnExpression&&d.getColumnExpression(h))&&d._addCellsToDirty(f,h,1,1),
this.removeAdjustCell(this._headAdjustCells);for(;this._headAdjustRows;)d=this._headAdjustRows.sheetSource,f=this._headAdjustRows.row,d.getRowExpression&&(g=d.getRowExpression(f))&&d._setRowExpression&&d._setRowExpression(f,this.adjustFormulaOnRemoveColumns(d,f,-1,g,a,b,e)),this.removeAdjustRow(this._headAdjustRows);for(;this._headAdjustColumns;)d=this._headAdjustColumns.sheetSource,h=this._headAdjustColumns.column,d.getColumnExpression&&(g=d.getColumnExpression(h))&&d._setColumnExpression&&d._setColumnExpression(h,
this.adjustFormulaOnRemoveColumns(d,-1,h,g,a,b,e)),this.removeAdjustColumn(this._headAdjustColumns)},adjustFormulaOnRemoveSheet:function(a,b,e){var d=b,f,h,g;if(b instanceof ra){if(b=b.source,a!==e&&b===e||a===e&&b!==e)d=new v(pa)}else if(b instanceof K)f=this.adjustFormulaOnRemoveSheet(a,b.argument,e),f!==b.argument&&(d=new K(f));else if(b instanceof ja)f=this.adjustFormulaOnRemoveSheet(a,b.operand,e),f!==b.operand&&(d=new ja(b.operator,f));else if(b instanceof fa){if(f=this.adjustFormulaOnRemoveSheet(a,
b.left,e),a=this.adjustFormulaOnRemoveSheet(a,b.right,e),f!==b.left||a!==b.right)d=new fa(b.operator,f,a)}else if(b instanceof A){var k=null,l=b.argCount();for(g=0;g<l;g++)if(h=b.getArg(g),f=this.adjustFormulaOnRemoveSheet(a,h,e),f!==h){k=[];k[g]=f;break}if(k){for(g=0;g<l;g++)if(h=b.getArg(g),k[g]===m||null===k[g])k[g]=this.adjustFormulaOnRemoveSheet(a,h,e);d=new A(b.fn,k)}}return d},adjustFormulasOnRemoveSheet:function(a){for(var b=0;b<this._customNames.length;b++){var e=this._customNames[b].value;
e.expression=this.adjustFormulaOnRemoveSheet(null,e.expression,a)}for(var d,f;this._headAdjustCells;)b=this._headAdjustCells.sheetSource,e=this._headAdjustCells.row,d=this._headAdjustCells.column,(f=b.getExpression(e,d))&&b.setExpression(e,d,this.adjustFormulaOnRemoveSheet(b,f,a)),this.removeAdjustCell(this._headAdjustCells);for(;this._headAdjustRows;)b=this._headAdjustRows.sheetSource,e=this._headAdjustRows.row,b.getRowExpression&&(f=b.getRowExpression(e))&&b.setRowExpression&&b.setRowExpression(e,
this.adjustFormulaOnRemoveSheet(b,f,a)),this.removeAdjustRow(this._headAdjustRows);for(;this._headAdjustColumns;)b=this._headAdjustColumns.sheetSource,d=this._headAdjustColumns.column,b.getColumnExpression&&(f=b.getColumnExpression(d))&&b.setColumnExpression&&b.setColumnExpression(d,this.adjustFormulaOnRemoveSheet(b,f,a)),this.removeAdjustColumn(this._headAdjustColumns)},_adjustCellExpressionOnMove:function(a,b,e,d,f){var h=d instanceof ra,g=h?d.source:a,k=d.rowRelative,l=d.columnRelative,n,F,m,B;
if((0<=b||!k)&&(0<=e||!l)){n=d.row+(k?b:0);F=d.column+(l?e:0);f.destinationContains(a,b,e,1,1)&&(n-=k?f.getRowOffset():0,F-=l?f.getColumnOffset():0);if(f.sourceContains(h?g:f._fromModel,n,F,1,1))n+=f.getRowOffset(),F+=f.getColumnOffset(),m=(h=f._toModel!==f._fromModel)&&f._toModel===a,B=h&&f._fromModel===a;else if(f.destinationContains(g,n,F,1,1))return new v(pa);n-=k?b:0;F-=l?e:0;if(n!==d.row||F!==d.column||m||B)return d instanceof da&&B||d instanceof ha&&!m?new ha(B?f._toModel:d.source,n,F,k,l):
new da(n,F,k,l)}else if((0<=b||!k)&&-1===e){n=d.row+(k?b:0);f.destinationContains(a,b,e,1,1)&&(n-=k?f.getRowOffset():0);if(f.sourceContains(g,n,-1,k,-1))n+=f.getRowOffset();else if(f.destinationContains(g,n,-1,1,-1))return new v(pa);n-=k?b:0;if(n!==d.row){if(d instanceof da)return new da(n,d.column,k,d.columnRelative);if(d instanceof ha)return new ha(d.source,n,d.column,k,d.columnRelative)}}else if(-1===b&&0<=e&&!l){F=d.column+(l?e:0);f.destinationContains(a,b,e,1,1)&&(F-=l?f.getColumnOffset():0);
if(f.sourceContains(g,n,F,1,1))F+=f.getColumnOffset();else if(f.destinationContains(g,n,F,1,1))return new v(pa);F-=l?e:0;if(n!==d.row||F!==d.column){if(d instanceof da)return new da(d.row,F,d.rowRelative,l);if(d instanceof ha)return new ha(d.source,d.row,F,d.rowRelative,l)}}return d},_adjustRangeExpressionOnMove:function(a,b,e,d,f){var h=d instanceof ra?d.source:a,g=d._getRangeType(),k,l,n,F,m,B,q,s,r,U,t,na,sa;if(0===g)if(g=d.startRowRelative,k=d.startColumnRelative,l=d.endRowRelative,n=d.endColumnRelative,
(0<=b||!g||!l)&&(0<=e||!k||!n)){F=d.startRow+(g?b:0);m=d.endRow+(l?b:0);B=d.startColumn+(k?e:0);q=d.endColumn+(n?e:0);if(F>m||B>q)return new v(pa);f.destinationContains(a,b,e,1,1)&&(na=g?f.getRowOffset():0,s=l?f.getRowOffset():0,r=k?f.getColumnOffset():0,sa=n?f.getColumnOffset():0,F-=na,m-=s,B-=r,q-=sa);s=m-F+1;r=q-B+1;na=!1;if(f.sourceContains(h,F,B,s,r))U=f.getRowOffset(),t=f.getColumnOffset(),F+=U,m+=U,B+=t,q+=t,U=(t=f._toModel!==f._fromModel)&&f._toModel===a,t=t&&f._fromModel===a;else if(f.destinationContains(h,
F,B,s,r)){q=f.sourceIntersectWith(h,F,B,s,r);if(!q||q.rowCount!==s&&q.columnCount!==r)return new v(pa);F=q.row+f.getRowOffset();B=q.column+f.getColumnOffset();m=F+q.rowCount;q=B+q.columnCount;na=!0}F-=g?b:0;m-=l?b:0;B-=k?e:0;q-=n?e:0;if(F!==d.startRow||B!==d.startColumn||m!==d.endRow||q!==d.endColumn||U||t||na)return d instanceof X&&t||d instanceof ca&&!U?new ca(t?f._toModel:d.source,F,B,m,q,g,k,l,n):new X(F,B,m,q,g,k,l,n)}else if((0<=b||!g||!l)&&-1===e){F=d.startRow+(g?b:0);m=d.endRow+(l?b:0);if(F>
m)return new v(pa);f.destinationContains(a,b,e,1,1)&&(na=g?f.getRowOffset():0,s=l?f.getRowOffset():0,F-=na,m-=s);s=m-F;if(f.sourceContains(h,F,-1,s,-1))U=f.getRowOffset(),F+=U,m+=U;else if(f.destinationContains(h,F,-1,s,-1))return new v(pa);F-=g?b:0;m-=l?b:0;if(F!==d.startRow||m!==d.endRow){if(d instanceof X)return new X(F,d.startColumn,m,d.endColumn,g,d.startColumnRelative,l,d.endColumnRelative);if(d instanceof ca)return new ca(d.source,F,d.startColumn,m,d.endColumn,g,d.startColumnRelative,l,d.endColumnRelative)}}else{if(-1===
b&&(0<=e||!k||!n)){B=d.startColumn+(k?e:0);q=d.endColumn+(n?e:0);if(B>q)return new v(pa);f.destinationContains(a,b,e,1,1)&&(r=k?f.getColumnOffset():0,sa=n?f.getColumnOffset():0,B-=r,q-=sa);r=q-B;if(f.sourceContains(h,-1,B,-1,r))t=f.getColumnOffset(),B+=t,q+=t;else if(f.destinationContains(h,-1,B,-1,r))return new v(pa);B-=k?e:0;q-=n?e:0;if(B!==d.startColumn||q!==d.endColumn){if(d instanceof X)return new X(d.startRow,B,d.endRow,q,d.startRowRelative,k,d.endRowRelative,n);if(d instanceof ca)return new ca(d.source,
d.startRow,B,d.endRow,q,d.startRowRelative,k,d.endRowRelative,n)}}}else if(1===g){if(g=d.startRowRelative,l=d.endRowRelative,0<=b||!g||!l){F=d.startRow+(g?b:0);m=d.endRow+(l?b:0);if(F>m)return new v(pa);f.destinationContains(a,b,e,1,1)&&(na=g?f.getRowOffset():0,s=l?f.getRowOffset():0,F-=na,m-=s);s=m-F;if(f.sourceContains(h,F,-1,s,-1))U=f.getRowOffset(),F+=U,m+=U;else if(f.destinationContains(h,F,-1,s,-1))return new v(pa);F-=g?b:0;m-=l?b:0;if(F!==d.startRow||m!==d.endRow){if(d instanceof X)return d=
new X,d.initBand(F,m,g,l,!0),d;if(d instanceof ca)return k=new ca,k.initBand(d.source,F,m,g,l,!0),k}}}else if(2===g){k=d.startColumnRelative;n=d.endColumnRelative;B=d.startColumn+(k?e:0);q=d.endColumn+(n?e:0);if(B<q)return new v(pa);f.destinationContains(a,b,e,1,1)&&(r=k?f.getColumnOffset():0,sa=n?f.getColumnOffset():0,B-=r,q-=sa);r=q-B;if(f.sourceContains(h,-1,B,-1,r))t=f.getColumnOffset(),B+=t,q+=t;else if(f.destinationContains(h,-1,B,-1,r))return new v(pa);B-=k?e:0;q-=n?e:0;if(B!==d.startColumn||
q!==d.endColumn){if(d instanceof X)return d=new X,d.initBand(B,q,k,n,!1),d;if(d instanceof ca)return g=new ca,g.initBand(d.source,B,q,k,n,!1),g}}return d},adjustFormulaOnMove:function(a,b,e,d,f){var h=d,g;if(d instanceof da||d instanceof ha)h=this._adjustCellExpressionOnMove(a,b,e,d,f);else if(d instanceof X||d instanceof ca)h=this._adjustRangeExpressionOnMove(a,b,e,d,f);else if(d instanceof K)g=this.adjustFormulaOnMove(a,b,e,d.argument,f),g!==d.argument&&(h=new K(g));else if(d instanceof ja)g=this.adjustFormulaOnMove(a,
b,e,d.operand,f),g!==d.operand&&(h=new ja(d.operator,g));else if(d instanceof fa){if(g=this.adjustFormulaOnMove(a,b,e,d.left,f),a=this.adjustFormulaOnMove(a,b,e,d.right,f),g!==d.left||a!==d.right)h=new fa(d.operator,g,a)}else if(d instanceof A){var k=null,l,n,F=d.argCount();for(n=0;n<F;n++)if(l=d.getArg(n),g=this.adjustFormulaOnMove(a,b,e,l,f),g!==l){k=[];k[n]=g;break}if(k){for(n=0;n<F;n++)if(l=d.getArg(n),k[n]===m||null===k[n])k[n]=this.adjustFormulaOnMove(a,b,e,l,f);h=new A(d.fn,k)}}return h},adjustFormulasOnMove:function(a,
b,e,d,f,h,g,k){a=new gb(a,b,e,d,f,h,g,k);for(b=0;b<this._customNames.length;b++)e=this._customNames[b].value,e.expression=this.adjustFormulaOnMove(null,-1,-1,e.expression,a);for(;this._headAdjustCells;)b=this._headAdjustCells.sheetSource,e=this._headAdjustCells.row,d=this._headAdjustCells.column,(f=b.getExpression(e,d))?b.setExpression(e,d,this.adjustFormulaOnMove(b,e,d,f,a)):(b.getRowExpression&&b.getRowExpression(e)||b.getColumnExpression&&b.getColumnExpression(d))&&b._addCellsToDirty(e,d,1,1),
this.removeAdjustCell(this._headAdjustCells);for(;this._headAdjustRows;)b=this._headAdjustRows.sheetSource,e=this._headAdjustRows.row,b.getRowExpression&&(f=b.getRowExpression(e))&&b.setRowExpression&&b.setRowExpression(e,this.adjustFormulaOnMove(b,e,-1,f,a)),this.removeAdjustRow(this._headAdjustRows);for(;this._headAdjustColumns;)b=this._headAdjustColumns.sheetSource,d=this._headAdjustColumns.column,b.getColumnExpression&&(f=b.getColumnExpression(d))&&b.setColumnExpression&&b.setColumnExpression(d,
this.adjustFormulaOnMove(b,-1,d,f,a)),this.removeAdjustColumn(this._headAdjustColumns)},_adjustCellExpressionOnSwap:function(a,b,e,d,f){var h=d instanceof ra?d.source:a,g=d.rowRelative,k=d.columnRelative,l,n;if((0<=b||!g)&&(0<=e||!k)){if(l=d.row+(g?b:0),n=d.column+(k?e:0),f.destinationContains(a,b,e,1,1)?(l-=g?f.getRowOffset():0,n-=k?f.getColumnOffset():0):f.sourceContains(a,l,n,1,1)&&(l+=g?f.getRowOffset():0,n+=k?f.getColumnOffset():0),f.sourceContains(h,l,n,1,1)?(l+=f.getRowOffset(),n+=f.getColumnOffset()):
f.destinationContains(h,l,n,1,1)&&(l-=f.getRowOffset(),n-=f.getColumnOffset()),l-=g?b:0,n-=k?e:0,l!==d.row||n!==d.column){if(d instanceof da)return new da(l,n,g,k);if(d instanceof ha)return new ha(d.source,l,n,g,k)}}else if((0<=b||!g)&&-1===e){if(l=d.row+(g?b:0),f.destinationContains(a,b,-1,1,-1)?l-=g?f.getRowOffset():0:f.sourceContains(a,l,-1,1,-1)&&(l+=g?f.getRowOffset():0),f.sourceContains(h,l,-1,1,-1)?l+=f.getRowOffset():f.destinationContains(h,l,-1,1,-1)&&(l-=f.getRowOffset()),l-=g?b:0,l!==d.row||
n!==d.column){if(d instanceof da)return new da(l,d.column,g,d.columnRelative);if(d instanceof ha)return new ha(d.source,l,d.column,g,d.columnRelative)}}else if(-1===b&&0<=e&&!k&&(n=d.column+(k?e:0),f.destinationContains(a,-1,e,-1,1)?n-=k?f.getColumnOffset():0:f.sourceContains(a,-1,n,-1,1)&&(n+=k?f.getColumnOffset():0),f.sourceContains(h,-1,n,-1,1)?n+=f.getColumnOffset():f.destinationContains(h,-1,n,-1,1)&&(n-=f.getColumnOffset()),n-=k?e:0,l!==d.row||n!==d.column)){if(d instanceof da)return new da(d.row,
n,d.rowRelative,k);if(d instanceof ha)return new ha(d.source,d.row,n,d.rowRelative,k)}return d},_adjustRangeExpressionOnSwap:function(a,b,e,d,f){var h=d instanceof ra?d.source:a,g=d._getRangeType(),k,l,n,F,m,B,q,s,r,U,t,na;if(0===g)if(B=d.startRowRelative,q=d.startColumnRelative,s=d.endRowRelative,r=d.endColumnRelative,(0<=b||!B||!s)&&(0<=e||!q||!r)){if(g=d.startRow+(B?b:0),k=d.endRow+(s?b:0),l=d.startColumn+(q?e:0),n=d.endColumn+(r?e:0),F=k-g,m=n-l,f.destinationContains(a,b,e,1,1)?(a=B?f.getRowOffset():
0,U=q?f.getColumnOffset():0,t=s?f.getRowOffset():0,na=r?f.getColumnOffset():0,g-=a,k-=t,l-=U,n-=na):f.sourceContains(a,g,l,F,m)&&(a=B?f.getRowOffset():0,U=q?f.getColumnOffset():0,t=s?f.getRowOffset():0,na=r?f.getColumnOffset():0,g+=a,k+=t,l+=U,n+=na),f.sourceContains(h,g,l,F,m)?(h=f.getRowOffset(),f=f.getColumnOffset(),g+=h,k+=h,l+=f,n+=f):f.destinationContains(h,g,l,F,m)&&(h=f.getRowOffset(),f=f.getColumnOffset(),g-=h,k-=h,l-=f,n-=f),g-=B?b:0,k-=s?b:0,l-=q?e:0,n-=r?e:0,g!==d.startRow||l!==d.startColumn||
k!==d.endRow||n!==d.endColumn){if(d instanceof X)return new X(g,l,k,n,B,q,s,r);if(d instanceof ca)return new ca(d.source,g,l,k,n,B,q,s,r)}}else if((0<=b||!B||!s)&&-1===e){g=d.startRow+(B?b:0);k=d.endRow+(s?b:0);if(g<k)return new v(pa);f.destinationContains(a,b,-1,1,-1)?(a=B?f.getRowOffset():0,t=B?f.getRowOffset():0,g-=a,k-=t):f.sourceContains(a,b,-1,1,-1)&&(a=B?f.getRowOffset():0,t=B?f.getRowOffset():0,g+=a,k+=t);F=k-g;f.sourceContains(h,g,-1,F,-1)?(h=f.getRowOffset(),g+=h,k+=h):f.destinationContains(h,
g,-1,F,-1)&&(h=f.getRowOffset(),g-=h,k-=h);g-=B?b:0;k-=s?b:0;if(g!==d.startRow||k!==d.endRow){if(d instanceof X)return new X(g,d.startColumn,k,d.endColumn,B,d.startColumnRelative,s,d.endColumnRelative);if(d instanceof ca)return new ca(d.source,g,d.startColumn,k,d.endColumn,B,d.startColumnRelative,s,d.endColumnRelative)}}else{if(-1===b&&(0<=e||!q||!r)){l=d.startColumn+(q?e:0);n=d.endColumn+(r?e:0);if(l<n)return new v(pa);f.destinationContains(a,-1,e,-1,1)?(U=q?f.getColumnOffset():0,na=r?f.getColumnOffset():
0,l-=U,n-=na):f.sourceContains(a,-1,e,-1,1)&&(U=q?f.getColumnOffset():0,na=r?f.getColumnOffset():0,l+=U,n+=na);m=n-l;f.sourceContains(h,-1,l,-1,m)?(f=f.getColumnOffset(),l+=f,n+=f):f.destinationContains(h,-1,l,-1,m)&&(f=f.getColumnOffset(),l-=f,n-=f);l-=q?e:0;n-=r?e:0;if(l!==d.startColumn||n!==d.endColumn){if(d instanceof X)return new X(d.startRow,l,d.endRow,n,d.startRowRelative,q,d.endRowRelative,r);if(d instanceof ca)return new ca(d.source,d.startRow,l,d.endRow,n,d.startRowRelative,q,d.endRowRelative,
r)}}}else if(1===g){if(B=d.startRowRelative,s=d.endRowRelative,0<=b||!B||!s){g=d.startRow+(B?b:0);k=d.endRow+(s?b:0);if(g<k)return new v(pa);f.destinationContains(a,b,-1,1,-1)?(a=B?f.getRowOffset():0,t=s?f.getRowOffset():0,g-=a,k-=t):f.sourceContains(a,b,-1,1,-1)&&(a=B?f.getRowOffset():0,t=s?f.getRowOffset():0,g+=a,k+=t);F=k-g;f.sourceContains(h,g,-1,F,-1)?(h=f.getRowOffset(),g+=h,k+=h):f.destinationContains(h,g,-1,F,-1)&&(h=f.getRowOffset(),g-=h,k-=h);g-=B?b:0;k-=s?b:0;if(g!==d.startRow||k!==d.endRow){if(d instanceof
X)return d=new X,d.initBand(g,k,B,s,!0),d;if(d instanceof ca)return l=new ca,l.initBand(d.source,g,k,B,s,!0),l}}}else if(2===g){q=d.startColumnRelative;r=d.endColumnRelative;l=d.startColumn+(q?e:0);n=d.endColumn+(r?e:0);if(l>n)return new v(pa);f.destinationContains(a,-1,e,-1,1)?(U=q?f.getColumnOffset():0,na=r?f.getColumnOffset():0,l-=U,n-=na):f.sourceContains(a,-1,e,-1,1)&&(U=q?f.getColumnOffset():0,na=r?f.getColumnOffset():0,l+=U,n+=na);m=n-l;f.sourceContains(h,-1,l,-1,m)?(f=f.getColumnOffset(),
l+=f,n+=f):f.destinationContains(h,-1,l,-1,m)&&(f=f.getColumnOffset(),l-=f,n-=f);l-=q?e:0;n-=r?e:0;if(l!==d.startColumn||n!==d.endColumn){if(d instanceof X)return d=new X,d.initBand(l,n,q,r,!1),d;if(d instanceof ca)return g=new ca,g.initBand(d.source,l,n,q,r,!1),g}}return d},adjustFormulaOnSwap:function(a,b,e,d,f){var h=d,g;if(d instanceof da||d instanceof ha)h=this._adjustCellExpressionOnSwap(a,b,e,d,f);else if(d instanceof X||d instanceof ca)h=this._adjustRangeExpressionOnSwap(a,b,e,d,f);else if(d instanceof
K)g=this.adjustFormulaOnSwap(a,b,e,d.argument,f),g!==d.argument&&(h=new K(g));else if(d instanceof ja)g=this.adjustFormulaOnSwap(a,b,e,d.operand,f),g!==d.operand&&(h=new ja(d.operator,g));else if(d instanceof fa){if(g=this.adjustFormulaOnSwap(a,b,e,d.left,f),a=this.adjustFormulaOnSwap(a,b,e,d.right,f),g!==d.left||a!==d.right)h=new fa(d.operator,g,a)}else if(d instanceof A){var k=null,l,n,F=d.argCount();for(n=0;n<F;n++)if(l=d.getArg(n),g=this.adjustFormulaOnSwap(a,b,e,l,f),g!==l){k=[];k[n]=g;break}if(k){for(n=
0;n<F;n++)if(l=d.getArg(n),k[n]===m||null===k[n])k[n]=this.adjustFormulaOnSwap(a,b,e,l,f);h=new A(d.fn,k)}}return h},adjustFormulasOnSwap:function(a,b,e,d,f,h,g,k){a=new gb(a,b,e,d,f,h,g,k);for(b=0;b<this._customNames.length;b++)e=this._customNames[b].value,e.expression=this.adjustFormulaOnSwap(null,-1,-1,e.expression,a);for(;this._headAdjustCells;)b=this._headAdjustCells.sheetSource,e=this._headAdjustCells.row,d=this._headAdjustCells.column,(f=b.getExpression(e,d))?b.setExpression(e,d,this.adjustFormulaOnSwap(b,
e,d,f,a)):(b.getRowExpression&&b.getRowExpression(e)||b.getColumnExpression&&b.getColumnExpression(d))&&b._addCellsToDirty(e,d,1,1),this.removeAdjustCell(this._headAdjustCells);for(;this._headAdjustRows;)b=this._headAdjustRows.sheetSource,e=this._headAdjustRows.row,b.getRowExpression&&(f=b.getRowExpression(e))&&b.setRowExpression&&b.setRowExpression(e,this.adjustFormulaOnSwap(b,e,-1,f,a)),this.removeAdjustRow(this._headAdjustRows);for(;this._headAdjustColumns;)b=this._headAdjustColumns.sheetSource,
d=this._headAdjustColumns.column,b.getColumnExpression&&(f=b.getColumnExpression(d))&&b.setColumnExpression&&b.setColumnExpression(d,this.adjustFormulaOnSwap(b,-1,d,f,a)),this.removeAdjustColumn(this._headAdjustColumns)}};ea._Controller=Ya;ob.prototype={_getSheetReference:function(){return this._reference=this._reference||new r(this)},getValue:function(a,b){if(0>a||0>b||a>=this.getRowCount()||b>=this.getColumnCount())return ya;var e=this._sheet;return e._isValidatingCell&&e._validatingRow===a&&e._validatingColumn===
b?e._validatingValue:e.getValue(a,b)},getReference:function(a,b,e,d){return-1===a&&-1===b?this._getSheetReference():-1===a?new t(this._getSheetReference(),[{row:0,rowCount:this.getRowCount(),col:b,colCount:d}]):-1===b?new t(this._getSheetReference(),[{row:a,rowCount:e,col:0,colCount:this.getColumnCount()}]):new t(this._getSheetReference(),[{row:a,rowCount:e,col:b,colCount:d}])},getFunction:function(a){return this._sheet?this._sheet._findCustomFunction(a):null},getName:function(a,b,e){return(a=this._sheet?
this._sheet._findCustomName(a):null)?a.getExpression():null},getColumnCount:function(){return this._sheet.getColumnCount()},getRowCount:function(){return this._sheet.getRowCount()},getCalcService:function(){return this._sheet?this._sheet.getCalcService():null},hasFormula:function(a,b){a=a!==m?a:-1;b=b!==m?b:-1;return!!this.getExpression(a,b)},setFormula:function(a,b,e){e&&0===e.length&&(e=null);var d=this.getFormula(a,b);if(d!==e&&(""!==d||e)&&(d||""!==e)){if(d=this.getCalcService())d=e?d.parse(e,
0<=a?a:0,0<=b?b:0):null,this.setExpression(a,b,d);0<=a&&0<=b&&this._sheet._getModel(this._sheetArea).setFormula(a,b,e)}},getFormula:function(a,b){var e=this.getCalcService();if(e){var d=this.getExpression(a,b);return d?e.unparse(d,a,b):null}return null},getRowFormula:function(a){return this.getFormula(a,-1)},setRowFormula:function(a,b){this.setFormula(a,-1,b)},getColumnFormula:function(a){this.getFormula(-1,a)},setColumnFormula:function(a,b){this.setFormula(-1,a,b)},getExpression:function(a,b){var e=
null,d,f;f=this._sheet._getCalcModel(this._sheetArea);if(this._sheet){if(d=f.getNode(a,b))e=d.formula;!e&&a<f.getRowCount()&&(d=f.getNode(a,-1))&&(e=d.formula);!e&&b<f.getColumnCount()&&(f=f.getNode(-1,b))&&(e=f.formula)}else 0<=a&&-1===b?!e&&a<f.getRowCount()&&(d=f.getNode(a,-1))&&(e=d.formula):-1===a&&0<=b?e&&b<f.getColumnCount()&&(f=f.getNode(-1,b))&&(e=f.formula):-1===a&&-1===b&&(d=f.getNode(-1,-1))&&(e=d.formula);return e},setExpression:function(a,b,e){0<=a&&0<=b?this._setCellExpression(a,b,
e):0<=a&&-1===b?this._setRowExpression(a,e):-1===a&&0<=b&&this._setColumnExpression(b,e);this._controller.autoCalculation&&this._controller.recalculate()},getRowExpression:function(a){return this.getExpression(a,-1)},getColumnExpression:function(a){return this.getExpression(-1,a)},_setCellExpression:function(a,b,e){var d=this._getCellCalc(a,b,!0);d&&(d.stopListening(),this._sheet._getCalcModel(this._sheetArea).getNode(a,b,!0).formula=e,d.startListening(),this._controller.addDirtyCell(d))},_setRowExpression:function(a,
b){var e=this._getRowCalc(a,!0);if(e){e.stopListening();var d=this._sheet._getCalcModel(this._sheetArea),f=d._rowDataArray[a];f||(d._rowDataArray[a]=f={});f.formula=b;e.startListening();this._controller.addDirtyRow(e)}},_setColumnExpression:function(a,b){var e=this._getColumnCalc(a,!0);if(e){e.stopListening();var d=this._sheet._getCalcModel(this._sheetArea),f=d._columnDataArray[a];f||(d._columnDataArray[a]=f={});f.formula=b;e.startListening();this._controller.addDirtyRow(e)}},onBeforeAddRemoveRows:function(a){var b=
this.getRowCount(),e=this.getColumnCount();this.unlinkCellExpression(a,0,b-a,e);this.unlinkRowExpression(a,b-a);this._addDependentsToAdjust(a,-1,b-a,-1)},onAfterAddRows:function(a,b){var e=this.getRowCount(),d=this.getColumnCount();this._addCellsToDirty(a,0,b,d);this._addCellsToAdjust(a,0,e-a,d);this._addRowsToAdjust(a,e-a);this._controller.adjustFormulasOnAddRows(this,a,b);this._controller.autoCalculation&&this._controller.recalculate()},onAfterRemoveRows:function(a,b){var e=this.getRowCount(),d=
this.getColumnCount();this._addCellsToAdjust(a,0,e-a,d);this._addRowsToAdjust(a,e-a);this._controller.adjustFormulasOnRemoveRows(this,a,b);this._controller.autoCalculation&&this._controller.recalculate()},onBeforeAddRemoveColumns:function(a){var b=this.getRowCount(),e=this.getColumnCount();this.unlinkCellExpression(0,a,b,e-a);this.unlinkColumnExpression(a,e-a);this._addDependentsToAdjust(-1,a,-1,e-a)},onAfterAddColumns:function(a,b){var e=this.getRowCount(),d=this.getColumnCount();this._addCellsToDirty(0,
a,e,b);this._addCellsToAdjust(0,a,e,d-a);this._addColumnsToAdjust(a,d-a);this._controller.adjustFormulasOnAddColumns(this,a,b)},onAfterRemoveColumns:function(a,b){var e=this.getRowCount(),d=this.getColumnCount();this._addCellsToAdjust(0,a,e,d-a);this._addColumnsToAdjust(a,d-a);this._controller.adjustFormulasOnRemoveColumns(this,a,b);this._controller.autoCalculation&&this._controller.recalculate()},_buildAction:function(a,b,e){return a[b+""+e]},_dealWithExpression:function(a,b,e,d){for(;e instanceof
K;)e=e.argument;var f,h,g,k,l,n,F,m,B;if(e instanceof da||e instanceof ha)B=e instanceof da?this:e.source,0<=a&&0<=b?(f=e.row+(e.rowRelative?a:0),h=e.column+(e.columnRelative?b:0),m=this._getCellCalc(a,b,!0),(f=B._getCellCalc(f,h,!0))&&this._buildAction(f,d,"CellListener").call(f,m)):0<=a&&-1===b?(f=e.row+(e.rowRelative?a:0),h=e.column,m=this._getRowCalc(a,!0),e.columnRelative?(f=B._getRowCalc(f,!0))&&this._buildAction(f,d,"RowListener2").call(f,m,-h):(f=B._getCellCalc(f,h,!0))&&this._buildAction(f,
d,"RowListener").call(f,m)):-1===a&&0<=b&&(f=e.row,h=e.column+(e.columnRelative?b:0),m=this._getColumnCalc(b,!0),e.rowRelative?(h=B._getColumnCalc(h,!0))&&this._buildAction(h,d,"ColumnListener2").call(h,m,-f):(f=B._getCellCalc(f,h,!0))&&this._buildAction(f,d,"ColumnListener").call(f,m));else if(e instanceof X||e instanceof ca)if(B=e instanceof X?this:e.source,l=e._getRangeType(),0===l)if(0<=a&&0<=b)if(g=e.startRow+(e.startRowRelative?a:0),l=e.startColumn+(e.startColumnRelative?b:0),k=e.endRow+(e.endRowRelative?
a:0),n=e.endColumn+(e.endColumnRelative?b:0),e=Math.abs(k-g)+1,F=Math.abs(n-l)+1,m=this._getCellCalc(a,b,!0),-1===f&&127<F||-1===h&&127<e||127<e*F)(B=B._getRangeCalc(!0))&&this._buildAction(B,d,"CellListener").call(B,g,l,e,F,m);else for(a=g;a<=k;a++)for(b=l;b<=n;b++)(f=B._getCellCalc(a,b,!0))&&this._buildAction(f,d,"CellListener").call(f,m);else if(0<=a&&-1===b)for(g=e.startRow+(e.startRowRelative?a:0),l=e.startColumn+(e.startColumnRelative?b:0),k=e.endRow+(e.endRowRelative?a:0),n=e.endColumn+(e.endColumnRelative?
b:0),m=this._getRowCalc(a,!0),a=g;a<=k;a++)for(b=l;b<=n;b++)e.startColumnRelative||e.endColumnRelative?(f=B._getRowCalc(a,!0))&&this._buildAction(f,d,"RowListener2").call(f,m,-b):(f=B._getCellCalc(a,b,!0))&&this._buildAction(f,d,"RowListener").call(f,m);else{if(-1===a&&0<=b)for(g=e.startRow+(e.startRowRelative?a:0),l=e.startColumn+(e.startColumnRelative?b:0),k=e.endRow+(e.endRowRelative?a:0),n=e.endColumn+(e.endColumnRelative?b:0),m=this._getColumnCalc(b,!0),a=g;a<=k;a++)for(b=l;b<=n;b++)e.startRowRelative||
e.endRowRelative?(h=B._getColumnCalc(a,!0))&&this._buildAction(h,d,"ColumnListener2").call(h,m,-a):(f=B._getCellCalc(a,b,!0))&&this._buildAction(f,d,"ColumnListener").call(f,m)}else if(1===l){if(0<=a&&0<=b)for(g=e.startRow+(e.startRowRelative?a:0),k=e.endRow+(e.endRowRelative?a:0),m=this._getCellCalc(a,b,!0),a=g;a<=k;a++)(f=B._getRowCalc(a,!0))&&this._buildAction(f,d,"CellListener").call(f,m)}else{if(2===l&&0<=a&&0<=b)for(l=e.startColumn+(e.startColumnRelative?b:0),n=e.endColumn+(e.endColumnRelative?
b:0),m=this._getCellCalc(a,b,!0),b=l;b<=n;b++)(h=B._getColumnCalc(b,!0))&&this._buildAction(h,d,"CellListener").call(h,m)}else if(e instanceof ja)this._dealWithExpression(a,b,e.operand,d);else if(e instanceof fa)this._dealWithExpression(a,b,e.left,d),this._dealWithExpression(a,b,e.right,d);else if(e instanceof L||e instanceof w){if(B=e instanceof L?this:e.source,m=this._getCellCalc(a,b,!0),l=B._getNameCalc(e.name,!0))this._buildAction(l,d,"CellListener").call(l,m),this._dealWithExpression(a,b,B.getName(e.name,
a,b),d)}else if(e instanceof A)for(B=e.argCount(),l=0;l<B;l++)this._dealWithExpression(a,b,e.getArg(l),d)},linkExpression:function(a,b,e){this._dealWithExpression(a,b,e,"add")},unlinkExpression:function(a,b,e){this._dealWithExpression(a,b,e,"remove")},_dealWithCellExpression:function(a,b,e,d,f){for(var h=this._sheet._getCalcModel(this._sheetArea),g=a;-1!==g&&g<a+e;g=h.nextNonNullRow(g))for(var k=b;-1!==k&&k<b+d;k=h.nextNonNullColumn(g,k)){var l=h.getFormula(g,k);l&&f.call(this,g,k,l)}},linkCellExpression:function(a,
b,e,d){this._dealWithCellExpression(a,b,e,d,this.linkExpression)},unlinkCellExpression:function(a,b,e,d){this._dealWithCellExpression(a,b,e,d,this.unlinkExpression)},linkRowExpression:function(a,b){},unlinkRowExpression:function(a,b){},linkColumnExpression:function(a,b){},unlinkColumnExpression:function(a,b){},_addColumnsToDirty:function(a,b){var e=this._sheet._getCalcModel(this._sheetArea);if(e._columnDataArray)for(var d=a;-1!==d&&d<a+b&&d<e._columnDataArray.length;d++){var f=e._columnDataArray[d];
f&&(f.columnCalc||f.formula)&&(f=this._getColumnCalc(d,!0),this._controller.addDirtyColumn(f))}},_addRowsToDirty:function(a,b){var e=this._sheet._getCalcModel(this._sheetArea);if(e._rowDataArray)for(var d=a;-1!==d&&d<a+b&&d<e._rowDataArray.length;d++){var f=e._rowDataArray[d];f&&(f.rowCalc||f.formula)&&(f=this._getRowCalc(d,!0),this._controller.addDirtyRow(f))}},_addCellsToDirty:function(a,b,e,d){for(var f=this._sheet._getCalcModel(this._sheetArea),h=a;-1!==h&&h<a+e;h=f.nextNonNullRow(h))for(var g=
b;-1!==g&&g<b+d;g=f.nextNonNullColumn(h,g)){var k=f.getNode(h,g,!1);k&&(k.cellCalc||k.formula)&&(k=this._getCellCalc(h,g,!0),this._controller.addDirtyCell(k))}this._addRowsToDirty(a,e);this._addColumnsToDirty(b,d)},_addDependentsToAdjust:function(a,b,e,d){this._addDependents(a,b,e,d,!0,!1)},_iterateEachCell:function(a,b,e,d,f,h,g){for(var k=b;-1!==k&&k<b+d;k=a.nextNonNullRow(k))for(var l=e;-1!==l&&l<e+f;l=a.nextNonNullColumn(k,l)){var n=this._getCellCalc(k,l,!1);n&&(h&&n.addListenersToAdjust(),g&&
n.addListenersToDirty())}},_iterateEachRow:function(a,b,e,d,f){if(a._rowDataArray)for(var h=b;-1!==h&&h<b+e&&h<a._rowDataArray.length;h++){var g=a._rowDataArray[h];g&&g.rowCalc&&(g=g.rowCalc,d&&g.addListenersToAdjust(),f&&g.addListenersToDirty())}},_iterateEachColumn:function(a,b,e,d,f){if(a._columnDataArray)for(var h=b;-1!==h&&h<b+e&&h<a._columnDataArray.length;h++){var g=a._columnDataArray[h];g&&g.columnCalc&&(g=g.columnCalc,d&&g.addListenersToAdjust(),f&&g.addListenersToDirty())}},_addDependents:function(a,
b,e,d,f,h){if(f||h){var g=this._sheet._getCalcModel(this._sheetArea);if(0<=a&&0<=b)this._iterateEachCell(g,a,b,e,d,f,h),this._iterateEachRow(g,a,e,f,h),this._iterateEachColumn(g,b,d,f,h),this._rangeCalc&&(f&&this._rangeCalc.addListenersToAdjust(a,b,e,d),h&&this._rangeCalc.addListenersToDirty(a,b,e,d));else if(0<=a&&-1===b)this._iterateEachCell(g,a,0,e,this.getColumnCount(),f,h),this._iterateEachRow(g,a,e,f,h),this._rangeCalc&&(f&&this._rangeCalc.addListenersToAdjust(a,b,e,d),h&&this._rangeCalc.addListenersToDirty(a,
b,e,d));else if(-1===a&&0<=b)this._iterateEachCell(g,0,b,this.getRowCount(),d,f,h),this._iterateEachColumn(g,b,d,f,h),this._rangeCalc&&(f&&this._rangeCalc.addListenersToAdjust(a,b,e,d),h&&this._rangeCalc.addListenersToDirty(a,b,e,d));else if(-1===a&&-1===b){var k=this.getRowCount(),l=this.getColumnCount();this._iterateEachCell(g,0,0,k,l,f,h);this._iterateEachRow(g,0,k,f,h);this._iterateEachColumn(g,0,l,f,h);this._rangeCalc&&(f&&this._rangeCalc.addListenersToAdjust(a,b,e,d),h&&this._rangeCalc.addListenersToDirty(a,
b,e,d))}}},_addCellsToAdjust:function(a,b,e,d){for(var f=this._sheet._getCalcModel(this._sheetArea),h=a;-1!==h&&h<a+e;h=f.nextNonNullRow(h))for(var g=b;-1!==g&&g<b+d;g=f.nextNonNullColumn(h,g)){var k=f.getNode(h,g,!1);k&&(k.cellCalc||k.formula)&&(k.cellCalc&&(k.cellCalc=null),k=this._getCellCalc(h,g,!0),this._controller.addAdjustCell(k))}},_addColumnsToAdjust:function(a,b){var e=this._sheet._getCalcModel(this._sheetArea);if(e._columnDataArray)for(var d=a;-1!==d&&d<a+b&&d<e._columnDataArray.length;d++){var f=
e._columnDataArray[d];f&&(f.columnCalc||f.formula)&&(f=this._getColumnCalc(d,!0),this._controller.addAdjustColumn(f))}},_addRowsToAdjust:function(a,b){var e=this._sheet._getCalcModel(this._sheetArea);if(e._rowDataArray)for(var d=a;-1!==d&&d<a+b&&d<e._rowDataArray.length;d++){var f=e._rowDataArray[d];f&&(f.rowCalc||f.formula)&&(f=this._getRowCalc(d,!0),this._controller.addAdjustRow(f))}},_getCellCalc:function(a,b,e){var d=null;if(0<=a&&0<=b){var f=this._sheet._getCalcModel(this._sheetArea).getNode(a,
b,e);f&&(d=f.cellCalc,!d&&e&&(f.cellCalc=d=new Na(this,a,b)))}return d},_getRowCalc:function(a,b){var e=null;if(0<=a){var d=this._sheet._getCalcModel(this._sheetArea).getNode(a,-1,b);d&&(e=d.rowCalc,!e&&b&&(d.rowCalc=e=new Ca(this,a)))}return e},_getColumnCalc:function(a,b){var e=null;if(0<=a){var d=this._sheet._getCalcModel(this._sheetArea).getNode(-1,a,b);d&&(e=d.columnCalc,!e&&b&&(d.columnCalc=e=new Da(this,a)))}return e},_getRangeCalc:function(a){var b=this._sheet._getCalcModel(this._sheetArea);
!b._rangeCalc&&a&&(b._rangeCalc=new mb(this));return b._rangeCalc},_getNameCalc:function(a,b){var e=null,d;this._sheet.getCustomName(a)?(d=this._sheet._getCalcModel(this._sheetArea),d._names||(d._names={}),e=d._names[a],!e&&b&&(e=d._names[a]=new Pa(a))):((d=this._sheet.getCalcService())&&d._getNameCalc&&(e=d._getNameCalc(a,b)),e||(d=this._sheet._getCalcModel(this._sheetArea),d._names||(d._names={}),e=d._names[a],!e&&b&&(e=d._names[a]=new Pa(a))));return e},recalculateCell:function(a,b){var e=this.getExpression(a,
b);if(e){var d=this._sheet.getValue(a,b),e=this._sheet.getCalcService().evaluateParsedFormula(this,e,a,b);d===e||d instanceof Date&&e instanceof Date&&d.valueOf()===e.valueOf()||this._sheet._getModel().setValue(a,b,e)}},shareCalculations:function(a){if(this._controller!==a._controller){this._controller.detachDataModel(this);if(0<this._controller._dataModels.length){var b=this._controller._dataModels[0];b&&b.shareCalculations(a)}a._controller.addCustomFunctions(this._controller._customFunctions);a._controller.addCustomNames(this._controller._customNames);
this._controller=a._controller;this._controller.attachDataModel(this)}},unshareCalculations:function(){this._addCellsToAdjust(0,0,this.getRowCount(),this.getColumnCount());this._addRowsToAdjust(0,this.getRowCount());this._addColumnsToAdjust(0,this.getColumnCount());this._addDependentsToAdjust(-1,-1,-1,-1);this._controller.adjustFormulasOnRemoveSheet(this);this._controller.autoCalculation&&this._controller.recalculate();this._controller.detachDataModel(this);this._controller=new Ya;this._controller.attachDataModel(this)}};
ea._SheetSource=ob;pb.prototype={contextChanged:function(){this.cachedContexts=null},_getExternalSource:function(a,b){if(!this.context||a&&!(this.context instanceof Ea.GcSpread&&this.context.name===a))return null;var e=this.getSheetContexts();if(e&&0<e.length)for(var d=0;d<e.length;d++){var f=e[d];if(B(f.name,b))return f.target._getSheetSource()}return null},_getExternalSourceToken:function(a){return a._sheet._name},_getParserContext:function(a,b){var e=new ab(this.useR1C1,a,b,null),d=this;e.getExternalSource=
function(a,b){return d._getExternalSource(a,b)};e.getExternalSourceToken=function(a){return d._getExternalSourceToken(a)};return e},_getEvaluatorContext4Cell:function(a,b,e,d){return new Sa(a._getSheetSource(),d,b,e)},_getEvaluatorContext4Range:function(a,b,e,d,f,h){return new Sa(a._getSheetSource(),h,b,e,d,f)},getSheetContexts:function(){this.cachedContexts||this.createSheetContexts();return this.cachedContexts},createSheetContexts:function(){this.context&&(this.cachedContexts=this.context._getCalcContexts())},
parse:function(a,b,e){var d=this._getParserContext(b,e);d.row=b;d.column=e;return this.parser.parse(a,d)},unparse:function(a,b,e){var d=this._getParserContext(b,e);d.row=b;d.column=e;return this.parser.unparse(a,d)},evaluateParsedFormula:function(a,b,e,d,f){a=this._getEvaluatorContext4Cell(a._sheet,e,d,f);b=this.evaluator.evaluateExpression(b,a);if(f)return b;if(b instanceof s){f=b.getRowCount(0);a=b.getColumnCount(0);if(0>=b.getRangeCount()||0>=f||0>=a)return pa;if(1!==b.getRangeCount()||1<f&&1<
a)return ya;try{var h=e-b.getRow(0),k=d-b.getColumn(0);return 1===f&&1===a?b.getValue(0,0,0):1===f&&1<a&&0<=k&&k<a?b.getValue(0,0,k):1<f&&1===a&&0<=h&&h<f?b.getValue(0,h,0):ya}catch(l){return ya}}else if(b instanceof g)return b.getValueByIndex(0);return b},evaluate:function(a,b,e,d){return this.evaluator.evaluateFormula(b,this._getParserContext(e,d),this._getEvaluatorContext4Cell(a._sheet,e,d,!1))},recalculate:function(a,b,e){if(a=a.target)if(a=a._getSheetSource())a._addCellsToDirty(b,e,1,1),0===
this._suspended&&a._controller.recalculate()},recalculateAll:function(a){var b=this.getSheetContexts();if(b)for(var e=0;e<b.length;e++){var d=b[e].target;if(d){var f=d._getSheetSource();if(f){if(!1!==a){var h=d.getColumnCount(),d=d.getRowCount();f._addColumnsToDirty(0,h);f._addRowsToDirty(0,d);f._addCellsToDirty(0,0,d,h)}0===this._suspended&&f._controller.recalculate()}}}},suspend:function(){this._suspended++},resume:function(){this._suspended--;0>this._suspended&&(this._suspended=0);0===this._suspended&&
this.recalculateAll(!1)}};ea.Service=pb})(this,jQuery);(function(p,l){var m=p.GrapeCity;"undefined"===typeof m&&(m=p.GrapeCity={});"undefined"===typeof m.UI&&(m.UI={})})(window,jQuery);
(function(p){var l=p.GrapeCity.UI;l.Cell=function(m,k,g,a){this.sheet=m;this.row2=this.row=k;this.col2=this.col=g;if(void 0===a||null===a)a=l.SheetArea.viewport;this.sheetArea=a};l.Cell.prototype={value:function(l){if(0===arguments.length)return this.sheet.getValue(this.row,this.col,this.sheetArea);for(var k=this.row;k<=this.row2;k++)for(var g=this.col;g<=this.col2;g++)this._isValidIndex(k,g)&&this.sheet.setValue(k,g,l,this.sheetArea);return this},text:function(l){if(0===arguments.length)return this.sheet.getText(this.row,
this.col,this.sheetArea);for(var k=this.row;k<=this.row2;k++)for(var g=this.col;g<=this.col2;g++)this._isValidIndex(k,g)&&this.sheet.setText(k,g,l,this.sheetArea);return this},formula:function(l){if(0===arguments.length)return this.sheet.getFormula(this.row,this.col,this.sheetArea);for(var k=this.row;k<=this.row2;k++)for(var g=this.col;g<=this.col2;g++)this._isValidIndex(k,g)&&this.sheet.setFormula(k,g,l,this.sheetArea);return this},bindingPath:function(l){if(0===arguments.length)return this.sheet.getBindingPath(this.row,
this.col,this.sheetArea);for(var k=this.row;k<=this.row2;k++)for(var g=this.col;g<=this.col2;g++)this._isValidIndex(k,g)&&this.sheet.setBindingPath(k,g,l,this.sheetArea);return this},dataValidator:function(l){return 0==arguments.length?this._getStyleProperty("validator"):this._setStyleProperty("validator",l)},cellType:function(l){return 0==arguments.length?this._getStyleProperty("cellType"):this._setStyleProperty("cellType",l)},backgroundImage:function(l){return 0==arguments.length?this._getStyleProperty("backgroundImage"):
this._setStyleProperty("backgroundImage",l)},backColor:function(l){return 0===arguments.length?this._getStyleProperty("backColor"):this._setStyleProperty("backColor",l)},foreColor:function(l){return 0===arguments.length?this._getStyleProperty("foreColor"):this._setStyleProperty("foreColor",l)},hAlign:function(l){return 0===arguments.length?this._getStyleProperty("hAlign"):this._setStyleProperty("hAlign",l)},vAlign:function(l){return 0===arguments.length?this._getStyleProperty("vAlign"):this._setStyleProperty("vAlign",
l)},themeFont:function(l){return 0===arguments.length?this._getStyleProperty("themeFont"):this._setStyleProperty("themeFont",l)},font:function(l){return 0===arguments.length?this._getStyleProperty("font"):this._setStyleProperty("font",l)},formatter:function(l){return 0===arguments.length?this._getStyleProperty("formatter"):this._setStyleProperty("formatter",l)},borderLeft:function(l){return 0===arguments.length?this._getStyleProperty("borderLeft"):this._setStyleProperty("borderLeft",l)},borderTop:function(l){return 0===
arguments.length?this._getStyleProperty("borderTop"):this._setStyleProperty("borderTop",l)},borderRight:function(l){return 0===arguments.length?this._getStyleProperty("borderRight"):this._setStyleProperty("borderRight",l)},borderBottom:function(l){return 0===arguments.length?this._getStyleProperty("borderBottom"):this._setStyleProperty("borderBottom",l)},locked:function(l){return 0===arguments.length?this._getStyleProperty("locked"):this._setStyleProperty("locked",l)},textIndent:function(l){return 0===
arguments.length?this._getStyleProperty("textIndent"):this._setStyleProperty("textIndent",l)},wordWrap:function(l){return 0===arguments.length?this._getStyleProperty("wordWrap"):this._setStyleProperty("wordWrap",l)},shrinkToFit:function(l){return 0===arguments.length?this._getStyleProperty("shrinkToFit"):this._setStyleProperty("shrinkToFit",l)},clearStyleProperty:function(l){for(var k=this.row;k<=this.row2;k++)for(var g=this.col;g<=this.col2;g++)if(this._isValidIndex(k,g)){var a=this.sheet.getStyle(k,
g,this.sheetArea);a&&a.clear(l)}},_getStyleProperty:function(l){var k=this.sheet.getActualStyle(this.row,this.col,this.sheetArea);return k?k[l]:void 0},_setStyleProperty:function(m,k){for(var g=this.row;g<=this.row2;g++)for(var a=this.col;a<=this.col2;a++)if(this._isValidIndex(g,a)){var d=this.sheet.getStyle(g,a,this.sheetArea);d||(d=new l.Style);d[m]=k;this.sheet.setStyle(g,a,d,this.sheetArea)}return this},_isValidIndex:function(l,k){if(this.sheet){var g=this.sheet.getRowCount(this.sheetArea),a=
this.sheet.getColumnCount(this.sheetArea);if(0<=l&&l<g&&0<=k&&k<a)return!0}return!1}};l.Row=function(m,k,g){this.sheet=m;this.index2=this.index=k;if(void 0===g||null===g)g=l.SheetArea.viewport;this.sheetArea=g};l.Row.prototype={height:function(l){if(0===arguments.length)return this.sheet.getRowHeight(this.index,this.sheetArea);for(var k=this.index;k<=this.index2;k++)this._isValidIndex(k)&&this.sheet.setRowHeight(k,l,this.sheetArea);return this},visible:function(l){if(0===arguments.length)return this.sheet.getRowVisible(this.index,
this.sheetArea);for(var k=this.index;k<=this.index2;k++)this._isValidIndex(k)&&this.sheet.setRowVisible(k,l,this.sheetArea);return this},resizable:function(l){if(0===arguments.length)return this.sheet.getRowResizable(this.index,this.sheetArea);for(var k=this.index;k<=this.index2;k++)this._isValidIndex(k)&&this.sheet.setRowResizable(k,l,this.sheetArea);return this},dataValidator:function(l){return 0==arguments.length?this._getStyleProperty("validator"):this._setStyleProperty("validator",l)},cellType:function(l){return 0==
arguments.length?this._getStyleProperty("cellType"):this._setStyleProperty("cellType",l)},backgroundImage:function(l){return 0==arguments.length?this._getStyleProperty("backgroundImage"):this._setStyleProperty("backgroundImage",l)},backColor:function(l){return 0===arguments.length?this._getStyleProperty("backColor"):this._setStyleProperty("backColor",l)},foreColor:function(l){return 0===arguments.length?this._getStyleProperty("foreColor"):this._setStyleProperty("foreColor",l)},hAlign:function(l){return 0===
arguments.length?this._getStyleProperty("hAlign"):this._setStyleProperty("hAlign",l)},vAlign:function(l){return 0===arguments.length?this._getStyleProperty("vAlign"):this._setStyleProperty("vAlign",l)},themeFont:function(l){return 0===arguments.length?this._getStyleProperty("themeFont"):this._setStyleProperty("themeFont",l)},font:function(l){return 0===arguments.length?this._getStyleProperty("font"):this._setStyleProperty("font",l)},formatter:function(l){return 0===arguments.length?this._getStyleProperty("formatter"):
this._setStyleProperty("formatter",l)},borderLeft:function(l){return 0===arguments.length?this._getStyleProperty("borderLeft"):this._setStyleProperty("borderLeft",l)},borderTop:function(l){return 0===arguments.length?this._getStyleProperty("borderTop"):this._setStyleProperty("borderTop",l)},borderRight:function(l){return 0===arguments.length?this._getStyleProperty("borderRight"):this._setStyleProperty("borderRight",l)},borderBottom:function(l){return 0===arguments.length?this._getStyleProperty("borderBottom"):
this._setStyleProperty("borderBottom",l)},locked:function(l){return 0===arguments.length?this._getStyleProperty("locked"):this._setStyleProperty("locked",l)},textIndent:function(l){return 0===arguments.length?this._getStyleProperty("textIndent"):this._setStyleProperty("textIndent",l)},wordWrap:function(l){return 0===arguments.length?this._getStyleProperty("wordWrap"):this._setStyleProperty("wordWrap",l)},shrinkToFit:function(l){return 0===arguments.length?this._getStyleProperty("shrinkToFit"):this._setStyleProperty("shrinkToFit",
l)},clearStyleProperty:function(m){for(var k=this.index;k<=this.index2;k++)if(this._isValidIndex(k)){var g=this.sheet.getStyle(k,-1,this.sheetArea);g&&(g.clear(m),this.sheet._trigger(l.Events.RowChanged,{sheet:this.sheet,sheetName:this.sheet._name,row:k,sheetArea:this.sheetArea,propertyName:m}))}},_getStyleProperty:function(l){var k=this.sheet.getStyle(this.index,-1,this.sheetArea);return k?k[l]:void 0},_setStyleProperty:function(m,k){for(var g=this.index;g<=this.index2;g++)if(this._isValidIndex(g)){var a=
this.sheet.getStyle(g,-1,this.sheetArea);a||(a=new l.Style);a[m]=k;this.sheet.setStyle(g,-1,a,this.sheetArea)}return this},_isValidIndex:function(l){if(this.sheet){var k=this.sheet.getRowCount(this.sheetArea);if(0<=l&&l<k)return!0}return!1}};l.Col=function(m,k,g){this.sheet=m;this.index2=this.index=k;if(void 0===g||null===g)g=l.SheetArea.viewport;this.sheetArea=g};l.Col.prototype={width:function(l){if(0===arguments.length)return this.sheet.getColumnWidth(this.index,this.sheetArea);for(var k=this.index;k<=
this.index2;k++)this._isValidIndex(k)&&this.sheet.setColumnWidth(k,l,this.sheetArea);return this},visible:function(l){if(0===arguments.length)return this.sheet.getColumnVisible(this.index,this.sheetArea);for(var k=this.index;k<=this.index2;k++)this._isValidIndex(k)&&this.sheet.setColumnVisible(k,l,this.sheetArea);return this},resizable:function(l){if(0===arguments.length)return this.sheet.getColumnResizable(this.index,this.sheetArea);for(var k=this.index;k<=this.index2;k++)this._isValidIndex(k)&&
this.sheet.setColumnResizable(k,l,this.sheetArea);return this},dataValidator:function(l){return 0==arguments.length?this._getStyleProperty("validator"):this._setStyleProperty("validator",l)},cellType:function(l){return 0==arguments.length?this._getStyleProperty("cellType"):this._setStyleProperty("cellType",l)},backgroundImage:function(l){return 0==arguments.length?this._getStyleProperty("backgroundImage"):this._setStyleProperty("backgroundImage",l)},backColor:function(l){return 0===arguments.length?
this._getStyleProperty("backColor"):this._setStyleProperty("backColor",l)},foreColor:function(l){return 0===arguments.length?this._getStyleProperty("foreColor"):this._setStyleProperty("foreColor",l)},hAlign:function(l){return 0===arguments.length?this._getStyleProperty("hAlign"):this._setStyleProperty("hAlign",l)},vAlign:function(l){return 0===arguments.length?this._getStyleProperty("vAlign"):this._setStyleProperty("vAlign",l)},themeFont:function(l){return 0===arguments.length?this._getStyleProperty("themeFont"):
this._setStyleProperty("themeFont",l)},font:function(l){return 0===arguments.length?this._getStyleProperty("font"):this._setStyleProperty("font",l)},formatter:function(l){return 0===arguments.length?this._getStyleProperty("formatter"):this._setStyleProperty("formatter",l)},borderLeft:function(l){return 0===arguments.length?this._getStyleProperty("borderLeft"):this._setStyleProperty("borderLeft",l)},borderTop:function(l){return 0===arguments.length?this._getStyleProperty("borderTop"):this._setStyleProperty("borderTop",
l)},borderRight:function(l){return 0===arguments.length?this._getStyleProperty("borderRight"):this._setStyleProperty("borderRight",l)},borderBottom:function(l){return 0===arguments.length?this._getStyleProperty("borderBottom"):this._setStyleProperty("borderBottom",l)},locked:function(l){return 0===arguments.length?this._getStyleProperty("locked"):this._setStyleProperty("locked",l)},textIndent:function(l){return 0===arguments.length?this._getStyleProperty("textIndent"):this._setStyleProperty("textIndent",
l)},wordWrap:function(l){return 0===arguments.length?this._getStyleProperty("wordWrap"):this._setStyleProperty("wordWrap",l)},shrinkToFit:function(l){return 0===arguments.length?this._getStyleProperty("shrinkToFit"):this._setStyleProperty("shrinkToFit",l)},clearStyleProperty:function(m){for(var k=this.index;k<=this.index2;k++)if(this._isValidIndex(k)){var g=this.sheet.getStyle(-1,k,this.sheetArea);g&&(g.clear(m),this.sheet._trigger(l.Events.ColumnChanged,{sheet:this.sheet,sheetName:this.sheet._name,
col:k,sheetArea:this.sheetArea,propertyName:m}))}},_getStyleProperty:function(l){var k=this.sheet.getStyle(-1,this.index,this.sheetArea);return k?k[l]:void 0},_setStyleProperty:function(m,k){for(var g=this.index;g<=this.index2;g++)if(this._isValidIndex(g)){var a=this.sheet.getStyle(-1,g,this.sheetArea);a||(a=new l.Style);a[m]=k;this.sheet.setStyle(-1,g,a,this.sheetArea)}return this},_isValidIndex:function(l){if(this.sheet){var k=this.sheet.getColumnCount(this.sheetArea);if(0<=l&&l<k)return!0}return!1}}})(window);
(function(p){p.widget("wijmo.wijspreadpanelex",{options:{allowResize:!1,autoRefresh:!1,animationOptions:{queue:!1,disabled:!1,duration:250,easing:void 0},hScrollerActivating:null,hScroller:{scrollBarPosition:"bottom",scrollBarVisibility:"auto",scrollMode:"scrollBar",scrollValue:null,scrollMax:100,scrollMin:0,scrollLargeChange:null,scrollSmallChange:null,scrollMinDragLength:6,increaseButtonPosition:null,decreaseButtonPosition:null,hoverEdgeSpan:20,firstStepChangeFix:0},keyboardSupport:!1,keyDownInterval:100,
mouseWheelSupport:!0,bubbleScrollingEvent:!0,resizableOptions:{handles:"all",helper:"ui-widget-content wijmo-wijsuperpanel-helper"},resized:null,dragStop:null,painted:null,scrolling:null,scroll:null,scrolled:null,showRounder:!0,vScrollerActivating:null,vScroller:{scrollBarPosition:"right",scrollBarVisibility:"auto",scrollMode:"scrollBar",scrollValue:null,scrollMax:100,scrollMin:0,scrollLargeChange:null,scrollSmallChange:null,scrollMinDragLength:6,increaseButtonPosition:null,decreaseButtonPosition:null,
hoverEdgeSpan:20,firstStepChangeFix:0}},_setOption:function(l,m){var k=this.options,g=this._fields(),a=g.hbarDrag,d=g.vbarDrag,e=g.resizer;"animationOptions"===l?m=p.extend(k.animationOptions,m):"hScroller"===l?(void 0!==m.scrollLargeChange&&null!==m.scrollLargeChange&&(this._autoHLarge=!1),m=p.extend(k.hScroller,m)):"vScroller"===l?(void 0!==m.scrollLargeChange&&null!==m.scrollLargeChange&&(this._autoVLarge=!1),m=p.extend(k.vScroller,m)):"resizableOptions"===l&&(m=p.extend(this.resizableOptions,
m));p.Widget.prototype._setOption.apply(this,arguments);p.isPlainObject(m)&&(this.options[l]=m);switch(l){case "allowResize":this._initResizer();break;case "disabled":m?(void 0!==a&&a.draggable("disable"),void 0!==d&&d.draggable("disable"),void 0!==e&&e.resizable("disable")):(void 0!==a&&a.draggable("enable"),void 0!==d&&d.draggable("enable"),void 0!==e&&e.resizable("enable"));break;case "mouseWheelSupport":case "keyboardSupport":this._bindElementEvents(this,g,this.element,k)}return this},_create:function(){var l=
this.options;l.vScroller.dir="v";l.hScroller.dir="h";this.paintPanel();this._initResizer();this.options.disabled&&this.disable();this._detectAutoRefresh()},_detectAutoRefresh:function(){var l=p.wijmo.wijspreadpanelex.panels;void 0===l&&(l=[],p.wijmo.wijspreadpanelex.panels=l);l.push(this);this.options.autoRefresh&&!p.wijmo.wijspreadpanelex.setAutoRefreshInterval&&(p.wijmo.wijspreadpanelex.setAutoRefreshInterval=this._setAutoRefreshInterval,p.wijmo.wijspreadpanelex.setAutoRefreshInterval())},_setAutoRefreshInterval:function(){var l=
p.wijmo.wijspreadpanelex.autoRereshInterval,m=p.wijmo.wijspreadpanelex.panels,k=window.setInterval(function(){window.clearInterval(k);var g=m.length,a=!1,d,e,b,f,l;for(d=0;d<g;d++)e=m[d],b=e.element[0],(f=e.options.autoRefresh)&&(a=!0),f=e.getContentElement(),l=e._paintedMark,e.options.autoRefresh&&f.is(":visible")&&(void 0===l||l.width!==f[0].offsetWidth||l.height!==f[0].offsetHeight||l.mainWidth!==b.offsetWidth||l.mainHeight!==b.offsetHeight)&&e.paintPanel();a&&window.setTimeout(p.wijmo.wijspreadpanelex.setAutoRefreshInterval,
0)},void 0===l?500:l)},destroy:function(){var l=this,m=l._fields(),k=l.element,g;p.wijmo.wijspreadpanelex.panels=p.grep(p.wijmo.wijspreadpanelex.panels,function(a){return a!==l});m.initialized&&(l._radiusKey&&l.element.css(l._radiusKey,""),void 0!==m.intervalID&&(window.clearInterval(m.intervalID),m.intervalID=void 0),void 0!==m.resizer&&m.resizer.resizable("destroy"),void 0!==m.hbarContainer&&(m.hbarDrag.remove(),m.hbarContainer.unbind("."+l.widgetName)),void 0!==m.vbarContainer&&(m.vbarDrag.remove(),
m.vbarContainer.unbind("."+l.widgetName)),k.unbind("."+l.widgetName),m.contentWrapper.unbind("."+l.widgetName),g=m.stateContainer.find(">.wijmo-wijsuperpanel-button"),g.unbind("."+l.widgetName),g=m.templateWrapper,g.contents().each(function(a,d){k.append(d)}),m.stateContainer.remove(),m.tabindex&&k.removeAttr("tabindex"),k.removeClass("wijmo-wijsuperpanel ui-widget ui-widget-content ui-corner-all"),p.Widget.prototype.destroy.apply(l,arguments))},_fields:function(){var l=this.element,m=this.widgetName+
"-fields",k=this._fieldsStore;void 0===k&&(k={},l.data(m,k),this._fieldsStore=k);return k},_hasMode:function(l,m){var k=l.scrollMode.split(","),k=p.map(k,function(g){return p.trim(g).toLowerCase()});return-1<p.inArray(m.toLowerCase(),k)},_bindElementEvents:function(l,m,k,g){m=l._hasMode(g.hScroller,"edge");var a=l._hasMode(g.vScroller,"edge"),d=l.widgetName;m||a?void 0===l._mousemoveBind&&(l._mousemoveBind=!0,k.bind("mousemove."+d,l,l._contentMouseMove),k.bind("mouseleave."+d,null,function(){l._clearInterval()})):
(k.unbind("mousemove",l._contentMouseMove),l._mousemoveBind=void 0);g.mouseWheelSupport?void 0===l._mouseWheelBind&&(l._mouseWheelBind=!0,k.bind("mousewheel."+d,l,l._panelMouseWheel)):(l.element.unbind("mousewheel",l._panelMouseWheel),l._mouseWheelBind=void 0);g.keyboardSupport?void 0===l._keyboardBind&&(l._keyboardBind=!0,k.bind("keydown."+d,l,l._panelKeyDown)):(k.unbind("keydown",l._panelKeyDown),l._keyboardBind=void 0)},_dragStop:function(l,m,k){m._trigger("dragStop",l,{dragHandle:k})},_contentMouseMove:function(l){var m,
k,g=l.data,a=g.options,d,e,b,f,s,q;a.disabled||(d=a.hScroller,e=a.vScroller,b=p(l.currentTarget),a=g._fields(),f=g._hasMode(d,"edge"),s=g._hasMode(e,"edge"),g._clearInterval(),m=l.pageX,k=l.pageY,q=b.offset(),l=q.left,q=q.top,l=m-l,q=k-q,d=d.hoverEdgeSpan,e=e.hoverEdgeSpan,m=b.innerHeight(),b=b.innerWidth(),k="",f&&(l<d&&(k="left"),l>b-d&&(k="right")),s&&(q<e&&(k="top"),q>m-e&&(k="bottom")),g._setScrollingInterval(a,k,g,!1))},_setScrollingInterval:function(l,m,k,g){var a=k.options;0<m.length&&(l.internalFuncID=
window.setInterval(function(){k._doScrolling(m,k,g)},a.keyDownInterval))},_scrollButtonMouseOver:function(l){var m=l.data;m.options.disabled||(l=p(l.currentTarget),l.hasClass("ui-state-disabled")||(l.bind("mouseout."+m.widgetName,m,m._buttonMouseOut).bind("mousedown."+m.widgetName,m,m._buttonMouseDown).bind("mouseup."+m.widgetName,m,m._buttonMouseUp).addClass("ui-state-hover"),m._buttonScroll(l,m,"buttonshover")))},_buttonScroll:function(l,m,k){var g="",a=m.options,d=m._fields(),e=m._hasMode(a.hScroller,
k);k=m._hasMode(a.vScroller,k);l.hasClass("wijmo-wijsuperpanel-buttonleft")&&e?g="left":l.hasClass("wijmo-wijsuperpanel-buttonright")&&e?g="right":l.hasClass("wijmo-wijsuperpanel-buttontop")&&k?g="top":l.hasClass("wijmo-wijsuperpanel-buttonbottom")&&k&&(g="bottom");0<g.length&&(m._clearInterval(),m._doScrolling(g,m,!0),m._setScrollingInterval(d,g,m,!0))},_buttonMouseDown:function(l){var m=l.data;m.options.disabled||(l=p(l.currentTarget),l.hasClass("ui-state-disabled")||(l.addClass("ui-state-active"),
m._buttonScroll(l,m,"buttons")))},_buttonMouseUp:function(l){var m=l.data;p(l.currentTarget).removeClass("ui-state-active");m._clearInterval()},_buttonMouseOut:function(l){var m=l.data;p(l.currentTarget).unbind("mouseout",m._buttonMouseOut).unbind("mousedown",m._buttonMouseDown).unbind("mouseup",m._buttonMouseUp).removeClass("ui-state-hover").removeClass("ui-state-active");m._clearInterval()},_panelKeyDown:function(l){var m=l.data,k=m.options,g;k.keyboardSupport&&!k.disabled&&(k=l.shiftKey,g=l.keyCode,
g===p.ui.keyCode.LEFT?m._doScrolling("left",m,k):g===p.ui.keyCode.RIGHT?m._doScrolling("right",m,k):g===p.ui.keyCode.UP?m._doScrolling("top",m,k):g===p.ui.keyCode.DOWN&&m._doScrolling("bottom",m,k),l.stopPropagation(),l.preventDefault())},_draggingInternal:function(l,m,k,g){var a=k.dir,d="h"===a,e=d?"left":"top";l=l.position[e]-m._getScrollContainerPadding(e);d=m._getTrackLen(a)-g[d?"outerWidth":"outerHeight"](!0);g=k.scrollMax-k.scrollLargeChange+1;d=l/d*g;d<k.scrollMin&&(d=k.scrollMin);d>g&&(d=
g);m._scrolling(!0,m,{oldValue:k.scrollValue,newValue:d,dir:a})&&(k.scrollValue=d,m._setDragAndContentPosition(!0,!1,a,"dragging"))},_dragging:function(l,m,k){var g=k.options;l=p(l.target);l.parent().hasClass("wijmo-wijsuperpanel-hbarcontainer")?k._draggingInternal(m,k,g.hScroller,l):k._draggingInternal(m,k,g.vScroller,l)},_panelMouseWheel:function(l,m){var k=l.data,g=k.options,a,d,e,b;g.mouseWheelSupport&&!g.disabled&&(a=p(l.srcElement||l.originalEvent.target),d=0<a.closest(".wijmo-wijsuperpanel-hbarcontainer",
k.element).size(),a=g.hScroller,e=g.vScroller,void 0!==l.wheelDelta&&null!==l.wheelDelta||void 0!==l.detail&&null!==l.detail||(l.wheelDelta=l.originalEvent.wheelDelta,l.detail=l.originalEvent.detail),l.wheelDelta&&(m=l.wheelDelta/120),l.detail&&(m=-l.detail/3),d=0<m?d?"left":"top":d?"right":"bottom",0<d.length&&k._doScrolling(d,k),b=!1,"left"===d&&(b=!k.hNeedScrollBar||0.001>Math.abs(a.scrollValue-a.scrollMin)),"right"===d&&(b=!k.hNeedScrollBar||0.001>Math.abs(a.scrollValue-(a.scrollMax-k._getHScrollBarLargeChange()+
1))),"top"===d&&(b=!k.vNeedScrollBar||0.001>Math.abs(e.scrollValue-e.scrollMin)),"bottom"===d&&(b=!k.vNeedScrollBar||0.001>Math.abs(e.scrollValue-(e.scrollMax-k._getVScrollBarLargeChange()+1))),b&&g.bubbleScrollingEvent&&"left"!==d&&"right"!==d||(l.stopPropagation(),l.preventDefault()))},_documentMouseUp:function(l){var m=l.data.self;l.data.ele.removeClass("ui-state-active");m._clearInterval();p(document).unbind("mouseup",m._documentMouseUp)},_scrollerMouseOver:function(l){var m=l.data,k,g;if(!m.options.disabled){l=
p(l.srcElement||l.originalEvent.target);k=null;g=!1;if(l.hasClass("ui-state-default"))k=l,g=!0;else if(l.parent().hasClass("ui-state-default"))k=l.parent(),g=!0;else if(l.hasClass("wijmo-wijsuperpanel-vbarcontainer")||l.hasClass("wijmo-wijsuperpanel-hbarcontainer"))k=l;void 0!==k&&(g&&k.addClass("ui-state-hover"),k.bind("mouseout."+m.widgetName,m,m._elementMouseOut),k.bind("mousedown."+m.widgetName,m,m._elementMouseDown),k.bind("mouseup."+m.widgetName,m,m._elementMouseUp))}},_elementMouseUp:function(l){p(l.currentTarget).removeClass("ui-state-active")},
_elementMouseDown:function(l){var m=p(l.currentTarget),k=l.data,g,a,d;if(!k.options.disabled&&1===l.which){g="";d=a=!1;if(m.hasClass("wijmo-wijsuperpanel-vbar-buttontop"))g="top",d=!0;else if(m.hasClass("wijmo-wijsuperpanel-vbar-buttonbottom"))g="bottom",d=!0;else if(m.hasClass("wijmo-wijsuperpanel-hbar-buttonleft"))g="left",d=!0;else if(m.hasClass("wijmo-wijsuperpanel-hbar-buttonright"))g="right",d=!0;else{if(m.hasClass("wijmo-wijsuperpanel-handle")){m.addClass("ui-state-active");return}m.hasClass("wijmo-wijsuperpanel-hbarcontainer")?
(g=m.find(".wijmo-wijsuperpanel-handle"),g=g.offset(),g=l.pageX<g.left?"left":"right",a=!0):m.hasClass("wijmo-wijsuperpanel-vbarcontainer")&&(g=m.find(".wijmo-wijsuperpanel-handle"),g=g.offset(),g=l.pageY<g.top?"top":"bottom",a=!0)}k._clearInterval();k._doScrolling(g,k,a);l=k._fields();k._setScrollingInterval(l,g,k,a);d&&m.addClass("ui-state-active");p(document).bind("mouseup."+k.widgetName,{self:k,ele:m},k._documentMouseUp)}},doScrolling:function(l,m){this._doScrolling(l,this,m)},_setScrollerValue:function(l,
m,k,g,a,d,e){var b=m.scrollMin,f=d?g:k;(k=m.scrollValue)||(k=b);if(a){g=m.scrollMax-g+1;if(0.001>Math.abs(k-g))return e._clearInterval(),!1;a=m.firstStepChangeFix;f=k+f;!d&&1E-4>Math.abs(k-b)&&!isNaN(a)&&(f+=a);f>g&&(f=g)}else{if(0.001>Math.abs(k-b))return e._clearInterval(),!1;f=k-f;0>f&&(f=b)}l={oldValue:m.scrollValue,newValue:f,direction:l,dir:m.dir};if(!e._scrolling(!0,e,l))return!1;m.scrollValue=l.newValue;return!0},_doScrolling:function(l,m,k){var g=m.options,a=g.vScroller,g=g.hScroller,d=m._getVScrollBarSmallChange(),
e=m._getVScrollBarLargeChange(),b=m._getHScrollBarLargeChange(),f=m._getHScrollBarSmallChange();if("top"===l||"bottom"===l){if(!m._setScrollerValue(l,a,d,e,"bottom"===l,k,m))return;l="v"}else if("left"===l||"right"===l){if(!m._setScrollerValue(l,g,f,b,"right"===l,k,m))return;l="h"}m._setDragAndContentPosition(!0,!0,l)},_disableButtonIfNeeded:function(l){var m=l._fields(),k,g,a,d,e,b,f,s;0<m.intervalID&&window.clearInterval(m.intervalID);k=l.options;g=m.buttonLeft;a=m.buttonRight;d=m.buttonTop;e=m.buttonBottom;
void 0!==g&&(b=l._getHScrollBarLargeChange(),b=k.hScroller.scrollMax-b+1,f=k.hScroller.scrollValue,s=k.hScroller.scrollMin,void 0===f&&(f=s),0.001>Math.abs(f-s)||!m.hScrolling?g.addClass("ui-state-disabled"):g.removeClass("ui-state-disabled"),0.001>Math.abs(f-b)||!m.hScrolling?a.addClass("ui-state-disabled"):a.removeClass("ui-state-disabled"));void 0!==d&&(l=l._getVScrollBarLargeChange(),l=k.vScroller.scrollMax-l+1,g=k.vScroller.scrollValue,k=k.vScroller.scrollMin,void 0===g&&(g=k),0.001>Math.abs(g-
k)||!m.vScrolling?d.addClass("ui-state-disabled"):d.removeClass("ui-state-disabled"),0.001>Math.abs(g-l)||!m.vScrolling?e.addClass("ui-state-disabled"):e.removeClass("ui-state-disabled"))},_clearInterval:function(){var l=this._fields(),m=l.internalFuncID;0<m&&(window.clearInterval(m),l.internalFuncID=-1)},_elementMouseOut:function(l){var m=p(l.currentTarget);l=l.data;m.unbind("mouseout",l._elementMouseOut);m.unbind("mousedown",l._elementMouseDown);m.unbind("mouseup",l._elementMouseUp);m.removeClass("ui-state-hover")},
_getScorllOffset:function(l){var m=p(l),k,g,a,d,e;l={left:null,top:null};if(0===m.size())return l;k=this._fields();g=k.contentWrapper;a=k.templateWrapper;k=m.offset();a=a.offset();k.leftWidth=k.left+m.outerWidth();k.topHeight=k.top+m.outerHeight();m=g.offset();m.leftWidth=m.left+g.outerWidth();m.topHeight=m.top+g.outerHeight();d=k.left-a.left;k.left<m.left?l.left=d:k.leftWidth>m.leftWidth&&(e=k.leftWidth-a.left-g.innerWidth(),l.left=d<e?d:e);d=k.top-a.top;k.top<m.top?l.top=d:k.topHeight>m.topHeight&&
(g=k.topHeight-a.top-g.innerHeight(),l.top=d<g?d:g);return l},needToScroll:function(l){l=this._getScorllOffset(l);return null!==l.top||null!==l.left},scrollChildIntoView:function(l){var m=this._getScorllOffset(l);l=m.left;m=m.top;null!==l&&this.hScrollTo(l);null!==m&&this.vScrollTo(m)},hScrollTo:function(l){this.options.hScroller.scrollValue=this.scrollPxToValue(l,"h");this._setDragAndContentPosition(!0,!0,"h","nonestop")},vScrollTo:function(l){this.options.vScroller.scrollValue=this.scrollPxToValue(l,
"v");this._setDragAndContentPosition(!0,!0,"v","nonestop")},scrollPxToValue:function(l,m){var k=this.options,g="h"===m?"outerWidth":"outerHeight",a="h"===m?"contentWidth":"contentHeight",d="h"===m?"hScroller":"vScroller",e=this._fields(),a=e[a],e=e.contentWrapper[g](),g=k[d].scrollMin,k=k[d].scrollMax-g,d="h"===m?this._getHScrollBarLargeChange():this._getVScrollBarLargeChange(),k=k-d+1,a=k*(l/(a-e));a<g&&(a=g);a>k&&(a=k);return a},scrollTo:function(l,m){this.hScrollTo(l);this.vScrollTo(m)},refresh:function(){this.paintPanel()},
paintPanel:function(l){var m=this.element,k,g,a,d;if(m.is(":visible")){k="unknown"!=typeof document.activeElement?document.activeElement:void 0;g=this.options;a=this._fields();a.initialized||this._initialize(a,m,this);this._resetLargeChange(this,a,g);this._bindElementEvents(this,a,m,g);d=a.templateWrapper;d.css({"float":"left",left:"0px",top:"0px",width:"auto",height:"auto"});d.hide();d.show();a.contentWidth=d.width();a.contentHeight=d.height();d.css("float","");this._setRounder(this,m);this._setInnerElementsSize(a,
m);if(!1===this._testScroll(this,a,g))return!1;this._initScrollBars(this,a,g);this._initScrollButtons(this,a,g);this._trigger("painted");this._paintedMark={date:new Date,mainWidth:m[0].offsetWidth,mainHeight:m[0].offsetHeight,width:a.contentWidth,height:a.contentWidth};void 0===k||l||p(k).focus();return!0}return!1},_resetLargeChange:function(l,m,k){l._autoVLarge&&(k.vScroller.scrollLargeChange=null);l._autoHLarge&&(k.hScroller.scrollLargeChange=null);m.vTrackLen=void 0;m.hTrackLen=void 0;m.vbarContainer&&
(l=m.vbarContainer.children(".wijmo-wijsuperpanel-handle:eq(0)"),l.detach(),m.vbarContainer.remove(),m.vbarContainer=void 0);m.hbarContainer&&(l=m.hbarContainer.children(".wijmo-wijsuperpanel-handle:eq(0)"),l.detach(),m.hbarContainer.remove(),m.hbarContainer=void 0)},_initialize:function(l,m,k){l.initialized=!0;m.addClass("wijmo-wijsuperpanel ui-widget ui-widget-content");l.oldHeight=m.css("height");var g=m.css("overflow");m.css("overflow","");m.height(m.height());m.css("overflow",g);k._createAdditionalDom(k,
l,m)},getContentElement:function(){return this._fields().templateWrapper},_setButtonPosition:function(l,m,k,g,a,d,e){m="h"===g;g="mouseover."+l.widgetName;var b=m?"buttonLeft":"buttonTop",f=m?"buttonRight":"buttonBottom",s=d[b],q=d[f],t;l._hasMode(k,"buttons")||l._hasMode(k,"buttonshover")?(t=m?"<div class='ui-state-default wijmo-wijsuperpanel-button wijmo-wijsuperpanel-buttonleft'><span class='ui-icon ui-icon-carat-1-w'></span></div><div class='ui-state-default wijmo-wijsuperpanel-button wijmo-wijsuperpanel-buttonright'><span class='ui-icon ui-icon-carat-1-e'></span></div>":
"<div class='ui-state-default wijmo-wijsuperpanel-button wijmo-wijsuperpanel-buttontop'><span class='ui-icon ui-icon-carat-1-n'></span></div><div class='ui-state-default wijmo-wijsuperpanel-button wijmo-wijsuperpanel-buttonbottom'><span class='ui-icon ui-icon-carat-1-s'></span></div>",void 0===s&&(s=p(t).appendTo(e),s.bind(g,l,l._scrollButtonMouseOver),d[b]=s=e.children(m?".wijmo-wijsuperpanel-buttonleft":".wijmo-wijsuperpanel-buttontop"),d[f]=q=e.children(m?".wijmo-wijsuperpanel-buttonright":".wijmo-wijsuperpanel-buttonbottom")),
l={my:m?"left":"top",of:a,at:m?"left":"top",collision:"none"},p.extend(l,k.decreaseButtonPosition),s.position(l),l={my:m?"right":"bottom",of:a,at:m?"right":"bottom",collision:"none"},p.extend(l,k.increaseButtonPosition),q.position(l)):void 0!==s&&(s.remove(),q.remove(),d[b]=d[f]=void 0)},_initScrollButtons:function(l,m,k){var g=m.contentWrapper,a=m.stateContainer;l._setButtonPosition(l,k,k.hScroller,"h",g,m,a);l._setButtonPosition(l,k,k.vScroller,"v",g,m,a)},_getVScrollBarSmallChange:function(){var l=
this.options,m;l.vScroller.scrollSmallChange||(m=this._getVScrollBarLargeChange(),l.vScroller.scrollSmallChange=m/2);return l.vScroller.scrollSmallChange},_getVScrollBarLargeChange:function(){return this._getLargeChange("v")},_getLargeChange:function(l){var m=this.options,k=this._fields(),g="v"===l,m=g?m.vScroller:m.hScroller,a=g?"contentHeight":"contentWidth";l=g?"_autoVLarge":"_autoHLarge";var d;if(m.scrollLargeChange)return m.scrollLargeChange;d=m.scrollMax-m.scrollMin;g=k.contentWrapper[g?"innerHeight":
"innerWidth"]();k=g/(k[a]-g);k=(d+1)*k/(1+k);isNaN(k)&&(k=0);m.scrollLargeChange=k;this[l]=!0;return m.scrollLargeChange},_getHScrollBarSmallChange:function(){var l=this.options,m;l.hScroller.scrollSmallChange||(m=this._getHScrollBarLargeChange(),l.hScroller.scrollSmallChange=m/2);return l.hScroller.scrollSmallChange},_getHScrollBarLargeChange:function(){return this._getLargeChange("h")},_initScrollBars:function(l,m,k){var g=k.hScroller,a=g.scrollMax-g.scrollMin,g=k.vScroller,g=g.scrollMax-g.scrollMin,
d=m.hbarDrag;m=m.vbarDrag;var e,b;l.hNeedScrollBar&&d.is(":visible")&&(e=l._getHScrollBarLargeChange(),b=l._getTrackLen("h"),a=l._getDragLength(a,e,b,k.hScroller.scrollMinDragLength),d.width(a),e=d.outerWidth(!0)-d.width(),d.width(a-e),a=d.children("span"),a.css("margin-left",(d.width()-a[0].offsetWidth)/2),b<=d.outerWidth(!0)?d.hide():d.show());l.vNeedScrollBar&&m.is(":visible")&&(b=l._getVScrollBarLargeChange(),d=l._getTrackLen("v"),k=l._getDragLength(g,b,d,k.vScroller.scrollMinDragLength),m.height(k),
g=m.outerHeight(!0)-m.height(),m.height(k-g),k=m.children("span"),k.css("margin-top",(m.height()-k[0].offsetHeight)/2),d<=m.outerHeight(!0)?m.hide():m.show());l._setDragAndContentPosition(!1,!1,"both")},_getTrackLen:function(l){var m=this._fields(),k=l+"TrackLen",g,a,d,e;if(void 0!==m[k])return m[k];g=m.hbarContainer;a=m.vbarContainer;e=d=0;"h"===l&&(e=this._getScrollContainerPadding("h"),d=g.innerWidth());"v"===l&&(e=this._getScrollContainerPadding("v"),d=a.innerHeight());m[k]=d-e;return m[k]},_getScrollContainerPadding:function(l){var m=
this._fields(),k=0,g,a;if("h"===l)k=this._getScrollContainerPadding("left")+this._getScrollContainerPadding("right");else if("v"===l)k=this._getScrollContainerPadding("top")+this._getScrollContainerPadding("bottom");else{g="left"===l||"right"===l?m.hbarContainer:m.vbarContainer;a=l+"Padding";if(void 0!==m[a])return k=m[a];g&&g.css&&(k=parseFloat(g.css("padding-"+l)));m[a]=k}return k},_triggerScroll:function(l,m,k){this._trigger("scroll",null,{position:l,dir:m,animationOptions:k})},_contentDragAnimate:function(l,
m,k,g,a,d,e){var b=this,f=b.options,s="v"===l,q=s?f.vScroller:f.hScroller,t=s?"outerHeight":"outerWidth",r=s?"innerHeight":"innerWidth",u=s?"contentHeight":"contentWidth",n=s?"top":"left",h=q.scrollMin,I=q.scrollMax-h,q=void 0===q.scrollValue?h:q.scrollValue-h,h=b._getLargeChange(l),h=I-h+1,E=b._fields(),O=E.contentWrapper,I=E.templateWrapper,H;q>h&&(q=h);r=(E[u]-O[r]())*(q/h);0.001>Math.abs(r)&&(r=0);r=Math.round(r);u=-1;void 0!==k&&(m&&g.is(":animated")&&"nonestop"!==a&&g.stop(!0,!1),k=b._getTrackLen(l),
t=g[t](!0),t=k-t,n=b._getScrollContainerPadding(n),u=q/h*t+n);m&&f.animationOptions&&!f.animationOptions.disabled?(0<=u&&"dragging"!==e&&(e=p.extend({},f.animationOptions),e.complete=void 0,n=s?{top:u}:{left:u},g.animate(n,e)),g=p.extend({},f.animationOptions),H=f.animationOptions.complete,g.complete=function(){b._scrollEnd(d,b,l);p.isFunction(H)&&H(arguments)},m&&I.is(":animated")&&"nonestop"!==a&&I.stop(!0,!1),m=s?{top:-r}:{left:-r},I.animate(m,g),b._triggerScroll(r,l,g)):(m=s?"top":"left",0<=u&&
"dragging"!==e&&(g[0].style[m]=u+"px"),I[0].style[m]=-r+"px",b._triggerScroll(r,l),b._scrollEnd(d,b,l))},_setDragAndContentPosition:function(l,m,k,g,a){var d=this,e=d._fields(),b=e.hbarContainer,f=e.hbarDrag,s=e.vbarContainer,q=e.vbarDrag;"both"!==k&&"h"!==k||!e.hScrolling||d._contentDragAnimate("h",m,b,f,g,l,a);"both"!==k&&"v"!==k||!e.vScrolling||d._contentDragAnimate("v",m,s,q,g,l,a);0<e.intervalID&&window.clearInterval(e.intervalID);e.intervalID=window.setInterval(function(){d._disableButtonIfNeeded(d)},
500)},_scrolling:function(l,m,k){var g=!0;l&&(k.beforePosition=m.getContentElement().position(),m._beforePosition=k.beforePosition,g=m._trigger("scrolling",null,k));return g},_scrollEnd:function(l,m,k){l&&window.setTimeout(function(){var g;m.getContentElement().is(":visible")&&(g=m.getContentElement().position(),g={dir:k,beforePosition:m._beforePosition,afterPosition:g},m._trigger("scrolled",null,g))},0)},_getDragLength:function(l,m,k,g){l=k/(l/m);l<g?l=g:l+1>=k&&(l=k-1);return Math.round(l)},_needScrollbar:function(l,
m){var k=this._hasMode(l,"scrollbar"),g=l.scrollBarVisibility;return k&&("visible"===g||"auto"===g&&m)},_bindBarEvent:function(l,m,k){var g=this;g._isDragging=!1;l.bind("mouseover."+g.widgetName,g,g._scrollerMouseOver);m.draggable({axis:"h"===k?"x":"y",start:function(a,d){g._isDragging=!0},drag:function(a,d){g._dragging(a,d,g)},containment:"parent",stop:function(a){g._dragStop(a,g,k);p(a.target).removeClass("ui-state-active");g._isDragging=!1}})},_createBarIfNeeded:function(l,m,k,g,a){if(l){var d=
this._fields(),e=k+"barContainer",b=k+"barDrag";l="h"===k;var f=a[l?"innerHeight":"innerWidth"]();g=d[e]=p(g);m.append(g);m=g[0][l?"offsetHeight":"offsetWidth"];f-=m;if(!1===this._trigger(l?"hScrollerActivating":"vScrollerActivating",null,{direction:l?"horizontal":"vertical",targetBarLen:m,contentLength:f}))return!1;m=d[b]=g.find(".wijmo-wijsuperpanel-handle");this._bindBarEvent(g,m,k);a[l?"height":"width"](f)}},_setScrollbarPosition:function(l,m,k,g,a,d,e,b,f,s,q){a="h"===s;var t,r,u,n,h;d?(t=g[0][a?
"offsetHeight":"offsetWidth"],l=m._getScrollContainerPadding(s),d=a?"top":"left",r=a?{top:"0px",bottom:"auto",left:"auto",right:"auto"}:{left:"0px",right:"auto",top:"auto",bottom:"auto"},t=a?{top:t+"px"}:{left:t+"px"},u=a?{top:"auto",right:"auto",left:"auto",bottom:"0px"}:{left:"auto",right:"0px",top:"auto",bottom:"auto"},n=a?{top:""}:{left:""},h=k[a?"innerWidth":"innerHeight"](),b===d?(g.css(r),k.css(t),a?(g.children(".wijmo-wijsuperpanel-hbar-buttonleft").removeClass("ui-corner-bl").addClass("ui-corner-tl"),
g.children(".wijmo-wijsuperpanel-hbar-buttonright").removeClass("ui-corner-br").addClass("ui-corner-tr"),g.removeClass("ui-corner-bottom").addClass("ui-corner-top")):(g.children(".wijmo-wijsuperpanel-vbar-buttontop").removeClass("ui-corner-tr").addClass("ui-corner-tl"),g.children(".wijmo-wijsuperpanel-vbar-buttonbottom").removeClass("ui-corner-br").addClass("ui-corner-bl"),g.removeClass("ui-corner-right").addClass("ui-corner-left"))):(g.css(u),k.css(n),a?(g.children(".wijmo-wijsuperpanel-hbar-buttonleft").removeClass("ui-corner-tl").addClass("ui-corner-bl"),
g.children(".wijmo-wijsuperpanel-hbar-buttonright").removeClass("ui-corner-bl").addClass("ui-corner-br"),g.removeClass("ui-corner-top").addClass("ui-corner-bottom")):(g.children(".wijmo-wijsuperpanel-vbar-buttontop").removeClass("ui-corner-tl").addClass("ui-corner-tr"),g.children(".wijmo-wijsuperpanel-vbar-buttonbottom").removeClass("ui-corner-bl").addClass("ui-corner-br"),g.removeClass("ui-corner-left").addClass("ui-corner-right"))),e&&("left"===f?g.css("right","0px"):"right"===f?g.css("left","0px"):
"top"===f?g.css("bottom","0px"):"bottom"===f&&g.css("top","0px")),g[a?"width":"height"](h-l),m._enableDisableScrollBar(s,g,!q)):l.css(a?"left":"top","")},_testScroll:function(l,m,k){var g=m.templateWrapper,a=m.contentWrapper,d=m.stateContainer,e=a.innerWidth(),b=a.innerHeight(),f=m.contentHeight,s;m.hScrolling=m.contentWidth>e;m.vScrolling=f>b;f=l.hNeedScrollBar=l._needScrollbar(k.hScroller,m.hScrolling);if(!1===l._createBarIfNeeded(f,d,"h","<div class='wijmo-wijsuperpanel-hbarcontainer ui-widget-header'><div class='wijmo-wijsuperpanel-handle ui-state-default ui-corner-all'><span class='ui-icon ui-icon-grip-solid-vertical'></span></div><div class='wijmo-wijsuperpanel-hbar-buttonleft ui-state-default ui-corner-bl'><span class='ui-icon ui-icon-triangle-1-w'></span></div><div class='wijmo-wijsuperpanel-hbar-buttonright ui-state-default ui-corner-br'><span class='ui-icon ui-icon-triangle-1-e'></span></div></div>",
a))return!1;f&&!m.vScrolling&&(g.css("float","left"),m.contentHeight=g.height(),m.vScrolling=m.contentHeight>b-m.hbarContainer[0].offsetHeight,g.css("float",""));b=l.vNeedScrollBar=l._needScrollbar(k.vScroller,m.vScrolling);if(!1===l._createBarIfNeeded(b,d,"v","<div class='wijmo-wijsuperpanel-vbarcontainer ui-widget-header'><div class='wijmo-wijsuperpanel-handle ui-state-default ui-corner-all'><span class='ui-icon ui-icon-grip-solid-horizontal'></span></div><div class='wijmo-wijsuperpanel-vbar-buttontop ui-state-default ui-corner-tr'><span class='ui-icon ui-icon-triangle-1-n'></span></div><div class='wijmo-wijsuperpanel-vbar-buttonbottom ui-state-default ui-corner-br'><span class='ui-icon ui-icon-triangle-1-s'></span></div></div>",
a)||b&&!m.hScrolling&&(g.css("float","left"),m.contentWidth=g.width(),m.hScrolling=m.contentWidth>e-m.vbarContainer[0].offsetWidth,g.css("float",""),m.hScrolling&&!f&&(f=l.hNeedScrollBar=l._needScrollbar(k.hScroller,m.hScrolling),!1===l._createBarIfNeeded(f,d,"h","<div class='wijmo-wijsuperpanel-hbarcontainer ui-widget-header'><div class='wijmo-wijsuperpanel-handle ui-state-default ui-corner-all'><span class='ui-icon ui-icon-grip-solid-vertical'></span></div><div class='wijmo-wijsuperpanel-hbar-buttonleft ui-state-default ui-corner-bl'><span class='ui-icon ui-icon-triangle-1-w'></span></div><div class='wijmo-wijsuperpanel-hbar-buttonright ui-state-default ui-corner-br'><span class='ui-icon ui-icon-triangle-1-e'></span></div></div>",
a))))return!1;d=m.hbarContainer;e=m.vbarContainer;s=k.hScroller.scrollBarPosition;k=k.vScroller.scrollBarPosition;l._setScrollbarPosition(g,l,a,d,e,f,b,s,k,"h",m.hScrolling);l._setScrollbarPosition(g,l,a,e,d,b,f,k,s,"v",m.vScrolling)},_enableDisableScrollBar:function(l,m,k){"v"===l?(m[k?"addClass":"removeClass"]("wijmo-wijsuperpanel-vbarcontainer-disabled"),m.find(".ui-state-default")[k?"addClass":"removeClass"]("ui-state-disabled")):"h"===l&&(m[k?"addClass":"removeClass"]("wijmo-wijsuperpanel-hbarcontainer-disabled"),
m.find(".ui-state-default")[k?"addClass":"removeClass"]("ui-state-disabled"));m.children(".wijmo-wijsuperpanel-handle")[k?"hide":"show"]()},_initResizer:function(){var l=this,m=l.options,k=l._fields(),g=k.resizer,a;!g&&m.allowResize&&(g=m.resizableOptions,a=g.stop,g.stop=function(d){l._resizeStop(d,l);p.isFunction(a)&&a(d)},k.resizer=g=l.element.resizable(g));!m.allowResize&&k.resizer&&(g.resizable("destroy"),k.resizer=null)},_resizeStop:function(l,m){this.options.autoRefresh||m.paintPanel(!0);m._trigger("resized")},
_createAdditionalDom:function(l,m,k){k.attr("tabindex")||(k.attr("tabindex","-1"),m.tabindex=!0);l=m.stateContainer=p("<div class='wijmo-wijsuperpanel-statecontainer'><div class='wijmo-wijsuperpanel-contentwrapper'><div class='wijmo-wijsuperpanel-templateouterwrapper'></div></div></div>");var g;m.contentWrapper=l.children();g=m.templateWrapper=m.contentWrapper.children();k.contents().each(function(a,d){var e=p(d);e.hasClass("wijmo-wijsuperpanel-header")?m.header=e:e.hasClass("wijmo-wijsuperpanel-footer")?
m.footer=e:g[0].appendChild(d)});void 0!==m.header&&k.prepend(m.header);k[0].appendChild(l[0]);void 0!==m.footer&&m.footer.insertAfter(l)},_setRounder:function(l,m){if(this.options.showRounder){if(m.addClass("ui-corner-all"),!l._rounderAdded&&!p.browser.msie){var k,g;p.browser.webkit?(g="WebkitBorderTopLeftRadius",k="WebkitBorderRadius"):p.browser.mozilla?(g="MozBorderRadiusBottomleft",k="MozBorderRadius"):(g="border-top-left-radius",k="border-radius");g=m.css(g);g=parseInt(g,10);m.css(k,g+1);l._rounderAdded=
!0;l._radiusKey=k}}else m.removeClass("ui-corner-all")},_setInnerElementsSize:function(l,m){var k=l.stateContainer,g=l.contentWrapper,a=0,d;void 0!==l.header&&(a+=l.header.outerHeight());void 0!==l.footer&&(a+=l.footer.outerHeight());k=k[0].style;a=m.innerHeight()-a;d=m.innerWidth();k.display="none";k.height=a+"px";k.width=d+"px";g=g[0].style;g.height=a+"px";g.width=d+"px";k.display=""}})})(jQuery);
(function(p,l){var m=p.GrapeCity;"undefined"===typeof m&&(m=p.GrapeCity={});"undefined"===typeof m.UI&&(m.UI={});var k=m.UI,g=p.document;k.GcSpread=function(a,d,e){this._init(a,d,e)};k.GcSpread.prototype={_scrollbarSize:18,_host:null,_allowUndo:!0,_paintSuspended:!1,_availableSheetIndex:-1,sheets:null,name:null,_tabStripRatio:0.5,_activeSheetIndex:0,_allowUserZoom:!0,_allowUserResize:!0,_tabStripVisible:!0,_tabEditable:!0,_newTabVisible:!0,useWijmoTheme:!1,_canUserEditFormula:!0,_highlightInvalidData:!1,
_init:function(a,d,e){this.name=a;this.calcService=new m.Calc.Service(this);this._userEvents=[];this._userEventsElem=g.createElement("input");this._eventSuspended=0;this._undoManager=new k._UndoManager(this,-1,this.allowUndo());this._clipboardHelper={fromSheet:null,range:null,isCutting:!1};this.sheets=[];for(a=0;a<d;a++)this.sheets.push(this._createSheet(this._getDefaultSheetName(a)));if(0<this.sheets.length){d=null;for(a=0;!d&&a<this.sheets.length;a++)d=this.sheets[a]._getSheetSource();if(d)for(a=
0;a<this.sheets.length;a++){var b=this.sheets[a]._getSheetSource();b&&b.shareCalculations(d)}}e&&this._setHost(e)},_getDefaultSheetName:function(a){this._availableSheetIndex<this.getSheetCount()?this._availableSheetIndex=this.getSheetCount():this._availableSheetIndex++;if(void 0===a||null===a||a<this._availableSheetIndex)a=this._availableSheetIndex;var d=!1,e;do{e="Sheet"+(a+1);var b=this.sheets.length;if(0<b)for(var f=0;f<b;f++)if(f in this.sheets)if(this.sheets[f]._name===e){a++;d=!0;break}else d&&
(d=!1)}while(d);return e},_createSheet:function(a,d,e){a=new k.GcSheet(a);a.borderWidth=0;a.setRowCount(d?d:200);a.setColumnCount(e?e:20);a.calcService=this.calcService;a.parent=this;a.borderWidth=0;return a},_setHost:function(a){if(this._host=a){var d=[],e,b=this;for(e=0;e<a.children.length;e++)d.push(a.children[e]);a.innerHTML="<table cellspacing=0 cellpadding=0 border=0><tr><td></td><td></td></tr><tr><td></td><td></td></tr></table>";for(var f=a.firstChild;0<d.length;)a.insertBefore(d.pop(),f);
this._vp=g.createElement("div");this._vp.id=a.id+"vp";f.rows[0].cells[0].insertBefore(this._vp,null);f.style.width="100%";f.style.height="100%";f.style.border="0";f.style.margin="0";for(e=0;e<f.rows.length;e++)for(d=0;d<f.rows[e].cells.length;d++)f.rows[e].cells[d].style.padding="0",f.rows[e].cells[d].style.border="0";this._vs=g.createElement("div");this._vs.id=a.id+"vs";this._vs.style.overflowY="scroll";this._vs.style.overflowX="hidden";this._vs.style.border="0";f.rows[0].cells[1].insertBefore(this._vs,
null);this._vscrollDelegate=function(a,e){var d=b.getActiveSheet();if(d&&e){var f=parseInt(e.newValue,10);if(void 0===e.oldValue||null===e.oldValue)e.oldValue=0;e.oldValue=parseInt(e.oldValue,10);"top"===e.direction?10===e.oldValue-e.newValue&&(f=d._getPrevPageTopRow()):"bottom"===e.direction&&10===e.newValue-e.oldValue&&(f=d._getNextPageTopRow());e.newValue!==f&&(e.newValue=f);e.oldValue!==f&&(d._eventHandler.doVScroll(f),d._trigger(k.Events.TopRowChanged,{sheet:d,sheetName:d._name,oldTopRow:e.oldValue,
newTopRow:f}))}};this.initPaint=function(){if(!m.UI._isStandardCanvas()){var a=this.getActiveSheet();if(a)if((a=a._getCanvas())&&a.firstChild&&a.firstChild.loaded)this.invalidateLayout(),this.repaint();else{var b=this;p.setTimeout(function(){b.initPaint.call(b)},10)}}};this.vScrollStop=function(a,e){var d=b.getActiveSheet();if(d){var f=l(b._vs),g=f.wijspreadpanelex().data("wijmo-wijspreadpanelex").options,h=g.vScroller.scrollValue,k=!1;h<d._getFirstPageTopRow()?(g.vScroller.scrollValue=d._getFirstPageTopRow(),
k=!0):h>d._getLastPageTopRow()&&(g.vScroller.scrollValue=d._getLastPageTopRow(),k=!0);k&&(f.wijspreadpanelex("refresh"),b._refreshScrollbar())}};l(this._vs).bind("scroll.gcSpread",this._vscrollDelegate);l(this._vs).bind("wijspreadpanelexdragstop.gcSpread",this.vScrollStop);e=g.createElement("div");e.id=a.id+"vsDummy";this._vs.appendChild(e);e.style.height="3000px";e.style.width="1px";f.rows[1].cells[0].innerHTML="<table cellspacing=0 cellpadding=0 border=0><tr><td></td><td></td></tr></table>";f=f.rows[1].cells[0].firstChild;
f.style.border="0";f.style.margin="0";for(e=0;e<f.rows.length;e++)for(d=0;d<f.rows[e].cells.length;d++)f.rows[e].cells[d].style.padding="0",f.rows[e].cells[d].style.border="0";this._tabs=g.createElement("div");this._tabs.style.width=""+this._getActualTabStripRatio()*this._host.clientWidth+"px";this._tabs.style.height=""+this._scrollbarSize+"px";f.rows[0].cells[0].insertBefore(this._tabs,null);this._tab=new k._GcTab(a.getAttribute("id")+"_tabStrip");this._tab.setOwner(this);this._tab._setHost(this._tabs);
this._hs=g.createElement("div");this._hs.id=a.id+"hs";this._hs.style.overflowX="scroll";this._hs.style.overflowY="hidden";this._hs.style.border="0";f.rows[0].cells[1].insertBefore(this._hs,null);this._hscrollDelegate=function(a,e){var d=b.getActiveSheet();if(d){var f=parseInt(e.newValue,10);if(void 0===e.oldValue||null===e.oldValue)e.oldValue=0;e.oldValue=parseInt(e.oldValue,10);"left"===e.direction?10===e.oldValue-e.newValue&&(f=d._getPrevPageLeftColumn()):"right"===e.direction&&10===e.newValue-
e.oldValue&&(f=d._getPageRightColumn());e.newValue!==f&&(e.newValue=f);e.oldValue!==e.newValue&&(d._eventHandler.doHScroll(f),d._trigger(k.Events.LeftColumnChanged,{sheet:d,sheetName:d._name,oldLeftCol:e.oldValue,newLeftCol:e.newValue}))}};this.hScrollStop=function(a,e){var d=b.getActiveSheet();if(d){var f=l(b._hs),g=f.wijspreadpanelex().data("wijmo-wijspreadpanelex").options,h=!1;g.hScroller.scrollValue<d._getFirstPageLeftColumn()&&(g.hScroller.scrollValue=d._getFirstPageLeftColumn(),h=!0);h&&(f.wijspreadpanelex("refresh"),
b._refreshScrollbar())}};l(this._hs).bind("scroll.gcSpread",this._hscrollDelegate);l(this._hs).bind("wijspreadpanelexdragstop.gcSpread",this.hScrollStop);e=g.createElement("div");e.id=a.id+"hsDummy";this._hs.appendChild(e);e.style.width="3000px";e.style.height="1px";l(p).bind("resize.gcSpread",k.createEventHandler(this,this._doResize));if(l.browser.chrome||l.browser.safari)e=g.createElement("div"),e.id=a.id+"vsTest",e.style.overflowY="scroll",e.style.overflowX="hidden",e.style.border="0",e.style.height=
"200px",e.style.width="26px",e.style.position="absolute",e.style.left="-1000px",this._dummyScrollbar=e,g.body.insertBefore(e,null),f=g.createElement("div"),f.id=a.id+"dummyPanel",e.appendChild(f),f.style.height="3000px",f.style.width="1px",a=l(this._dummyScrollbar),a.css("overflowY",""),a.wijspreadpanelex({allowResize:!1,keyboardSupport:!1,bubbleScrollingEvent:!1,hScroller:{scrollBarVisibility:"hidden"},vScroller:{scrollSmallChange:1,scrollLargeChange:10,scrollMin:0,scrollMax:100,scrollBarVisibility:"visible"}});
var s=this.getActiveSheet();s&&(s._setHost(this._vp),l(p).unbind("resize.gcSheet"),b=this,s._scrollCallback=function(a){b.getActiveSheet()===s&&("scroll"===a.action?"vertical"===a.orientation?(a=l(b._vs),a.wijspreadpanelex().data("wijmo-wijspreadpanelex").options.vScroller.scrollValue=s._scrollTopRow,a.wijspreadpanelex("refresh"),b._refreshScrollbar()):"horizontal"===a.orientation&&(a=l(b._hs),a.wijspreadpanelex().data("wijmo-wijspreadpanelex").options.hScroller.scrollValue=s._scrollLeftCol,a.wijspreadpanelex("refresh"),
b._refreshScrollbar()):"resize"===a.action&&b._doResize())});this._doResize();this._loadData();(a=this._getFunction(this._host.id+"_onLoad"))&&a(this);this.submitDelegate=function(a){var e=a.onsubmit;a.onsubmit=function(){b.saveData();"function"===typeof e&&e.apply()}};(a=l(g.forms).get(0))&&this.submitDelegate(a)}},_refreshScrollbar:function(){this._dummyScrollbar&&l(this._dummyScrollbar).wijspreadpanelex("refresh")},_loadData:function(a){var d=g.getElementById(this._host.id+"_data");if(d&&""!==
d.value){var e="undefined"!==typeof JSON&&JSON.parse?JSON.parse(d.value):null;if(void 0!==e&&null!==e){this.suspendEvent();this.isPaintSuspended(!0);var b=null;0<e.length&&(b=JSON.parse(e[0]));this.calcService.suspend();this.setSheetCount(b.sheetCount);0<e.length&&null!==b.referenceStyle&&void 0!==b.referenceStyle&&this.referenceStyle(b.referenceStyle);var f,l,m,t,r,u;if(1<e.length){var n=[],h,p;for(m=1;m<e.length;m++){var E=JSON.parse(e[m]);l=this.sheets[m-1];var O=E.name;h=E.rowCount;p=E.columnCount;
l._allowCellOverflow=b.allowCellOverflow;if(f=E.data){if(a)for(t in f)"function"!==typeof t&&(l._dataModel.dataTable[t]=f[t]);else l._dataModel.dataTable=f;l._dataModel.dataTable.length=h}E.dataSource&&0<E.dataSource.length&&(u=JSON.parse(E.dataSource))&&(l._dataSource=u);E.rows&&(l._rowInfos=E.rows);E.columns&&(l._colInfos=E.columns,l._colInfos.length=p);if(E.spans)for(t=0;t<E.spans.length;t++)u=E.spans[t],l._addSpanImp(u.Row,u.Column,u.RowCount,u.ColumnCount);if(E.colStyles)for(r in E.colStyles)isNaN(r)||
(u=parseInt(r,10),l.setStyle(-1,u,E.colStyles[r]));if(E.rowStyles)for(r in E.rowStyles)isNaN(r)||(u=parseInt(r,10),l.setStyle(u,-1,E.rowStyles[r],k.SheetArea.viewport));null!==E.rowHeaderAutoText&&void 0!==E.rowHeaderAutoText&&(l.rowHeaderAutoText=E.rowHeaderAutoText);null!==E.colHeaderAutoText&&void 0!==E.colHeaderAutoText&&(l.colHeaderAutoText=E.colHeaderAutoText);null!==E.referenceStyle&&void 0!==E.referenceStyle&&l.referenceStyle(E.referenceStyle);null!==E.gridline&&void 0!==E.gridline&&(l.gridline=
E.gridline);l._dataModel.name=O;l._name=O;l.setRowCount(h);l.setColumnCount(p);l.setActiveCell(E.ar,E.ac);l.setFrozenCount(E.frozenRowCount,E.frozenColCount);n[m]=f}}if(0<e.length){this.setActiveSheetIndex(b.activeSheetIndex);"undefined"!==typeof b.tabStripRatio&&this.setTabStripRatio(b.tabStripRatio);"undefined"!==typeof b.tabStripVisible&&(this._tabStripVisible=b.tabStripVisible);"undefined"!==typeof b.tabEditable&&(this._tabEditable=b.tabEditable);"undefined"!==typeof b.newTabVisible&&(this._newTabVisible=
b.newTabVisible);this.gcSpreadsheet=b.gcSpreadsheet;if(l=this.getActiveSheet())f=b.theme,"string"!==typeof f&&"undefined"!==typeof f&&(m=f.themeColor,m=new k.ThemeColor(f.name,m.text1,m.text2,m.background1,m.background2,m.accent1,m.accent2,m.accent3,m.accent4,m.accent5,m.accent6,m.link,m.followedLink),f=new k.SpreadTheme(f.name,m,f.headingFont,f.bodyFont)),l.currentTheme(f);b.useWijmoTheme&&(this.useWijmoTheme=b.useWijmoTheme);if(b.names)for(f=0;f<b.names.length;f++)m=b.names[f],m.sn?(l=this.getSheetFromName(m.sn))&&
l.addCustomName(m.name,m.formula,m.row,m.col):this.addCustomName(m.name,m.formula,m.row,m.col);for(m=1;m<e.length;m++)for(t in f=n[m],l=this.sheets[m-1],l.getRowCount(),p=l.getColumnCount(),f)if("function"!==typeof t&&(b=f[t]))for(u=0;u<p;u++)a=null,b[u]&&(a=b[u].formula),a&&(b[u].formula=null,l.setFormula(parseInt(t,10),u,a))}this.calcService.resume();this._recalcAll();for(m=0;m<this.sheets.length;m++)l=this.sheets[m],l.clearPendingChanges();this.resumeEvent();this.isPaintSuspended(!1);d.value=""}}},
_getFunction:function(a){if(void 0===a||null===a||""===a)return null;try{return p[a]}catch(d){}return null},_dispose:function(){l(p).unbind("resize.gcSpread");l(this._vs).unbind("scroll.gcSpread");l(this._hs).unbind("scroll.gcSpread");this._disposeUserEvents();var a=this.getActiveSheet();a&&a._dispose();this._host&&(this._host.innerHTML="",this._host.removeAttribute("gcUIElement"));(l.browser.chrome||l.browser.safari)&&l("#"+this._host.id+"vsTest").remove()},_disposeUserEvents:function(){l(this._userEventsElem).unbind(".gcSpread");
for(var a=0;a<this.sheets.length;a++)this.sheets[a]._disposeUserEvents()},_getCalcContexts:function(){for(var a=[],d=0;d<this.sheets.length;d++){var e=this.sheets[d]._getCalcContexts();if(e)for(;0<e.length;)a.push(e.pop())}return a},_doResize:function(){if(l.browser.msie&&9>parseInt(l.browser.version,10)){var a=this.canvas;if(a){var d=a.parentElement,e=d.parentElement;if((a=a.firstChild)&&e){var b=function(a){return""===a||"auto"===a||/%$/ig.test(a)};b(d.style.width)&&12<e.offsetWidth&&(a.width=e.offsetWidth-
12);b(d.style.height&&10<e.offsetHeight)&&(a.height=e.offsetHeight-10)}}}d=this._scrollbarSize;if(b=this._host){a=l(this._vp).width();e=b.clientWidth;b=b.clientHeight;a*=this._getActualTabStripRatio();this._tabs.style.width=""+(a-1)+"px";this._vp.style.width=""+(e-d)+"px";this._vp.style.height=""+(b-d)+"px";this._vs.style.width=""+d+"px";this._vs.style.height=this._vp.style.height;e=e-(this._tabStripVisible?a:0)-d;this._hs.style.width=""+(0<e?e:1)+"px";this._hs.style.height=""+d+"px";if(d=this.getActiveSheet())0===
d._scrollTopRow&&(d._scrollTopRow=d._getFirstPageTopRow()),0===d._scrollLeftCol&&(d._scrollLeftCol=d._getFirstPageLeftColumn());a=l(this._vs);(e=a.data("wijmo-wijspreadpanelex")?a.data("wijmo-wijspreadpanelex").options:null)||(e={allowResize:!1,keyboardSupport:!0,bubbleScrollingEvent:!0,hScroller:{scrollBarVisibility:"hidden"},vScroller:{scrollSmallChange:1,scrollLargeChange:10,scrollMin:0,scrollBarVisibility:"visible"}});d&&(e.vScroller.scrollMin=d._getFirstPageTopRow(),e.vScroller.scrollMax=d.getRowCount()+
e.vScroller.scrollLargeChange-2,e.vScroller.scrollValue<d._scrollTopRow&&(e.vScroller.scrollValue=d._scrollTopRow));a.css("overflowY","");a.wijspreadpanelex(e);a.unbind("wijspreadpanelexscrolling",this._vscrollDelegate);a.bind("wijspreadpanelexscrolling",this._vscrollDelegate);a.wijspreadpanelex("refresh");a=l(this._hs);(e=a.data("wijmo-wijspreadpanelex")?a.data("wijmo-wijspreadpanelex").options:null)||(e={allowResize:!1,keyboardSupport:!0,bubbleScrollingEvent:!0,vScroller:{scrollBarVisibility:"hidden"},
hScroller:{scrollSmallChange:1,scrollLargeChange:10,scrollMin:0,scrollBarVisibility:"visible"}});d&&(e.hScroller.scrollMin=d._getFirstPageLeftColumn(),e.hScroller.scrollMax=d.getColumnCount()+e.hScroller.scrollLargeChange-2,e.hScroller.scrollValue<d._scrollLeftCol&&(e.hScroller.scrollValue=d._scrollLeftCol));a.css("overflowX","");a.wijspreadpanelex(e);a.unbind("wijspreadpanelexscrolling",this._hscrollDelegate);a.bind("wijspreadpanelexscrolling",this._hscrollDelegate);a.wijspreadpanelex("refresh");
d&&d._eventHandler.doResize();!0===this._tabStripVisible?l(this._tabs).show():l(this._tabs).hide();this._tab.doResize();d=l(this._vp).width();if(l(this._tabs).width()>d+1&&!this._haveLayoutFixing){this._haveLayoutFixing=!0;var f=this;setTimeout(function(){delete f._haveLayoutFixing;f._doResize()},1)}}},_doTabHSResize:function(){var a=this._scrollbarSize,d=this._host;if(d){var e=this._vp.clientWidth,d=d.clientWidth,e=this._getActualTabStripRatio()*e;this._tabs.style.width=""+(e-1)+"px";e=d-(this._tabStripVisible?
e:0)-a;this._hs.style.width=""+(0<e?e:1)+"px";this._hs.style.height=""+a+"px";!0===this._tabStripVisible?l(this._tabs).show():l(this._tabs).hide();this._tab.doResize()}},_trigger:function(a,d){0===this._eventSuspended&&l(this._userEventsElem).trigger(a,d)},_copyUserEvents:function(a){a._eventHandler._eventSuspended=this._eventSuspended;for(var d=0;d<this._userEvents.length;d++){var e=this._userEvents[d];a.bind(e.type,e.data,e.fn)}},_suspendInvalidate:function(){this.getActiveSheet()._suspendInvalidate()},
_resumeInvalidate:function(){this.getActiveSheet()._resumeInvalidate()},allowUserZoom:function(a){if(0===arguments.length)return this._allowUserZoom;this._allowUserZoom=a;return this},allowUserResize:function(a){if(0===arguments.length)return this._allowUserResize;this._allowUserResize=a;return this},tabStripVisible:function(a){if(0===arguments.length)return this._tabStripVisible;this._tabStripVisible=a;this._doResize();return this},tabEditable:function(a){if(0===arguments.length)return this._tabEditable;
this._tabEditable=a;return this},newTabVisible:function(a){if(0===arguments.length)return this._newTabVisible;this._newTabVisible=a;this._doTabHSResize();return this},canUserEditFormula:function(a){if(0===arguments.length)return this._canUserEditFormula;this._canUserEditFormula=a;return this},startSheetIndex:function(a){if(0===arguments.length)return this._tab?this._tab._firstTab:0;this._tab&&0<=a&&a<this.getSheetCount()&&(this._tab._firstTab=a);this._doTabHSResize();return this},highlightInvalidData:function(a){if(0===
arguments.length)return this._highlightInvalidData;var d=this,e=this.getActiveSheet();if(e)return e._bindToAutoRefresh(function(a){d._highlightInvalidData=a;return d})(a);d._highlightInvalidData=a},isPaintSuspended:function(a){if(0===arguments.length)return this._paintSuspended;if(this._paintSuspended!==a){this._paintSuspended=a;for(var d=0;d<this.sheets.length;d++)this.sheets[d].isPaintSuspended(a)}return this},repaint:function(){this._tab&&this._tab.repaint();var a=this.getActiveSheet();a&&(a.invalidateLayout(),
a.repaint())},invalidateLayout:function(){this._doResize();var a=this.getActiveSheet();a&&a.invalidateLayout()},getActiveSheet:function(){return 0<this.sheets.length?this.sheets[this._activeSheetIndex]:null},getActiveSheetIndex:function(){return this._activeSheetIndex},setActiveSheetIndex:function(a){if("number"===typeof a&&a!==this._activeSheetIndex){var d=this.getActiveSheet();d&&d._dispose();this._activeSheetIndex=a;(d=this.getActiveSheet())&&this._setActiveSheetImp(d);this._doResize()}},_setActiveSheetImp:function(a){a._setHost(this._vp);
var d=this;a._scrollCallback=function(e){d.getActiveSheet()===a&&("scroll"===e.action?"vertical"===e.orientation?(e=l(d._vs),e.wijspreadpanelex().data("wijmo-wijspreadpanelex").options.vScroller.scrollValue=a._scrollTopRow,e.wijspreadpanelex("refresh"),d._refreshScrollbar()):"horizontal"===e.orientation&&(e=l(d._hs),e.wijspreadpanelex().data("wijmo-wijspreadpanelex").options.hScroller.scrollValue=a._scrollLeftCol,e.wijspreadpanelex("refresh"),d._refreshScrollbar()):"resize"===e.action&&d._doResize())};
p.gcGlobal.activeElement=a;a._syncHScollbarPosition();a._syncVScrollbarPosition()},addSheet:function(a,d){if(void 0===d||null===d)d=this._createSheet(this._getDefaultSheetName(a),200,20);if(void 0===d._name||null===d._name||""===d._name)d._name=this._getDefaultSheetName(a);var e,b=this.sheets.length;for(e=0;e<b;e++)if(this.sheets[e]._name===d._name)throw"NotSupportedException";this._copyUserEvents(d);var f=null;if(0<this.sheets.length)for(e=0;!f&&e<this.sheets.length;e++)f=this.sheets[e]._getSheetSource();
var b=this.getActiveSheet(),g=this._activeSheetIndex,k=this.sheets.length-a,l=[];for(e=0;e<k&&0<this.sheets.length;e++)l.push(this.sheets.pop());this.isPaintSuspended()!==d.isPaintSuspended()&&d.isPaintSuspended(this.isPaintSuspended());this.sheets.push(d);d.parent=this;d.borderWidth=0;d.calcService=this.calcService;f&&(e=d._getSheetSource())&&e.shareCalculations(f);for(;0<l.length;)this.sheets.push(l.pop());1===this.sheets.length?(this._vp&&d._setHost(this._vp),this._activeSheetIndex=0):this._activeSheetIndex=
g;e=this.getActiveSheet();e!==b&&(b&&b._dispose(),e&&this._setActiveSheetImp(e),this._doResize());this._tab&&this._tab.repaint()},removeSheet:function(a){if(isNaN(a)||0>a||a>=this.sheets.length)throw Error("index is out of range");var d=a<=this._activeSheetIndex||a===this.sheets.length-1,e=this.getActiveSheet();a<this._activeSheetIndex&&this._activeSheetIndex--;this.sheets[a]._disposeUserEvents();this.sheets.splice(a,1);0===this.sheets.length?this._activeSheetIndex=-1:this._activeSheetIndex>=this.sheets.length&&
(this._activeSheetIndex=this.sheets.length-1);d&&(e&&e._dispose(),-1<this._activeSheetIndex&&this._setActiveSheetImp(this.sheets[this._activeSheetIndex]));this._tab&&(this._tab._firstTab>=this.sheets.length&&(this._tab._firstTab=this.sheets.length-1),0>this._tab._firstTab&&(this._tab._firstTab=0),this._tab.repaint())},clearSheets:function(){for(var a=0;a<this.sheets.length;a++)this.sheets[a]._disposeUserEvents(),this.sheets[a]._dispose();this.sheets.splice(0,this.sheets.length);this._activeSheetIndex=
-1;this._tab&&(this._tab._firstTab=0,this._tab.repaint())},getSheet:function(a){return 0<=a&&a<this.sheets.length?this.sheets[a]:null},getSheetFromName:function(a){for(var d=0;d<this.sheets.length;d++)if(this.sheets[d].getName()===a)return this.sheets[d];return null},getSheetCount:function(){return this.sheets.length},setSheetCount:function(a){if(0>a)throw"ArgumentOutOfRangeException";0===a&&this.clearSheets();var d=this.sheets.length;if(a<d)for(d-=1;d>=a;d--)this.removeSheet(d);else if(a>d)for(;d<
a;d++)this.addSheet(d)},search:function(a){if(!a)return null;var d=k.SearchFoundFlags.None,e=k.SearchResult;if(!a.searchString||a.searchTarget===d||0>=this.getSheetCount())return new e;-1===a.startSheetIndex&&(a.startSheetIndex=0);-1===a.endSheetIndex&&(a.endSheetIndex=this.getSheetCount()-1);if(a.endSheetIndex>=a.startSheetIndex&&0<=a.startSheetIndex&&a.startSheetIndex<this.getSheetCount()&&0<=a.endSheetIndex&&a.endSheetIndex<this.getSheetCount())for(var b=a.startSheetIndex;b<=a.endSheetIndex;b++){var f=
this.getSheet(b).search(a);if(f&&f.searchFoundFlag!==d)return f.foundSheetIndex=b,f}return new e},showCell:function(a,d,e,b){var f=this.getActiveSheet();f&&f.showCell(a,d,e,b)},showColumn:function(a,d){var e=this.getActiveSheet();e&&e.showColumn(a,d)},showRow:function(a,d){var e=this.getActiveSheet();e&&e.showRow(a,d)},showActiveCell:function(a,d){var e=this.getActiveSheet();e&&e.showCell(e._activeRowIndex,e._activeColIndex,a,d)},getCustomName:function(a){return this._names?this._names[a]:null},addCustomName:function(a,
d,e,b){if(void 0===a||null===a||""===a||void 0===d||null===d||""===d)throw Error("invalid custom name");this._names||(this._names={});d=this.calcService.parse(d,e,b);this._names[a]=new k.NameInfo(a,d,e,b);this._recalcAll()},removeCustomName:function(a){this._names&&void 0!==a&&null!==a&&""!==a&&this._names.hasOwnProperty(a)&&(delete this._names[a],this._recalcAll())},clearCustomNames:function(){this._names&&(delete this._names,this._recalcAll())},_findCustomName:function(a){if(void 0===a||null===
a||""===a)return null;var d=this.getCustomName(a);(void 0===d||null===d)&&this.parent&&this.parent.getCustomName&&(d=this.parent.getCustomName(a));return d},addCustomFunction:function(a){if(void 0===a||null===a||!(a instanceof m.Calc.Functions.Function))throw Error("invalid custom function");var d=a.name.toUpperCase();this._functions||(this._functions={});this._functions[d]=a;this._recalcAll()},getCustomFunction:function(a){return this._functions&&void 0!==a&&null!==a&&""!==a?this._functions[a.toUpperCase()]:
null},removeCustomFunction:function(a){this._functions&&void 0!==a&&null!==a&&""!==a&&(a=a.toUpperCase(),this._functions.hasOwnProperty(a)&&(delete this._functions[a],this._recalcAll()))},clearCustomFunctions:function(){if(this._functions){var a=[],d;for(d in this._functions)this._functions.hasOwnProperty(d)&&a.push(d);delete this._functions;this._recalcAll()}},_recalcAll:function(){this.calcService&&this.calcService.recalculateAll()},referenceStyle:function(a){var d=k.ReferenceStyle.R1C1,e=k.ReferenceStyle.A1;
if(0===arguments.length)return this.calcService.useR1C1?d:e;this.calcService.useR1C1=a===d;return this},bind:function(a,d,e){this._userEvents.push({type:a,data:d,fn:e});l(this._userEventsElem).bind(a+".gcSpread",d,e);for(var b=0;b<this.sheets.length;b++)this.sheets[b].bind(a,d,e)},unbind:function(a,d){for(var e=0;e<this._userEvents.length;e++)this._userEvents[e].type===a&&this._userEvents.splice(e,1);l(this._userEventsElem).unbind(a+".gcSpread",d);for(e=0;e<this.sheets.length;e++)this.sheets[e].unbind(a,
d)},unbindAll:function(){this._userEvents.length=0;l(this._userEventsElem).unbind(".gcSpread");for(var a=0;a<this.sheets.length;a++)this.sheets[a].unbindAll()},suspendEvent:function(){this._eventSuspended++;for(var a=0;a<this.sheets.length;a++)this.sheets[a].suspendEvent()},resumeEvent:function(){this._eventSuspended--;0>this._eventSuspended&&(this._eventSuspended=0);for(var a=0;a<this.sheets.length;a++)this.sheets[a].resumeEvent()},saveData:function(){if(this._host){var a=g.getElementById(this._host.id+
"_data");if(void 0!==a&&null!==a){var d=this.getSheetCount(),e=[],b={activeSheetIndex:this.getActiveSheetIndex(),sheetCount:d,tabStripRatio:this.getTabStripRatio(),tabStripVisible:this._tabStripVisible,tabEditable:this._tabEditable,newTabVisible:this._newTabVisible,allowCellOverflow:this.getActiveSheet()?this.getActiveSheet()._allowCellOverflow:!1,theme:this.getActiveSheet().currentTheme().name()};e.push(JSON.stringify(b));for(b=0;b<d;b++){var f=this.getSheet(b),k="";f.deletedRows&&(k=JSON.stringify(f.deletedRows));
var l={},m;for(m in f._rowInfos)if("function"!==typeof m){var r=f._rowInfos[m];r&&r.dirty&&(l[m]=r)}r={};for(m in f._colInfos)if("function"!==typeof m){var u=f._colInfos[m];u&&u.dirty&&(r[m]=u)}f={name:f._name,ar:f._activeRowIndex,ac:f._activeColIndex,columns:r,rows:l,rowCount:f.getRowCount(),columnCount:f.getColumnCount(),data:f._dataModel.dirtyNodes,deletedRows:k,spans:f._getSpanModel(),rowHeaderAutoText:f.rowHeaderAutoText,colHeaderAutoText:f.colHeaderAutoText,referenceStyle:f.referenceStyle(),
gridline:f.gridline,frozenRowCount:f.frozenRowCount,frozenColCount:f.frozenColCount};e.push(JSON.stringify(f))}a.value=JSON.stringify(e)}}},doCommand:function(a){this._undoManager.doAction(a)},allowUndo:function(a){if(0===arguments.length)return this._allowUndo;this._allowUndo=a;this._undoManager&&(this._undoManager._allowUndo=a);return this},undoManager:function(){this._undoManager||(this._undoManager=new k._UndoManager(this,-1,this.allowUndo()));return this._undoManager},canUserDragDrop:function(a){if(0===
arguments.length){if(void 0===this._allowDragDrop||null===this._allowDragDrop)this._allowDragDrop=!0;return this._allowDragDrop}this._allowDragDrop=a;return this},canUserDragFill:function(a){if(0===arguments.length){if(void 0===this._allowDragFill||null===this._allowDragFill)this._allowDragFill=!0;return this._allowDragFill}if(this._allowDragFill!==a){this._allowDragFill=a;var d=this.getActiveSheet();d&&1===d.getSelections().length&&d._render.repaintSelection(d.getSelections().toArray()[0])}return this},
toJSON:function(){for(var a=this.getSheetCount(),d={activeSheetIndex:this.getActiveSheetIndex(),sheetCount:a,tabStripRatio:this.getTabStripRatio(),tabStripVisible:this._tabStripVisible,tabEditable:this._tabEditable,newTabVisible:this._newTabVisible,referenceStyle:this.referenceStyle(),useWijmoTheme:this.useWijmoTheme,canUserEditFormula:this._canUserEditFormula,startSheetIndex:this.startSheetIndex(),allowUndo:this._allowUndo,allowUserZoom:this._allowUserZoom,allowUserResize:this._allowUserResize,allowDragDrop:this._allowDragDrop,
allowDragFill:this._allowDragFill,highlightInvalidData:this._highlightInvalidData},e={},b=0;b<a;b++){var f=this.getSheet(b);e[f._name]=f.toJSON()}d.sheets=e;a=[];if(this._names&&this.calcService)for(var g in this._names)if(this._names.hasOwnProperty(g)){var k=this._names[g],e=k.getName(),b=k.getRow(),f=k.getColumn(),k=k.getExpression(),k=this.calcService.unparse(k,b,f);a.push({name:e,formula:k,row:b,col:f})}d.names=a;return d},fromJSON:function(a){if(a){var d=this.isPaintSuspended();this.isPaintSuspended(!0);
try{this.calcService=new m.Calc.Service(this);this._availableSheetIndex=-1;this.clearSheets();this.setSheetCount(a.sheetCount);null!==a.referenceStyle&&void 0!==a.referenceStyle&&this.referenceStyle(a.referenceStyle);var e=0,b;if(a.sheets)for(var f in a.sheets)if("string"===typeof f){var g=a.sheets[f];b=this.sheets[e];b.fromJSON(g);e++}this.setActiveSheetIndex(a.activeSheetIndex);"undefined"!==typeof a.tabStripRatio&&this.setTabStripRatio(a.tabStripRatio);"undefined"!==typeof a.tabStripVisible&&(this._tabStripVisible=
a.tabStripVisible);"undefined"!==typeof a.tabEditable&&(this._tabEditable=a.tabEditable);"undefined"!==typeof a.newTabVisible&&(this._newTabVisible=a.newTabVisible);this.gcSpreadsheet=a.gcSpreadsheet;"undefined"!==typeof a.useWijmoTheme&&(this.useWijmoTheme=a.useWijmoTheme);"undefined"!==typeof a.canUserEditFormula&&(this._canUserEditFormula=a.canUserEditFormula);"undefined"!==typeof a.startSheetIndex&&this.startSheetIndex(a.startSheetIndex);"undefined"!==typeof a.allowUndo&&this.allowUndo(a.allowUndo);
"undefined"!==typeof a.allowUserZoom&&(this._allowUserZoom=a.allowUserZoom);"undefined"!==typeof a.allowUserResize&&(this._allowUserResize=a.allowUserResize);"undefined"!==typeof a.allowDragDrop&&(this._allowDragDrop=a.allowDragDrop);"undefined"!==typeof a.allowDragFill&&(this._allowDragFill=a.allowDragFill);"undefined"!==typeof a.highlightInvalidData&&(this._highlightInvalidData=a.highlightInvalidData);if(a.names){for(b=0;b<a.names.length;b++){var k=a.names[b];this.addCustomName(k.name,k.formula,
k.row,k.col)}for(e=0;e<a.sheetCount;e++)this.sheets[e]._rebuildCalcNodes()}}finally{this.isPaintSuspended(d)}}},setTabStripRatio:function(a,d){var e;if(isNaN(e=parseFloat(a)))throw"ArgumentException";var b=this._tab._resizeBarWidth/this._vp.clientWidth;this._tabStripRatio=e<b?b:1<e?1:e;this._tabStripRatioUserSet=0>e?0:1<e?1:e;this._doTabHSResize();d||(e=l(this._hs),e.wijspreadpanelex&&e.wijspreadpanelex("refresh"),this._refreshScrollbar())},getTabStripRatio:function(){if(void 0===this._tabStripRatioUserSet||
null===this._tabStripRatioUserSet)this._tabStripRatioUserSet=this._tabStripRatio;return this._tabStripRatioUserSet},_getActualTabStripRatio:function(){return this._tabStripRatio}};k._GcTab=function(a){this._init(a)};k._GcTab.prototype={_init:function(a){this._bounds=new k.Rect(0,0,200,20);this.name=a},_spread:null,_activeIndex:0,_firstTab:0,_tabStartPos:74,_tabLeftPadding:12,_tabRightPadding:8,_tabSpace:3,_activePos:70,_hoverNavButton:-1,_hoverTab:-1,_navButtonSize:18,_newTabSize:48,_firstTabSpace:5,
_font:"10pt Arial",_resizeBarWidth:8,_tabSizes:[],_setHost:function(a){var d=g.createElement("canvas");d.setAttribute("id",this.name);a.appendChild(d);d.gcObject=!0;this.canvas&&(a=l(this.canvas),a.unbind("mousedown.gcTab"),a.unbind("mousemove.gcTab"),a.unbind("mouseup.gcTab"),a.unbind("mouseout.gcTab"),a.unbind("dblclick.gcTab"),this.canvas.parentNode.removeChild(this.canvas));this.canvas=d;!m.UI._isStandardCanvas()&&m.UI._isSilverlightCanvas()&&(d.setAttribute("renderMethod","auto"),this.test=function(a){a._spread.initPaint.call(a._spread)},
d.setAttribute("onload",this.test(this)));var e=k.createEventHandler;a=l(d);a.bind("mousedown.gcTab",e(this,this.doMouseDown));a.bind("mousemove.gcTab",e(this,this.doMouseMove));a.bind("mouseup.gcTab",e(this,this.doMouseUp));a.bind("mouseout.gcTab",e(this,this.doMouseOut));a.bind("dblclick.gcTab",e(this,this.doMouseDbClick));this.doResize()},setOwner:function(a){(this._spread=a)&&a._font&&0<a._font.length&&(this._font=a._font)},_dispose:function(){var a=this.canvas;a&&(l(a).unbind("mousedown.gcTab"),
l(a).unbind("mousemove.gcTab"),l(a).unbind("mouseup.gcTab"),l(a).unbind("dblclick.gcTab"),l(a).unbind("mouseout.gcTab"),a.parentNode.removeChild(a))},getBounds:function(){return this._bounds},setBounds:function(a){this._bounds.x=a.x;this._bounds.y=a.y;this._bounds.width=a.width;this._bounds.height=a.height},doNavButtonClick:function(a){var d=this._firstTab,e=this;switch(a){case 0:d=0;break;case 1:d-=1;0<d&&(this._repeatDown=p.setTimeout(function(){e.doNavButtonClick(1)},200));0>d&&(d=0);break;case 2:d+=
1;d<this._spread.sheets.length-1&&(this._repeatDown=p.setTimeout(function(){e.doNavButtonClick(2)},200));d>=this._spread.sheets.length&&(d=this._spread.sheets.length-1);0>d&&(d=0);break;case 3:d=this._spread.sheets.length-1;0>d&&(d=0);break;default:return}d!==this._firstTab&&(this._firstTab=d,this.repaint())},_hitTest:function(a,d){var e=this.getBounds();if(e.x+e.width-this._resizeBarWidth<a&&a<e.x+e.width)return{element:"resizeBar"};var b=-1,e=0,f;for(f=0;4>f;f++){if(e<=a&&a<e+this._navButtonSize){b=
f;break}e+=this._navButtonSize}if(-1!==b)return{element:"navButton",index:f};e=this._tabStartPos;if(0<this._firstTab){if(e<a&&a<e+this._firstTabSpace+this._tabSpace)return{element:"tab",index:this._firstTab-1,position:e};e+=this._firstTabSpace}b=0;if(-1<this._firstTab)for(f=this._firstTab;f<this._spread.sheets.length&&f<this._tabSizes.length;f++){b=this._tabSizes[f];if(e<a&&a<e+b+this._tabSpace)return{element:"tab",index:f,position:e};e+=b+this._tabSpace}return this._spread._newTabVisible&&a>e&&a<
e+this._newTabSize?{element:"newTab",position:e}:{element:""}},doMouseDown:function(a){var d=l(this._getCanvas()).offset(),e=a.pageX-d.left,b=a.pageY-d.top,d=this._spread.getActiveSheet(),f;this._tabNameEditor&&this.endSheetTabEditing(d,!1);b=this._hitTest(e,b);e=k.Events;if(0===a.button){if("resizeBar"===b.element)this.resizeTab=!0,this.activeX=a.pageX,this.handleDocumentMouseMove();else if("navButton"===b.element)this.doNavButtonClick(b.index);else if("tab"===b.element){var g=b.index,b=b.position;
this._activeIndex=g;this._activePos=b;a=this._spread.getSheet(g);this._spread._trigger(e.SheetTabClick,{sheet:a,sheetName:a._name,sheetTabIndex:g});g!==this._spread._activeSheetIndex&&(f={oldSheet:d,newSheet:a,cancel:!1},this._spread._trigger(e.ActiveSheetChanging,f),f&&!1===f.cancel&&(this._spread.setActiveSheetIndex(g),this._spread._trigger(e.ActiveSheetChanged,{oldSheet:d,newSheet:a}),this._activeIndex<this._firstTab?this._firstTab--:this._activeIndex>this._firstTab&&this._activePos+this._tabSizes[this._activeIndex]>
this.getBounds().width-this._resizeBarWidth&&this._firstTab++,this.repaint()))}else if("newTab"===b.element){this._spread._trigger(e.SheetTabClick,f={sheet:null,sheetName:null,sheetTabIndex:-1});if(f&&!0===f.cancel)return!1;g=this._spread.sheets.length;a=this._spread._createSheet(this._spread._getDefaultSheetName(g));this._spread.addSheet(g,a);this._activeIndex=g;this._activePos=b.position;f={oldSheet:d,newSheet:a,cancel:!1};this._spread._trigger(e.ActiveSheetChanging,f);if(f&&!1===f.cancel){a._eventHandler&&
a._eventHandler._doCallBack("activeSheetChanged,"+this._spread._activeSheetIndex+","+g,{oldValue:this._spread._activeSheetIndex,newValue:g});this._spread.setActiveSheetIndex(g);for(this._spread._trigger(e.ActiveSheetChanged,{oldSheet:d,newSheet:a});this._activeIndex>this._firstTab&&this._activePos+this._tabSizes[this._activeIndex]+this._newTabSize>this.getBounds().width-this._resizeBarWidth;)this._activePos-=this._tabSizes[this._firstTab],this._firstTab++;this.repaint()}}(d=this._spread.getActiveSheet())&&
!d.isEditing()&&d._eventHandler&&d._eventHandler._setFocus()}return!1},doMouseMove:function(a){if(this.resizeTab){this.canvas.style.cursor="w-resize";var d=a.pageX-this.activeX,e=this._spread._vp.clientWidth,b=this._spread;b.setTabStripRatio(b._getActualTabStripRatio()+d/e,!0);d=this._resizeBarWidth/e;b._getActualTabStripRatio()<d?(b.setTabStripRatio(d,!0),this.activeX=this._resizeBarWidth):1<=b._getActualTabStripRatio()?(b.setTabStripRatio(1,!0),this.activeX=e):this.activeX=a.pageX}else{this._hoverTab=
this._hoverNavButton=-1;e=l(this._getCanvas()).offset();a=this._hitTest(a.pageX-e.left,a.pageY-e.top);if(""===a.element)return this.canvas.style.cursor="default",this.repaint(),!1;"resizeBar"===a.element?this.canvas.style.cursor="w-resize":(this.canvas.style.cursor="default","navButton"===a.element?this._hoverNavButton=a.index:"tab"===a.element?this._hoverTab=a.index:"newTab"===a.element&&(this._hoverTab=-2));this.repaint()}return!1},doMouseUp:function(a){this.resizeTab&&(this.resizeTab=!1,a=l(this._spread._hs),
a.wijspreadpanelex&&a.wijspreadpanelex("refresh"),this._spread._refreshScrollbar());this._repeatDown&&(p.clearTimeout(this._repeatDown),this._repeatDown=null);this.unhandleDocumentMouseMove()},doMouseOut:function(a){a=this._hoverNavButton;this._hoverNavButton=-1;var d=this._hoverTab;this._hoverTab=-1;this._hoverNavButton===a&&this._hoverTab===d||this.repaint();return!1},doMouseDbClick:function(a){var d=l(this._getCanvas()).offset();if("tab"===this._hitTest(a.pageX-d.left,a.pageY-d.top).element){(a=
p.gcGlobal.activeElement)&&a.endEdit&&a.endEdit();p.gcGlobal.activeElement=null;var e=this._activeIndex,b=this._spread.sheets[e];a=this._tabSizes[e];d=l(this._getCanvas()).offset();this._spread._trigger(k.Events.SheetTabDoubleClick,e={sheet:b,sheetName:b._name,sheetTabIndex:e,cancel:!1});if(e&&!0===e.cancel||!this._spread._tabEditable)return!1;var f=g.createElement("input");f.type="text";f.value=b._name;f.setAttribute("contentEditable","true");f.setAttribute("autocomplete","off");f.style.position=
"absolute";f.style.margin="0";f.style.padding="0";f.style.margin="0";f.style.left=d.left+this._activePos+this._tabLeftPadding+"px";f.style.top=d.top+1+"px";f.style.width=a-this._tabLeftPadding-this._tabRightPadding+2+"px";f.style.backgroundColor="white";f.style.borderWidth=0;f.style.outline="none";g.body.insertBefore(f,null);this._tabNameEditor=f;var m=this;l(f).addClass("sheetTabEditor");l(f).bind("keydown.tabNameEditor",function(a){var e=k.Key;if(a.keyCode===e.enter)return m.endSheetTabEditing(b,
!1),!1;if(a.keyCode===e.esc)return m.endSheetTabEditing(b,!0),!1});l(f).bind("focusin.tabNameEditor",function(a){f.selectionStart=0;f.selectionEnd=f.value.length});l(f).bind("focusout.tabNameEditor",function(a){m.endSheetTabEditing(b,!1)});f.focus()}},_isValidSheetName:function(a){if(void 0===a||null===a||""===a)return!1;for(var d=this._spread.sheets.length,e=0;e<d;e++){var b=this._spread.sheets[e];if(b!==this._spread.getActiveSheet()&&a===b._name)return!1}return!0},endSheetTabEditing:function(a,
d){if(this._tabNameEditor){var e=this._tabNameEditor.value,b;this._spread._trigger(k.Events.SheetTabEditEnd,b={sheet:a,sheetName:a._name,sheetTabIndex:this._activeIndex,editingText:e,cancel:!1});b&&b.cancel||(!1===d&&void 0!==e&&null!==e&&""!==e&&this._isValidSheetName(e)&&(e=new k.UndoRedo.SheetRenameUndoAction(a,e),a._doCommand(e)),l(this._tabNameEditor).unbind("keydown.tabNameEditor"),l(this._tabNameEditor).unbind("focusin.tabNameEditor"),l(this._tabNameEditor).unbind("focusout.tabNameEditor"),
this._tabNameEditor.parentNode.removeChild(this._tabNameEditor),delete this._tabNameEditor)}},handleDocumentMouseMove:function(){if(!this._isCapture){var a=this;l(g).bind("mousemove.spliter",function(e){a.doMouseMove(e)});l(g).bind("mouseup.spliter",function(e){a.doMouseUp(e)});var d=this._spread.getActiveSheet();d&&(d._continueMouseUpBubble=!0);this._isCapture=!0}},unhandleDocumentMouseMove:function(){if(this._isCapture){this._isCapture=!1;l(g).unbind("mousemove.spliter");l(g).unbind("mouseup.spliter");
var a=this._spread.getActiveSheet();a&&delete a._continueMouseUpBubble}},repaint:function(a){var d=this._getCanvas();d&&(d.getContext||!m.UI._isSilverlightCanvas()||d.getContext)&&(d.getContext||"undefined"===typeof p.FlashCanvas||p.FlashCanvas.initElement(d),d.getContext&&this.paint(d.getContext("2d"),a))},doResize:function(){var a=this._getCanvas();a&&a.parentNode&&0!==a.parentNode.clientWidth&&0!==a.parentNode.clientHeight&&(a.style.display="none",a.width=Math.max(a.parentNode.clientWidth,0),a.height=
Math.max(a.parentNode.clientHeight,0),a.style.display="",this._bounds.width=a.clientWidth,this._bounds.height=a.clientHeight,this.repaint())},paint:function(a,d){var e=this.getBounds();if(d&&(d.x>=e.x+e.width||d.y>=e.y+e.height||d.x+d.width>e.width&&(d.width=e.width-d.x,0>=d.width)||d.y+d.height>e.height&&(d.height=e.height-d.y,0>=d.height)||0>=d.width||0>=d.height))return;var b,f=m.UI._useDoubleBuffer();if(f&&(b=this.buffer,b&&b.width===e.width&&b.height===e.height||(this.buffer=b=g.createElement("canvas"),
b.width=e.width,b.height=e.height),!b.getContext))if(m.UI._isSilverlightCanvas()){if(!b.getContext)return}else if("undefined"!==typeof p.FlashCanvas&&(p.FlashCanvas.initElement(c),!b.getContext))return;b=f?this.buffer.getContext("2d"):a;b.clearRect(0,0,e.width,e.height);b.translate(-e.x,-e.y);this.paintTabs(b,d);b.translate(e.x,e.y);if(f){var f=0<=e.x?0:-e.x,l=0<=e.y?0:-e.y;d&&(f=e.x+d.x,l=e.y+d.y,e=new k.Rect(e.x+d.x,e.y+d.y,d.width,d.height));b=this.buffer.getContext("2d");var q=null;try{if(d)q=
b.getImageData(d.x,d.y,d.width,d.height);else var t=this._getCanvas(),q=t?b.getImageData(f,l,Math.min(e.width-f,Math.max(t.width-e.x,3)),Math.min(e.height-l,Math.max(t.height-e.y,3))):b.getImageData(f,l,Math.max(e.width-f,0),Math.max(e.height-l,0))}catch(r){return}f=0<=e.x?e.x:0;l=0<=e.y?e.y:0;q&&0<e.width&&0<e.height&&a.putImageData(q,f,l)}},_getCanvas:function(){var a=this.canvas;!a&&this.parent&&(a=this.parent.canvas);a&&!a.getContext&&a.firstChild&&(a.getContext=a.firstChild.getContext);return a},
paintTabs:function(a,d){if(a&&this._spread){var e=this.getBounds();a.save();a.font=this._font;a.rect(e.x,e.y,e.width,e.height);a.clip();a.beginPath();var b=null,f;this._spread.useWijmoTheme?(b=a.createLinearGradient(e.x,e.y,e.width,e.height),f=k.Global.prototype.getWijmoThemeStyle(k.VisualState.Normal),b.addColorStop(0,"#DDDDDD"),b.addColorStop(1,f.backgroundColor)):(b=a.createLinearGradient(e.x+0.7*e.height,e.y+0,0.7*e.height,e.height),b.addColorStop(0,"#7FA1D1"),b.addColorStop(0.3,"#A1BADD"),b.addColorStop(1,
"#9AB5DB"));a.fillStyle=b;a.fillRect(e.x,e.y,e.width,e.height);var g=60,l=this._tabStartPos;this._tabSizes=[];for(f=0;f<this._spread.sheets.length;f++)g=a.measureText(this._spread.sheets[f]._name).width+this._tabRightPadding+this._tabLeftPadding,this._tabSizes.push(g);b=[];0<this._firstTab&&(l+=this._firstTabSpace);if(0<=this._firstTab)for(f=this._firstTab;f<this._spread.sheets.length;f++)g=this._tabSizes[f],b.push({i:f,x:l,w:g,t:this._spread.sheets[f]._name}),l+=g+this._tabSpace;this._spread._newTabVisible&&
this.drawTab(a,l,0,this._newTabSize,e.height,5,!1,-2===this._hoverTab,"New\u2026");this._activeIndex=this._spread.getActiveSheetIndex();if(0<this._spread.sheets.length){for(f=b.length-1;0<=f;f--)g=b[f],g.i!==this._activeIndex&&this.drawTab(a,g.x,0,g.w,e.height,5,!1,g.i===this._hoverTab,g.t);0<this._firstTab&&(f=this._firstTab-1,g=this._tabSizes[f],this.drawTab(a,this._tabStartPos+this._firstTabSpace-g-this._tabSpace,0,g,e.height,5,this._activeIndex===f,this._hoverTab===f,""));this._activeIndex>=this._firstTab&&
this._activeIndex<this._spread.sheets.length&&(b=b[this._activeIndex-this._firstTab],this.drawTab(a,b.x,0,b.w,e.height,5,!0,!1,b.t))}a.fillStyle="#92A5C7";a.fillRect(e.x,e.y,this._tabStartPos-1,e.height);b=9;this.drawNavButton(a,b,9,b+5,14,b+5,4,!0,b-5,0===this._hoverNavButton);b+=this._navButtonSize;this.drawNavButton(a,b,9,b+5,14,b+5,4,!0,null,1===this._hoverNavButton);b+=this._navButtonSize;this.drawNavButton(a,b,9,b-5,14,b-5,4,!1,null,2===this._hoverNavButton);b+=this._navButtonSize;this.drawNavButton(a,
b,9,b-5,14,b-5,4,!1,b+4,3===this._hoverNavButton);this._spread.useWijmoTheme?(f=k.Global.prototype.getWijmoThemeStyle,g=k.VisualState,b=f(g.Hover),f=f(g.Normal),a.fillStyle=f.backgroundColor,a.fillRect(e.x+e.width-this._resizeBarWidth,e.y,this._resizeBarWidth,e.height),a.fillStyle=b.backgroundColor,a.fillRect(e.x+e.width-7,e.y+1,6,e.height-2),a.fillStyle=b.color,a.fillRect(e.x+e.width-5,e.y+4,2,e.height-8)):(a.fillStyle="#688CAF",a.fillRect(e.x+e.width-this._resizeBarWidth,e.y,this._resizeBarWidth,
e.height),a.fillStyle="#D7E6F7",a.fillRect(e.x+e.width-7,e.y+1,6,e.height-2),a.fillStyle="white",a.fillRect(e.x+e.width-5,e.y+4,4,e.height-8),a.fillStyle="#688CAF",a.fillRect(e.x+e.width-5,e.y+4,1,e.height-8));a.beginPath();a.restore()}},drawNavButton:function(a,d,e,b,f,g,l,m,r,u){a.save();var n=null,h=null,p=this.getBounds();if(this._spread.useWijmoTheme){var h=k.Global.prototype.getWijmoThemeStyle,E=k.VisualState,n=h(E.Hover),h=h(E.Normal);u?(a.fillStyle=n.backgroundColor,a.fillRect(d-7,p.y+2,14,
p.height-4)):(a.fillStyle=h.backgroundColor,a.fillRect(d-9,p.y+1,this._navButtonSize,p.height-2))}else u?(a.fillStyle="orange",a.fillRect(d-8,p.y+1,16,p.height-2),a.fillStyle="lightyellow",a.fillRect(d-7,p.y+2,14,p.height-4)):(E=a.createLinearGradient(p.x+0.7*p.height,p.y+0,0.7*p.height,p.height),E.addColorStop(0,"#FFFFFF"),E.addColorStop(0.1,"#D8E7FA"),E.addColorStop(0.45,"#D5E5F9"),E.addColorStop(0.45,"#B6D2F5"),E.addColorStop(0.9,"#D9E7F9"),E.addColorStop(1,"#FFFFFF"),a.fillStyle=E,a.fillRect(d-
9,p.y+1,this._navButtonSize,p.height-2));a.fillStyle=this._spread.useWijmoTheme?u?n.color:h.color:"black";void 0!==r&&null!==r&&a.fillRect(r,Math.min(f,l),1,Math.max(f,l)-Math.min(f,l));m?(d-=2,b-=2,g-=2):(d+=2,b+=2,g+=2);a.beginPath();a.moveTo(d,e);a.lineTo(b,f);a.lineTo(g,l);a.lineTo(d,e);a.fill();a.restore()},drawTab:function(a,d,e,b,f,g,l,m,r){a.save();a.beginPath();a.moveTo(d,e);a.lineTo(d,e+f-g);a.arcTo(d,e+f,d+b,e+f,g);a.lineTo(d+b,e+f);a.lineTo(d+b+f,e);l||a.lineTo(d,e);b=null;f=this.getBounds();
f=a.createLinearGradient(f.x+0.7*f.height,f.y+0,0.7*f.height,f.height);g=this._spread.getSheetFromName(r);""===r&&0<this._firstTab&&(g=this._spread.getSheet(this._firstTab-1));var u=!1;if(this._spread.useWijmoTheme){b=k.VisualState.Normal;if(l||m)b=k.VisualState.Hover;b=k.Global.prototype.getWijmoThemeStyle(b);f.addColorStop(0,b.backgroundColor);u=!0}else g&&g._sheetTabColor&&(a.fillStyle="rgba(0, 0, 0, 0)",a.fillStyle=(new k._ThemeContext(g)).getColor(g._sheetTabColor),g=a.fillStyle,"rgba(0, 0, 0, 0)"===
g?u=!1:(m||l?(f.addColorStop(0,"#FFFFFF"),f.addColorStop(0.45,"#F1F6FD"),f.addColorStop(0.9,g),f.addColorStop(1,"#FFFFFF")):f=g,u=!0));u||(m||l?(f.addColorStop(0,"#FFFFFF"),f.addColorStop(0.6,"#F1F6FD"),f.addColorStop(0.9,"#BCD5F6"),f.addColorStop(1,"#FFFFFF")):(f.addColorStop(0,"#D8E7FA"),f.addColorStop(0.45,"#D5E5F9"),f.addColorStop(0.6,"#B6D2F5"),f.addColorStop(1,"#D9E7F9")));a.fillStyle=f;a.fill();a.strokeStyle="#92A5C7";a.stroke();a.textBaseline="top";a.fillStyle=this._spread.useWijmoTheme&&
b?b.color:"black";a.fillText(r,d+this._tabLeftPadding,e+1);a.restore()}}})(window,jQuery);
(function(p,l){var m=p.GrapeCity;l.wijmo._wijspreadNS=l.wijmo.wijspread;l.wijmo.wijspread=void 0;l.widget("wijmo.wijspread",{_init:function(){var g=this.element.context;if(g){var a=new m.UI.GcSpread(g.id,this.options.sheetCount);this.element.data("spread",a);g.setAttribute("gcUIElement","gcSpread");m.UI.Global.prototype._createDummyObjects();var d=this.options;"string"===typeof d.name&&0<d.name.length&&(a.name=d.name);"string"===typeof d.font&&0<d.font.length&&(a._font=d.font);"boolean"===typeof d._allowUserZoom&&
(a._allowUserZoom=d._allowUserZoom);"boolean"===typeof d._allowUserResize&&(a._allowUserResize=d._allowUserResize);"boolean"===typeof d.tabStripVisible&&(a._tabStripVisible=d.tabStripVisible);"boolean"===typeof d.tabEditable&&(a._tabEditable=d.tabEditable);"boolean"===typeof d.newTabVisible&&(a._newTabVisible=d.newTabVisible);"boolean"===typeof d.useWijmoTheme&&(a.useWijmoTheme=d.useWijmoTheme);"number"===typeof d.tabStripRatio&&(a._tabStripRatio=d.tabStripRatio);"number"===typeof d.activeSheetIndex&&
(a._activeSheetIndex=d.activeSheetIndex);if(!m.UI._isStandardCanvas()&&m.UI._isSilverlightCanvas()){var e=document.createElement("canvas");e.setAttribute("width",""+g.clientWidth);e.setAttribute("height",""+g.clientHeight);g.appendChild(e);a.canvas=e;e.setAttribute("renderMethod","auto");e.setAttribute("gcSpreadsheet","true");e.setAttribute("onload",'$("#'+g.id+'").wijspread("initPaint");');l(p).bind("resize.gcSpread",m.UI.createEventHandler(a,a._doResize))}else a._setHost(g);if(d.sheets&&0<d.sheets.length){if(a.getSheetCount()<
d.sheets.length)for(e=a.getSheetCount();e<d.sheets.length;)g=a._createSheet(a._getDefaultSheetName(e)),a.addSheet(e,g),e=a.getSheetCount();for(e=0;e<d.sheets.length;e++)g=a.getSheet(e),g.applyOptions(d.sheets[e])}m.UI._isStandardCanvas()?(a.invalidateLayout(),a.repaint()):m.UI._isSilverlightCanvas()&&slcanvas&&slcanvas.autoLoad&&slcanvas.autoLoad()}},initPaint:function(){if(!m.UI._isStandardCanvas()){var g=this;void 0!==g._initPaintTimeout&&null!==g._initPaintTimeout&&p.clearTimeout(g._initPaintTimeout);
var a=g.spread().canvas.firstChild;a&&a.loaded?(a=a.Content.SpreadsheetObject,g.spread().attachSpreadsheetObject(a)):g._initPaintTimeout=p.setTimeout(function(){g.initPaint.call(g)},10)}},spread:function(){return this.element.data("spread")},destroy:function(){l(p).unbind("resize.gcSpread");this.spread()._dispose()},refresh:function(){var g=this.spread();g._doResize();g.repaint()},repaint:function(){this.spread().repaint()},options:{sheetCount:1,name:"",font:"10pt Arial",_allowUserZoom:!0,_allowUserResize:!0,
tabStripVisible:!0,tabEditable:!0,newTabVisible:!0,useWijmoTheme:!1,tabStripRatio:0.5,activeSheetIndex:0,sheets:[]}});l.wijmo._wijspreadNS&&(l.wijmo.wijspread=l.wijmo._wijspreadNS);var k=p.ko;k&&(k.wijmo=k.wijmo||{},k.wijmo.wijspreadBinding={init:function(g,a,d,e){l("#"+g.id).wijspread(a())},update:function(g,a,d,e){}},k.bindingHandlers.wijspread=k.wijmo.wijspreadBinding)})(window,jQuery);
(function(p,l){function m(a){a=a.toString(16);1===a.length&&(a="0"+a);return a}function k(a,b,e,d){this.a=a;this.r=b;this.g=e;this.b=d}function g(a,b,e){0>e&&(e+=240);240<e&&(e-=240);return 40>e?a+((b-a)*e+20)/40:120>e?b:160>e?a+((b-a)*(160-e)+20)/40:a}function a(a,b,e){if(0===e)b=e=a=parseInt(255*b/240,10);else{var d,f;f=120>=b?(b*(240+e)+120)/240:b+e-(b*e+120)/240;d=2*b-f;b=parseInt((255*g(d,f,a+80)+120)/240,10);e=parseInt((255*g(d,f,a)+120)/240,10);a=parseInt((255*g(d,f,a-80)+120)/240,10)}return new k(255,
b,e,a)}function d(a){var b=a.r,e=a.g,d=a.b;a=Math.max(Math.max(b,e),d);var f=Math.min(Math.min(b,e),d),h=a+f;this.luminosity=parseInt((240*h+255)/510,10);f=a-f;if(0===f)this.saturation=0,this.hue=160;else{this.saturation=120>=this.luminosity?parseInt((240*f+h/2)/h,10):parseInt((240*f+(510-h)/2)/(510-h),10);var h=(40*(a-b)+f/2)/f,g=(40*(a-e)+f/2)/f,d=(40*(a-d)+f/2)/f;this.hue=b===a?parseInt(d-g,10):e===a?parseInt(80+h-d,10):parseInt(160+g-h,10);0>this.hue&&(this.hue+=240);240<this.hue&&(this.hue-=
240)}}function e(a){return parseInt(a,16)}function b(a){return parseInt(a+a,16)}function f(a){return 0<a.indexOf("%")?2.55*parseFloat(a):a|0}function s(a){if(a instanceof k)return a;var d=0,g=0,l=0,m=0;if(a&&""!==a){var q=O(a);a=RegExp;n.test(q)?a=[a.$1,a.$2,a.$3].map(e):E.test(q)?(q=[a.$1,a.$2,a.$3].map(f),q.splice(0,0,255*parseFloat(a.$4)),a=q):a=I.test(q)?[a.$1,a.$2,a.$3].map(f):h.test(q)?[a.$1,a.$2,a.$3].map(b):null;a&&(3===a.length?(d=255,g=a[0],l=a[1],m=a[2]):4===a.length&&(d=a[0],g=a[1],l=
a[2],m=a[3]))}return new k(d,g,l,m)}function q(a,b,e,d,f,h,g,k,l,n,m,q,r){this._name=a;this._colorList=[s(d),s(f),s(b),s(e),s(h),s(g),s(k),s(l),s(n),s(m),s(q),s(r)]}function t(a,b,e,d){this._name=a;this._themeColor=b?b:new q(a);this._headingFont=e;this._bodyFont=d}var r=p.GrapeCity;"undefined"===typeof r&&(r=p.GrapeCity={});"undefined"===typeof r.UI&&(r.UI={});var u=r.UI;k.prototype={a:1,r:0,g:0,b:0,toString:function(){return 255===this.a?"#"+m(this.r)+m(this.g)+m(this.b):"rgba("+this.r+","+this.g+
","+this.b+","+this.a+")"},getBrightness:function(){return(299*this.r+587*this.g+114*this.b)/1E3}};r.UI._Color=k;d.prototype={hue:160,luminosity:0,saturation:0,toColor:function(){return a(this.hue,this.luminosity,this.saturation)},getLighterColor:function(b){var e=this.luminosity,d=this.newLuma(this.luminosity,500,!0);return a(this.hue,e+(d-e)*b,this.saturation)},getDrakerColor:function(b){var e=this.newLuma(this.luminosity,-333,!0);return a(this.hue,e*(1-b),this.saturation)},newLuma:function(a,b,
e){if(0===b)return a;if(e)return 0<b?(a*(1E3-b)+241*b)/1E3:a*(b+1E3)/1E3;a+=240*b/1E3;0>a&&(a=0);240<a&&(a=240);return a}};var n=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,h=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,I=/^rgb\(([\s\d]*),([\s\d]*),([\s\d]*)\)$/i,E=/^rgba\(([\s\d]*),([\s\d]*),([\s\d]*),([\s\d]*)\)$/i,O=function(a){var b,e;return a?function(a){if(!e){var b=p.document.createElement("canvas");b&&b.getContext&&(e=b.getContext("2d"))}if(!e)return a;e.fillStyle=a;return a=e.fillStyle}:function(a){"undefined"===
typeof b&&(b=l("<span></span>"));b.css("color",a);return b.css("color")}}(r.UI._isStandardCanvas());k.parse=function(a){return s(a)};q.prototype={name:function(a){if(0===arguments.length)return this._name;this._name=a;return this},background1:function(a){return this._property(0,0===arguments.length,a)},background2:function(a){return this._property(1,0===arguments.length,a)},textColor1:function(a){return this._property(2,0===arguments.length,a)},textColor2:function(a){return this._property(3,0===arguments.length,
a)},accent1:function(a){return this._property(4,0===arguments.length,a)},accent2:function(a){return this._property(5,0===arguments.length,a)},accent3:function(a){return this._property(6,0===arguments.length,a)},accent4:function(a){return this._property(7,0===arguments.length,a)},accent5:function(a){return this._property(8,0===arguments.length,a)},accent6:function(a){return this._property(9,0===arguments.length,a)},hyperline:function(a){return this._property(10,0===arguments.length,a)},followedHyperline:function(a){return this._property(11,
0===arguments.length,a)},_property:function(a,b,e){if(b)return this._colorList[a];this._colorList[a]=s(e);return this},getColor:function(b){if(b&&""!==b){var e=-1,f=b.split(" ");if(f){if(1<f.length){if(void 0===f[0]||null===f[0])return b;var h=f[0].toLowerCase();"background"===h?e=parseInt(f[1],10)-1:"text"===h?e=parseInt(f[1],10)+1:"accent"===h&&(e=parseInt(f[1],10)+3)}else if(1===f.length){if(void 0===f[0]||null===f[0])return b;h=f[0].toLowerCase();"hyperlink"===h?e=10:"followedHyperlink"===h&&
(e=11)}h=0;2<f.length&&(h=parseInt(f[2],10));if(0<=e&&11>=e)return b=this._colorList[e],e=h/100,0!==e&&(b=new d(b),e=parseInt(0<e?(240-b.luminosity)*e:b.luminosity*e,10),b=a(b.hue,b.luminosity+e,b.saturation)),b.toString()}}return b}};u.ThemeColor=q;var H={Default:new q("Default","#000000","#1F497D","#FFFFFF","#EEECE1","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),Office:new q("Office","#000000","#1F497D","#FFFFFF","#EEECE1","#4F81BD","#C0504D","#9BBB59","#8064A2",
"#4BACC6","#F79646","#0000FF","#800080"),Apex:new q("Apex","#000000","#69676D","#FFFFFF","#C9C2D1","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),Aspect:new q("Aspect","#000000","#323232","#FFFFFF","#E3DED1","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),Concourse:new q("Concourse","#000000","#464646","#FFFFFF","#DEF5FA","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),Civic:new q("Civic","#000000",
"#646B86","#FFFFFF","#C5D1D7","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),Oriel:new q("Oriel","#000000","#575F6D","#FFFFFF","#FFF39D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),Origin:new q("Origin","#000000","#464653","#FFFFFF","#DDE9EC","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),Paper:new q("Paper","#000000","#444D26","#FFFFFF","#FEFAC9","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0",
"#809EC2","#8E58B6","#7F6F6F"),Solstice:new q("Solstice","#000000","#4F271C","#FFFFFF","#E7DEC9","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),Technic:new q("Technic","#000000","#3B3B3B","#FFFFFF","#D4D2D0","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),Trek:new q("Trek","#000000","#4E3B30","#FFFFFF","#FBEEC9","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),Urban:new q("Urban","#000000","#424456",
"#FFFFFF","#DEDEDE","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),Verve:new q("Verve","#000000","#666666","#FFFFFF","#D2D2D2","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),Equity:new q("Equity","#000000","#696464","#FFFFFF","#E9E5DC","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),Flow:new q("Flow","#000000","#04617B","#FFFFFF","#DBF5F9","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249",
"#E2D700","#85DFD0"),Foundry:new q("Foundry","#000000","#676A55","#FFFFFF","#EAEBDE","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),Median:new q("Median","#000000","#775F55","#FFFFFF","#EBDDC3","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),Metro:new q("Metro","#000000","#4E5B6F","#FFFFFF","#D6ECFF","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),Module:new q("Module","#000000","#5A6378","#FFFFFF",
"#D4D4D6","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),Opulent:new q("Opulent","#000000","#B13F9A","#FFFFFF","#F4E7ED","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5")};r.UI.ThemeColors=H;t.prototype={name:function(a){if(0===arguments.length)return this._name;this._name=a;return this},colors:function(a){if(0===arguments.length)return this._themeColor;this._themeColor=a;return this},headerFont:function(a){if(0===arguments.length)return this._headingFont;
this._headingFont=a;return this},bodyFont:function(a){if(0===arguments.length)return this._bodyFont;this._bodyFont=a;return this}};r.UI.SpreadTheme=t;u.SpreadThemes={Default:new t("Default",H.Default,"Cambria","Calibri"),Office:new t("Office",H.Office,"Cambria","Calibri"),Apex:new t("Apex",H.Apex,"Lucida Sans","Book Antiqua"),Aspect:new t("Aspect",H.Aspect,"Verdana","Verdana"),Concourse:new t("Concourse",H.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),Civic:new t("Civic",H.Civic,"Georgia",
"Georgia"),Oriel:new t("Oriel",H.Oriel,"Century Schoolbook","Century Schoolbook"),Origin:new t("Origin",H.Origin,"Bookman Old Style","Gill Sans MT"),Paper:new t("Paper",H.Paper,"Constantia","Constantia"),Solstice:new t("Solstice",H.Solstice,"Gill Sans MT","Gill Sans MT"),Technic:new t("Technic",H.Technic,"Franklin Gothic Book","Arial"),Trek:new t("Trek",H.Trek,"Franklin Gothic Medium","Franklin Gothic Book"),Urban:new t("Urban",H.Urban,"Trebuchet MS","Georgia"),Verve:new t("Verve",H.Verve,"Century Gothic",
"Century Gothic"),Equity:new t("Equity",H.Equity,"Franklin Gothic Book","Perpetua"),Flow:new t("Flow",H.Flow,"Calibri","Constantia"),Foundry:new t("Foundry",H.Foundry,"Rockwell","Rockwell"),Median:new t("Median",H.Median,"Tw Cen MT","Tw Cen MT"),Metro:new t("Metro",H.Metro,"Consolas","Corbel"),Module:new t("Module",H.Module,"Corbel","Corbel"),Opulent:new t("Opulent",H.Opulent,"Trebuchet MS","Trebuchet MS")}})(window,jQuery);
(function(p){function l(a,e,d,g,k){if(a)return k?k.call(e,e[d]):e[d];a=e[d];e[d]=g;k&&k.call(e,a!==g);return e}function m(a,e,d,g){this.X=a;this.Y=e;this.Width=d;this.Height=g;this.Left=this.X;this.Right=this.Left+this.Width;this.Top=this.Y;this.Bottom=this.Y+this.Height}function k(a){this._minItemHeight=2;this.info=a;this._clearCache()}var g=p.GrapeCity;"undefined"===typeof g&&(g=p.GrapeCity={});"undefined"===typeof g.UI&&(g.UI={});var a=g.UI,d={FromArgb:function(b,e,d,g){return(new a._Color(b,e,
d,g)).toString()}},e={};a.EmptyValueStyle={Gaps:0,Zero:1,Connect:2};a.SparklineAxisMinMax={individual:0,group:1,custom:2};a.SparklineSetting=function(b){if(b)for(var e in b)e&&(this[e]=b[e]);else this._axisColor="black",this._firstMarkerColor=d.FromArgb(255,149,179,215),this._highMarkerColor="Blue",this._lastMarkerColor=d.FromArgb(255,149,179,215),this._lowMarkerColor="Blue",this._markersColor=d.FromArgb(255,36,64,98),this._negativeColor="Brown",this._seriesColor=d.FromArgb(255,36,64,98),this.displayEmptyCellsAs=
a.EmptyValueStyle.Gaps,this._showMarkers=this._showNegative=this._showLow=this._showLast=this._showHigh=this._showFirst=this.displayXAxis=this.displayHidden=this.rightToLeft=!1,this.manualMin=this.manualMax=0,this.minAxisType=this.maxAxisType=a.SparklineAxisMinMax.individual,this.groupMinValue=this.groupMaxValue=0,this.lineWeight=1;this._worksheet=null};a.SparklineSetting.prototype={axisColor:function(a){return l(0===arguments.length,this,"_axisColor",a)},firstMarkerColor:function(a){return l(0===
arguments.length,this,"_firstMarkerColor",a)},highMarkerColor:function(a){return l(0===arguments.length,this,"_highMarkerColor",a)},lastMarkerColor:function(a){return l(0===arguments.length,this,"_lastMarkerColor",a)},lowMarkerColor:function(a){return l(0===arguments.length,this,"_lowMarkerColor",a)},markersColor:function(a){return l(0===arguments.length,this,"_markersColor",a)},negativeColor:function(a){return l(0===arguments.length,this,"_negativeColor",a)},seriesColor:function(a){return l(0===
arguments.length,this,"_seriesColor",a)},showFirst:function(a){return l(0===arguments.length,this,"_showFirst",a)},showHigh:function(a){return l(0===arguments.length,this,"_showHigh",a)},showLast:function(a){return l(0===arguments.length,this,"_showLast",a)},showLow:function(a){return l(0===arguments.length,this,"_showLow",a)},showNegative:function(a){return l(0===arguments.length,this,"_showNegative",a)},showMarkers:function(a){return l(0===arguments.length,this,"_showMarkers",a)},clone:function(){var b=
new a.SparklineSetting;b._axisColor=this._axisColor;b._firstMarkerColor=this._firstMarkerColor;b._highMarkerColor=this._highMarkerColor;b._lastMarkerColor=this._lastMarkerColor;b._lowMarkerColor=this._lowMarkerColor;b._markersColor=this._markersColor;b._negativeColor=this._negativeColor;b._seriesColor=this._seriesColor;b.displayEmptyCellsAs=this.displayEmptyCellsAs;b.rightToLeft=this.rightToLeft;b.displayHidden=this.displayHidden;b.displayXAxis=this.displayXAxis;b._showFirst=this._showFirst;b._showHigh=
this._showHigh;b._showLast=this._showLast;b._showLow=this._showLow;b._showNegative=this._showNegative;b._showMarkers=this._showMarkers;b.manualMax=this.manualMax;b.manualMin=this.manualMin;b.maxAxisType=this.maxAxisType;b.minAxisType=this.minAxisType;b.groupMaxValue=this.groupMaxValue;b.groupMinValue=this.groupMinValue;b.lineWeight=this.lineWeight;return b},_setThemeContext:function(a){this._worksheet=a},_getActualColor:function(b){a:{b=this[b]();var e=new a._ThemeContext(this._worksheet);if(e&&b&&
""!==b&&e.getColor&&(e=e.getColor(b))){b=e;break a}}return b},toJSON:function(){return{_axisColor:this._axisColor,_firstMarkerColor:this._firstMarkerColor,_highMarkerColor:this._highMarkerColor,_lastMarkerColor:this._lastMarkerColor,_lowMarkerColor:this._lowMarkerColor,_markersColor:this._markersColor,_negativeColor:this._negativeColor,_seriesColor:this._seriesColor,displayEmptyCellsAs:this.displayEmptyCellsAs,rightToLeft:this.rightToLeft,displayHidden:this.displayHidden,displayXAxis:this.displayXAxis,
_showFirst:this._showFirst,_showHigh:this._showHigh,_showLast:this._showLast,_showLow:this._showLow,_showNegative:this._showNegative,_showMarkers:this._showMarkers,manualMax:this.manualMax,manualMin:this.manualMin,maxAxisType:this.maxAxisType,minAxisType:this.minAxisType,groupMaxValue:this.groupMaxValue,groupMinValue:this.groupMinValue,lineWeight:this.lineWeight}}};a.SparklineType={line:0,column:1,winloss:2};a.DataOrientation={Vertical:0,Horizontal:1};a.SparklineGroup=function(b,e){this.setting=e;
this.displayDateAxis=!1;this.sparklineType=b;this._sparklineGroupManager=null;this._innerList=[];this._axisReference=null;this._axisOrientation=a.DataOrientation.Horizontal};a.SparklineGroup.prototype={add:function(a){a&&(this._innerList.push(a),a.group(this),this._adjustGroupMaxMinValue(),this.onGroupChanged())},remove:function(a){var e=this._innerList.remove(a);a.onSparklineChanged();a._group=this.clone();this._adjustGroupMaxMinValue();this.onGroupChanged();return e},contains:function(a){return this._innerList.contains(a)},
onGroupChanged:function(){if(this._innerList)for(var a=0;a<this._innerList.length;a++){var e=this._innerList[a];if(e)e.onSparklineChanged()}},clone:function(){var b=this.setting?this.setting.clone():null,b=new a.SparklineGroup(this.sparklineType,b);b.displayDateAxis=this.displayDateAxis;b._axisReference=this._axisReference;b._axisOrientation=this._axisOrientation;return b},dateAxisData:function(a){return 0===arguments.length?l(!0,this,"_axisReference",a):l(!1,this,"_axisReference",a,function(a){if(a)this.onGroupChanged()})},
dateAxisOrientation:function(a){return l(0===arguments.length,this,"_axisOrientation",a,function(a){if(a)this.onGroupChanged()})},count:function(){return this._innerList.length},_adjustGroupMaxMinValue:function(){if(this.setting){this.setting.groupMaxValue=Number.MIN_VALUE;this.setting.groupMinValue=Number.MAX_VALUE;var b=this.setting.maxAxisType===a.SparklineAxisMinMax.group,e=this.setting.minAxisType===a.SparklineAxisMinMax.group,d=!1;if(b||e)for(var g=0;g<this._innerList.length;g++){var k=this._getMaxMinValues(this._innerList[g]),
l=k.min,k=k.max;b&&this.setting.groupMaxValue<k&&(this.setting.groupMaxValue=k,d=!0);e&&this.setting.groupMinValue>l&&(this.setting.groupMinValue=l,d=!0)}return d}},_getMaxMinValues:function(a){var d=Number.MIN_VALUE,g=Number.MAX_VALUE,k=a.data();if(k)for(a=a._provideValues(k,a.dataOrientation(),!1),k=0;k<a.length;k++){var l=a[k];l===e&&(l=0);"number"===typeof l&&(d=d<l?l:d,g=g>l?l:g)}return{min:g,max:d}},toJSON:function(){return{setting:this.setting?this.setting.toJSON():null,displayDateAxis:this.displayDateAxis,
sparklineType:this.sparklineType,axisReference:this._axisReference,axisOrientation:this._axisOrientation,sparklines:this._innerList}},fromJSON:function(b){if(b&&(b.setting&&(this.setting=new a.SparklineSetting(b.setting)),void 0!==b.displayDateAxis&&null!==b.displayDateAxis&&(this.displayDateAxis=b.displayDateAxis),void 0!==b.sparklineType&&null!==b.sparklineType&&(this.sparklineType=b.sparklineType),void 0!==b.axisReference&&null!==b.axisReference&&(this._axisReference=b.axisReference),void 0!==
b.axisOrientation&&null!==b.axisOrientation&&(this._axisOrientation=b.axisOrientation),b.sparklines)){this._innerList=[];b=b.sparklines;for(var e=b.length,d=0;d<e;d++){var g=new a.Sparkline;g.fromJSON(b[d]);this.add(g)}}}};k.prototype={sparklineInfo:function(a){return l(0===arguments.length,this,"info")},paint:function(b,e,d,g,k){this._clearCache();this.info.sparklineType()===a.SparklineType.line&&this._paintLines(b,e,d,g,k);this._paintDataPoints(b,e,d,g,k);this._paintAxis(b,e,d,g,k)},_clearCache:function(){this._cachedMinDatetime=
Number.MAX_VALUE;this._cachedMaxDatetime=Number.MIN_VALUE;this._cachedMinValue=Number.MAX_VALUE;this._cachedMaxValue=Number.MIN_VALUE;this._cachedDatetimes=this._cachedValues=this._cachedIndexMapping=null},_getWorksheet:function(){if(this.info&&this.info.group()&&this.info.group()._sparklineGroupManager)return this.info.group()._sparklineGroupManager._sheet},_getSpace:function(b){return this.info.sparklineType()===a.SparklineType.line?3+this._getLineWeight()+1:3},_leftSpace:function(){return this._getSpace("left")},
_rightSpace:function(){return this._getSpace("right")},_topSpace:function(){return this._getSpace("top")},_bottomSpace:function(){return this._getSpace("bottom")},_getCachedValues:function(){if(!this._cachedValues){var a=this.info.data(),e=this.info.dataOrientation();this._cachedValues=this.info._provideValues(a,e)}return this._cachedValues},_getCachedDatetimes:function(){if(!this._cachedDatetimes){var a=this.info.group().dateAxisData(),e=this.info.group().dateAxisOrientation();this._cachedDatetimes=
this.info._provideValues(a,e,!0)}return this._cachedDatetimes},_getCachedIndexMaping:function(){if(this._cachedIndexMapping)return this._cachedIndexMapping;var a,d;if(this.sparklineInfo().displayDateAxis()){this._cachedIndexMapping=[];var g=this._getCachedValues().length;a=this._getCachedDatetimes().length;a=Math.min(g,a);g=[];0<a&&(g=this._getCachedDatetimes().slice(0,a));g.sort(function(a,b){if(a===b)return 0;a===e&&(a=0);b===e&&(b=0);return a-b});for(a=0;a<g.length;a++)if(d=g[a],void 0!==d&&null!==
d){for(var k=this._getCachedDatetimes().indexOf(d);this._cachedIndexMapping.contains(k);)k=this._getCachedDatetimes().indexOf(d,k+1);isNaN(d)||(d=this._getCachedValues()[k],void 0!==d&&null!==d&&isNaN(d)&&d!==e||this._cachedIndexMapping.push(k))}}else for(this._cachedIndexMapping=[],a=0;a<this._getCachedValues().length;a++)d=this._getCachedValues()[a],void 0!==d&&null!==d&&isNaN(d)&&d!==e||this._cachedIndexMapping.push(a);return this._cachedIndexMapping},_getValue:function(b){b=this._getCachedValues()[b];
void 0===b||null===b?this.sparklineInfo().setting().displayEmptyCellsAs===a.EmptyValueStyle.Zero&&(b=0):b===e&&(b=0);return b},_paintLines:function(b,e,d,g,k){var l,m,n,h=this._getCachedIndexMaping().length-1;0>h&&(h=0);this.linePos=[];for(l=0;l<h;l++)if(m=this._getValue(this._getCachedIndexMaping()[l]),void 0!==m&&null!==m){m=l+1;n=this._getValue(this._getCachedIndexMaping()[m]);if(void 0===n||null===n){var p=this.sparklineInfo().setting().displayEmptyCellsAs;if(p===a.EmptyValueStyle.Zero)n=0;else if(p===
a.EmptyValueStyle.Connect)for(m=l+2;m<=h;m++)if(p=this._getCachedValues()[this._getCachedIndexMaping()[m]],void 0!==p&&null!==p){n=p;break}}if(void 0!==n&&null!==n){n=this._getDataPointPosition(this._getCachedIndexMaping()[l],{Width:g,Height:k});var p=this._getDataPointPosition(this._getCachedIndexMaping()[m],{Width:g,Height:k}),E=n.Width/2;m={X:n.X+E,Y:n.Y+E};n={X:p.X+E,Y:p.Y+E};this.linePos[l]={P1:m,P2:n}}else l++}if(0<this.linePos.length)for(b.strokeStyle=this.info.setting().seriesColor(),b.lineCap=
"round",b.lineWidth=this._getLineWeight(),l=0;l<this.linePos.length;l++)if(g=this.linePos[l])b.beginPath(),m=g.P1,n=g.P2,b.moveTo(e+m.X,d+m.Y),b.lineTo(e+n.X,d+n.Y),b.stroke(),b.closePath()},_getDataPointColor:function(b){var e=null,d=this._getValue(b),g=this._getWorksheet();if(void 0!==d&&null!==d){this.info.setting()._setThemeContext(g);this._cachedMinValue!==Number.MAX_VALUE&&this._cachedMaxValue!==Number.MIN_VALUE||this._getMaxMinValue();d===this._cachedMinValue&&this.info.setting().showLow()&&
(e=this.info.setting()._getActualColor("lowMarkerColor"));(void 0===e||null===e)&&d===this._cachedMaxValue&&this.info.setting().showHigh()&&(e=this.info.setting()._getActualColor("highMarkerColor"));if(void 0===e||null===e)this.info.group().displayDateAxis?0===this._getCachedIndexMaping().indexOf(b)&&this.info.setting().showFirst()&&(e=this.info.setting()._getActualColor("firstMarkerColor")):0===b&&this.info.setting().showFirst()&&(e=this.info.setting()._getActualColor("firstMarkerColor"));if(void 0===
e||null===e)this.info.group().displayDateAxis?this._getCachedIndexMaping().indexOf(b)===this._getCachedIndexMaping().length-1&&this.info.setting().showLast()&&(e=this.info.setting()._getActualColor("lastMarkerColor")):b===this._getCachedIndexMaping().length-1&&this.info.setting().showLast()&&(e=this.info.setting()._getActualColor("lastMarkerColor"));(void 0===e||null===e)&&0>d&&this.info.setting().showNegative()&&(e=this.info.setting()._getActualColor("negativeColor"));if(void 0===e||null===e)b=this.info.sparklineType(),
b===a.SparklineType.line?this.info.setting().showMarkers()&&(e=this.info.setting()._getActualColor("markersColor")):b===a.SparklineType.column?e=this.info.setting()._getActualColor("seriesColor"):b===a.SparklineType.winloss&&(e=this.info.setting()._getActualColor("seriesColor"))}return void 0===e||null===e?"Transparent":e},_paintDataPoints:function(b,e,d,g,k){g={Width:g,Height:k};for(k=0;k<this._getCachedIndexMaping().length;k++){var l=this._getCachedIndexMaping()[k],m=this._getDataPointColor(l),
l=this._getDataPointPosition(l,g);b.fillStyle=m;this.info.sparklineType()===a.SparklineType.line?(b.save(),b.translate(e+l.X+l.Width/2,d+l.Y+l.Height/2),b.rotate(45*Math.PI/180),b.fillRect(0-l.Width/2,0-l.Height/2,l.Width,l.Height),b.restore()):(m=e+l.X+l.Width/4,m=Math.floor(m),b.fillRect(m,d+l.Y,l.Width/2,l.Height))}},_paintAxis:function(a,e,d,g,k){if(this.info.setting().displayXAxis&&this._hasAxis()){var l={Width:g,Height:k};g=this._leftSpace();k=l.Width-this._rightSpace();var l=this._getAxisY(l),
m=l=Math.floor(l)+0.5,n=this.info.setting()._getActualColor("axisColor"),h=this._getWorksheet()._zoomFactor;1>h&&(h=1);a.strokeStyle=n;a.lineWidth=h;a.beginPath();a.moveTo(e+g,d+l);a.lineTo(e+k,d+m);a.stroke()}},_hasAxisNormal:function(){var a=this._getActualMaxValue();if(a!==Number.MIN_VALUE){var e=this._getActualMinValue();if(e!==Number.MAX_VALUE)return a===e||0>=a*e}return!0},_hasAxis:function(){var b=this._hasAxisNormal();if(this.info.sparklineType()!==a.SparklineType.winloss)return b;if(!b&&
0<this._getCachedIndexMaping().length)for(var e in this._getCachedIndexMaping())if(e){var d=this._getCachedIndexMaping()[e],d=this._getCachedValues()[d];if(void 0!==d&&null!==d)return!0}return b},_getMinDatetime:function(){(isNaN(this._cachedMinDatetime)||this._cachedMinDatetime===Number.MAX_VALUE)&&this._getMaxMindatetimes();return this._cachedMinDatetime},_getMaxDatetime:function(){(isNaN(this._cachedMaxDatetime)||this._cachedMaxDatetime===Number.MIN_VALUE)&&this._getMaxMindatetimes();return this._cachedMaxDatetime},
_getMaxMindatetimes:function(){for(var a=0;a<this._getCachedIndexMaping().length;a++){var e=this._getCachedIndexMaping()[a],d=this._getCachedDatetimes()[e];isNaN(d)||(e=this._getValue(e),null!==e&&void 0===e||isNaN(e)||void 0===d||null===d||(d>this._cachedMaxDatetime&&(this._cachedMaxDatetime=d),d<this._cachedMinDatetime&&(this._cachedMinDatetime=d)))}},_calcItemWidth:function(a){var e=this._getMinDatetime(),d=this._getMaxDatetime(),g=[],k,l;for(k=0;k<this._getCachedIndexMaping().length;k++)l=this._getCachedIndexMaping()[k],
l=this._getCachedDatetimes()[l],void 0===l||null===l||isNaN(l)||l&&g.push(l);g.sort(function(a,b){return a-b});if(1<g.length&&e!==d){e=Number.MAX_VALUE;d=0;for(k=1;k<g.length;k++)l=g[k]-g[k-1],l<e&&0<l&&(e=l),d+=l;a=(a.Width-this._leftSpace()-this._rightSpace())*e/d/2;2>a&&(a=2);return a}return(a.Width-this._leftSpace()-this._rightSpace())/2},_getItemWidth:function(a){if(this.info.displayDateAxis())return this._calcItemWidth(a);var e=this._getCachedIndexMaping().length;return(a.Width-this._leftSpace()-
this._rightSpace())/e},_getItemX:function(a,e){var d;if(this.sparklineInfo().displayDateAxis()){d=this._getItemWidth(a);var g=this._getMaxDatetime(),k=this._getMinDatetime();if(g===k)return this._leftSpace()+d/2;var l=this._getCachedDatetimes()[e];if(!l)return 0;var m=a.Width-this._leftSpace()-this._rightSpace(),m=m-d;d=g-k;return this._leftSpace()+Math.floor((l-k)/d*m)}d=this._getItemWidth(a);k=this._getCachedIndexMaping().indexOf(e);d=this._leftSpace()+d*k;return d=Math.floor(d)},_getCanvasSize:function(a){var e=
a.Width-this._leftSpace()-this._rightSpace(),e=Math.max(e,0);a=a.Height-this._topSpace()-this._bottomSpace();a=Math.max(a,0);return{Width:e,Height:a}},_getMaxMinValue:function(){for(var a=0;a<this._getCachedValues().length;a++){var e=this._getCachedValues()[a];void 0!==e&&void 0!==e&&null!==e&&("number"!==typeof e&&(e=0),e<this._cachedMinValue&&(this._cachedMinValue=e),e>this._cachedMaxValue&&(this._cachedMaxValue=e))}},_getActualMaxValue:function(){this._cachedMaxValue!==Number.MIN_VALUE&&this._cachedMaxValue||
this._getMaxMinValue();var b=this.info.setting().maxAxisType;if(b!==a.SparklineAxisMinMax.individual){if(b===a.SparklineAxisMinMax.group)return this.info.setting().groupMaxValue;if(b===a.SparklineAxisMinMax.custom)return this.info.setting().manualMax}return this._cachedMaxValue},_getActualMinValue:function(){this._cachedMinValue!==Number.MAX_VALUE&&this._cachedMinValue||this._getMaxMinValue();var b=this.info.setting().minAxisType;if(b===a.SparklineAxisMinMax.individual)return this._cachedMinValue;
if(b===a.SparklineAxisMinMax.group)return this.info.setting().groupMinValue;if(b===a.SparklineAxisMinMax.custom)return this.info.setting().manualMin},_getItemHeightNormal:function(a,e){var d=this._getCanvasSize(a),g=this._getActualMaxValue(),k=this._getActualMinValue(),l=g-k;if(g===k){if(0===g)return 0;l=Math.abs(g)}(g=this._getCachedValues()[e])||(g=0);return g*(d.Height/l)},_getItemHeight:function(b,e){var d=this.info.sparklineType();if(d===a.SparklineType.line)return this._getItemHeightNormal(b,
e);if(d===a.SparklineType.column){d=this._getCachedValues()[e];if((void 0===d||null===d)&&this.info.setting().displayEmptyCellsAs===a.EmptyValueStyle.Zero)return 0;var g=this._getItemHeightNormal(b,e);if(g>-this._minItemHeight&&g<this._minItemHeight){if(0<d)return g+this._minItemHeight;if(0>d)return g-this._minItemHeight}return g}if(d===a.SparklineType.winloss){d=this._getCachedValues()[e];if(void 0===d||null===d||0===d||isNaN(d))return 0;g=this._getCanvasSize(b);return 0<=d?g.Height/2:-g.Height/
2}},_getAxisYNormal:function(a){var e=this._getCanvasSize(a),d=this._getActualMaxValue(),g=this._getActualMinValue();if(d===Number.MIN_VALUE||g===Number.MAX_VALUE)return a.Height/2;var k=d-g;if(d===g){if(0===d)return a.Height/2;k=d;0>d&&(d=0)}a=e.Height/k;return this._topSpace()+d*a},_getAxisY:function(b){return this.info.sparklineType()===a.SparklineType.winloss?b.Height/2:this._getAxisYNormal(b)},_getItemVisibleHeightNormal:function(a,e){var d=this._getCanvasSize(a),g=this._getActualMaxValue(),
k=this._getActualMinValue(),l=g-k;if(g===k){if(0===g)return 0;l=g}d=d.Height/l;l=this._getValue(e);if(void 0===l||null===l)l=0;return g!==k&&0<g*k?0<=l?(l-k)*d:(l-g)*d:l*d},_getItemVisibleHeight:function(b,e){var d=this.info.sparklineType();if(d===a.SparklineType.line)return this._getItemVisibleHeightNormal(b,e);if(d===a.SparklineType.column){d=this._getItemVisibleHeightNormal(b,e);if(d>-this._minItemHeight&&d<this._minItemHeight){var g=this._getValue(e);if(void 0===g||null===g)g=0;if(0!==g)return 0<
g?d+this._minItemHeight:d-this._minItemHeight}return d}if(d===a.SparklineType.winloss)return this._getItemHeight(b,e)},_getDataPointPositionNormal:function(a,e){var d=this._getItemWidth(e),g=this._getItemX(e,a);0>d&&(d=0);d=Math.floor(d);1===d%2&&(d+=1);var k=this._getItemHeight(e,a),l=this._getAxisY(e),p=this._getActualMaxValue(),n=this._getActualMinValue(),h=0;0>p&&0>n?h=Math.max(this.info._topSpace(),l):(h=l,0<=k&&(h=l-k));l=this._getItemVisibleHeight(e,a);d=new m(g,h,d,Math.abs(l));0!==k&&(d.Y<
this._topSpace()&&d.Bottom<this._topSpace()+1?d.Height=Math.floor(d.Height+1):(k=e.Height-this._bottomSpace(),d.Bottom>k&&d.Y>k-1&&(d.Y=k-l,d.Height=l)));return d},_getLineWeight:function(){var a=this.info.setting().lineWeight*this._getWorksheet()._zoomFactor;1>a&&(a=1);return a},_getDataPointPosition:function(b,e){var d=this._getLineWeight();d++;2>d&&(d=2);var g=this._getDataPointPositionNormal(b,e);if(this.info.sparklineType()===a.SparklineType.line){g.X+=(g.Width-d)/2;var k=this._getValue(b);void 0!==
k&&null!==k?(g.Y=0<=k?g.Y-d/2:g.Bottom-d/2,g.Width=d,g.Height=d):(g.Width=0,g.Height=0)}this.info.group().setting.rightToLeft&&(g=new m(e.Width-g.X-g.Width,g.Y,g.Width,g.Height));return g}};a.Sparkline=function(b,e,d,g,l,m){this.row=b;this.column=e;this._dataOrientation=g;this._data=d;this._group=new a.SparklineGroup(l,m);this._group.add(this);this._renderer=new k(this)};a.Sparkline.prototype={group:function(b){if(0===arguments.length){if(void 0===this._group||null===this._group){var e=new a.SparklineGroup;
e.add(this);this._group=e}return this._group}b!==this._group&&(this._group&&this._group.remove(this),(this._group=b)&&(this._group.contains(this)||this._group.add(this)),this.onSparklineChanged());return this},sparklineType:function(a){if(0===arguments.length)return this.group().sparklineType;this.group().sparklineType!==a&&(this.group().sparklineType=a,this.onSparklineChanged());return this},onSparklineChanged:function(){var b=this._getWorksheet();b&&b._trigger(a.Events.SparklineChanged,{sheet:b,
sheetName:b._name,sparkline:this})},setting:function(a){if(0===arguments.length)return this.group().setting;this.group().setting=a;return this},data:function(a){if(0===arguments.length)return this._data;this._data!==a&&(this._data=a,this.onSparklineChanged());return this},dataOrientation:function(a){if(0===arguments.length)return this._dataOrientation;this._dataOrientation!==a&&(this._dataOrientation=a,this.onSparklineChanged());return this},dateAxisData:function(a){if(0===arguments.length)return this.group().dateAxisData();
this.group().dateAxisData(a);return this},dateAxisOrientation:function(a){if(0===arguments.length)return this.group().dateAxisOrientation();this.group().dateAxisOrientation(a);return this},displayDateAxis:function(a){if(0===arguments.length)return this.group().displayDateAxis;this.group().displayDateAxis=a;return this},clone:function(){var b=new a.Sparkline;b.row=this.row;b.column=this.column;b.data(this.data());b.dataOrientation(this.dataOrientation());b.group(this.group().clone());return b},paintSparkline:function(a,
e,d,g,k){this._renderer.paint(a,e,d,g,k)},_provideValues:function(b,d,g){var k=this._getWorksheet(),l=[];if(!k)return l;var m;m=d===a.DataOrientation.Horizontal?b.colCount:b.rowCount;for(var p=0;p<m;p++){var n;n=k;var h=p,I=b;n=d===a.DataOrientation.Horizontal?n.getValue(I.row,I.col+h):n.getValue(I.row+h,I.col);if(h=!this.setting().displayHidden)var h=k,I=p,E=b,h=d===a.DataOrientation.Horizontal?0>=h.getColumnWidth(E.col+I)||0>=h.getRowHeight(E.row):0>=h.getRowHeight(E.row+I)||0>=h.getColumnWidth(E.col);
h?n=NaN:null!==n&&void 0!==n&&(g?n=Date.parse(n):"number"!==typeof n&&(n=e));l.push(n)}return l},_getWorksheet:function(){return this.group()&&this.group()._sparklineGroupManager?this.group()._sparklineGroupManager._sheet:null},toJSON:function(){return{row:this.row,col:this.column,orientation:this._dataOrientation,data:this._data,type:this._group.sparklineType,setting:this._group.setting,axisReference:this._group._axisReference,axisOrientation:this._group._axisOrientation}},fromJSON:function(b){b&&
(void 0!==b.row&&null!==b.row&&(this.row=b.row),void 0!==b.col&&null!==b.col&&(this.column=b.col),void 0!==b.orientation&&null!==b.orientation&&(this._dataOrientation=b.orientation),b.data&&(b=b.data,this._data=new a.Range(b.row,b.col,b.rowCount,b.colCount)))}};a.WorksheetSparklineGroupManager=function(a,e){this._groups=[];this._sheet=a;this.evaluator=e};a.WorksheetSparklineGroupManager.prototype={groups:function(a){return l(0===arguments.length,this,"_groups")},add:function(a){this.groups().push(a);
a._sparklineGroupManager=this},remove:function(a){this.groups().remove(a)},contains:function(a){return this.groups().contains(a)},count:function(){return this.groups().length},_addRows:function(a,e){for(var d=0;d<this._groups.length;d++){var g=this._groups[d];if(g.displayDateAxis){var k=this._addRowRange(a,e,g.dateAxisData());g.dateAxisData(k)}for(k=0;k<g._innerList.length;k++){var l=g._innerList[k];a<=l.row&&(l.row+=e);var m=this._addRowRange(a,e,l.data());l.data(m)}}},_addColumns:function(a,e){for(var d=
0;d<this._groups.length;d++){var g=this._groups[d];if(g.displayDateAxis){var k=this._addColumnRange(a,e,g.dateAxisData());g.dateAxisData(k)}for(k=0;k<g._innerList.length;k++){var l=g._innerList[k];a<=l.column&&(l.column+=e);var m=this._addColumnRange(a,e,l.data());l.data(m)}}},_removeRows:function(a,e){for(var d=0;d<this._groups.length;d++){var g=this._groups[d];if(g.displayDateAxis){var k=this._removeRowRange(a,e,g.dateAxisData());if(null!==k&&void 0!==k)g.dateAxisData(k);else{g.clear();this.remove(g);
continue}}for(var k=[],k=k.concat(g._innerList),l=0;l<k.length;l++){var m=k[l];if(m.row>=a&&m.row<a+e)g.remove(m);else{a<=m.row&&(m.row-=e);var n=this._removeRowRange(a,e,m.data());null!==n&&void 0!==n?m.data(n):g.remove(m)}}0>=g.count()&&this.remove(g)}},_removeColumns:function(a,e){for(var d=0;d<this._groups.length;d++){var g=this._groups[d];if(g.displayDateAxis){var k=this._removeColumnRange(a,e,g.dateAxisData());if(null!==k&&void 0!==k)g.dateAxisData(k);else{g.clear();this.remove(g);continue}}for(var k=
[],k=k.concat(g._innerList),l=0;l<k.length;l++){var m=k[l];if(m.column>=a&&m.column<a+e)g.remove(m);else{a<=m.column&&(m.column-=e);var n=this._removeColumnRange(a,e,m.data());null!==n&&void 0!==n?m.data(n):g.remove(m)}}0>=g.count()&&this.remove(g)}},clear:function(a,e,d,g){if(0===arguments.length){for(var k=0;k<this._groups.length;k++){var l=this._groups[k];l&&(l.SparklineGroupManager=null)}this._groups.clear()}else for(k=a;k<a+d;k++)for(l=e;l<e+g;l++){var m=this._find(k,l);if(m){var n=m.group();
n.remove(m);0===n.count()&&this.remove(n)}}},_find:function(a,e){for(var d=0;d<this._groups.length;d++)for(var g=this._groups[d],k=0;k<g.count();k++){var l=g[k];if(l&&l.row===a&&l.column===e)return l}return null},_copy:function(b,e,d,g,k,l){var m=new a._GcSheetModel(k,l,null),n=d-b,h=g-e,p=this._sheet._getModel(),E,O;for(E=0;E<k;E++)for(O=0;O<l;O++){var H=p.getSparkline(b+E,e+O);if(H){H=H.clone();H.row=d+E;H.column=g+O;var C=H.dateAxisData();null!==C&&void 0!==C&&this._canOffset(C,n,h,this._sheet.getRowCount(),
this._sheet.getColumnCount())&&H.dateAxisData(C.offset(h,n));C=H.data();void 0!==C&&null!==C&&this._canOffset(C,n,h,this._sheet.getRowCount(),this._sheet.getColumnCount())&&H.data(C.offset(h,n));this.add(H.group());m.setValue(E,O,H)}}for(E=0;E<k;E++)for(O=0;O<l;O++)p.setSparkline(d+E,g+O,m.getValue(E,O))},_canOffset:function(a,e,d,g,k){var l=this._getExpressionRange(a);if(l){a=0>l.row?0:l.row;var m=0>l.col?0:l.col,n=0>l.row?g:l.rowCount,l=0>l.col?k:l.colCount;return!(0>a+e||0>m+d||a+n+e>g||m+l+d>
k)}return!1},_move:function(b,e,d,g,k,l){this._moveDataRange(b,e,d,g,k,l);var m=this._sheet._getModel(),n=new a._GcSheetModel(k,l,null),h,p;for(h=0;h<k;h++)for(p=0;p<l;p++){var E=m.getSparkline(b+h,e+p);E&&(E.row=d+h,E.column=g+p,n.setValue(h,p,E));m.setSparkline(b+h,e+p,null)}for(h=0;h<k;h++)for(p=0;p<l;p++)m.setSparkline(d+h,g+p,n.getValue(h,p))},_moveDataRange:function(b,e,d,g,k,l){k=new a.Range(b,e,k,l);b=d-b;e=g-e;for(g=0;g<this._groups.length;g++)for(d=this._groups[g],l=0;l<d._innerList.length;l++){var m=
d._innerList[l];if(m){var n=m.dateAxisData(),h=this._getExpressionRange(n);h&&k.containsRange(h)&&k.contains(m.row,m.column)&&m.dateAxisData(n.offset(e,b));n=m.data();(h=this._getExpressionRange(n))&&k.containsRange(h)&&k.contains(m.row,m.column)&&m.data(n.offset(e,b))}}},_getExpressionRange:function(a){return a},_swap:function(a,e,d,g,k,l){},_exCopy:function(a,e,d,g,k,l,m){if(a===this._sheet)this._copy(e,d,g,k,l,m);else{var n=g-e,h=k-d;a=a._getModel();for(var p=this._sheet._getModel(),E=0;E<l;E++)for(var O=
0;O<m;O++){var H=a.getSparkline(e+E,d+O);if(H){H=H.clone();H.row=g+E;H.column=k+O;var C=H.dateAxisData();void 0!==C&&null!==C&&this._canOffset(C,n,h,this._sheet.getRowCount(),this._sheet.getColumnCount())&&H.dateAxisData(C.offset(h,n));C=H.data();void 0!==C&&null!==C&&this._canOffset(C,n,h,this._sheet.getRowCount(),this._sheet.getColumnCount())&&H.data(C.offset(h,n));this.add(H.group());p.setSparkline(g+E,k+O,H)}else p.setSparkline(g+E,k+O,null)}}},_exMove:function(a,e,d,g,k,l,m){if(a===this._sheet)this._move(e,
d,g,k,l,m);else{var n=a._getModel(),h=this._sheet._getModel();this._exMoveDataRange(a,e,d,g,k,l,m);for(var p=0;p<l;p++)for(var E=0;E<m;E++){var O=n.getSparkline(e+p,d+E);if(O){O.row=g+p;O.column=k+E;var H=O.group(),C=H.clone();H.remove(O);0>=H.length&&a._sparklineGroupManager.remove(H);C.add(O);this.add(C);h.setSparkline(g+p,k+E,O)}else h.setSparkline(g+p,k+E,null);n.setSparkline(e+p,d+E,null)}}},_exMoveDataRange:function(b,e,d,g,k,l,m){if(b===this._sheet)this._moveDataRange(e,d,g,k,l,m);else for(l=
new a.Range(e,d,l,m),e=g-e,d=k-d,k=0;k<b._sparklineGroupManager._groups.length;k++)for(g=b._sparklineGroupManager._groups[k],m=0;m<g._innerList.length;m++){var n=g._innerList[m];if(n){var h=n.dateAxisData(),p=this._getExpressionRange(h);p&&this._sameSource(b,h)&&l.containsRange(p)&&l.contains(n.row,n.column)&&n.dateAxisData(h.offset(d,e));h=n.data();(p=this._getExpressionRange(h))&&this._sameSource(b,h)&&l.containsRange(p)&&l.contains(n.row,n.column)&&n.data(h.offset(d,e))}}},_sameSource:function(a,
e){return!0},_addRowRange:function(b,e,d){return d?b>d.row+d.rowCount-1?d:b>d.row?new a.Range(d.row,d.col,d.rowCount+e,d.colCount):new a.Range(d.row+e,d.col,d.rowCount,d.colCount):null},_addColumnRange:function(b,e,d){return d?b>d.col+d.colCount-1?d:b>d.col?new a.Range(d.row,d.col,d.rowCount,d.colCount+e):new a.Range(d.row,d.col+e,d.rowCount,d.colCount):null},_removeColumnRange:function(b,e,d){return(b=this._rangeSubCat(d.col,d.col+d.colCount-1,b,b+e-1))?new a.Range(d.row,b.start,d.rowCount,b.end-
b.start+1):null},_removeRowRange:function(b,e,d){return(b=this._rangeSubCat(d.row,d.row+d.rowCount-1,b,b+e-1))?new a.Range(b.start,d.col,b.end-b.start+1,d.colCount):null},_rangeSubCat:function(a,e,d,g){var k=-1,l;if(g<a)return k=g-d+1,{start:a-k,end:e-k};if(d>e)return{start:a,end:e};if(d<=a){var m=0;for(l=a;l<=g;l++)if(l<=e)m++;else break;k=d;a=k+(e-a+1)-m-1;return{start:k,end:a}}m=0;for(l=a;l<=e;l++)-1===k&&(l<d||l>g)&&(k=l),(l<d||l>g)&&m++;return-1!==k&&0<m?(a=k+m-1,{start:k,end:a}):null},toJSON:function(){return{groups:this._groups?
this._groups:null}},fromJSON:function(b){if(b&&b.groups){this._groups=[];b=b.groups;for(var e=b.length,d=0;d<e;d++){var g=new a.SparklineGroup;g.fromJSON(b[d]);this.add(g)}}}}})(window);
(function(p){var l=p.GrapeCity;"undefined"===typeof l&&(l=p.GrapeCity={});"undefined"===typeof l.UI&&(l.UI={});p=l.UI;Array.prototype.nextNonEmptyIndex=function(k){0>k&&(k=-1);for(k+=1;k<this.length;k++)if(void 0!==this[k]&&null!==this[k])return k;return-1};Array.prototype.clear=function(k,g){if(!(0>k))for(var a=0,d=0;a<g&&d<this.length;d++)this[k+d]=null,a++};p.GroupState={Expanded:0,Collapsed:1};p.RangeGroupDirection={Backward:0,Forward:1};p.RangeGroupInfo=function(k,g,a,d){this.model=k;this.start=
g;this.end=a;this.level=d};p.RangeGroupInfo.prototype={model:null,children:null,parent:null,start:0,end:0,level:0,getState:function(){return this.model?this.model.getState(this):l.UI.GroupState.Expanded},setState:function(k){this.model&&this.model.expand(this.level,k===l.UI.GroupState.Expanded)},contains:function(k){return this.start<=k&&k<=this.end},addChild:function(k){k&&(this.children||(this.children=[]),this.children.push(k),k.parent=this)}};l.UI.WorkingState=function(){this.count=0};l.UI.WorkingState.prototype=
{addRef:function(){this.count++},release:function(){this.count--},isWorking:function(){return 0<this.count}};p.RangeGroup=function(k){this.items=Array(k);this.suspendAddingGroup=new l.UI.WorkingState};p.RangeGroup.prototype={head:null,tail:null,items:null,_rootCached:null,direction:l.UI.RangeGroupDirection.Forward,suspendAddingGroup:null,setDirection:function(k){this.direction=k},getDirection:function(){return this.direction},_getCount:function(){return this.items?this.items.length:0},group:function(k,
g){if(!this._isIndexValid(k))throw Error("index");if(!this._isIndexValid(k+g-1))throw Error("count");this._rootCached=null;for(var a=0;a<g;a++){var d=this._getModelIndexFromViewIndex(k+a);this.items[d]?this.items[d].level++:this.items[d]=new l.UI.RangeGroupItemInfo}this._rootCached=this.createRangeGroup()},ungroupRange:function(k,g){if(!this._isIndexValid(k))throw Error("index");if(!this._isIndexValid(k+g-1))throw Error("count");var a=!1,d=null,e=-1;if(this.direction===l.UI.RangeGroupDirection.Forward){if(e=
k+g,a=this._isIndexValid(e)){var b=k+g-1,f=b,m=null;do m=this._getModelIndexFromViewIndex(b),m=this.items[m],void 0!==m&&null!==m&&(f=b),b--;while((void 0===m||null===m)&&b>=k);void 0!==m&&null!==m&&((d=this._findImp(this._rootCached,f,m.level))&&(e=d.end+1),a=d&&(d.end===k+g-1||this.getState(d)===l.UI.GroupState.Collapsed))}}else if(this.direction===l.UI.RangeGroupDirection.Backward&&(e=k-1,a=this._isIndexValid(e))){f=b=k;m=null;do m=this._getModelIndexFromViewIndex(b),m=this.items[m],void 0!==m&&
null!==m&&(f=b),b++;while((void 0===m||null===m)&&b<k+g);void 0!==m&&null!==m&&((d=this._findImp(this._rootCached,f,m.level))&&(e=d.start-1),a=d&&(d.start===k||this.getState(d)===l.UI.GroupState.Collapsed))}this._rootCached=null;for(b=0;b<g;b++)f=this._getModelIndexFromViewIndex(k+b),this.items[f]&&-1<this.items[f].level&&this.items[f].level--;a&&(a=this._getModelIndexFromViewIndex(e),(e=this.items[a])&&e.level===d.level&&(this.items[a]=null));this._rootCached=this.createRangeGroup()},ungroup:function(){this._rootCached=
null;var k=this._getCount();this.items=Array(k);this._rootCached=this.createRangeGroup()},_expand:function(k,g,a){if(!this._isIndexValid(k))throw Error("index");if(-1>g)throw Error("level");(k=this.find(k,g))&&this.expandGroup(k,a)},expand:function(k,g){if(-1>k)throw Error("level");for(var a=new l.UI.GroupedItemIndexEnumerator(this);a.moveNext();)this._expand(a.current,k,g)},expandGroup:function(k,g){if(!k)throw Error("groupInfo");var a=-1;switch(this.direction){case l.UI.RangeGroupDirection.Backward:a=
k.start-1;break;case l.UI.RangeGroupDirection.Forward:a=k.end+1}this.setCollapsed(a,!g)},isCollapsed:function(k){if(!this._isIndexValid(k))throw Error("index");var g=this.getLevel(k);if(-1<g){k=this.find(k,g);for(var a=-1;a<=g;a++)if(k){if(k.getState()===l.UI.GroupState.Collapsed)return!0;k=k.parent;if(!k)break}}return!1},find:function(k,g){if(this._rootCached){if(-1===g)return this._rootCached;if(!this._isIndexValid(k))throw Error("index");return this._findImp(this._rootCached,k,g)}return null},
getLevel:function(k){if(!this._isIndexValid(k))throw Error("index");k=this._getModelIndexFromViewIndex(k);return(k=this.items[k])?k.level:-1},getCollapsed:function(k){k=this._getModelIndexFromViewIndex(k);return(k=this.items[k])?!!k.collapsed:!1},setCollapsed:function(k,g){if(0>k)this.head||(this.head=new l.UI.RangeGroupItemInfo),this.head.collapsed=g;else if(-1<k&&k<this._getCount()){var a=this._getModelIndexFromViewIndex(k);this.items[a]||(this.items[a]=new l.UI.RangeGroupItemInfo,this.items[a].level=
-1);this.items[a].collapsed=g}else k>=this._getCount()&&(this.tail||(this.tail=new l.UI.RangeGroupItemInfo),this.tail.collapsed=g);this._rootCached=null;this.refresh()},getMaxLevel:function(){for(var k=-1,g=new l.UI.GroupedItemIndexEnumerator(this);g.moveNext();){var a=this.getLevel(g.current);k<a&&(k=a)}return k},_move:function(k,g,a){if(0<a&&(0>k&&(k=0),0>g&&(g=0),k!==g)){for(var d=[],e=this.items.nextNonEmptyIndex(k-1);0<=e&&e<k+a;){var b=new l.UI.RangeGroupItemInfo(this.items[e]);d.push({index:e-
k,value:b});e=this.items.nextNonEmptyIndex(e)}this.items.clear(k,a);this.items.clear(g,a);if(0<d.length)for(k=0;k<d.length;k++)a=d[k],this.items[g+a.index]=a.value;this._rootCached=null;this.refresh()}},_copy:function(k,g,a){if(0<a&&(0>k&&(k=0),0>g&&(g=0),k!==g)){for(var d=[],e=this.items.nextNonEmptyIndex(k-1);0<=e&&e<k+a;){var b=new l.UI.RangeGroupItemInfo(this.items[e]);d.push({index:e-k,value:b});e=this.items.nextNonEmptyIndex(e)}this.items.clear(g,a);if(0<d.length)for(k=0;k<d.length;k++)a=d[k],
this.items[g+a.index]=a.value;this._rootCached=null;this.refresh()}},_add:function(k,g){if(0<g){for(var a=this._getModelIndexFromViewIndex(k),d=1<a?this.items[a-1]:null,e=0;e<g;e++)this.items.splice(a,0,d?new l.UI.RangeGroupItemInfo(d):null);if(!this.suspendAddingGroup.isWorking&&0<k&&(d=this._getModelIndexFromViewIndex(k-1),a=null,a=0>d?this.head:this.items[d]))for(d=0;d<g;d++)this.items[k+d]=new l.UI.RangeGroupItemInfo({collapsed:a.collapsed,level:a.level});this._rootCached=null;this.refresh()}},
_remove:function(k,g){0<g&&(this.items.splice(k,g),this._rootCached=null,this.refresh())},equals:function(k){if(k){if(!this.items&&k.items&&0<k.items.length||!k.items&&this.items&&0<this.items.length||!this.rangeGroupItemInfoEquals(this.head,k.head)||!this.rangeGroupItemInfoEquals(this.tail,k.tail))return!1;if(this.items&&k.items){if(this.direction!==k.direction||this.items.length!==k.items.length)return!1;for(var g=0;g<this.items.length;g++)if(!this.items[g]&&k.items[g]||this.items[g]&&!k.items[g])return!1}return!0}return!1},
_isEmpty:function(){return this.items&&0<this.items.length?!1:!0},refresh:function(){this._isEmpty()||(this._rootCached=this.createRangeGroup())},_setCount:function(k){this.items||(this.items=Array(k));this._rootCached=null;var g=this._getCount();if(k<g)this.items.splice(k,g-k);else if(k>g)if(g=this.items[this.items.length-1])for(var a=0;a<k;a++)this.items.push(new l.UI.RangeGroupItemInfo(g));else this.items=this.items.concat(Array(k))},getState:function(k){var g=-1;switch(this.direction){case l.UI.RangeGroupDirection.Forward:g=
k.end+1;break;case l.UI.RangeGroupDirection.Backward:g=k.start-1}k=null;0>g&&(k=this.head);-1<g&&g<this._getCount()?(g=this._getViewIndexFromModelIndex(g),k=this.items[g]):g>=this._getCount()&&(k=this.tail);return k&&k.collapsed?l.UI.GroupState.Collapsed:l.UI.GroupState.Expanded},_setLevel:function(k,g){if(0>k)this.head||(this.head=new l.UI.RangeGroupItemInfo),this.head.level=g;else if(-1<k&&k<this._getCount()){var a=this._getModelIndexFromViewIndex(k);this.items[a]||(this.items[a]=new l.UI.RangeGroupItemInfo,
this.items[a].level=-1);this.items[a].level=g}else k>=this._getCount()&&(this.tail||(this.tail=new l.UI.RangeGroupItemInfo),this.tail.level=g);this._rootCached=null;this.refresh()},suspendAdding:function(){this.suspendAddingGroup.addRef()},resumeAdding:function(){this.suspendAddingGroup.release()},_getViewIndexFromModelIndex:function(k){return k},_getModelIndexFromViewIndex:function(k){return k},rangeGroupItemInfoEquals:function(k,g){return k?g?k.level===g.level&&k.collapsed===g.collapsed:!1:!g},
createRangeGroup:function(){for(var k=new l.UI.RangeGroupInfo(this,0,this._getCount()-1,-1),g=new l.UI.GroupedItemIndexEnumerator(this);g.moveNext();){var a=this._createRangeGroup(g,0);a&&-1<a.level&&k.addChild(a)}return k},_createRangeGroup:function(k,g){var a=null;do{var d=k.current,e=this._getModelIndexFromViewIndex(d),b=this.items[e],e=k.nextToCurrent();if(!(b.level<g)&&(b.level>=g&&(a||(a=new l.UI.RangeGroupInfo(this,d,d,g))),b.level>g&&(b=this._createRangeGroup(k,g+1),-1<k.current?(d=k.current,
e=k.nextToCurrent()):(d=b.end,e=-1),a.addChild(b)),d>a.end&&(a.end=d),this.isGroupEnd(d,e,g)))break}while(k.moveNext());return a},isGroupEnd:function(k,g,a){k=this._getModelIndexFromViewIndex(k);k=this.items[k];if(!this._isIndexValid(g))return!0;g=this._getModelIndexFromViewIndex(g);g=this.items[g];if(!g)return!0;if(g.level<k.level){g=k.level-g.level;a=k.level-a;if(g===a)return!1;if(0<=a&&a<g)return!0}return!1},_isIndexValid:function(k){return-1<=k&&k<this._getCount()},_findImp:function(k,g,a){if(k){if(k.contains(g)&&
k.level===a)return k;if(k.children&&0<k.children.length)for(var d=0;d<k.children.length;d++){var e=this._findImp(k.children[d],g,a);if(e)return e}}return null},fromJSON:function(k){if(k){if(null!==k.itemsCount&&void 0!==k.itemsCount&&(this.items=Array(k.itemsCount),k.itemsData))for(var g=k.itemsData.length,a=0;a<g;a++){var d=k.itemsData[a];if(0<d.count&&0<=d.index&&d.info)for(var e=0;e<d.count&&!(d.index+e>=this.items.length);e++)this.items[d.index+e]=new l.UI.RangeGroupItemInfo(d.info)}null!==k.direction&&
void 0!==k.direction&&(this.direction=k.direction);k.head&&(this.head=k.head);k.tail&&(this.tail=k.tail);this.refresh()}},toJSON:function(){for(var k=[],g=this.items.length,a=-1,d=0;d<g;d++)this.items[d]&&(0<=a&&d===k[a].count+k[a].index&&this.items[d].level===k[a].info.level&&this.items[d].collapsed===k[a].info.collapsed?k[a].count++:(a++,k[a]={index:d,count:1,info:this.items[d]}));return{itemsCount:g,itemsData:k,direction:this.direction,head:this.head,tail:this.tail}}};p.RangeGroupItemInfo=function(k){this!==
k&&k&&(this.level=k.level,this.collapsed=k.collapsed);k||(this.level=0,this.collapsed=null)};p.GroupedItemIndexEnumerator=function(k){this.rangeGroup=k};p.GroupedItemIndexEnumerator.prototype={isEOF:!1,rangeGroup:null,current:-1,nextToCurrent:function(){return this.current+1},moveNext:function(){if(this.isEOF||!this.rangeGroup||!this.rangeGroup.items)return!1;for(var k=!1,g=this.current+1;g<this.rangeGroup.items.length;g++){var a=this.rangeGroup._getModelIndexFromViewIndex(g);if(this.rangeGroup.items[a]){k=
!0;this.current=g;break}}k||(this.current=-1);if(-1<this.current)return!0;this.isEOF=!0;return!1},reset:function(){this.isEOF=!1;this.current=-1}};var m={getThemeBackgroundColor:function(k,g){if(!0===(k.parent?k.parent.useWijmoTheme:k.useWijmoTheme)){var a=l.UI.Global.prototype.getWijmoThemeStyle(l.UI.VisualState.Normal);a&&a.backgroundColor&&""!==a.backgroundColor&&(g=a.backgroundColor)}return g},getThemeForeColor:function(k,g){if(!0===(k.parent?k.parent.useWijmoTheme:k.useWijmoTheme)){var a=l.UI.Global.prototype.getWijmoThemeStyle(l.UI.VisualState.Normal);
a&&a.color&&""!==a.color&&(g=a.color)}return g}};l.UI._RangeGroupPresenter=function(k,g,a){this._sheet=k;this._rowGroup=g;this._viewportIndex=a};l.UI._RangeGroupPresenter.prototype={_sheet:null,_rowGroup:null,_viewportIndex:1,PADDING:2,LINE_SIZE:2,STARTLINE_SIZE:6,createGroupInfo:function(){this._groupLineInfos=[];this._groupDotInfos=[];this._groupButtonInfos=[];var k=this._rowGroup;if(-1!==this.getMaxLevel(k)){var g=this._sheet._getGroupLayout(),g=this._calcMinWidthOrHeight({width:g.width,height:g.height},
k);if((k=this.getGroupsByLevel(0,k))&&0<k.length)for(var a=0;a<k.length;a++)this._measureGroups(k[a],g)}},paintGroups:function(k){this._rowGroup?this._paintRowGroups(k):this._paintColumnGroups(k)},_calcMinWidthOrHeight:function(k,g){var a=0,a=this.getMaxLevel(g),a=g?(k.width-2*this.PADDING)/(a+2):(k.height-2*this.PADDING)/(a+2);return a=Math.max(0,a)},_measureGroups:function(k,g){var a=this._rowGroup,d=this.getGroupDirection(a),e=this.getViewportStartIndex(a),b=this.getViewportEndIndex(a),a=k.start,
f=k.end,m,q;if(k.getState()===l.UI.GroupState.Expanded){var t=!0;(m=k.parent)&&(d===l.UI.RangeGroupDirection.Backward&&k.start===m.start||d===l.UI.RangeGroupDirection.Forward&&k.end===m.end)&&(t=!1);t&&(m={isExpanded:!0,level:k.level,paintLine:!0},d===l.UI.RangeGroupDirection.Forward?(q=f+1,q>=e&&q<=b&&(m.index=q,m.lineDirection=l.UI.RangeGroupDirection.Forward,this._groupButtonInfos.push(m))):d===l.UI.RangeGroupDirection.Backward&&(q=a-1,q>=e&&q<=b&&(m.index=q,m.lineDirection=l.UI.RangeGroupDirection.Backward,
this._groupButtonInfos.push(m))));if(a<=b&&f>=e){e=Math.max(e,a);b=Math.min(b,f);if(t){t={start:e,end:b,level:k.level};if(d===l.UI.RangeGroupDirection.Forward&&e===a||d===l.UI.RangeGroupDirection.Backward&&b===f)t.startLine=!0;this._groupLineInfos.push(t)}a=[];for(f=e;f<=b;f++)a.push(f);if(k.children&&0<k.children.length)for(f=0;f<k.children.length;f++){t=k.children[f];if(t.getState()===l.UI.GroupState.Collapsed)for(e=t.start;e<=t.end;e++)a.remove(e);d===l.UI.RangeGroupDirection.Forward?a.remove(t.end+
1):d===l.UI.RangeGroupDirection.Backward&&a.remove(t.start-1);this._measureGroups(t,g)}f=!0;if(k.children)for(t=0;t<k.children.length;t++)if(e=k.children[t])if(e.start===k.start&&e.end===k.end){f=!1;break}else if(d===l.UI.RangeGroupDirection.Forward&&e.end===k.end||d===l.UI.RangeGroupDirection.Backward&&e.start===k.start)for(b=e.start;b<=e.end;b++)a.remove(b);if(f&&0<a.length)for(f=0;f<a.length;f++)this._groupDotInfos.push({index:a[f],level:k.level+1})}}else k.getState()===l.UI.GroupState.Collapsed&&
(m={isExpanded:!1,level:k.level},d===l.UI.RangeGroupDirection.Forward?(q=f+1,q>=e&&q<=b&&(m.index=q,m.lineDirection=l.UI.RangeGroupDirection.Forward,this._groupButtonInfos.push(m))):d===l.UI.RangeGroupDirection.Backward&&(q=a-1,q>=e&&q<=b&&(m.index=q,m.lineDirection=l.UI.RangeGroupDirection.Backward,this._groupButtonInfos.push(m))))},_paintRowGroups:function(k){if(-1!==this.getMaxLevel(!0)){var g=this._sheet._getGroupLayout(),a=this._calcMinWidthOrHeight({width:g.width,height:g.height},!0);if(0!==
a){k.save();var d=Math.max(0,(a-this.STARTLINE_SIZE)/2)+this.PADDING,e,b,f,s,q=this._sheet._getRowLayout(this._viewportIndex,l.UI.SheetArea.viewport);if(this._groupDotInfos&&0<this._groupDotInfos.length)for(f=0;f<this._groupDotInfos.length;f++)if(e=this._groupDotInfos[f],(s=q.findRow(e.index))&&s.height>=this.LINE_SIZE){e=e.level*a+d;b=s.y+Math.max(0,(s.height-this.LINE_SIZE)/2);var t=s=this.LINE_SIZE;k.fillStyle=m.getThemeForeColor(this._sheet,"black");k.fillRect(g.x+e+0.5,g.y+b,s,t)}s=this._sheet.rowRangeGroup.direction;
if(this._groupLineInfos&&0<this._groupLineInfos.length)for(f=0;f<this._groupLineInfos.length;f++){var r=this._groupLineInfos[f];e=r.start;b=r.end;var p=t=null;do t=q.findRow(e),e++;while(!t&&e<=b);do p=q.findRow(b),b--;while(!p&&b>=e);if(t||p){!t&&p?t=p:t&&!p&&(p=t);e=r.level*a+d;b=t.y;s===l.UI.RangeGroupDirection.Forward&&(b+=1);var n=this.LINE_SIZE,h=Math.max(0,p.y+p.height-t.y);k.fillStyle=m.getThemeForeColor(this._sheet,"black");k.fillRect(g.x+e+0.5,g.y+b,n,h);r.startLine&&(r=Math.min(this.STARTLINE_SIZE,
a-this.LINE_SIZE),0<r&&(s===l.UI.RangeGroupDirection.Backward&&(b=b+h-this.LINE_SIZE),b>=t.y&&b<p.y+p.height&&(k.fillStyle=m.getThemeForeColor(this._sheet,"black"),k.fillRect(g.x+e+0.5,g.y+b,r,this.LINE_SIZE))))}}if(this._groupButtonInfos&&0<this._groupButtonInfos.length)for(f=0;f<this._groupButtonInfos.length;f++)t=this._groupButtonInfos[f],!(s=q.findRow(t.index))||s&&0>=s.height||(p=Math.max(0,(s.height-a)/2),e=t.level*a+this.PADDING,b=s.y+p,h=a,r=Math.min(a,s.height),k.strokeStyle="gray",k.lineWidth=
1,k.strokeRect(g.x+e+0.5,g.y+b,h,r),t.isExpanded||k.fillRect(g.x+e+h/2-1+0.5,g.y+b+4,2,r-8),k.fillRect(g.x+e+4+0.5,g.y+b+r/2-1,h-8,2),t.paintLine&&r<s.height&&(e=t.level*a+d,b=s.y,h=this.LINE_SIZE,n=p,t.lineDirection===l.UI.RangeGroupDirection.Backward&&(b+=p+r,n=s.height-r-p),k.fillStyle=m.getThemeForeColor(this._sheet,"black"),k.fillRect(g.x+e+0.5,g.y+b,h,n)));k.stroke();k.beginPath();k.restore()}}},_paintColumnGroups:function(k){if(-1!==this.getMaxLevel(!1)){var g=this._sheet._getGroupLayout(),
a=this._calcMinWidthOrHeight({width:g.width,height:g.height},!1);if(0!==a){var d=Math.max(0,(a-this.STARTLINE_SIZE)/2)+this.PADDING,e,b,f,s,q=this._sheet._getColumnLayout(this._viewportIndex,l.UI.SheetArea.viewport);k.save();for(f=0;f<this._groupDotInfos.length;f++)if(b=this._groupDotInfos[f],(s=q.findCol(b.index))&&s.width>=this.LINE_SIZE){e=s.x+Math.max(0,(s.width-this.LINE_SIZE)/2);b=b.level*a+d;var t=s=this.LINE_SIZE;k.fillStyle=m.getThemeForeColor(this._sheet,"black");k.fillRect(g.x+e,g.y+b+
0.5,s,t)}s=this._sheet.colRangeGroup.direction;for(f=0;f<this._groupLineInfos.length;f++){var r=this._groupLineInfos[f];e=r.start;b=r.end;var p=t=null;do t=q.findCol(e),e++;while(!t&&e<=b);do p=q.findCol(b),b--;while(!p&&b>=e);if(t||p){!t&&p?t=p:t&&!p&&(p=t);e=t.x;s===l.UI.RangeGroupDirection.Forward&&(e+=1);b=r.level*a+d;var n=Math.max(0,p.x+p.width-t.x),h=this.LINE_SIZE;k.fillStyle=m.getThemeForeColor(this._sheet,"black");k.fillRect(g.x+e,g.y+b+0.5,n,h);r.startLine&&(r=Math.min(this.STARTLINE_SIZE,
a-this.LINE_SIZE),0<r&&(s===l.UI.RangeGroupDirection.Backward&&(e=e+n-this.LINE_SIZE),e>=t.x&&e<p.x+p.width&&(k.fillStyle=m.getThemeForeColor(this._sheet,"black"),k.fillRect(g.x+e,g.y+b+0.5,this.LINE_SIZE,r))))}}for(f=0;f<this._groupButtonInfos.length;f++)t=this._groupButtonInfos[f],!(s=q.findCol(t.index))||s&&0>=s.width||(p=Math.max(0,(s.width-a)/2),e=s.x+p,b=t.level*a+this.PADDING,r=Math.min(a,s.width),n=a,k.strokeStyle="gray",k.lineWidth=1,k.strokeRect(g.x+e,g.y+b+0.5,r,n),t.isExpanded||k.fillRect(g.x+
e+r/2-1,g.y+b+4.5,2,n-8),k.fillRect(g.x+e+4,g.y+b+n/2-0.5,r-8,2),t.paintLine&&r<s.width&&(e=s.x,b=t.level*a+d,n=p,h=this.LINE_SIZE,t.lineDirection===l.UI.RangeGroupDirection.Backward&&(e+=p+r,n=s.width-r-p),k.fillStyle=m.getThemeForeColor(this._sheet,"black"),k.fillRect(g.x+e,g.y+b+0.5,n,h)));k.beginPath();k.restore()}}},getRowOrColumnStartIndex:function(k){if(k)return k=this._sheet.getViewportTopRow(this._viewportIndex),Math.max(0,k-1);k=this._sheet.getViewportLeftColumn(this._viewportIndex);return Math.min(0,
k-1)},getRowOrColumnCount:function(k){if(k)return k=this._sheet.getViewportBottomRow(this._viewportIndex),Math.min(this._sheet.getRowCount(),k+2);k=this._sheet.getViewportRightColumn(this._viewportIndex);return Math.min(this._sheet.getColumnCount(),k+2)},getGroupsByLevel:function(k,g){for(var a=[],d=this.getRowOrColumnStartIndex(g),e=this.getRowOrColumnCount(g);d<e;){var b=null;(b=g?this._sheet.rowRangeGroup.find(d,k):this._sheet.colRangeGroup.find(d,k))?(d=b.end+1,a.push(b)):d++}return a},getMaxLevel:function(k){var g=
-1;return g=k?this._sheet.rowRangeGroup.getMaxLevel():this._sheet.colRangeGroup.getMaxLevel()},getGroupDirection:function(k){return k?this._sheet.rowRangeGroup.direction:this._sheet.colRangeGroup.direction},getViewportStartIndex:function(k){return k?this._sheet.getViewportTopRow(this._viewportIndex):this._sheet.getViewportLeftColumn(this._viewportIndex)},getViewportEndIndex:function(k){return k?this._sheet.getViewportBottomRow(this._viewportIndex):this._sheet.getViewportRightColumn(this._viewportIndex)},
getRowGroupButton:function(k,g){if(-1===this.getMaxLevel(!0))return null;var a=this._sheet._getGroupLayout(),d=this._calcMinWidthOrHeight({width:a.width,height:a.height},!0);if(0===d)return null;var e,b,f=this._sheet._getRowLayout(this._viewportIndex,l.UI.SheetArea.viewport);if(this._groupButtonInfos&&0<this._groupButtonInfos.length)for(var m=0;m<this._groupButtonInfos.length;m++){var q=this._groupButtonInfos[m],t=f.findRow(q.index);if(t&&!(t&&0>=t.height)){b=Math.max(0,(t.height-d)/2);e=q.level*
d+this.PADDING;b=t.y+b;var r=d,t=Math.min(d,t.height);if((new l.UI.Rect(a.x+e+0.5,a.y+b+0.5,r,t)).contains(k,g))return q}}return null},getColGroupButton:function(k,g){if(-1===this.getMaxLevel(!1))return null;var a=this._sheet._getGroupLayout(),d=this._calcMinWidthOrHeight({width:a.width,height:a.height},!1);if(0===d)return null;var e,b,f=this._sheet._getColumnLayout(this._viewportIndex,l.UI.SheetArea.viewport);if(this._groupButtonInfos&&0<this._groupButtonInfos.length)for(var m=0;m<this._groupButtonInfos.length;m++){var q=
this._groupButtonInfos[m],t=f.findCol(q.index);if(t&&!(t&&0>=t.width)&&(e=Math.max(0,(t.width-d)/2),e=t.x+e,b=q.level*d+this.PADDING,t=Math.min(d,t.width),(new l.UI.Rect(a.x+e+0.5,a.y+b+0.5,t,d)).contains(k,g)))return q}return null}};l.UI._RangeGroupHeaderPresenter=function(k,g){this._sheet=k;this._rowGroup=g};l.UI._RangeGroupHeaderPresenter.prototype={_sheet:null,_rowGroup:null,PADDING:2,paintGroupHeader:function(k){if(this._sheet){var g=this._rowGroup,a=this.getMaxLevel(g);if(-1!==a){var d=this._sheet._getGroupLayout(),
e=this._calcMinWidthOrHeight({width:d.width,height:d.height},g);if(0!==e){var a=a+2,b,f,l,q,t,r,p,n;b=this._sheet._getSheetLayout();k.fillStyle=m.getThemeBackgroundColor(this._sheet,"#D7E6F7");k.strokeStyle="gray";k.font="8.25pt Arial";k.lineWidth=1;if(g){if(k.fillRect(d.x,d.y,d.width,b.height),k.strokeRect(d.x-0.5,d.y-0.5,d.width,b.height+1),k.strokeRect(d.x-0.5,b.headerY-0.5,d.width,b.colHeaderHeight),k.fillStyle=m.getThemeForeColor(this._sheet,"black"),this._sheet.colHeaderVisible&&b.colHeaderHeight>=
e)for(g=this.PADDING,b=Math.max(0,b.headerY+(b.colHeaderHeight-e)/2),f=0;f<a;f++)l=e-1,q=d.x+g+0.5,t=d.y+b,k.strokeRect(q,t,l,l),r=""+(f+1),p=k.measureText(r).width,n=this._sheet._getFontHeight(k.font),l>=p&&e>=n&&k.fillText(r,q+(l-p)/2,t+11),g+=e}else if(k.fillRect(d.x,d.y,b.width,d.height),k.strokeRect(d.x-0.5,d.y-0.5,b.width+1,d.height),k.strokeRect(b.headerX-0.5,d.y-0.5,b.rowHeaderWidth,d.height),k.fillStyle=m.getThemeForeColor(this._sheet,"black"),this._sheet.rowHeaderVisible&&b.rowHeaderWidth>=
e)for(g=Math.max(0,b.headerX+(b.rowHeaderWidth-e)/2),b=this.PADDING,f=0;f<a;f++)l=e-1,q=d.x+g,t=d.y+b+0.5,k.strokeRect(q,t,l,l),r=""+(f+1),p=k.measureText(r).width,n=this._sheet._getFontHeight(k.font),l>=p&&e>=n&&k.fillText(r,q+(l-p)/2,t-0.5+11),b+=e}}}},getGroupButton:function(k,g){if(!this._sheet)return null;var a=this._rowGroup,d=this.getMaxLevel(a);if(-1!==d){var e=this._sheet._getGroupLayout(),b=this._calcMinWidthOrHeight({width:e.width,height:e.height},a);if(0===b)return null;var d=d+2,f,m,
q;f=this._sheet._getSheetLayout();if(a)for(a=this.PADDING,f=Math.max(0,f.headerY+(f.colHeaderHeight-b)/2),m=0;m<d;m++){q=new l.UI.Rect(e.x+a,e.y+f,b,b);if(q.contains(k,g))return{index:m};a+=b}else for(a=Math.max(0,f.headerX+(f.rowHeaderWidth-b)/2),f=this.PADDING,m=0;m<d;m++){q=new l.UI.Rect(e.x+a,e.y+f,b,b);if(q.contains(k,g))return{index:m};f+=b}}return null}};l.UI._RangeGroupHeaderPresenter.prototype._calcMinWidthOrHeight=l.UI._RangeGroupPresenter.prototype._calcMinWidthOrHeight;l.UI._RangeGroupHeaderPresenter.prototype.getMaxLevel=
l.UI._RangeGroupPresenter.prototype.getMaxLevel})(window);
(function(p){var l=p.GrapeCity;"undefined"===typeof l&&(l=p.GrapeCity={});"undefined"===typeof l.UI&&(l.UI={});p=l.UI;l.UI.CellsEnumerator=function(l,k){if(!l)throw Error("sheet is null.");this.actualEndRow=-1;this.isBlockRange=this.isActualEndRowSet=!1;this.options=1;this.worksheet=l;this.sheetArea=k.sheetArea;this.searchOrder=k.searchOrder;this.rowStart=k.rowStart;this.columnStart=k.columnStart;this.rowEnd=k.rowEnd;this.columnEnd=k.columnEnd;this.findBeginRow=k.findBeginRow;this.findBeginColumn=
k.findBeginColumn;this.init();this.block=this.worksheet._getModel(this.sheetArea)};l.UI.CellsEnumerator.prototype={init:function(){this.currentColumn=this.currentRow=-1},moveNext:function(){if(-1===this.currentRow&&-1===this.currentColumn&&this.rowStart<=this.rowEnd&&this.columnStart<=this.columnEnd&&(this.currentRow=this.findBeginRow,this.currentColumn=this.findBeginColumn,this.isIndexAcceptable(this.currentRow,this.currentColumn)&&!this.skipCurrent()))return!0;if(this.rowStart<=this.rowEnd&&this.columnStart<=
this.columnEnd)for(;this.tryMoveNext();)if(!this.skipCurrent())return!0;this.currentColumn=this.currentRow=-1;return!1},isIndexAcceptable:function(l,k){return 0<(this.options&1)&&this.block&&(null!==this.block.getValue(l,k)||null!==this.block.getFormula(l,k))?!0:0===this.options},skipCurrent:function(){return!1},tryMoveNext:function(){var l=this.currentRow,k=this.currentColumn,g=!1;if(0<(this.options&1)){var a={value:l},d={value:k};this.nextValue(a,d)&&(l=a.value,k=d.value,g=!0)}1===this.options&&
(g?(this.currentRow=l,this.currentColumn=k):this.currentColumn=this.currentRow=-1);return!(-1===this.currentRow&&-1===this.currentColumn)},nextValue:function(l,k){for(;this.next(l,k);)if(this.isIndexAcceptable(l.value,k.value))return!0;return!1},nextZOrder:function(l,k,g){if(l){var a=this.getNextNonEmptyColumnInRow(l,k.value,g.value+1);if(-1!==a&&(g.value=a,this.isZOrderOver(k.value,g.value)))return!0;do if(a=l.nextNonNullRow(k.value),-1===a||a>this.rowEnd?k.value=-1:(-1!==a&&(k.value=a),-1!==a&&
a<k.value&&(k.value=a)),-1!==k.value){g.value=k.value===this.rowStart||this.isBlockRange?this.columnStart-1:-1;do if(a=this.getNextNonEmptyColumnInRow(l,k.value,g.value+1),-1===a||a>this.columnEnd?g.value=-1:(-1!==a&&(g.value=a),-1!==a&&a<g.value&&(g.value=a)),-1!==g.value)return this.isZOrderOver(k.value,g.value);while(-1!==g.value)}while(-1!==k.value)}return!1},getNextNonEmptyColumnInRow:function(l,k,g){for(;g<=this.columnEnd;g++)if(null!==l.getValue(k,g))return g;return-1},isZOrderOver:function(l,
k){return this.isBlockRange?l>=this.rowStart&&l<=this.getActualEndRow()&&k>=this.columnStart&&k<=this.actualEndColumn():l>this.getActualEndRow()||l===this.getActualEndRow()&&(0>k||k>this.actualEndColumn())||l<this.rowStart||l===this.rowStart&&k<this.columnStart?!1:!0},getActualEndRow:function(){if(!this.isActualEndRowSet){var l=-1,k=!1;0<(this.options&1)&&this.block&&(k=this.block.getRowCount()-1,l=Math.max(l,k),k=!0);this.actualEndRow=l=k?Math.min(l,this.rowEnd):this.rowEnd;this.isActualEndRowSet=
!0}return this.actualEndRow},actualEndColumn:function(){return this.columnEnd},next:function(m,k){if(this.searchOrder===l.UI.SearchOrder.ZOrder){var g=this.getActualEndColumnZOrder(m.value);if(k.value+1<=g)return k.value+=1,this.isZOrderOver(m.value,k.value);if(m.value+1<=this.getActualEndRow())return m.value+=1,k.value=this.isBlockRange?this.columnStart:0,this.isZOrderOver(m.value,k.value)}else if(this.searchOrder===l.UI.SearchOrder.NOrder){g=this.getActualEndRowNOrder(k.value);if(m.value+1<=g)return m.value+=
1,this.isNOrderOver(m.value,k.value);if(k.value+1<=this.actualEndColumn())return k.value+=1,m.value=this.isBlockRange?this.rowStart:0,this.isNOrderOver(m.value,k.value)}return!1},getActualEndColumnZOrder:function(l){if(l>=this.rowStart&&l<=this.rowEnd){var k=-1,g=!1;0<(this.options&1)&&this.block&&(k=Math.max(k,this.block.getColumnCount()-1),g=!0);return k=l===this.rowEnd||this.isBlockRange?g?Math.min(k,this.columnEnd):this.columnEnd:g?Math.max(k,this.worksheet.getColumnCount(this.sheetArea)-1):this.worksheet.getColumnCount(this.sheetArea)-
1}return-1},getActualEndRowNOrder:function(l){if(l>=this.columnStart&&l<=this.columnEnd){var k=-1,g=!1;0<(this.options&1)&&this.block&&(k=Math.max(k,this.rowEnd),g=!0);return k=l===this.columnEnd||this.isBlockRange?g?Math.min(k,this.rowEnd):this.rowEnd:g?Math.max(k,this.worksheet.getRowCount(this.sheetArea)-1):this.worksheet.getRowCount(this.sheetArea)-1}return-1},isNOrderOver:function(l,k){return this.isBlockRange?l>=this.rowStart&&l<=this.getActualEndRow()&&k>=this.columnStart&&k<=this.actualEndColumn():
k>this.actualEndColumn()||k===this.actualEndColumn()&&(0>l||l>this.getActualEndRow())||k<this.columnStart||k===this.columnStart&&l<this.rowStart?!1:!0},current:function(){return 0<=this.currentRow&&this.currentRow<this.worksheet.getRowCount(this.sheetArea)&&0<=this.currentColumn&&this.currentColumn<this.worksheet.getColumnCount(this.sheetArea)?new l.UI.Cell(this.worksheet,this.currentRow,this.currentColumn,this.sheetArea):null}};l.UI.SearchCondition=function(){this.endSheetIndex=this.startSheetIndex=
-1;this.searchString=null;this.searchFlags=l.UI.SearchFlags.None;this.searchOrder=l.UI.SearchOrder.ZOrder;this.searchTarget=l.UI.SearchFoundFlags.CellText;this.sheetArea=l.UI.SheetArea.viewport;this.findBeginColumn=this.findBeginRow=this.columnEnd=this.rowEnd=this.columnStart=this.rowStart=-1};l.UI.SearchResult=function(){this.searchFoundFlag=l.UI.SearchFoundFlags.None;this.foundColumnIndex=this.foundRowIndex=this.foundSheetIndex=-1;this.foundString=null};p.SearchFlags={None:0,IgnoreCase:1,ExactMatch:2,
UseWildCards:4,BlockRange:8};p.SearchOrder={ZOrder:0,NOrder:1};p.SearchFoundFlags={None:0,CellText:1,CellFormula:8}})(window);
(function(p){function l(g){this.range=g;this.reset()}function m(g){this.range=g;this.filterInRows=[];this.filterItemMap=[];this.filteredColMap=[];this.filteredItems=[];this.filteredInRowsWithColIndexs={};this.sortInfo=null}var k=p.GrapeCity;"undefined"===typeof k&&(k=p.GrapeCity={});"undefined"===typeof k.UI&&(k.UI={});p=k.UI;l.prototype={sheet:null,range:null,filterInRows:null,filterItemMap:null,filteredColMap:null,filteredItems:null,filteredInRowsWithColIndexs:null,sortInfo:null,setShowFilterButton:function(g){this.showFilterButton=
g},getShowFilterButton:function(){return this.showFilterButton},addFilterItem:function(g,a){if(void 0===a||null===a)throw Error("FilterItem is null.");if(-1>g||g>=this.sheet.getColumnCount())throw Error("Invalid column index.");if(this.range){var d=this.sheet._getActualRange(this.range);g<d.col||g>=d.col+d.colCount||((d=this.filterItemMap[g])||(d=[]),d.push(a),this.filterItemMap[g]=d)}},addAverageFilter:function(g,a){var d=new k.UI.AverageCondition(a);this.addFilterItem(g,d)},addBackgroundFilter:function(g,
a){var d=new k.UI.ColorCondition(k.UI.ColorCompareType.BackgroundColor,a);this.addFilterItem(g,d)},addDateFilter:function(g,a,d){a=new k.UI.DateCondition(a,d);this.addFilterItem(g,a)},addForegroundFilter:function(g,a){var d=new k.UI.ColorCondition(k.UI.ColorCompareType.ForegroundColor,a);this.addFilterItem(g,d)},addNumberFilter:function(g,a,d){a=new k.UI.NumberCondition(a,d);this.addFilterItem(g,a)},addTextFilter:function(g,a,d){a=new k.UI.TextCondition(a,d);this.addFilterItem(g,a)},addTop10Filter:function(g,
a,d){a=new k.UI.Top10Condition(a,d);this.addFilterItem(g,a)},removeFilterItems:function(g){this.filterItemMap[g]&&this.filterItemMap.splice(g,1,null);this.unfilter(g)},unfilter:function(g){if(this.sheet){var a=this;this.sheet._bindToAutoRefresh(function(d){if(null!==d&&void 0!==d)a._unfilterColumn(d);else if(a.filteredColMap)for(d=0;d<a.filteredColMap.length;d++)a._unfilterColumn(a.filteredColMap[d])})(g)}},_filterColumn:function(g){this._unfilterColumn(g);var a,d;if(this.filterItemMap[g]&&(!this.range||
-1===this.range.col||!(g<this.range.col||g>this.range.col+this.range.colCount-1))){var e=this.sheet.getRowCount();this.range&&(a=this.range.row,d=this.range.rowCount,-1===a&&(a=0,d=e));for(var b=0;b<e;b++)this.range&&(b<a||b>=a+d)?this._addRowFilteredIn(b):this._filterRowByCell(b,g);this._setColumnFilteredState(g,!0)}},filter:function(g){if(this.sheet){var a=this;this.sheet._bindToAutoRefresh(function(d){if(null!==d&&void 0!==d)a._filterColumn(d);else if(a.filterItemMap)for(d=0;d<a.filterItemMap.length;d++)a.filterItemMap[d]&&
0<a.filterItemMap[d].length&&a._filterColumn(d)})(g)}},isHideRowFilter:function(){return!1},isFiltered:function(){return 0<this.filteredColMap.length},isColumnFiltered:function(g){return this.filteredColMap.contains(g)},isRowFilteredOut:function(g){return this.isFiltered()?!this.filterInRows.contains(g):!1},reset:function(){this.filterInRows=[];this.filterItemMap=[];this.filteredColMap=[];this.filteredItems=[];this.filteredInRowsWithColIndexs={};this.showFilterButton=!0;this.sortInfo=null},isFilterHeader:function(g,
a,d){var e=!1;if(this.range){var b=this.sheet._getActualRange(this.range,d);d===k.UI.SheetArea.colHeader&&g===this.sheet.getRowCount(d)-1&&0>b.row-1?a>=b.col&&a<b.col+b.colCount&&(e=!0):d===k.UI.SheetArea.viewport&&g===b.row-1&&a>=b.col&&a<b.col+b.colCount&&(e=!0)}return e},isLastFilteredColumn:function(g){var a=this.filteredColMap.length;return 0<a?this.filteredColMap[a-1]===g:!1},getFilterItems:function(g){(g=this.filterItemMap[g])||(g=[]);return g},getFilteredItems:function(){return this.filteredItems},
sortColumn:function(g,a){if(this.sheet){var d=this;this.sheet._bindToAutoRefresh(function(a,b){var f=d.sheet._getActualRange(d.range),g=d.sheet.isPaintSuspended();d.sheet.isPaintSuspended(!0);f=d.sheet.sortRange(f.row,f.col,f.rowCount,f.colCount,!0,[{index:a,ascending:b}]);d.sheet.isPaintSuspended(g);f&&(d.sortInfo={index:a,ascending:b},d.isColumnFiltered(a)&&d.reFilter())})(g,a)}},getSortState:function(g){var a=k.UI.SortState.None;this.sortInfo&&this.sortInfo.index===g&&(a=this.sortInfo.ascending?
k.UI.SortState.Ascending:k.UI.SortState.Descending);return a},reFilter:function(){this.filteredInRowsWithColIndexs={};if(this.filteredItems||0<this.filteredItems.length)this.filteredItems.length=0;if(this.filteredColMap||0<this.filteredColMap.length)for(var g=[],g=g.concat(this.filteredColMap),a=this.filteredColMap.length=0;a<g.length;a++)this.filter(g[a])},_addRowFilteredIn:function(g){this.filterInRows.contains(g)||this.filterInRows.push(g)},_addFilteredInRowsWithColumnIndex:function(g,a){var d=
this.filteredInRowsWithColIndexs[g];void 0===d||null===d?d=[a]:(d.contains(a)&&d.remove(a),d.push(a));this.filteredInRowsWithColIndexs[g]=d},_addFilteredItem:function(g){this.filteredItems.contains(g)||this.filteredItems.push(g)},_unfilterColumn:function(g){if(this.range){var a=this.sheet._getActualRange(this.range),d;if(this.isColumnFiltered(g)){if(!(1<this.filteredColMap.length&&g===this.filteredColMap[0]))for(d=a.row;d<a.row+a.rowCount;d++)this._isRowfilteredOutByColumn(d,g)&&this._addRowFilteredIn(d);
this._setColumnFilteredState(g,!1);this._removeFilteredInRowsWithColumnIndex(g);this._removeFilteredItems(g)}else for(d=a.row;d<a.row+a.rowCount;d++)this.isRowFilteredOut(d)||this._addRowFilteredIn(d)}},_setColumnFilteredState:function(g,a){if(a){if(0<this.filteredColMap.length){if(this.filteredColMap[this.filteredColMap.length-1]===g)return;this.filteredColMap.remove(g)}this.filteredColMap.push(g)}else this.filteredColMap.remove(g)},_removeFilteredItems:function(g){if(this.filterItemMap[g]){for(var a=
[],d=[],e=0;e<this.filterItemMap.length;e++)e===g?a=a.concat(this.filterItemMap[e]):d=d.concat(this.filterItemMap[e]);for(e=0;e<a.length;e++)g=a[e],d.contains(g)||this.filteredItems.remove(g)}},_removeFilteredInRowsWithColumnIndex:function(g){for(var a in this.filteredInRowsWithColIndexs)if(a){var d=this.filteredInRowsWithColIndexs[a];d.contains(g)&&d.remove(g)}},_filterRowByCell:function(g,a){for(var d=this.filterItemMap[a],e=0;e<d.length;e++){var b=d[e],f,l;if("RelationCondition"===b.conditionType||
b instanceof k.UI.RelationCondition){if(b.item1)if(f=this._getActualValue(b.item1,g,a),"Top10Condition"===b.item1.conditionType||b.item1 instanceof k.UI.Top10Condition)b.item1.ranges=this._getReviseRanges(a,this.range);else if("AverageCondition"===b.item1.conditionType||b.item1 instanceof k.UI.AverageCondition)b.item1.ranges=this._getReviseRanges(a,this.range);if(b.item2)if(l=this._getActualValue(b.item2,g,a),"Top10Condition"===b.item2.conditionType||b.item2 instanceof k.UI.Top10Condition)b.item2.ranges=
this._getReviseRanges(a,this.range);else if("AverageCondition"===b.item2.conditionType||b.item2 instanceof k.UI.AverageCondition)b.item2.ranges=this._getReviseRanges(a,this.range)}else if(f=this._getActualValue(b,g,a),"Top10Condition"===b.conditionType||b instanceof k.UI.Top10Condition)b.ranges=this._getReviseRanges(a,this.range);else if("AverageCondition"===b.conditionType||b instanceof k.UI.AverageCondition)b.ranges=this._getReviseRanges(a,this.range);if(b.evaluate(this.sheet,g,a,f,l)){this._addRowFilteredIn(g);
this._addFilteredInRowsWithColumnIndex(g,a);this._addFilteredItem(b);break}else this.filterInRows.remove(g)}},_getReviseRanges:function(g,a){var d=[];if(a){var e=this.sheet._getActualRange(a);e.col<=g&&g<e.col+e.colCount&&d.push(new k.UI.Range(e.row,g,e.rowCount,1))}return d},_getActualValue:function(g,a,d){var e=null;if("TextCondition"===g.conditionType||"TextLengthCondition"===g.conditionType)e=this.sheet.getText(a,d);else if("ColorCondition"===g.conditionType){if(a=this.sheet.getActualStyle(a,
d))g.compareType===k.UI.ColorCompareType.BackgroundColor?e=a.backColor:g.compareType===k.UI.ColorCompareType.ForegroundColor&&(e=a.foreColor)}else e=this.sheet.getValue(a,d);return e},_getCandindateDataItems:function(g,a){var d=[],e=this.sheet._getActualRange(this.range);if(g<e.col||g>e.col+e.colCount-1)return d;for(var b=!1,f=e.row;f<e.row+e.rowCount;f++){var l=this.sheet.getText(f,g);""===l?b=!0:d.contains(l)||(this.isRowFilteredOut(f)?!this.isFiltered()||this.isLastFilteredColumn(g)&&this._isRowfilteredOutByColumn(f,
g)?d.push(l):0<this.sheet.getRowHeight(f,k.UI.SheetArea.viewport)&&d.push(l):0<this.sheet.getRowHeight(f,k.UI.SheetArea.viewport)&&d.push(l))}b&&a&&(a.hasBlank=!0);return d},_isRowfilteredOutByColumn:function(g,a){if(0===this.filteredColMap.length)return!1;if(this.filteredInRowsWithColIndexs){var d=-1,e=this.filteredColMap.indexOf(a);0<e&&(d=this.filteredColMap[e-1]);e=this.filteredInRowsWithColIndexs[g];if(-1<d){if(e&&0!==e.length)return d===e[e.length-1]}else if(1===this.filteredColMap.length)return!e||
0===e.length}return!1},_addRows:function(g,a){if(this.range){var d=this.sheet.getRowCount()-a-1;if(-1<this.range.row){var e=this.range,d=e.row+e.rowCount-1;e.row>=g?this._setRangeInternal(new k.UI.Range(e.row+a,e.col,e.rowCount,e.colCount)):e.row<g&&g<e.row+e.rowCount&&this._setRangeInternal(new k.UI.Range(e.row,e.col,e.rowCount+a,e.colCount))}if(this.isFiltered()&&this.filterInRows)for(e=this.filterInRows.length-1;0<=e;e--){var b=this.filterInRows[e];b>=g&&b<=d&&(this.filterInRows[b+a]=this.filterInRows[b],
this.filterInRows.remove(b))}this.reFilter()}},_addColumns:function(g,a){if(this.range){var d;if(0<=g&&this._isSortted()){for(var e=0,b=0;b<a;b++)d=b+g,d<=this._sorttedColumn()&&e++;this._sorttedColumn(this._sorttedColumn()+e)}e=-1;d=0;b=this.range;-1<b.col&&(b.col>=g?(e=this.range.col,this._setRangeInternal(new k.UI.Range(b.row,b.col+a,b.rowCount,b.colCount)),d=this.range.colCount):b.col<g&&g<b.col+b.colCount&&(e=g,d=b.columnCount-(g-b.col),this._setRangeInternal(new k.UI.Range(b.row,b.col,b.rowCount,
b.colCount+a))));0>e&&(e=0,d=this.sheet.getColumnCount()-a);for(d=e+d-1;d>=e;d--)if(d>=g){var b=d+a,f=this.filteredColMap.indexOf(d);0<=f&&(this.filteredColMap[f]=b);(f=this.filterItemMap[d])&&0<f.length&&(this.filterItemMap.remove(d),this.filterItemMap[b]=f)}this.reFilter()}},_removeRows:function(g,a){if(this.range){var d=0,e=this.sheet.getRowCount()+a-1;if(-1<this.range.row){var b=this.range,d=b.row,e=b.row+b.rowCount-1;b.row>=g?b.row===g+1?this._setRangeInternal(null):b.row+b.rowCount<=g+a?this._setRangeInternal(null):
b.row<g+a?this._setRangeInternal(new k.UI.Range(g,b.col,b.row+b.rowCount-(g+a),b.colCount)):this._setRangeInternal(new k.UI.Range(b.row-a,b.col,b.rowCount,b.colCount)):b.row<g&&g<b.row+b.rowCount&&this._setRangeInternal(new k.UI.Range(b.row,b.col,b.rowCount-Math.min(b.row+b.rowCount-g,a),b.colCount))}if(this.isFiltered()&&this.filterInRows)for(;d<=e;d++)if(d>=g)if(d<g+a)this.filterInRows.remove(d);else{var b=d,f=this.filterInRows[b];void 0!==f&&null!==f&&(this.filterInRows[b-a]=f,this.filterInRows.remove(b))}this.reFilter()}},
_setRangeInternal:function(g){this.range=g},_removeColumns:function(g,a){if(this.range){0<=g&&this._isSortted()&&(g<=this._sorttedColumn()&&this._sorttedColumn()<g+a?this._sorttedColumn(-1):this._sorttedColumn()>=g&&this._sorttedColumn(this._sorttedColumn()-a));var d=this.range,e=d.col,b=d.colCount;0>e?(e=0,b=this.sheet.getColumnCount()+a):b=this.range.colCount;for(var f=g+a,l=e;l<e+b;l++)if(l>=g)if(l<f)this.removeFilterItems(l);else{var m=l-a,t=this.filteredColMap.indexOf(l);0<=t&&(this.filteredColMap[t]=
m);(t=this.filterItemMap[l])&&0<t.length&&(this.filterItemMap.remove(l),this.filterItemMap[m]=t)}0<=d.col&&(g<d.col?f<=d.col?this._setRangeInternal(new k.UI.Range(d.row,d.col-a,d.rowCount,d.colCount)):f<=d.col+d.colCount?this._setRangeInternal(new k.UI.Range(d.row,g,d.rowCount,d.col+d.colCount-f)):this._setRangeInternal(null):g<d.col+d.colCount&&(f<=d.col+d.colCount?this._setRangeInternal(new k.UI.Range(d.row,d.col,d.rowCount,d.colCount-a)):this._setRangeInternal(new k.UI.Range(d.row,d.col,d.rowCount,
g-d.col))));this.reFilter()}},_isSortted:function(){return this.sortInfo?-1<this.sortInfo.index&&this.getSortState(this.sortInfo.index)!==k.UI.SortState.None:!1},_sorttedColumn:function(g){if(0===arguments.length)return this.sortInfo?this.sortInfo.index:-1;this.sortInfo?this.sortInfo.index=g:this.sortInfo={index:g,ascending:!1};return this},_clear:function(g,a,d,e){this.range&&(g=new k.UI.Range(g,a,d,e),this.showFilterButton?(a=this.range.row-1,d=this.range.rowCount+1,0>a&&(d=a=-1),g.containsRange(new k.UI.Range(a,
this.range.col,d,this.range.colCount))&&this.unfilter()):g.containsRange(this.range)&&this.unfilter())},_getConditionTypeDictionary:function(){if(!this._ruleTypeDictionary){var g={};g[k.UI.ConditionType.RelationCondition]=k.UI.RelationCondition;g[k.UI.ConditionType.NumberCondition]=k.UI.NumberCondition;g[k.UI.ConditionType.TextCondition]=k.UI.TextCondition;g[k.UI.ConditionType.ColorCondition]=k.UI.ColorCondition;g[k.UI.ConditionType.FormulaCondition]=k.UI.FormulaCondition;g[k.UI.ConditionType.DateCondition]=
k.UI.DateCondition;g[k.UI.ConditionType.DateExCondition]=k.UI.DateExCondition;g[k.UI.ConditionType.TextLengthCondition]=k.UI.TextLengthCondition;g[k.UI.ConditionType.Top10Condition]=k.UI.Top10Condition;g[k.UI.ConditionType.UniqueCondition]=k.UI.UniqueCondition;g[k.UI.ConditionType.AverageCondition]=k.UI.AverageCondition;g[k.UI.ConditionType.CellValueCondition]=k.UI.CellValueCondition;g[k.UI.ConditionType.AreaCondition]=k.UI.AreaCondition;this._ruleTypeDictionary=g}return this._ruleTypeDictionary},
fromJSON:function(g){if(g){if(g.filterItemMap)for(var a=0;a<g.filterItemMap.length;a++){var d=g.filterItemMap[a].conditions;if(d)for(var e=0;e<d.length;e++){var b=d[e],f=null;b&&(f=this._getConditionTypeDictionary()[b.conType])&&(f=new f,f.fromJSON(b),this.addFilterItem(g.filterItemMap[a].index,f))}}if(g.filteredColMap)for(a=0;a<g.filteredColMap.length;a++)d=g.filteredColMap[a],void 0!==d&&null!==d&&this.filter(d);g.sortInfo&&this.sortColumn(g.sortInfo.index,g.sortInfo.ascending);null!==g.showFilterButton&&
void 0!==g.showFilterButton&&(this.showFilterButton=g.showFilterButton)}},toJSON:function(){for(var g=[],a=0,d=0;a<this.filterItemMap.length;a++){var e=this.filterItemMap[a];if(e){for(var b=[],f=0;f<e.length;f++){var k=e[f];b.push(k?k.toJSON():null)}g[d++]={index:a,conditions:b}}}return{range:this.range,filterItemMap:g,filteredColMap:this.filteredColMap,sortInfo:this.sortInfo,showFilterButton:this.showFilterButton}}};m.prototype=new l;m.prototype.isHideRowFilter=function(){return!0};p.RowFilterBase=
l;p.HideRowFilter=m})(window);
(function(p,l){function m(a,b,d,g,k){var m="<"+a+" ";b&&(m+="id='"+b+"' ");g&&l.each(g,function(a,b){m+=a+"='"+b+"' "});return m=d?m+(">"+d+"</"+a+">"):m+(!0===k?">":"/>")}function k(a,b){this.sheet=a;this.filterButtonInfo=b;this._init()}var g=p.GrapeCity;"undefined"===typeof g&&(g=p.GrapeCity={});"undefined"===typeof g.UI&&(g.UI={});var a=g.UI,d={noSortFilter:0,ascend:1,descend:2,filter:3,filterAscend:4,filterDescend:5,sortAscending:6,sortDescending:7};k.prototype={_init:function(){this.dialogID="gc_filterDialog";
this.topMenuID="gc_filterTopMenu";this.sortAscID="gc_sortAsc";this.sortDesID="gc_sortDes";this.itemListID="gc_filterItemList";this.okID="gc_filterOK";this.cancelID="gc_filterCancel";this.superPanelID="gc_filterSuperPanel";this.activeCheckItemClass="gc_filterActiveCheckItem";this.filterCheckItemName="multiselect_gc_filterItemList";this.allItemsLength=-1;var a=this;this._creatDom();var b=l("#"+this.dialogID);this.dialog=b.wijsheetfilterdialog({show:"blind",_filterDialog:null});b.wijsheetfilterdialog("option",
"_filterDialog",this);this.dialog.parent().css("boxShadow","2px 4px 5px rgba(0,0,0,0.4)");b=l("#"+this.topMenuID);b.menu({select:function(b,d){var f=l(d.item).attr("id");f===a.sortAscID?a._sortByUser(!0):f===a.sortDesID&&a._sortByUser(!1);a.close()}})[0].tabIndex=-1;var d=b.data("ui-menu")._activate;b.data("ui-menu")._activate=function(a){this.active&&d.apply(this,arguments)};var b=l("#"+this.itemListID),g=l("#"+this.okID),k=l("#"+this.cancelID);this.itemList=b.wijsheetmultiselect().wijsheetmultiselectfilter();
g.button();k.button();g.unbind("click");g.click(function(){a.dialog.wijsheetfilterdialog("close");var b=a._getCheckedValuesByUser();a._updateData(b);a._filter(b)});k.unbind("click");k.click(function(){a.dialog.wijsheetfilterdialog("close")});b.unbind("change");b.bind("change",function(){a._setButtonState()});l("#"+this.superPanelID).wijspreadpanelex();b=l(".ui-multiselect-filter > input");b.unbind(".gcSheetInternal");b.bind("keyup.gcSheetInternal",function(){l("#"+a.superPanelID).wijspreadpanelex("refresh")});
b.bind("search.gcSheetInternal",function(){a.itemList.wijsheetmultiselect("refresh");a.itemList.wijsheetmultiselectfilter("updateCache");l("#"+a.superPanelID).wijspreadpanelex("refresh")})},_setButtonState:function(){0<this.itemList.wijsheetmultiselect("getChecked").length?l("#"+this.okID).button("option","disabled",!1):l("#"+this.okID).button("option","disabled",!0)},_sortByUser:function(a){var b=this.sheet.rowFilter();if(b){var d=this.filterButtonInfo.col;this.sheet._trigger(g.UI.Events.RangeSorting,
{sheet:this.sheet,sheetName:this.sheet._name,col:d,ascending:a});b.sortColumn(d,a);this.sheet._trigger(g.UI.Events.RangeSorted,{sheet:this.sheet,sheetName:this.sheet._name,col:d,ascending:a});this.sheet.invalidateLayout();this.sheet.repaint()}},_getCheckedValuesByUser:function(){var a=[];this.itemList.wijsheetmultiselect("getChecked").each(function(){a.push(this.value)});this.allItemsLength===a.length&&(a=[]);return a},_getDomString:function(){return m("div",this.dialogID,m("table",null,m("tr",null,
m("td",null,m("div",null,m("div",null,"",{style:"height: 10px"})+m("div",null,m("img",null,null,{src:k.getImageSrc(d.sortAscending)},!0))+m("div",null,"",{style:"height: 5px"})+m("div",null,m("img",null,null,{src:k.getImageSrc(d.sortDescending)})),{style:"text-align: left"}),{style:"border-right: 1px solid #CCC;vertical-align: top"})+m("td",null,m("table",null,m("tr",null,m("td",null,m("div",null,m("ul",this.topMenuID,m("li",this.sortAscID,"<a style='cursor:default'>Sort Ascending</a>",{style:"width: 195px",
tabindex:0})+m("li",this.sortDesID,"<a style='cursor:default'>Sort Descending</a>",{tabindex:0}),{style:"border-width: 0;"}),{style:"text-align: left"}),{style:"border-bottom: 1px solid #CCC"}))+m("tr",null,m("td",null,m("select",this.itemListID,""))))+m("div",null,m("input",this.okID,null,{type:"button",value:"OK",style:"width: 70px;"})+m("input",this.cancelID,null,{type:"button",value:"Cancel",style:"width: 70px;"}),{style:"text-align: right;"})))),{style:"font-size: 10pt;padding: 0;display: none; overflow: hidden"})},
_hasDom:function(){return!!p.document.getElementById(this.dialogID)},_creatDom:function(){var a=this.sheet._getCanvas();if(a&&!this._hasDom()){var b=this._getDomString(),b=l(b)[0];a.appendChild(b)}},_initData:function(a){var b=this.sheet.rowFilter();if(b){var d=this._getAllData(a);this._bindData(d);var g=[],g=b.isColumnFiltered(a)?this._getCheckedData(a):d;a=this._getActualValues(d,g);this._setCheckedValues(a);this.itemList.wijsheetmultiselect("refresh",!0);this.itemList.wijsheetmultiselectfilter("updateCache")}},
_updateData:function(a){var b=this.filterButtonInfo.col,d=this.sheet.rowFilter();if(d){d.unfilter(b);d.removeFilterItems(b);for(var k=0;k<a.length;k++){var l=a[k];"(Blanks)"===l&&(l="");l=new g.UI.TextCondition(g.UI.TextCompareType.EqualsTo,l,null);d.addFilterItem(b,l)}}},_filter:function(a){var b=this.sheet.rowFilter();b&&(a&&0<a.length&&this.sheet._trigger(g.UI.Events.RangeFiltering,{sheet:this.sheet,sheetName:this.sheet._name,col:this.filterButtonInfo.col,filterValues:a}),b.filter(this.filterButtonInfo.col),
a&&0<a.length&&this.sheet._trigger(g.UI.Events.RangeFiltered,{sheet:this.sheet,sheetName:this.sheet._name,col:this.filterButtonInfo.col,filterValues:a}),this.sheet.invalidateLayout(),this.sheet.repaint())},_setCheckedValues:function(a){l("#"+this.itemListID+" option").each(function(){var b=l(this).val();a.contains(b)?l(this).attr("aria-selected","true"):l(this).attr("aria-selected","false")})},_getActualValues:function(a,b){for(var d=[],g=0;g<b.length;g++){var k=b[g];if(void 0===k||null===k||""===
k)k="(Blanks)";a.contains(k)&&!d.contains(k)&&d.push(k)}return d},_bindData:function(a){for(var b=l("#"+this.itemListID)[0],d=b.options.length=0;d<a.length;d++){var g=a[d];b.options.add(new p.Option(g,g))}this.allItemsLength=b.options.length},_getAllData:function(a){var b=[],d=this.sheet.rowFilter();if(!d)return b;var g=this.sheet._getActualRange(d.range);if(a<g.col||a>g.col+g.colCount-1)return b;g={hasBlank:!1};b=d._getCandindateDataItems(a,g);g.hasBlank&&b.push("(Blanks)");return b},_getCheckedData:function(a){var b=
[],d=this.sheet.rowFilter();if(!d)return b;if(d.isColumnFiltered(a))for(var g=-1===d.range.row?0:d.range.row,k=-1===d.range.rowCount?this.sheet.getRowCount():d.range.rowCount,l=g;l<g+k;l++)if(!d.isRowFilteredOut(l)){var m=this.sheet.getValue(l,a),p=null,p=m instanceof Date?m:this.sheet.getText(l,a);b.contains(p)||b.push(p)}return b},open:function(){if(this.dialog){var a=this;this._initData(this.filterButtonInfo.col);var b=l(this.sheet._getCanvas()).offset(),d=this.dialog.wijsheetfilterdialog("option",
"width");this.dialog.wijsheetfilterdialog("option","height");var d=this.filterButtonInfo.x+this.filterButtonInfo.width-d,g=this.filterButtonInfo.y+this.filterButtonInfo.height,d=d+(b.left-8),g=g+b.top,b=l(p.document).scrollLeft(),k=l(p.document).scrollTop();this.dialog.wijsheetfilterdialog({show:"blind",position:[d-b,g-k],open:function(){p.gcGlobal.suspendEvent();l("#"+a.superPanelID).wijspreadpanelex("refresh")},close:function(){p.gcGlobal.resumeEvent();a.sheet&&a.sheet._eventHandler._setFocus()}});
this.dialog.wijsheetfilterdialog("open");l(".ui-multiselect-filter > input").val("");this.itemList.wijsheetmultiselectfilter("initFirstOpenCache");l("#"+this.dialogID+" *").removeClass("ui-state-hover");var g=this.dialog.find("ul").last(),m=0;g.find("span").each(function(a,b){m=Math.max(m,b.offsetWidth)});d=g.find("label").width();g=g.find("input").outerWidth(!0);m+=g;m>d&&this.dialog.find("ul").last().find("label").width(m)}},close:function(){this.dialog&&this.dialog.wijsheetfilterdialog("close");
this.sheet&&this.sheet._eventHandler._setFocus()},isOpen:function(){return this.dialog?this.dialog.wijsheetfilterdialog("isOpen"):!1}};k.getImageSrc=function(a){return a===d.noSortFilter?"data:image/png;base64,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":
a===d.ascend?"data:image/png;base64,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":
a===d.descend?"data:image/png;base64,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":
a===d.filter?"data:image/png;base64,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":
a===d.filterAscend?"data:image/png;base64,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":
a===d.filterDescend?"data:image/png;base64,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":
a===d.sortAscending?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAABy0lEQVR42pyST2gTQRTGv9nEpCnqTasHES8VLCioiFDIYYum+I/ebFXQm1BbsdSDhKgoXhS8tLQSqAhexIInETwJIqJiexJEZXupwRJNbRsy2Z3dzHxesjGEChs/eMx7A+837817giQAYCD3cZuScqG8Wtj19tG5n/iHhBAkKcLYCh3fdSd04HXCq5xHG2oAdOAdNIG3qAJ5tW1A/9hrm8ZsV+7vDLTe2nsmP9AWwATuXe27330lLwvLkloHY5EBR0dexkB0xxKp9Ieno8MbOjYP1ZRMHz77YE8kAMk35V/fkpWSc6L3dL7Tl6uPAaAm155EAYhwjFHVOsY4AEwPXXkG7W+0EqmCodlRW17oCkrO5Pjc55lon7i2mBqenc7ETTmLFWdvaenLpijJDUBcywsAYFRwu/jja1dMWNfWKf2WEOJ43T8ihLgHACAJkpgZvNQ3kTnJG/u6Z8O7ZgNwAACbzCb5dxNVLPnQW3aKyY7EKABM2XZPcwUk5wG8qIfvSL5qtJAfHLnvF+Z2GsPr2fefipPH0luq5aXsOi3frJ+5xhSm+k/1VErOxRWlqgkrfujO/t191ZqxLeB5azbJeSFELnz9v/agVX8GAIjG5r9I9yjkAAAAAElFTkSuQmCC":
a===d.sortDescending?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAACXBIWXMAAAsSAAALEgHS3X78AAAAGXRFWHRTb2Z0d2FyZQBQYWludC5ORVQgVjMuNS41Tib51gAAAXlJREFUOE9jYACCqRH5a6eGZu6cHl00d2pUwa6J7r4Xe4w1U0ByWMB/DLHJnoHbQIKzI1PEp3r6vKjVU72HQzNIGNOA6W5uYiCZmUHxM+v0Vf836KuHkWQASPGciGznSe6+/+v01Vbh0YzdBeBwiC560GWi+aLVXEccxJ/i6KhNdBjMCM/u7be3+99hpJEK0jTJ01a0y1hjKVEGTHH31e4w1vxSrqP0tVZPbXazodqKSl2VV9W6KnOJMoCAf4mLRpAq/+pTEh4F+79aJSwGxwjJseBZdHCVa/b2/1YR00vJMsAtd+c957T1D42De17iMKARKO4NTUiuQLoLrs694IAT0PbvNrFzNYwDOv9bRc4IwGKIMVQzKCWCsBNcDVDzaafUdbfMwiZNMwnq/mIeNvkgDldsgWo+hqyZ2TVr+0egIRIgQcuomb7G/h3/zaOmaeFxBcJ2l6xtx8xDJ/6wDJ+cYhU2g8vYv/M9yABj//aLOFxRTUbU49YCALt6h216b0oVAAAAAElFTkSuQmCC":
""};a._GcFilterDialog=k;a._FilterButtonState=d})(window,jQuery);
(function(p,l){var m=p.GrapeCity;"undefined"===typeof m&&(m=p.GrapeCity={});"undefined"===typeof m.UI&&(m.UI={});var k=m.UI,g={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},a={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},d=l.attrFn||{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0,click:!0};l.widget("wijmo.wijsheetfilterdialog",{options:{autoOpen:!1,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!1,hide:null,height:"auto",
maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:235,modal:!0,position:{my:"center",at:"center",collision:"fit",using:function(a){var b=l(this).css(a).offset().top;0>b&&l(this).css("top",a.top-b)}},resizable:!1,show:null,stack:!0,title:"",width:235,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");"string"!==typeof this.originalTitle&&(this.originalTitle="");this.options.title=this.options.title||this.originalTitle;var a=this,b=a.options,e=l.ui.dialog.getTitleId(a.element),
e=(a.uiDialog=l("<div></div>")).appendTo(p.document.body).hide().addClass("ui-dialog ui-widget ui-widget-content "+b.dialogClass).css({zIndex:b.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(e){b.closeOnEscape&&e.keyCode&&e.keyCode===l.ui.keyCode.ESCAPE&&(a.close(e),e.preventDefault())}).attr({role:"dialog","aria-labelledby":e}).mousedown(function(b){a.moveToTop(!1,b)});a.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(e);l.isFunction(b.beforeclose)&&
!l.isFunction(b.beforeClose)&&(b.beforeClose=b.beforeclose);b.draggable&&l.fn.draggable&&a._makeDraggable();b.resizable&&l.fn.resizable&&a._makeResizable();a._createButtons(b.buttons);a._isOpen=!1;l.fn.bgiframe&&e.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){this.overlay&&this.overlay.destroy();this.uiDialog.hide();this.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();
this.originalTitle&&this.element.attr("title",this.originalTitle);return this},widget:function(){return this.uiDialog},close:function(a){var b=this,e,d;if(!1!==b._trigger("beforeClose",a)){var g=b.options._filterDialog;g&&(l("#"+g.dialogID+" *").removeClass("ui-state-hover"),l("#"+g.dialogID+" *").removeClass("ui-state-focus"),l("#"+g.superPanelID).unbind("wijspreadpanelexscrolled"));b.overlay&&(b.overlay.$el.unbind("mousedown.wijsheetfilterdialog-overlay"),b.overlay.destroy());l(document).unbind("keydown.ui-dialog");
b.uiDialog.unbind("mousewheel.ui-dialog");b.uiDialog.unbind("mouseover.wijsheetfilterdialog-overlay");b._isOpen=!1;b.options.hide?b.uiDialog.hide(b.options.hide,function(){b._trigger("close",a)}):(b.uiDialog.hide(),b._trigger("close",a));l.ui.dialog.overlay.resize();b.options.modal&&(e=0,l(".ui-dialog").each(function(){this!==b.uiDialog[0]&&(d=l(this).css("z-index"),isNaN(d)||(e=Math.max(e,d)))}),l.ui.dialog.maxZ=e);return b}},isOpen:function(){return this._isOpen},moveToTop:function(a,b){var e=this.options;
if(e.modal&&!a||!e.stack&&!e.modal)return this._trigger("focus",b);e.zIndex>l.ui.dialog.maxZ&&(l.ui.dialog.maxZ=e.zIndex);this.overlay&&(l.ui.dialog.maxZ+=1,this.overlay.$el.css("z-index",l.ui.dialog.overlay.maxZ=l.ui.dialog.maxZ));e={scrollTop:this.element.attr("scrollTop"),scrollLeft:this.element.attr("scrollLeft")};l.ui.dialog.maxZ+=1;this.uiDialog.css("z-index",l.ui.dialog.maxZ);this.element.attr(e);this._trigger("focus",b);return this},open:function(){if(!this._isOpen){var a=this,b=a.options,
e=a.uiDialog;a.overlay=b.modal?new l.ui.dialog.overlay(a):null;a._size();a._position(b.position);e.show(b.show);a.moveToTop(!0);b.modal&&(l(document).bind("keydown.ui-dialog",function(b){var d=a.options._filterDialog;if(d&&d.dialogID){var g=null;if(null===g&&(h=l("#"+d.dialogID+" .ui-state-hover"),0<h.length)){var k=l(h[0]).children("input");0<k.length&&k[0].name&&"multiselect_gc_filteritemlist"===k[0].name.toLowerCase()&&(g=k[0]);null!==g||"gc_sortAsc"!==h[0].parentNode.id&&"gc_sortDes"!==h[0].parentNode.id||
(g=h[0].parentNode);null===g&&(g=h[0])}if(null===g){var h=l("#"+d.dialogID+" .ui-state-focus");0<h.length&&(g=h[0])}null===g&&(g=b.target);if(b.keyCode===l.ui.keyCode.ENTER)k=g.id,k===d.sortAscID?(d._sortByUser(!0),d.close()):k===d.sortDesID&&(d._sortByUser(!1),d.close());else if(b.keyCode===l.ui.keyCode.TAB||b.keyCode===l.ui.keyCode.DOWN||b.keyCode===l.ui.keyCode.UP){k=!0;switch(b.keyCode){case l.ui.keyCode.TAB:b.shiftKey&&(k=!1);break;case l.ui.keyCode.UP:k=!1}var h=l(":tabbable",a.uiDialog[0]),
g=l.inArray(g,h),m=null,s=0<=g?h[g]:null;if(s&&s.name&&s.name===d.filterCheckItemName&&b.keyCode===l.ui.keyCode.TAB){for(var m=b=null,p=0;p<h.length;p++){var H=h[p];H.name&&H.name===d.filterCheckItemName&&(null===b&&(b=h[p-1]),m=h[p+1])}m=k?m:b}null===m&&(g=-1!==g?k?g===h.length-1?0:g+1:0===g?h.length-1:g-1:0,m=h[g],!m.name||m.name!==d.filterCheckItemName||s&&s.name&&s.name===d.filterCheckItemName||(k=l("#"+d.superPanelID+" ."+d.activeCheckItemClass),0<k.length&&(m=l(k[0]).children("input")[0])));
l("#"+d.dialogID+" *").removeClass("ui-state-hover");l("#"+d.dialogID+" *").removeClass("ui-state-focus");if(m.name&&m.name===d.filterCheckItemName)return k=m.parentNode,l("#"+d.superPanelID+" *").removeClass(d.activeCheckItemClass),l(k).addClass("ui-state-hover "+d.activeCheckItemClass),l("#"+d.superPanelID).wijspreadpanelex("needToScroll",k)?(l("#"+d.superPanelID).wijspreadpanelex("scrollChildIntoView",k),e.focus()):l(m).focus().addClass("ui-state-focus ui-state-hover"),!1;if("gc_sortAsc"===m.id||
"gc_sortDes"===m.id)return a.uiDialog.focus(1),l(m).children("a").addClass("ui-state-focus ui-state-hover"),!1;l(m).focus(1).addClass("ui-state-focus");return!1}}}),a.options._filterDialog&&l("#"+a.options._filterDialog.superPanelID).bind("wijspreadpanelexscrolled",function(){var b=a.options._filterDialog,e=l("#"+b.dialogID+" .ui-state-hover");0<e.length&&(e=l(e[0]).children("input"),0<e.length&&e[0].name&&e[0].name===b.filterCheckItemName&&(l("#"+b.superPanelID).wijspreadpanelex("needToScroll",e[0])||
l(e[0]).focus().addClass("ui-state-focus ui-state-hover")))}),e.bind("mousewheel.ui-dialog",function(a){return!1}),e.bind("mouseover.wijsheetfilterdialog-overlay",function(b){var d=a.options._filterDialog;if(d&&d.dialogID){l("#"+d.dialogID+" .ui-state-hover").removeClass("ui-state-hover");l("#"+d.dialogID+" .ui-state-focus").removeClass("ui-state-focus");document.activeElement&&"input"===document.activeElement.nodeName.toLowerCase()&&"search"===document.activeElement.type.toLowerCase()||e.focus();
var g=function(){var a=l(b.target);l(this).find(".ui-state-default").each(function(){0<a.closest(this).length&&l(this).addClass("ui-state-hover")})};l("#"+d.dialogID+" .wijmo-wijsuperpanel-vbarcontainer").each(g);l("#"+d.dialogID+" .wijmo-wijsuperpanel-hbarcontainer").each(g);var g=l(":tabbable",this),k=l.inArray(b.target,g),h=null;if(-1!==k)h=g[k];else if(k=l(b.target).children("input"),0<k.length&&k[0].name&&k[0].name===d.filterCheckItemName&&(h=k[0]),null===h&&(k=l(b.target.parentNode).children("input"),
0<k.length&&k[0].name&&k[0].name===d.filterCheckItemName&&(h=k[0])),null===h)for(k=0;k<g.length;k++)if(0<l(b.target).closest(g[k]).length){h=g[k];break}null===h||"input"===h.nodeName.toLowerCase()&&"search"===h.type.toLowerCase()||(h.name&&h.name===d.filterCheckItemName?l(h.parentNode).addClass("ui-state-hover"):"gc_sortAsc"===h.id||"gc_sortDes"===h.id?l(h).children("a").addClass("ui-state-hover"):l(h).addClass("ui-state-hover"))}}),a.overlay.$el.css({opacity:0}),a.overlay.$el.bind("mousedown.wijsheetfilterdialog-overlay",
function(b){a.isOpen()&&(a.close(),k.cancelDefault(b))}),l(p).trigger("resize.dialog-overlay"));l(a.element.find(":tabbable").get().concat(e.find(".ui-dialog-buttonpane :tabbable").get().concat(e.get()))).eq(0).focus();a._isOpen=!0;a._trigger("open");e.focus(1);a.options._filterDialog&&l("#"+a.options._filterDialog.superPanelID).wijspreadpanelex("scrollTo",0,0);return a}},_createButtons:function(a){var b=this,e=!1,g=l("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),
k=l("<div></div>").addClass("ui-dialog-buttonset").appendTo(g);b.uiDialog.find(".ui-dialog-buttonpane").remove();"object"===typeof a&&null!==a&&l.each(a,function(){return!(e=!0)});e&&(l.each(a,function(a,e){e=l.isFunction(e)?{click:e,text:a}:e;var f=l('<button type="button"></button>').click(function(){e.click.apply(b.element[0],arguments)}).appendTo(k);l.each(e,function(a,b){if("click"!==a)if(a in d)f[a](b);else f.attr(a,b)});l.fn.button&&f.button()}),g.appendTo(b.uiDialog))},_makeDraggable:function(){function a(b){return{position:b.position,
offset:b.offset}}var b=this,e=b.options,d=l(p.document),g;b.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(d,k){g="auto"===e.height?"auto":l(this).height();l(this).height(l(this).height()).addClass("ui-dialog-dragging");b._trigger("dragStart",d,a(k))},drag:function(e,d){b._trigger("drag",e,a(d))},stop:function(k,n){e.position=[n.position.left-d.scrollLeft(),n.position.top-d.scrollTop()];l(this).removeClass("ui-dialog-dragging").height(g);
b._trigger("dragStop",k,a(n));l.ui.dialog.overlay.resize()}})},_makeResizable:function(a){function b(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}a=void 0===a?this.options.resizable:a;var e=this,d=e.options,g=e.uiDialog.css("position");a="string"===typeof a?a:"n,e,s,w,se,sw,ne,nw";e.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:e.element,maxWidth:d.maxWidth,maxHeight:d.maxHeight,minWidth:d.minWidth,minHeight:e._minHeight(),
handles:a,start:function(a,d){l(this).addClass("ui-dialog-resizing");e._trigger("resizeStart",a,b(d))},resize:function(a,d){e._trigger("resize",a,b(d))},stop:function(a,f){l(this).removeClass("ui-dialog-resizing");d.height=l(this).height();d.width=l(this).width();e._trigger("resizeStop",a,b(f));l.ui.dialog.overlay.resize()}}).css("position",g).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,
a.height)},_position:function(a){var b=[],e=[0,0],d;if(a){if("string"===typeof a||"object"===typeof a&&"0"in a)b=a.split?a.split(" "):[a[0],a[1]],1===b.length&&(b[1]=b[0]),l.each(["left","top"],function(a,d){+b[a]===b[a]&&(e[a]=b[a],b[a]=d)}),a={my:b.join(" "),at:b.join(" "),offset:e.join(" ")};a=l.extend({},l.ui.dialog.prototype.options.position,a)}else a=l.ui.dialog.prototype.options.position;(d=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position(l.extend({of:p},
a));d||this.uiDialog.hide()},_setOptions:function(b){var e=this,d={},k=!1;l.each(b,function(b,f){e._setOption(b,f);b in g&&(k=!0);b in a&&(d[b]=f)});k&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",d)},_setOption:function(a,b){var e=this.uiDialog;switch(a){case "beforeclose":a="beforeClose";break;case "buttons":this._createButtons(b);break;case "dialogClass":e.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content "+b);break;case "disabled":b?
e.addClass("ui-dialog-disabled"):e.removeClass("ui-dialog-disabled");break;case "draggable":var d=e.is(":data(draggable)");d&&!b&&e.draggable("destroy");!d&&b&&this._makeDraggable();break;case "position":this._position(b);break;case "resizable":(d=e.is(":data(resizable)"))&&!b&&e.resizable("destroy"),d&&"string"===typeof b&&e.resizable("option","handles",b),d||!1===b||this._makeResizable(b)}l.Widget.prototype._setOption.apply(this,arguments)},_size:function(){var a=this.options,b,e,d=this.uiDialog.is(":visible");
this.element.show().css({width:"auto",minHeight:0,height:0});a.minWidth>a.width&&(a.width=a.minWidth);b=this.uiDialog.css({height:"auto",width:a.width}).height();e=Math.max(0,a.minHeight-b);"auto"===a.height?l.support.minHeight?this.element.css({minHeight:e,height:"auto"}):(this.uiDialog.show(),a=this.element.css("height","auto").height(),d||this.uiDialog.hide(),this.element.height(Math.max(a,e))):this.element.height(Math.max(a.height-b,0));this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",
"minHeight",this._minHeight())}});var e=0;l.widget("wijmo.wijsheetmultiselect",{options:{header:!0,height:175,minWidth:200,classes:"",checkAllText:"Check all",uncheckAllText:"Uncheck all",noneSelectedText:"Select options",selectedText:"# selected",selectedList:0,show:"",hide:"",autoOpen:!1,multiple:!0,position:{}},_create:function(){var a=this.element.hide(),b=this.options;this.speed=l.fx.speeds._default;this._isOpen=!1;var a=(this.menu=l("<div />")).addClass("ui-multiselect-menu ui-widget ui-corner-all").addClass(b.classes).insertAfter(a),
e=(this.header=l("<div />")).addClass("ui-widget-header ui-corner-all ui-multiselect-header ui-helper-clearfix").appendTo(a);(this.headerLinkContainer=l('<ul style="cursor: pointer" />')).addClass("ui-helper-reset").html(function(){return!0===b.header?'<li><a class="ui-multiselect-all"><span class="ui-icon ui-icon-check"></span><span>'+b.checkAllText+'</span></a></li><li><a class="ui-multiselect-none"><span class="ui-icon ui-icon-closethick"></span><span>'+b.uncheckAllText+"</span></a></li>":"string"===
typeof b.header?"<li>"+b.header+"</li>":""}).appendTo(e);e=l("<div id='gc_filterSuperPanel' />").addClass("ui-multiselect-superpanel").appendTo(a);(this.checkboxContainer=l("<ul />")).addClass("ui-multiselect-checkboxes ui-helper-reset").appendTo(e);this._bindEvents();this.refresh(!0);b.multiple||a.addClass("ui-multiselect-single")},_init:function(){!1===this.options.header&&this.header.hide();this.options.multiple||this.headerLinkContainer.find(".ui-multiselect-all, .ui-multiselect-none").hide();
this.options.autoOpen&&this.open();this.element.is(":disabled")&&this.disable()},refresh:function(a){var b=this.element,d=this.options,g=this.menu,k=this.checkboxContainer,m=[],n=[],h=b.attr("id")||e++;b.find("option").each(function(a){var b=l(this),e=this.parentNode,f=this.innerHTML,g=this.title,k=this.value;a=this.id||"ui-multiselect-"+h+"-option-"+a;var r=this.disabled,b=b.attr("aria-selected"),t=["ui-corner-all"];"optgroup"===e.tagName.toLowerCase()&&(e=e.getAttribute("label"),-1===l.inArray(e,
m)&&(n.push('<li class="ui-multiselect-optgroup-label"><a href="#">'+e+"</a></li>"),m.push(e)));r&&t.push("ui-state-disabled");b&&!d.multiple&&t.push("ui-state-active");n.push('<li class="'+(r?"ui-multiselect-disabled":"")+'">');n.push('<label for="'+a+'" title="'+g+'" class="'+t.join(" ")+'">');n.push('<input id="'+a+'" name="multiselect_'+h+'" type="'+(d.multiple?"checkbox":"radio")+'" value="'+k+'" title="'+f+'"');"true"===b&&(n.push(' checked="checked"'),n.push(' aria-selected="true"'));r&&(n.push(' disabled="disabled"'),
n.push(' aria-disabled="true"'));n.push(' /><span style="font-weight:normal">'+f+"</span></label></li>")});k.html(n.join(""));this.labels=g.find("label");a||this._trigger("refresh")},update:function(){var a=this.options,b=this.labels.find("input"),e=b.filter("[checked]"),d=e.length;return 0===d?a.noneSelectedText:l.isFunction(a.selectedText)?a.selectedText.call(this,d,b.length,e.get()):/\d/.test(a.selectedList)&&0<a.selectedList&&d<=a.selectedList?e.map(function(){return l(this).next().text()}).get().join(", "):
a.selectedText.replace("#",d).replace("#",b.length)},_bindEvents:function(){var a=this;this.header.delegate("a","click.multiselect",function(b){l(this).hasClass("ui-multiselect-close")?a.close():(a[l(this).hasClass("ui-multiselect-all")?"checkAll":"uncheckAll"](),a.element.trigger("change"));b.preventDefault()});this.menu.delegate("li.ui-multiselect-optgroup-label a","click.multiselect",function(b){b.preventDefault();var e=l(this),d=e.parent().nextUntil("li.ui-multiselect-optgroup-label").find("input:visible:not(:disabled)"),
g=d.get(),e=e.parent().text();!1!==a._trigger("beforeoptgrouptoggle",b,{inputs:g,label:e})&&(a._toggleChecked(d.filter("[checked]").length!==d.length,d),a._trigger("optgrouptoggle",b,{inputs:g,label:e,checked:g[0].checked}))}).delegate("label","mouseenter.multiselect",function(){l(this).hasClass("ui-state-disabled")||a.labels.removeClass("ui-state-hover")}).delegate("label","keydown.multiselect",function(a){a.preventDefault();switch(a.which){case 13:l(this).find("input")[0].click()}}).delegate('input[type="checkbox"], input[type="radio"]',
"click.multiselect",function(b){var e=l(this),d=this.value,g=this.checked,k=a.element.find("option");this.disabled||!1===a._trigger("click",b,{value:d,text:this.title,checked:g})?b.preventDefault():(e.focus(),e.attr("aria-selected",g),l("#gc_filterSuperPanel *").removeClass("gc_filterActiveCheckItem"),l(this.parentNode).addClass("gc_filterActiveCheckItem"),k.each(function(){this.value===d?this.selected=g:a.options.multiple||(this.selected=!1)}),a.options.multiple||(a.labels.removeClass("ui-state-active"),
e.closest("label").toggleClass("ui-state-active",g),a.close()),a.element.trigger("change"),p.setTimeout(l.proxy(a.update,a),10))});l(p.document).bind("mousedown.multiselect",function(b){!a._isOpen||l.contains(a.menu[0],b.target)||l.contains(a.button[0],b.target)||b.target===a.button[0]||a.close()});l(this.element[0].form).bind("reset.multiselect",function(){p.setTimeout(l.proxy(a.refresh,a),10)})},_traverse:function(a,b){var e=l(b),d=38===a||37===a,e=e.parent()[d?"prevAll":"nextAll"]("li:not(.ui-multiselect-disabled, .ui-multiselect-optgroup-label)")[d?
"last":"first"]();e.length?e.find("label").trigger("mouseover"):(e=this.menu.find("ul").last(),this.menu.find("label")[d?"last":"first"]().trigger("mouseover"),e.scrollTop(d?e.height():0))},_toggleState:function(a,b){return function(){this.disabled||(this[a]=b);b?this.setAttribute("aria-selected",!0):this.removeAttribute("aria-selected")}},_toggleChecked:function(a,b){var e=b&&b.length?b:this.labels.find("input"),d=this;e.each(this._toggleState("checked",a));e.eq(0).focus();this.update();var g=e.map(function(){return this.value}).get();
this.element.find("option").each(function(){!this.disabled&&-1<l.inArray(this.value,g)&&d._toggleState("selected",a).call(this)});e.length&&this.element.trigger("change")},_toggleDisabled:function(a){this.button.attr({disabled:a,"aria-disabled":a})[a?"addClass":"removeClass"]("ui-state-disabled");this.menu.find("input").attr({disabled:a,"aria-disabled":a}).parent()[a?"addClass":"removeClass"]("ui-state-disabled");this.element.attr({disabled:a,"aria-disabled":a})},open:function(a){a=this.button;var b=
this.menu,e=this.speed,d=this.options;if(!1!==this._trigger("beforeopen")&&!a.hasClass("ui-state-disabled")&&!this._isOpen){var g=b.find("ul").last(),k=d.show,n=a.offset();l.isArray(d.show)&&(k=d.show[0],e=d.show[1]||this.speed);g.scrollTop(0).height(d.height);l.ui.position&&!l.isEmptyObject(d.position)?(d.position.of=d.position.of||a,b.show().position(d.position).hide().show(k,e)):b.css({top:n.top+a.outerHeight(),left:n.left}).show(k,e);this.labels.eq(0).trigger("mouseover").trigger("mouseenter").find("input").trigger("focus");
a.addClass("ui-state-active");this._isOpen=!0;this._trigger("open")}},close:function(){if(!1!==this._trigger("beforeclose")){var a=this.options,b=a.hide,e=this.speed;l.isArray(a.hide)&&(b=a.hide[0],e=a.hide[1]||this.speed);this.menu.hide(b,e);this.button.removeClass("ui-state-active").trigger("blur").trigger("mouseleave");this._isOpen=!1;this._trigger("close")}},enable:function(){this._toggleDisabled(!1)},disable:function(){this._toggleDisabled(!0)},checkAll:function(a){this._toggleChecked(!0);this._trigger("checkAll")},
uncheckAll:function(){this._toggleChecked(!1);this._trigger("uncheckAll")},getChecked:function(){return this.menu.find("input:checked")},destroy:function(){l.Widget.prototype.destroy.call(this);this.menu.remove();this.element.show();return this},isOpen:function(){return this._isOpen},widget:function(){return this.menu},_setOption:function(a,b){var e=this.menu;switch(a){case "header":e.find("div.ui-multiselect-header")[b?"show":"hide"]();break;case "checkAllText":e.find("a.ui-multiselect-all span").eq(-1).text(b);
break;case "uncheckAllText":e.find("a.ui-multiselect-none span").eq(-1).text(b);break;case "height":e.find("ul").last().height(parseInt(b,10));break;case "minWidth":this.options[a]=parseInt(b,10);this._setButtonWidth();this._setMenuWidth();break;case "selectedText":case "selectedList":case "noneSelectedText":this.options[a]=b;this.update();break;case "classes":e.add(this.button).removeClass(this.options.classes).addClass(b)}l.Widget.prototype._setOption.apply(this,arguments)}});var b=/[\-\[\]{}()*+?.,\\\^$|#\s]/g;
l.widget("wijmo.wijsheetmultiselectfilter",{options:{label:"",width:165,placeholder:"Search",autoReset:!1},_create:function(){var a=this,b=this.options,e=this.instance=l(this.element).data("wijmo-wijsheetmultiselect");this.header=e.menu.find(".ui-multiselect-header").addClass("ui-multiselect-hasfilter");b=this.wrapper=l('<div class="ui-multiselect-filter">'+(b.label.length?b.label:"")+'<input placeholder="'+b.placeholder+'" type="search"'+(/\d/.test(b.width)?'style="width:'+b.width+'px"':"")+" /></div>").prependTo(this.header);
this.inputs=e.menu.find('input[type="checkbox"], input[type="radio"]');this.input=b.find("input").bind({keydown:function(a){13===a.which&&a.preventDefault()},keyup:function(b){switch(b.keyCode){case l.ui.keyCode.TAB:case l.ui.keyCode.UP:case l.ui.keyCode.RIGHT:case l.ui.keyCode.DOWN:case l.ui.keyCode.LEFT:break;default:l.proxy(a._handler(b),a)}}});this.updateCache();e._toggleChecked=function(b,e){var d=e&&e.length?e:this.labels.find("input"),g=this,d=d.not(a.instance._isOpen?":disabled, :hidden":
":disabled").each(this._toggleState("checked",b));this.update();var h=d.map(function(){return this.value}).get();this.element.find("option").filter(function(){!this.disabled&&-1<l.inArray(this.value,h)&&g._toggleState("selected",b).call(this)})};e=l(p.document).bind("wijsheetmultiselectrefresh",function(){a.updateCache();a._handler()});this.options.autoReset&&e.bind("wijsheetmultiselectclose",l.proxy(this._reset,this))},_handler:function(a){var e=l.trim(this.input[0].value.toLowerCase()),d=this.rows,
g=d.find("input"),k=this.cache;if(e){d.hide();g.prop("checked",!1);var m=RegExp(e.replace(b,"\\$&"),"gi");this._trigger("filter",a,l.map(k,function(a,b){if(-1!==a.search(m)){d.eq(b).show();var e=g.get(b);l(e).prop("checked",!0);return e}return null}))}else if(d.show(),this._firstOpenCache){g.prop("checked",!1);var n=this;l.each(g,function(a,b){-1!==l.inArray(b.value,n._firstOpenCache)&&l(b).prop("checked",!0)})}else this.initFirstOpenCache();this.instance.menu.find(".ui-multiselect-optgroup-label").each(function(){var a=
l(this),b=a.nextUntil(".ui-multiselect-optgroup-label").filter(function(){return"none"!==l.css(this,"display")}).length;a[b?"show":"hide"]()});this.instance.element.trigger("change")},initFirstOpenCache:function(){var a=this.rows.find("input");this._firstOpenCache=[];var b=this;l.each(a,function(a,e){!0===l(e).prop("checked")&&b._firstOpenCache.push(e.value)})},_reset:function(){this.input.val("").trigger("keyup")},updateCache:function(){this.rows=this.instance.menu.find(".ui-multiselect-checkboxes li:not(.ui-multiselect-optgroup-label)");
this.cache=this.element.children().map(function(){var a=l(this);"optgroup"===this.tagName.toLowerCase()&&(a=a.children());return a.map(function(){return this.innerHTML.toLowerCase()}).get()}).get()},widget:function(){return this.wrapper},destroy:function(){l.Widget.prototype.destroy.call(this);this.input.val("").trigger("keyup");this.wrapper.remove()}})})(window,jQuery);
(function(p){function l(a,e,d,f){return new b.Range(a,e,d,f)}function m(a){return new b._DateTimeHelper(a)}function k(a){this._sheet=a}function g(a){this._startIndex=void 0===a||null===a?-1:a;this._indexes=[];this._innerValues=[];this._type=null}function a(a,b){function d(a,f,g,k){return e.Calc.Functions.findGlobalFunction(b).evaluate([f,g,k])[0][0]}return function(){return d.apply(a,arguments)}}function d(a){this._worksheet=a;this._fillCache=new k(a)}var e=p.GrapeCity;"undefined"===typeof e&&(e=
{});"undefined"===typeof e.UI&&(e.UI={});var b=e.UI;b.FillSeries={Column:0,Row:1};b.FillType={Direction:0,Linear:1,Growth:2,Date:3,Auto:4};b.FillDateUnit={Day:0,Weekday:1,Month:2,Year:3};var f=Math.floor;g.prototype={dataCount:function(){return this._innerValues.length},values:function(){if(0<this._innerValues.length){for(var a=[],b=0;b<this._innerValues.length;b++){var e=this._innerValues[b],e="object"===this._type?this.toDateTime(e):e;a.push(e)}return a}return[]},indexes2:function(){var a=this._indexes.length;
if(0<a){var b=this._startIndex;-1===b&&(b=this._indexes[0]);var d=Array(1);d[0]=Array(a);for(var f=0;f<a;f++)d[0][f]=this._indexes[f]-b+1;return new e.Calc._ConcreteArray(d,a)}return null},values2:function(){var a=this._innerValues.length;return 0<a?new e.Calc._ConcreteArray([this._innerValues],a):null},insert:function(a,d,f){if(!b.FormatConverter.IsNumber(f))throw Error("Only works for Numbers");if(void 0===this._type||null===this._type)this._type=f instanceof Date?"date":"number";var g=e.UI._ArrayHelper;
(new g(this._indexes)).insert(a,d);(new g(this._innerValues)).insert(a,this.toDouble(f))},add:function(a,b){if(void 0===this._type||null===this._type)this._type=b instanceof Date?"date":"number";this._indexes.push(a);this._innerValues.push(this.toDouble(b))},toActualValue:function(a){return"date"===this._type?this.toDateTime(a):a},toDouble:function(a){return b.FormatConverter.ToDouble(a)},toDateTime:function(a){var b=null;return b=a instanceof Date?a:e.Calc.Convert.toDateTime(a)}};var s={TREND:a(this,
"Trend"),GROWTH:a(this,"Growth"),FORECAST:a(this,"Forecast")};d.prototype={fillLinear:function(a,e,d,f){void 0!==d&&null!==d||void 0!==f&&null!==f?this.seriesFillRange(a,e,b.FillType.Linear,d,f,null):this.seriesTrendFillRange(a,e,b.FillType.Linear)},fillGrowth:function(a,e,d,f){void 0!==d&&null!==d||void 0!==f&&null!==f?this.seriesFillRange(a,e,b.FillType.Growth,d,f,null):this.seriesTrendFillRange(a,e,b.FillType.Growth)},fillDate:function(a,e,d,f,g){this.seriesFillRange(a,e,b.FillType.Date,f,g,d)},
seriesTrendFillRange:function(a,e,d){var f=this.fixRange(a);a=f.row;var g=f.col,h=f.rowCount,f=f.colCount;if(this.hasSpans(a,g,h,f))throw Error("Range should not have merged cell.");var k,l,m;if(e===b.FillSeries.Row)for(var s=a;s<a+h;s++){if((k=this.getSeriesSource(s,g,1,f,e))&&0<k.dataCount()&&(l=this.calcSeriesTrendData(k,f,d))&&0<l.length)for(m=0;m<l.length;m++)this.copyCell(this._worksheet,s,k._indexes[0],s,g+m,k.toActualValue(l[m]),d)}else if(e===b.FillSeries.Column)for(s=g;s<g+f;s++)if((k=this.getSeriesSource(a,
s,h,1,e))&&0<k.dataCount()&&(l=this.calcSeriesTrendData(k,h,d))&&0<l.length)for(m=0;m<l.length;m++)this.copyCell(this._worksheet,k._indexes[0],s,a+m,s,k.toActualValue(l[m]),d)},getSeriesSource:function(a,e,d,f,k){var h=null;if(k===b.FillSeries.Row)for(f=e+f-1;f>=e;)d=this._worksheet.getValue(a,f),b.FormatConverter.IsNumber(d)&&(h||(h=new g(e)),h.insert(0,f,d)),f--;else if(k===b.FillSeries.Column)for(f=a+d-1;f>=a;)d=this._worksheet.getValue(f,e),b.FormatConverter.IsNumber(d)&&(h||(h=new g(a)),h.insert(0,
f,d)),f--;return h},calcSeriesTrendData:function(a,e,d){if(a&&0<a.dataCount()&&(d===b.FillType.Linear||d===b.FillType.Growth)){var f=[];1===a.dataCount()&&(d===b.FillType.Linear?a.add(a._indexes[0]+1,a.toActualValue(a._innerValues[0]+1)):d===b.FillType.Growth&&a.add(a._indexes[0]+1,a.values()[0]));for(var g=0;g<e;g++)d===b.FillType.Linear?f.push(s.TREND(this._worksheet,a.values2(),a.indexes2(),g+1)):d===b.FillType.Growth&&f.push(s.GROWTH(this._worksheet,a.values2(),a.indexes2(),g+1));return f}return null},
fillAuto:function(a,b){var e=this._worksheet,d=this.fixRange(a),f=d.row,g=d.col,k=d.rowCount,d=d.colCount;if(e=this.fixRange(e._eventHandler._dragFillStartRange)){if(this.hasPartSpans(e.row,e.col,e.rowCount,e.colCount)||this.hasPartSpans(f,g,k,d))throw Error("Can not change part of merged cell.");this.autoFillRange(e,k,d,b)}},fixRange:function(a){var b=a.row,e=a.col,d=a.rowCount;a=a.colCount;-1===b&&(b=0,d=this._worksheet.getRowCount());-1===e&&(e=0,a=this._worksheet.getColumnCount());return l(b,
e,d,a)},autoFillRange:function(a,e,d,g){var k,h;if(g===b.FillSeries.Row){k=f(d/a.colCount);e=d%a.colCount;if(1<k)for(h=1;h<k;h++)d=l(a.row,a.col+h*a.colCount,a.rowCount,a.colCount),this.copyRange(a,d,g,b.FillType.Auto);0<k&&0<e&&(d=l(a.row,a.col+k*a.colCount,a.rowCount,e),this.copyRange(a,d,g,b.FillType.Auto))}else if(g===b.FillSeries.Column){k=f(e/a.rowCount);e%=a.rowCount;if(1<k)for(h=1;h<k;h++)d=l(a.row+h*a.rowCount,a.col,a.rowCount,a.colCount),this.copyRange(a,d,g,b.FillType.Auto);0<k&&0<e&&(d=
l(a.row+k*a.rowCount,a.col,e,a.colCount),this.copyRange(a,d,g,b.FillType.Auto))}},copyRange:function(a,e,d,f){var k=this._worksheet,h,l,m,s,p,C,G,z=null,S=null;if(d===b.FillSeries.Row)for(d=0;d<a.rowCount;d++){S=z=null;m=a.row+d;s=e.row+d;for(h=0;h<a.colCount;){l=a.col+h;p=e.col+h;C=null;(G=k.getFormula(m,l))&&""!==G||(C=k.getValue(m,l));if(f===b.FillType.Auto&&b.FormatConverter.IsNumber(C)&&(z||(z=new g),G=C instanceof Date?"date":"number",S||(S=G),S===G)){z.add(l,C);h++;continue}C&&z&&0<z.dataCount()?
(this.autoFillRowTrendValues(a,e,m,s,z),S=z=null):(G=k._spanModel.find(m,l))?(G.row===m&&p<e.col+e.colCount&&this.copyCell(k,m,l,s,p,C,f),h+=G.colCount):(p<e.col+e.colCount&&this.copyCell(k,m,l,s,p,C,f),h++)}z&&0<z.dataCount()&&this.autoFillRowTrendValues(a,e,m,s,z)}else if(d===b.FillSeries.Column)for(h=0;h<a.colCount;h++){S=z=null;l=a.col+h;p=e.col+h;for(d=0;d<a.rowCount;){m=a.row+d;s=e.row+d;C=null;(G=k.getFormula(m,l))&&""!==G||(C=k.getValue(m,l));if(f===b.FillType.Auto&&b.FormatConverter.IsNumber(C)&&
(z||(z=new g),G=C instanceof Date?"date":"number",S||(S=G),S===G)){z.add(m,C);d++;continue}C&&z&&0<z.dataCount()?(this.autoFillColumnTrendValues(a,e,l,p,z),S=z=null):(G=k._spanModel.find(m,l))?(G.col===l&&s<e.row+e.rowCount&&this.copyCell(k,m,l,s,p,C,f),d+=G.rowCount):(s<e.row+e.rowCount&&this.copyCell(k,m,l,s,p,C,f),d++)}z&&0<z.dataCount()&&this.autoFillColumnTrendValues(a,e,l,p,z)}},autoFillRowTrendValues:function(a,d,f,g,k){var h=this._worksheet,l,m,p,H,C;if(k&&0<k.dataCount()){var G=(d.col-a.col)/
a.colCount;if(this.isArithmeticProgression(k._indexes,k._innerValues)){var z=k.values2();p=Array(1);l=k.dataCount();p[0]=Array(l);for(m=0;m<l;m++)p[0][m]=m+1;var S=new e.Calc._ConcreteArray(p,l);for(m=0;m<l;m++)p=s.TREND(h,z,S,l*G+m+1),H=k._indexes[m],C=H+G*a.colCount,C<d.col+d.colCount&&this.copyCell(h,f,H,g,C,k.toActualValue(p),b.FillType.Auto)}else for(z=k._indexes[0],l=k._indexes[k.dataCount()-1]-z+1,1===k.dataCount()&&k.add(k._indexes[0]+1,k.toActualValue(k._innerValues[0]+1)),m=0;m<l;m++)p=
s.TREND(h,k.values2(),k.indexes2(),l*G+m+1),H=z+m,C=H+G*a.colCount,C<d.col+d.colCount&&this.copyCell(h,f,H,g,C,k.toActualValue(p),b.FillType.Auto)}},copyCell:function(a,d,f,g,k,h,l){if(a.hasFormula(d,f)||a.hasFormula(g,k))a.setFormula(g,k,null),(l===b.FillType.Direction||l===b.FillType.Auto)&&a.getFormula(d,f)&&a._copyFormula(d,f,g,k,1,1);a.setValue(g,k,h);(h=a.getCompositeStyle(d,f))?(l=new e.UI.Style,l.copyFrom(h),a.setStyle(g,k,l,e.UI.SheetArea.viewport)):a.setStyle(g,k,null,e.UI.SheetArea.viewport);
a._spanModel.isEmpty()||(a.removeSpan(g,k,e.UI.SheetArea.viewport),(d=a._spanModel.find(d,f))&&a._addSpanImp(g,k,d.rowCount,d.colCount,e.UI.SheetArea.viewport))},autoFillColumnTrendValues:function(a,d,f,g,k){var h=this._worksheet,l,m,p,H,C;if(k&&0<k.dataCount()){var G=(d.row-a.row)/a.rowCount;if(this.isArithmeticProgression(k._indexes,k._innerValues)){var z=k.values2();p=Array(1);l=k.dataCount();p[0]=Array(l);for(m=0;m<l;m++)p[0][m]=m+1;var S=new e.Calc._ConcreteArray(p,l);for(m=0;m<l;m++)p=s.TREND(h,
z,S,l*G+m+1),H=k._indexes[m],C=H+G*a.rowCount,C<d.row+d.rowCount&&this.copyCell(h,H,f,C,g,k.toActualValue(p),b.FillType.Auto)}else for(z=k._indexes[0],l=k._indexes[k.dataCount()-1]-z+1,1===k.dataCount()&&k.add(k._indexes[0]+1,k.toActualValue(k._innerValues[0]+1)),m=0;m<l;m++)p=s.TREND(h,k.values2(),k.indexes2(),l*G+m+1),H=z+m,C=H+G*a.rowCount,C<d.row+d.rowCount&&this.copyCell(h,z,f,C,g,k.toActualValue(p),b.FillType.Auto)}},isArithmeticProgression:function(a,b){if(a.length!==b.length)return!1;var e=
b.length;if(1>=e)return!1;if(2!==e)for(var d=a[1]-a[0],f=b[1]-b[0],g=2;g<e;g++)if(a[g]-a[g-1]!==d||b[g]-b[g-1]!==f)return!1;return!0},fillAutobyDirection:function(a,b){var e=this.fixRange(a),d=e.row,f=e.col,g=e.rowCount,e=e.colCount,k=this.getDirectionFillSourceRange(d,f,g,e,b);k&&this.directionFillRange(k,d,f,g,e,b)},directionFillRange:function(a,e,d,g,k,h){var m=b.FillDirection;if(h===m.Left){if(this.hasSpans(e,d,g,k-a.colCount))throw Error("Target range should not have merged cells.");e=f(k/a.colCount);
g=k%a.colCount;if(0!==g)throw Error("This operation requires the merged cells to be identically sized.");if(1<e)for(k=1;k<e;k++)g=l(a.row,a.col-k*a.colCount,a.rowCount,a.colCount),this.copyRange(a,g,b.FillSeries.Row,b.FillType.Direction)}else if(h===m.Right){if(this.hasSpans(e,d+a.colCount,g,k-a.colCount))throw Error("Target range should not have merged cells.");e=f(k/a.colCount);g=k%a.colCount;if(0!==g)throw Error("This operation requires the merged cells to be identically sized.");if(1<e)for(k=
1;k<e;k++)g=l(a.row,a.col+k*a.colCount,a.rowCount,a.colCount),this.copyRange(a,g,b.FillSeries.Row,b.FillType.Direction)}else if(h===m.Up){if(this.hasSpans(e,d,g-a.rowCount,k))throw Error("Target range should not have merged cells.");e=f(g/a.rowCount);g%=a.rowCount;if(0!==g)throw Error("This operation requires the merged cells to be identically sized.");if(1<e)for(k=1;k<e;k++)g=l(a.row-k*a.rowCount,a.col,a.rowCount,a.colCount),this.copyRange(a,g,b.FillSeries.Column,b.FillType.Direction)}else if(h===
m.Down){if(this.hasSpans(e+a.rowCount,d,g-a.rowCount,k))throw Error("Target range should not have merged cells.");e=f(g/a.rowCount);g%=a.rowCount;if(0!==g)throw Error("This operation requires the merged cells to be identically sized.");if(1<e)for(k=1;k<e;k++)g=l(a.row+k*a.rowCount,a.col,a.rowCount,a.colCount),this.copyRange(a,g,b.FillSeries.Column,b.FillType.Direction)}},getDirectionFillSourceRange:function(a,e,d,f,g){var h=null,k=b.FillDirection;g===k.Left?h=l(a,e+f-1,d,1):g===k.Right?h=l(a,e,d,
1):g===k.Up?h=l(a+d-1,e,1,f):g===k.Down&&(h=l(a,e,1,f));return this.inflateCellRange(h)},inflateCellRange:function(a){var b=this._worksheet.getSpans();b&&a&&(a=this._worksheet._cellRangeInflate(b,a));return a},hasPartSpans:function(a,b,e,d){for(var f=this._worksheet._spanModel.getEnumerator(a,b,e,d);f.moveNext();){var g=f.current();if(g.row<a||g.row+g.rowCount>a+e||g.col<b||g.col+g.colCount>b+d)return!0}return!1},hasSpans:function(a,b,e,d){return this._worksheet._spanModel.getEnumerator(a,b,e,d).moveNext()},
seriesFillRange:function(a,e,d,f,g,h){var k=this.fixRange(a);a=k.row;var l=k.col,m=k.rowCount,k=k.colCount,s,p,G;if(this.hasSpans(a,l,m,k))throw Error("The range should not have a merged cell.");if(e===b.FillSeries.Row)for(var z=a;z<a+m;z++){if((s=this.getSeriesSource(z,l,1,1,e))&&0<s.dataCount()&&(p=this.calcSeriesData(s,k,d,f,g,h))&&0<p.length)for(G=0;G<p.length;G++)this.copyCell(this._worksheet,z,s._indexes[0],z,l+G,s.toActualValue(p[G]),d)}else if(e===b.FillSeries.Column)for(z=l;z<l+k;z++)if((s=
this.getSeriesSource(a,z,1,1,e))&&0<s.dataCount()&&(p=this.calcSeriesData(s,m,d,f,g,h))&&0<p.length)for(G=0;G<p.length;G++)this.copyCell(this._worksheet,s._indexes[0],z,a+G,z,s.toActualValue(p[G]),d)},calcSeriesData:function(a,e,d,f,g,h){if(a&&0<a.dataCount()){for(var k=[],l=a=a._innerValues[0],m=0;m<e;m++)if(void 0===g||null===g||l<=g)k.push(l),d===b.FillType.Linear?l+=f:d===b.FillType.Growth?l*=f:d===b.FillType.Date&&void 0!==h&&null!==h&&(l=this.getNextDateValue(h,a,l,f,m+1));return k}return null},
getNextDateValue:function(a,e,d,g,k){var h=d;if(a===b.FillDateUnit.Day)a=b._DateTimeHelper.fromOADate(d),h=m(a.setDate(a.getDate()+g)).toOADate();else if(a===b.FillDateUnit.Weekday){a=b._DateTimeHelper.fromOADate(d);for(k=Math.abs(g);0<k;)0<g?a.setDate(a.getDate()+Math.min(1,k)):a.setDate(a.getDate()-Math.min(1,k)),6!==a.getDay()&&0!==a.getDay()&&(k-=1);h=m(a).toOADate()}else a===b.FillDateUnit.Month?(a=b._DateTimeHelper.fromOADate(e),h=m(a.setMonth(a.getMonth()+f(k*g))).toOADate()):a===b.FillDateUnit.Year&&
(a=b._DateTimeHelper.fromOADate(e),h=m(a.setFullYear(a.getFullYear()+f(k*g))).toOADate());return h}};b.FillImp=d})(window);
(function(p,l){function m(a,b){this.sheet=a;this.fillInfo=b;this._init()}function k(a,b,d,g,k){var m="<"+a+" ";b&&(m+="id='"+b+"' ");g&&l.each(g,function(a,b){m+=a+"='"+b+"' "});return m=d?m+(">"+d+"</"+a+">"):m+(!0===k?">":"/>")}var g=p.GrapeCity;"undefined"===typeof g&&(g=p.GrapeCity={});"undefined"===typeof g.UI&&(g.UI={});var a=g.UI,d={Tag:0,Down:1};m.prototype={_init:function(){this._creatDom();var a=l("#gc_smartTag"),b=l("#gc_smartMenu");this.dialogTag=a.wijsheetfilterdialog({height:"auto",
width:"auto",minHeight:"auto",minWidth:"auto"});this.dialogTag.removeClass("ui-dialog-content");this.dialogTag.parent().removeClass("ui-widget-content");this.dialog=b.wijsheetfilterdialog({height:"auto",width:"auto",minHeight:"auto",minWidth:"auto",show:"auto"});this.dialog.removeClass("ui-dialog-content");this.dialog.parent().removeClass("ui-widget-content");a.addClass("ui-widget-header");b.addClass("ui-widget-content")},_getMenuItemDomString:function(a,b,d,g){b={name:"gc_fillType","class":"gc_fillTypeRadio",
type:"radio",value:b};g&&(b.checked="");a=k("div",null,k("input",a,null,b,!0),{"class":"gc_fillTypeRadioLable"});d=k("div",null,k("label",null,d,{"class":"gc_fillTypeText"}));return k("div",null,a+d,{"class":"gc_smartMenuItem"})},_getDomString:function(){var a=k("div","gc_smartTag",k("img",null,null,{style:"vertical-align: bottom",src:m.getImageSrc(d.Tag)})+k("img","gc_smartTagDown",null,{style:"vertical-align: bottom",src:m.getImageSrc(d.Down)})),b=k("div","gc_smartMenu",this._getMenuItemDomString("gc_smartMenuCopyCells",
"0","Copy Cells",!0)+this._getMenuItemDomString("gc_smartMenuFillSeries","1","Fill Series")+this._getMenuItemDomString("gc_smartMenuFillFormattingOnly","2","Fill Formatting Only")+this._getMenuItemDomString("gc_smartMenuFillWithoutFormatting","3","Fill Without Formatting"));return a+b},_hasDom:function(){return!!p.document.getElementById("gc_smartTag")},_creatDom:function(){var a=this.sheet._getCanvas();if(a&&!this._hasDom()){var b=this._getDomString();l(b).appendTo(a);this._prepareLayout()}},_prepareLayout:function(){l("#gc_smartTagDown").hide();
var a=l("#gc_smartMenu");a.hide();a.css({width:"170px",boxShadow:"1px 2px 5px rgba(0,0,0,0.4)"});a=l(".gc_smartMenuItem");a.css({width:"150px",height:"20px"});a.addClass("ui-state-default");a=l(".gc_fillTypeRadio");a.css({display:"none"});a.parent().css({width:"16px",height:"16px",margin:"1px","float":"left"});l(".gc_fillTypeRadio[checked]").parent().addClass("ui-icon ui-icon-check");a=l(".gc_fillTypeText");a.parent().css({paddingTop:"3px",paddingLeft:"20px"});a.css({fontSize:"9pt",fontFamily:"Arial",
fontWeight:"normal"});l("#gc_smartTag").css({width:"18px",height:"18px",padding:"0px",overflow:"hidden"})},_registerEvent:function(){var a=this,b=l("#gc_smartTag");b.unbind();b.hover(function(){a.dialog.wijsheetfilterdialog("isOpen")||(l(this).css({width:"32px",height:"18px"}),l(this).addClass("ui-state-hover"),l("#gc_smartTagDown").show())},function(){a.dialog.wijsheetfilterdialog("isOpen")||(l(this).css({width:"18px",height:"18px"}),l(this).removeClass("ui-state-hover"),l("#gc_smartTagDown").hide())});
b.toggle(function(){l(this).addClass("ui-state-active");a._openMenu()},function(){l(this).removeClass("ui-state-active");a._closeMenu()});var d=l(".gc_smartMenuItem");d.unbind();d.hover(function(){l(this).addClass("ui-state-hover")},function(){l(this).removeClass("ui-state-hover")});d.click(function(){l(this).find(":radio")[0].checked=!0;l(this).find(":radio").change();b.click();b.mouseleave();var d=parseInt(l(this).find(":radio")[0].value,10);p.setTimeout(function(){a._changeFill(d)},10)});d=l("#gc_smartMenu :radio");
d.unbind();d.change(function(){l(".gc_fillTypeRadioLable").removeClass("ui-icon ui-icon-check");l(this).parent().addClass("ui-icon ui-icon-check")})},_changeFill:function(a){var b=this.sheet;b._skipCloseDragFillSmartTag=!0;g.UI.SpreadActions.undo.call(b);b._skipCloseDragFillSmartTag=!1;b._eventHandler.executeDragFillAction(b._eventHandler._currentFillRange,a)},_initData:function(){var a=this.fillInfo.fillType;(a=this.dialog.find(":radio")[a])&&!1===a.checked&&(a.checked=!0,l(a).change())},open:function(){if(this.dialogTag){var a=
this;this._registerEvent();this._initData();var b=l(this.sheet._getCanvas()).offset(),d=this.fillInfo.x,g=this.fillInfo.y,d=d+(b.left-3),g=g+(b.top-3),b=l(p.document).scrollLeft(),k=l(p.document).scrollTop();this.dialogTag.wijsheetfilterdialog({position:[d-b,g-k],open:function(){},close:function(){a.close()}});this.reset();this.dialogTag.wijsheetfilterdialog("open")}},_openMenu:function(){if(this.dialog){var a=l(this.dialogTag).offset(),b=a.left-2.5,a=a.top+17.5,d=l(p.document).scrollLeft(),g=l(p.document).scrollTop();
this.dialog.wijsheetfilterdialog({position:[b-d,a-g],modal:!1});this.dialog.wijsheetfilterdialog("open")}},_closeMenu:function(){this.dialog&&this.dialog.wijsheetfilterdialog("close")},reset:function(){if(this.dialog){var a=this.dialog.wijsheetfilterdialog("isOpen"),b=l("#gc_smartTag");a&&b.click();b.mouseleave()}},close:function(){this.reset();this.isOpen()&&(this.dialog.wijsheetfilterdialog("close"),this.dialogTag.wijsheetfilterdialog("close"));this.sheet&&this.sheet._eventHandler._setFocus()},
isOpen:function(){return this.dialogTag?this.dialogTag.wijsheetfilterdialog("isOpen"):!1}};m.getImageSrc=function(a){return a===d.Tag?"data:image/png;base64,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":
a===d.Down?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAASCAYAAACXScT7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAGCSURBVHjafNFPKKRxHAbw5/v7GYdBYUQjLm5SkoNykCQHtcx431/KgdKumJvSrAO7Nwc3RQ5kd3OkHJC/hUJREluonVcToqRh3sRFPA6M1Mbhc3z6Pj1fkMRHQNJL0uPeul731lU37o1y49cqHr8GvvgWQRLBsmpM/P0j4XAXiooKcXl1CZDEzl4EJBEwAZBUwWAQsVgsFSRR11gmM8trimSa3WypzZ31l5v2/vfk/4oAcv9aSGyUSz4gg/AIAOET0YQswIQWaNrnH+2OeSaY0BJN2+wDTi/OpCrwkxX1vW8q63p5cnaaB+Z/09u7x0nFJTVMiEajPsNCQaC6Ryb8THKcw/Tikho6zj//0RGUNV6gMZ1H8fmpH5iTHDlwsiOhO7FrN5RdP6aBIUj/pvJ2bkFbkxAzBzELELNCQQqgrJ5ST1/jqmYOJcHa7dYYGV5TrQ3d+vfUU+b7IfrOIRCGBYD0o1VGmaHaB6DZkqvMD2hUfF1UAISkvE/+yqbCZ89+HgBtwgFOrBUzJgAAAABJRU5ErkJggg==":
""};a._FillSmartTag=d;g.UI._GcFillDialog=m})(window,jQuery);
(function(p,l){function m(g){this._loadedCount=this._imageCount=0;this.onLoadedComplete=g}var k=p.GrapeCity;"undefined"===typeof k&&(k=p.GrapeCity={});"undefined"===typeof k.UI&&(k.UI={});k=k.UI;m.prototype={addImage:function(g){this._imgs||(this._imgs={});var a=this._imgs[g];if(!a){var a={},d=l("<img/>"),e=this;d.bind("load",function(){e.imageLoaded(g)});d.bind("error",function(){e.imageLoaded(g)});d.bind("abort",function(){e.imageLoaded(g)});this._imageCount++;a.state=!1;a.img=d;this._imgs[g]=a;
d[0].src=g}},getImage:function(g){return this._imgs[g].img[0]},getState:function(g){return this._imgs&&this._imgs[g]?this._imgs[g].state:!1},imageLoaded:function(g){this._loadedCount++;this._imgs[g].state=!0;if(this._loadedCount>=this._imageCount&&this.onLoadedComplete)this.onLoadedComplete()}};k._GcImageLoader=m})(window,jQuery);
(function(p,l){var m=p.GrapeCity;"undefined"===typeof m&&(m=p.GrapeCity={});"undefined"==typeof m.UI&&(m.UI={});m=m.UI;m.CellBindingSource=function(k){this._source=k;this.__cellBindingSource__=!0};m.CellBindingSource.prototype={setValue:function(k,g){if(this._source&&k)for(var a=p.ko,d=this._source,e=k.split("."),b=0;b<e.length;b++){var f=e[b];if(!d)break;if(b===e.length-1)if("function"===typeof d[f]){if("undefined"===typeof a||a.isWriteableObservable(d[f]))d[f](g)}else d[f]=g;else d="function"===
typeof d[f]?d[f]():d[f]}},getValue:function(k){if(this._source&&k){var g=this._source;k=k.split(".");for(var a=0;a<k.length;a++){var d=k[a];if(!g)return null;g="function"===typeof g[d]?g[d]():g[d]}return g}return null},getSource:function(){return this._source}}})(window,jQuery);
(function(p,l){function m(a){return!0}function k(a){return 0!==a}function g(a){return 1===a}function a(a){return 2===a}function d(a){return 0===a||2===a}function e(a){return 0===a||1===a%2}function b(a){return 3===a}function f(){return!0}function s(a){return 1===a||2===a}function q(a){return 0===a}function t(a,b,e){var d=v.Convert;if(d.isError(a))return e.value=a,!1;if(d._isCalcReference(a))for(d=0;d<a.getRangeCount();d++)for(var f=0;f<a.getRowCount(d);f++)for(var g=0;g<a.getColumnCount(d);g++)if(a instanceof
v._SheetRangeReference)for(var h=0;h<a.getSheetCount();h++){if((e.includeSubtotal||!a.isSubtotal(h,d,f,g))&&!1===b(a.getValue(h,d,f,g),e))return!1}else{if((e.includeSubtotal||!a.isSubtotal(d,f,g))&&!1===b(a.getValue(d,f,g),e))return!1}else if(d._isCalcArray(a))for(d=0;d<a.length();d++){if(!1===b(a.getValueByIndex(d),e))return!1}else if(l.isArray(a))l.each(a,function(a,d){return b(d,e)});else if(!1===b(a,e))return!1;return!0}function r(a,b){this.Key=a;this.Value=b}function u(a,b){var d=v.Convert;if(d.isError(a))return b.value=
a,!1;if(d._isCalcReference(a)||d._isCalcArray(a)||l.isArray(a))return t(a,u,b);d=parseFloat(a);!isNaN(d)&&isFinite(a)&&(b.value+=d);return!0}function n(a,b){for(;0!==b;){var d=a%b;a=b;b=d}return a}function h(a,b){for(var d=1,e=0,f=v.Convert,g,h,k,l,n,m=0;m<a.length;m++){if(f.isError(a[m]))return a[m];if(f._isCalcArray(a[m]))for(h=a[m].getColumnCount(),g=a[m].getRowCount(),l=0;l<h;l++)for(k=0;k<g;k++)if(n=a[m].getValue(k,l),f.isNumber(n))d*=f.toDouble(n),e++;else{if(f.isError(n))return n}else if(f._isCalcReference(a[m]))for(var q=
a[m].getRangeCount(),r=0;r<q;r++)for(h=a[m].getColumnCount(r),l=0;l<h;l++)for(g=a[m].getRowCount(r),k=0;k<g;k++){if(a[m]instanceof v._SheetRangeReference)for(var p=0;p<a[m].getSheetCount();p++){if(b||!a[m].isSubtotal(p,r,k,l))n=a[m].getValue(p,r,k,l)}else if(b||!a[m].isSubtotal(r,k,l))n=a[m].getValue(r,k,l);if(f.isNumber(n))d*=f.toDouble(n),e++;else if(f.isError(n))return n}else{if(isNaN(f.toDouble(a[m])))return v.Errors.Value;d*=a[m];e++}}return f.toResult(0<e?d:0)}function I(a){var b=v.Convert,
d=b.toDouble(a[0]);if(isNaN(d))return v.Errors.Value;a=b.toInt(a[1]);var e=V._MathHelper,f=e.pow10(Math.abs(a)),d=0>a?d/f:d*f,d=0>d?e.approxCeiling(d-0.5):e.approxFloor(d+0.5);return b.toResult(0>a?d*f:d/f)}function E(a,b,d){var e=0;if(void 0===a||null===a)return e;var f=v.Convert,g=v._ArrayHelper;a=V._MathHelper.parseCriteria(a);if(g.getRowCount(b)!==g.getRowCount(d)||g.getColumnCount(b)!==g.getColumnCount(d))return v.Errors.Value;for(var h=0;h<g.getLength(b);h++){var k=g.getValueByIndex(b,h);if(f.isError(k))return k;
if(a&&a(k))if(k=g.getValueByIndex(d,h),f.isNumber(k))e+=f.toDouble(k);else if(f.isError(k))return k}return f.toResult(e)}function O(a){for(var b=1;1<a;a--)b*=a;return b}function H(a){try{return!v.Convert.toBool(a)}catch(b){return v.Errors.Value}}function C(a,b,d){try{var e=v.Convert.toBool(a)?b:d;return void 0!==e&&null!==e?e:0}catch(f){return v.Errors.Value}}function G(a,b){return v.Convert.isError(a)?void 0!==b&&null!==b?b:0:void 0!==a&&null!==a?a:0}function z(a){return 0===a%400||0===a%4&&0!==
a%100||1900===a}function S(a){a=v.Convert.toString(a[0]);if(void 0===a||null===a||""===a)return v.Errors.Value;try{var b;try{b=ia._DateTimeHelper.parseLocale(a)}catch(d){b=v.Errors.Value}return(60*(60*b.getHours()+b.getMinutes())+b.getSeconds())/86400}catch(e){return v.Errors.Value}}function Q(a){var b;try{b=v.Convert.toDateTime(a[0])}catch(d){return v.Errors.Value}if(isNaN(a=v.Convert.toInt(v._Helper._argumentExists(a,1)?a[1]:1)))return v.Errors.Value;switch(a){case 1:b=b.getDay()+1;break;case 2:b=
0===b.getDay()?7:b.getDay();break;case 3:b=0===b.getDay()?6:b.getDay()-1;break;default:return v.Errors.Number}return b}function aa(a,b){for(var d=a.length,e=0;e<d;e++)if(0===a[e]-b)return!0;return!1}function ka(a){var b=v.Convert,d=v._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]);a=d._argumentExists(a,2)?b.toBool(a[2]):!1;var b=e.getDate(),d=f.getDate(),g=e.getMonth(),h=f.getMonth(),e=e.getFullYear(),f=f.getFullYear();a?(d=31===d?30:d,b=31===b?30:b):(b=31===b?30:b,31===d&&(30>b?(d=1,h++,12<h&&
(h=1,f++)):d=30));return 30*(12*(f-e)+(h-g))+(d-b)}function J(a){var b=v.Convert,d=v._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),d=d._argumentExists(a,2)?b.toInt(a[2]):0;if(0>d||4<d)return v.Errors.Number;a=e;var b=f,e=v.Convert,g=V._FinancialHelper,f=g.days_between_basis(a,b,d);if(0>f){var h,f=-f;h=a;a=b;b=h}if(1===d){g=a.getFullYear();h=b.getFullYear();var k;k=a;k.setFullYear(k.getFullYear()+1);0<b-k?(d=h+1-g,k=new Date(g,0,1),a=new Date(h+1,0,1),b=ia._DateTimeHelper,a=e.toInt((new b(a)).toOADate()-
(new b(k)).toOADate())-365*(h+1-g)):(d=1,a=z(g)&&3>a.getMonth()||z(h)&&541<=256*b.getMonth()+b.getDate()?1:0);e=365+e.toDouble(a)/e.toDouble(d)}else e=g.annual_year_basis(new Date,d);return f/e}function K(){return[function(a,b){return b.getFullYear()-a.getFullYear()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?-1:0)},function(a,b){return 12*(b.getFullYear()-a.getFullYear())+(b.getMonth()-a.getMonth())+(b.getDate()<a.getDate()?-1:0)},function(a,b){return(b.getTime()-
a.getTime())/864E5},function(a,b){var d=new Date(b.getFullYear(),b.getMonth()+b.getDate()<a.getDate()?-1:0,a.getDate());return(b.getTime()-d.getTime())/864E5},function(a,b){return b.getMonth()-a.getMonth()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?12:0)+(b.getDate()<a.getDate()?-1:0)},function(a,b){var d=new Date(b.getFullYear()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?-1:0),a.getMonth(),a.getDate());return(b-d)/864E5}]}
function A(a){var b=a.toString(),d="";0>a&&(b=b.substr(1),d="-");b=b.split(".");if(1>b.length||2<b.length)return v.Errors.Value;a=[];2===b.length&&(a.push(b[1]),a.push("."));for(var b=b[0],e=b.length-1-2;0<=e;e-=3)a.push(b.substr(e,3)),0<e&&a.push(",");a.push(b.substring(0,e+3));a.reverse();return d+a.join("")}function L(a,b){if(v.Convert.isError(a))b.value=!0;else if(typeof a===M){var d=v.Error.parse(a);b.value=void 0!==d&&null!==d}b.value=!1}function D(a,b){if(v.Convert.isError(a)&&a._code!==v.Errors.NotAvailable._code)b.value=
!0;else if(typeof a===M){var d=v.Error.parse(a);b.value=void 0!==d&&null!==d&&d!==v.Errors.NotAvailable}b.value=!1}function w(a){if(void 0===a||null===a)throw T;if(1>a.length||1<a.length)throw T;}var M="string",T="Invalid arguments",P=p.GrapeCity;"undefined"===typeof P&&(P=p.GrapeCity={});"undefined"===typeof P.UI&&(P.UI={});var ia=P.UI;"undefined"===typeof P.Calc&&(P.Calc={});var v=P.Calc;"undefined"===typeof v.Functions&&(v.Functions={});var V=v.Functions;V._builtInFunctions=V._builtInFunctions||
{};"undefined"===typeof V._defineBuildInFunction&&(V._defineBuildInFunction=function(a,b,d){if(void 0===a||null===a)throw"Invalid function name";var e;a=a.toUpperCase();if(V._builtInFunctions.hasOwnProperty(a))if(e=V._builtInFunctions[a],!e)V._builtInFunctions[a]=new V.Function(a,0,255),e=V[a.toUpperCase()];else{if(!d||!d.override)throw"Attempt to override function while override is not allowed";}else e=new V.Function(a,0,255),V._builtInFunctions[a]=e;b&&"function"===typeof b&&(e.evaluate=b);if(d)for(var f in d)d.hasOwnProperty(f)&&
"override"!==f&&(e[f]=d[f]);return e});var N=V._defineBuildInFunction,R=[/\\/g,/\(/g,/\[/g,/\{/g,/\^/g,/\$/g,/\|/g,/\)/g,/\+/g,/\./g],ga={log:function(a,b){return isNaN(a)?a:isNaN(b)?b:1!==b&&1===a||0!==b&&b!==Number.POSITIVE_INFINITY?Math.log(a)/Math.log(b):NaN},log10:function(a){return ga.log(a,10)}};V._DateTimeHelper={days360:ka,yearfrac:J};V._MathHelper=function(){function a(b){var d=Math.floor(b);return V._MathHelper.approxEqual(b,d+1)?d+1:d}function b(a){var d=Math.ceil(a);return V._MathHelper.approxEqual(a,
d-1)?d-1:d}function d(a){var b=Array(17);b[0]=1;b[1]=10;b[2]=100;b[3]=1E3;b[4]=1E4;b[5]=1E5;b[6]=1E6;b[7]=1E7;b[8]=1E8;b[9]=1E9;b[10]=1E10;b[11]=1E11;b[12]=1E12;b[13]=1E13;b[14]=1E14;b[15]=1E15;b[16]=1E16;b=b[a];return void 0!==b&&null!==b?b:Math.pow(10,parseFloat(a))}function e(a,b){var d,f;switch(a){case 0:d=function(a,b){return a<=b};f=function(a,b){return a<=b};break;case 1:d=function(a,b){return a>=b};f=function(a,b){return a>=b};break;case 2:d=function(a,b){return a!==b};f=function(a,b){return a!==
b};break;case 3:d=function(a,b){return a<b};f=function(a,b){return a<b};break;case 4:d=function(a,b){return a===b};f=function(a,b){return a===b};break;case 5:d=function(a,b){return a>b};f=function(a,b){return a>b};break;default:return function(a){return!1}}var g=-1,h=!0;try{void 0===b||null===b?g=0:isNaN(g=v.Convert.toDouble(b.toString()))&&(h=!1)}catch(k){h=!1}return function(a){if(void 0===a||null===a)return!1;if(h){var e=-1;try{if(!isNaN(e=v.Convert.toDouble(a)))return f(e,g)}catch(k){}}return d(a.toString().toUpperCase(),
void 0!==b&&null!==b?b.toString().toUpperCase():"")}}function f(a){return Math.log(1+a)-(1+a-1-a)/(1+a)}return{approxFloor:a,approxCeiling:b,approxEqual:function(a,b){return a===b?!0:Math.abs(a-b)<Math.abs(a)/281474976710656},pow10:d,parseCriteria:function(a){if(v.Convert.isNumber(a))return e(4,a);for(var b=void 0!==a&&null!==a?a.toString().toUpperCase():"",d="\x00",f=0;2>f&&f<b.length;f++){var g=b[f];if(-1!=="=><".indexOf(g))if("="===g)switch(d){case "<":return e(0,b.substring(2));case ">":return e(1,
b.substring(2));default:return e(4,"\x00"===d?b.substring(1):a)}else if("\x00"===d)d=g;else{if("<"===d)return">"===g?e(2,b.substring(2)):e(3,b.substring(1));if(">"===d)return e(5,b.substring(1))}else switch(d){case "<":return e(3,b.substring(1));case ">":return e(5,b.substring(1))}}return e(4,a)},round:function(e,f){if(isNaN(e))return v.Errors.Value;var g=d(Math.abs(f));e=0>f?e/g:e*g;e=0>e?b(e-0.5):a(e+0.5);return v.Convert.toResult(0>f?e*g:e/g)},combin:function(a,b){if(isNaN(a)||isNaN(b))return v.Errors.Value;
if(0>a||0>b||a<b)return v.Errors.Number;var d=1;b=Math.min(a-b,b);for(var e=1;e<=b;e++)d*=a-e+1,d/=e;return v.Convert.toResult(d)},log10:ga.log10,log:ga.log,pow1p:function(a,b){var d;d=0.5<Math.abs(a)?Math.pow(1+a,b):Math.exp(b*f(a));isFinite(d)?isNaN(d)&&(d=4.9E-324):d===Number.POSITIVE_INFINITY?d=1.79769E308:d===Number.NEGATIVE_INFINITY&&(d=-1.79769E308);return d},log1p:f,cosh:function(a){return(Math.exp(a)+Math.exp(-a))/2},sinh:function(a){return(Math.exp(a)-Math.exp(-a))/2}}}();N("ABS",function(a){var b,
d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:d.toResult(Math.abs(b))},{minArgs:1,maxArgs:1});N("ACOS",function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:-1>b||1<b?v.Errors.Number:d.toResult(Math.acos(b))},{minArgs:1,maxArgs:1});N("ASIN",function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:-1>b||1<b?v.Errors.Number:d.toResult(Math.asin(b))},{minArgs:1,maxArgs:1});N("ATAN",function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?
v.Errors.Value:d.toResult(Math.atan(b))},{minArgs:1,maxArgs:1});N("ATAN2",function(a){var b,d,e=v.Convert;return isNaN(b=e.toDouble(a[0]))||isNaN(d=e.toDouble(a[1]))?v.Errors.Value:0===b&&0===d?v.Errors.DivideByZero:e.toResult(Math.atan2(d,b))},{minArgs:2,maxArgs:2});N("COS",function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:d.toResult(Math.cos(b))},{minArgs:1,maxArgs:1});N("CEILING",function(a){var b=v.Convert,d=b.toDouble(a[0]);a=b.toDouble(a[1]);return isNaN(d)||isNaN(a)?
v.Errors.Value:0===d||0===a?0:0<d&&0>a?v.Errors.Number:0>d&&0<a?(a=-a,V._MathHelper.approxFloor(d/a)*a):V._MathHelper.approxCeiling(d/a)*a},{minArgs:2,maxArgs:2});N("ODD",function(a){a=parseFloat(a[0]);0>a?(a=Math.floor(a),0===a%2&&(a-=1)):(a=Math.ceil(a),0===a%2&&(a+=1));return a},{minArgs:1,maxArgs:1});N("EVEN",function(a){a=parseFloat(a[0]);0>a?(a=Math.floor(a),0!==a%2&&(a-=1)):(a=Math.ceil(a),0!==a%2&&(a+=1));return a},{minArgs:1,maxArgs:1});N("FLOOR",function(a){var b=v.Convert,d=b.toDouble(a[0]);
a=b.toDouble(a[1]);if(isNaN(d)||isNaN(a))return v.Errors.Value;if(0===d||0===a)return 0;if(0<d&&0>a)return v.Errors.Number;b=V._MathHelper;return 0>d&&0<a?(a=-a,b.approxCeiling(d/a)*a):b.approxFloor(d/a)*a},{minArgs:2,maxArgs:2});N("LN",function(a){a=parseFloat(a[0]);return void 0===a||null===a?v.Errors.Value:0>=a?v.Errors.Number:v.Convert.toResult(Math.log(a))},{minArgs:1,maxArgs:1});N("SQRT",function(a){a=parseFloat(a[0]);return 0<=a?Math.sqrt(a):v.Errors.Number},{minArgs:1,maxArgs:1});N("SIN",
function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:d.toResult(Math.sin(b))},{minArgs:1,maxArgs:1});N("TAN",function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:d.toResult(Math.tan(b))},{minArgs:1,maxArgs:1});N("SIGN",function(a){a=parseFloat(a[0]);return 0<a?1:0===a?0:-1},{minArgs:1,maxArgs:1});N("GCD",function(a){for(var b=0,d=a.length,e=v.Convert,f=v._ArrayHelper,g=0;g<d;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g]))for(var h=
f.getLength(a[g]),k=0;k<h;k++){var l=f.getValueByIndex(a[g],k);if(e.isError(l))return l;l=e.toInt(l);if(0>l)return v.Errors.Number;b=n(b,l)}else{h=e.toInt(a[g]);if(0>h)return v.Errors.Number;b=n(b,h)}}return b},{minArgs:1,acceptsReference:m,acceptsArray:m});N("LCM",function(a){for(var b=1,d=[],e=v.Convert,f=v._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g]))for(var h=0;h<f.getLength(a[g]);h++){var k=f.getValueByIndex(a[g],h);if(e.isError(k))return k;d.push(e.toInt(k))}else d.push(e.toInt(a[g]));
for(h=0;h<d.length;h++){k=d[h];if(0>k)return v.Errors.Number;if(0===k)return 0;b/=n(b,k);b*=k}}return b},{minArgs:1,acceptsReference:m,acceptsArray:m});N("PRODUCT",function(a){return h(a,!0)},{minArgs:1,acceptsReference:m,acceptsArray:m});N("POWER",function(a){var b=parseFloat(a[0]);a=parseFloat(a[1]);return Math.pow(b,a)},{minArgs:2,maxArgs:2});N("MOD",function(a){var b=parseFloat(a[0]);a=parseFloat(a[1]);return 0===a?"DivideByZero":b-a*Math.floor(b/a)},{minArgs:2,maxArgs:2});N("QUOTIENT",function(a){var b=
v.Convert;if(b.isError(a[0]))return a[0];if(b.isError(a[1]))return a[1];var d=b.toDouble(a[0]);a=b.toDouble(a[1]);return isNaN(d)||isNaN(a)?v.Errors.Value:0===a?v.Errors.DivideByZero:parseInt(d/a,10)},{minArgs:2,maxArgs:2});N("SUBTOTAL",function(a){for(var b=v.Convert.toInt(a[0]),d=[],e=1;e<a.length;e++)d[e-1]=a[e];a=V.StatHelper;if(1===b||101===b)return a.__averageIncludeSubtotals(d,!1);if(2===b||102===b)return a.__countIncludeSubtotals(d,!1);if(3===b||103===b)return a.__countaIncludeSubtotals(d,
!1);if(4===b||104===b)return a.__maxIncludeSubtotals(d,!1);if(5===b||105===b)return a.__minIncludeSubtotals(d,!1);if(6===b||106===b)return h(d,!1);if(7===b||107===b)return a.__stdevIncludeSubtotals(d,!1);if(8===b||108===b)return a.__stdevpIncludeSubtotals(d,!1);if(9===b||109===b){if(!d||1>d.length)throw T;b={value:0,includeSubtotal:!1};for(a=0;a<d.length&&!1!==t(d[a],u,b);a++);return b.value}return 10===b||110===b?a.__varrIncludeSubtotals(d,!1):11===b||111===b?a.__varpIncludeSubtotals(d,!1):v.Errors.Value},
{minArgs:2,acceptsReference:k,acceptsArray:k});N("INT",function(a){a=parseFloat(a[0]);return void 0===a||null===a?v.Errors.Value:V._MathHelper.approxFloor(a)},{minArgs:1,maxArgs:1});N("MROUND",function(a){var b=v.Convert,d=b.toDouble(a[0]);a=b.toDouble(a[1]);return isNaN(d)||isNaN(a)?v.Errors.Value:0===d||0===a?0:0>d&&0<a||0>a&&0<d?v.Errors.Number:V._MathHelper.approxFloor(d/a+0.5)*a},{minArgs:2,maxArgs:2});N("ROUND",I,{minArgs:2,maxArgs:2});N("ROUNDDOWN",function(a){var b=v.Convert,d=b.toDouble(a[0]);
if(isNaN(d))return v.Errors.Value;a=b.toInt(a[1]);var e=V._MathHelper,f=e.pow10(Math.abs(a)),d=0>a?d/f:d*f,d=0>d?e.approxCeiling(d):e.approxFloor(d);return b.toResult(0>a?d*f:d/f)},{minArgs:2,maxArgs:2});N("ROUNDUP",function(a){var b=v.Convert,d=b.toDouble(a[0]);if(isNaN(d))return v.Errors.Value;a=b.toInt(a[1]);var e=V._MathHelper,f=e.pow10(Math.abs(a)),d=0>a?d/f:d*f,d=0>d?e.approxFloor(d):e.approxCeiling(d);return b.toResult(0>a?d*f:d/f)},{minArgs:2,maxArgs:2});N("TRUNC",function(a){var b=v.Convert,
d=b.toDouble(a[0]);if(isNaN(d))return v.Errors.Value;a=v._Helper._argumentExists(a,1)?b.toInt(a[1]):0;var e=V._MathHelper,f=e.pow10(Math.abs(a)),d=0>a?d/f:d*f,d=0>d?e.approxCeiling(d):e.approxFloor(d);return b.toResult(0>a?d*f:d/f)},{minArgs:1,maxArgs:2,acceptsMissingArgument:g});N("EXP",function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:d.toResult(Math.exp(b))},{minArgs:1,maxArgs:1});N("LOG",function(a){var b=v.Convert,d=b.toDouble(a[0]);if(isNaN(d))return v.Errors.Value;
if(v._Helper._argumentExists(a,1)){if(a=b.toDouble(a[1]),isNaN(a))return v.Errors.Value}else a=10;return 0>=d||0>=a?v.Errors.Number:1===a?v.Errors.DivideByZero:b.toResult(ga.log(d,a))},{minArgs:1,maxArgs:2,acceptsMissingArgument:g});N("LOG10",function(a){var b=v.Convert;a=b.toDouble(a[0]);return isNaN(a)?v.Errors.Value:0>=a?v.Errors.Number:b.toResult(ga.log10(a))},{minArgs:1,maxArgs:1});N("SUM",function(a){if(!a||1>a.length)throw T;for(var b={value:0,includeSubtotal:!0},d=0;d<a.length&&!1!==t(a[d],
u,b);d++);return b.value},{minArgs:1,acceptsReference:m,acceptsArray:m});N("SUMIF",function(a){var b=a[0],d=a[1];if(void 0===d||null===d)throw"criteria";var e=v._Helper._argumentExists(a,2)?a[2]:a[0],f=v.Convert,g=a[1];if(f._isCalcReference(g))return d=g.getRowCount(0),f=g.getColumnCount(0),1===d&&1===f?E(g.getValue(0,0,0),b,e):new v._TernaryCompositeConcreteReference(g.getSource(),g.getRow(0),g.getColumn(0),d,f,E,b,e);g=a[1];if(f._isCalcArray(g)){d=g.getRowCount();f=g.getColumnCount();a=new v._ConcreteArray(g,
f);for(var h=0;h<d;h++)for(var k=0;k<f;k++)a._value[h][k]=E(g.getValue(h,k),b,e);return a}return E(d,b,e)},{minArgs:2,maxArgs:3,acceptsMissingArgument:a,acceptsReference:d,acceptsArray:d});N("SUMIFS",function(a){var b;a:if(3>a.length||1!==a.length%2)b=!1;else{b=P.Calc._ArrayHelper.getRowCount(a[0]);for(var d=P.Calc._ArrayHelper.getColumnCount(a[0]),e=1;e<a.length;e+=2)if(b!==P.Calc._ArrayHelper.getRowCount(a[e])||d!==P.Calc._ArrayHelper.getColumnCount(a[e])){b=!1;break a}b=!0}if(!b)return v.Errors.Value;
b=0;for(var d=a[0],e=v.Convert,f=v._ArrayHelper,g=f.getLength(a[0]),h=0;h<g;h++){for(var k=!0,l=1;l<a.length;l+=2){var n=a[l],k=V._MathHelper.parseCriteria(a[l+1]),n=f.getValueByIndex(n,h),k=k&&k(n);if(!k)break}if(k)if(l=f.getValueByIndex(d,h),e.isNumber(l))b+=e.toDouble(l);else if(e.isError(l))return l}return e.toResult(b)},{minArgs:3,acceptsReference:e,acceptsArray:e});N("SUMPRODUCT",function(a){for(var b=0,d=v.Convert,e=v._ArrayHelper,f=e.getRowCount(a[0]),g=e.getColumnCount(a[0]),h=1;h<a.length;h++)if(f!==
e.getRowCount(a[h])||g!==e.getColumnCount(a[h]))return v.Errors.Value;for(h=0;h<f;h++)for(var k=0;k<g;k++){for(var l=1,n=0;n<a.length;n++){var m=e.getValue(a[n],h,k);if(d.isError(m))return m;l=d.isNumber(m)?l*d.toDouble(m):0}b+=l}return d.toResult(b)},{minArgs:1,acceptsReference:m,acceptsArray:m});N("SUMSQ",function(a){for(var b,d=0,e=v.Convert,f=v._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g]))for(var h=0;h<f.getLength(a[g]);h++)if(b=f.getValueByIndex(a[g],
h),e.isNumber(b))b=e.toDouble(b),d+=b*b;else{if(e.isError(b))return b}else{if(isNaN(b=e.toDouble(a[g])))return v.Errors.Value;d+=b*b}}return e.toResult(d)},{minArgs:1,acceptsReference:m,acceptsArray:m});N("SUMX2MY2",function(a){var b=0,d,e,f=v.Convert,g=v._ArrayHelper;if(g.getLength(a[0])!==g.getLength(a[1]))return v.Errors.NotAvailable;if(f.isError(a[0]))return a[0];if(f.isError(a[1]))return a[1];if(g.isArrayOrReference(a[0]))for(var h=0;h<g.getLength(a[0]);h++)if(d=g.getValueByIndex(a[0],h),e=g.getValueByIndex(a[1],
h),f.isNumber(d)&&f.isNumber(e))d=f.toDouble(d),e=f.toDouble(e),b+=d*d-e*e;else{if(f.isError(d))return d;if(f.isError(e))return e}else{if(isNaN(d=f.toDouble(a[0]))||isNaN(e=f.toDouble(a[1])))return v.Errors.Value;b+=d*d-e*e}return b},{minArgs:2,maxArgs:2,acceptsReference:m,acceptsArray:m});N("SUMX2PY2",function(a){var b=0,d,e,f=v.Convert,g=v._ArrayHelper;if(g.getLength(a[0])!==g.getLength(a[1]))return v.Errors.NotAvailable;if(f.isError(a[0]))return a[0];if(f.isError(a[1]))return a[1];if(g.isArrayOrReference(a[0]))for(var h=
0;h<g.getLength(a[0]);h++)if(d=g.getValueByIndex(a[0],h),e=g.getValueByIndex(a[1],h),f.isNumber(d)&&f.isNumber(e))d=f.toDouble(d),e=f.toDouble(e),b+=d*d+e*e;else{if(f.isError(d))return d;if(f.isError(e))return e}else{if(isNaN(d=f.toDouble(a[0]))||isNaN(e=f.toDouble(a[1])))return v.Errors.Value;b+=d*d+e*e}return f.toResult(b)},{minArgs:2,maxArgs:2,acceptsReference:m,acceptsArray:m});N("SUMXMY2",function(a){var b=0,d,e,f=v.Convert,g=v._ArrayHelper;if(g.getLength(a[0])!==g.getLength(a[1]))return v.Errors.NotAvailable;
if(f.isError(a[0]))return a[0];if(f.isError(a[1]))return a[1];if(g.isArrayOrReference(a[0]))for(var h=0;h<g.getLength(a[0]);h++)if(d=g.getValueByIndex(a[0],h),e=g.getValueByIndex(a[1],h),f.isNumber(d)&&f.isNumber(e))d=f.toDouble(d),e=f.toDouble(e),b+=(d-e)*(d-e);else{if(f.isError(d))return d;if(f.isError(e))return e}else{if(isNaN(d=f.toDouble(a[0]))||isNaN(e=f.toDouble(a[1])))return v.Errors.Value;b+=(d-e)*(d-e)}return f.toResult(b)},{minArgs:2,maxArgs:2,acceptsReference:m,acceptsArray:m});N("SERIESSUM",
function(a){var b,d,e,f=v.Convert,g=v._ArrayHelper;if(isNaN(b=f.toDouble(a[0]))||isNaN(e=f.toInt(a[1]))||isNaN(d=f.toInt(a[2])))return v.Errors.Value;a=a[3];for(var h=0,k=0;k<g.getLength(a);k++){var l;if(isNaN(l=f.toDouble(g.getValueByIndex(a,k))))return v.Errors.Value;h+=l*Math.pow(b,e+k*d)}return f.toResult(h)},{minArgs:4,maxArgs:4,acceptsReference:b,acceptsArray:b});N("PI",function(a){return Math.PI},{minArgs:0,maxArgs:0});N("SQRTPI",function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?
v.Errors.Value:0>b?v.Errors.Number:d.toResult(Math.sqrt(b*Math.PI))},{minArgs:1,maxArgs:1});N("DEGREES",function(a){var b;return isNaN(b=parseFloat(a[0]))?v.Errors.Value:180*b/Math.PI},{minArgs:1,maxArgs:1});N("RADIANS",function(a){var b;return isNaN(b=v.Convert.toDouble(a[0]))?v.Errors.Value:Math.PI*b/180},{minArgs:1,maxArgs:1});N("COSH",function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:d.toResult((Math.exp(b)+Math.exp(-b))/2)},{minArgs:1,maxArgs:1});N("ACOSH",function(a){var b,
d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:1>b?v.Errors.Number:d.toResult(Math.log(b+Math.sqrt(b*b-1)))},{minArgs:1,maxArgs:1});N("SINH",function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:d.toResult((Math.exp(b)-Math.exp(-b))/2)},{minArgs:1,maxArgs:1});N("ASINH",function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:d.toResult(Math.log(b+Math.sqrt(b*b+1)))},{minArgs:1,maxArgs:1});N("TANH",function(a){var b,d=v.Convert;if(isNaN(b=d.toDouble(a[0])))return v.Errors.Value;
a=Math.exp(b);b=Math.exp(-b);return d.toResult(a-b)/(a+b)},{minArgs:1,maxArgs:1});N("ATANH",function(a){var b,d=v.Convert;return isNaN(b=d.toDouble(a[0]))?v.Errors.Value:-1>=b||1<=b?v.Errors.Number:d.toResult(Math.log((1+b)/(1-b))/2)},{minArgs:1,maxArgs:1});N("MDETERM",function(a){var b=v.Convert,d=b._toArray(a[0]);if(d.getRowCount()!==d.getColumnCount())return v.Errors.Value;a=d.getRowCount();for(var e=[],f=0;f<a;f++){e[f]=[a];for(var g=0;g<a;g++){var h=d.getValue(f,g);if(b.isError(h))return h;if(!b.isNumber(h))return v.Errors.Value;
e[f][g]=b.toDouble(h)}}b=1;for(d=0;d<a-1;d++){if(0===e[d][d]){g=!1;for(f=d+1;!g&&f<a;f++)if(0!==e[f][d]){for(g=d;g<a;g++)h=e[d][g],e[d][g]=e[f][g],e[f][g]=h;b*=-1;g=!0}if(!g)return 0}for(f=d+1;f<a;f++)if(0!==e[f][d])for(g=e[f][d]/e[d][d],h=d;h<a;h++)e[f][h]-=g*e[d][h]}for(d=0;d<a;d++)b*=e[d][d];return b},{minArgs:1,maxArgs:1,acceptsArray:m,acceptsReference:m});N("MINVERSE",function(a){var b=v.Convert,d=b._toArray(a[0]);if(d.getRowCount()!==d.getColumnCount())return v.Errors.Value;a=d.getRowCount();
for(var e=[],f=[],g=0;g<a;g++){e[g]=[a];for(var h=0;h<a;h++){var k=d.getValue(g,h);if(b.isError(k))return k;if(!b.isNumber(k))return v.Errors.Value;e[g][h]=b.toDouble(k)}}for(b=0;b<a;b++)for(f[b]=[a],d=0;d<a;d++)f[b][d]=b===d?1:0;for(b=0;b<a;b++){if(0===e[b][b]){g=!1;for(d=b+1;!g&&d<a;d++)if(0!==e[d][b]){for(g=b;g<a;g++)h=e[b][g],e[b][g]=e[d][g],e[d][g]=h;for(g=1;g<a;g++)h=f[b][g],f[b][g]=f[d][g],f[d][g]=h;g=!0}if(!g)return v.Errors.Number}for(d=0;d<a;d++)if(d!==b&&0!==e[d][b]){g=e[d][b]/e[b][b];
for(h=b;h<a;h++)e[d][h]-=g*e[b][h];for(h=0;h<a;h++)f[d][h]-=g*f[b][h]}}for(b=0;b<a;b++)for(d=e[b][b],g=0;g<a;g++)f[b][g]/=d;return new v._ConcreteArray(f)},{minArgs:1,maxArgs:1,acceptsArray:m,acceptsReference:m});N("MMULT",function(a){var b=v.Convert,d=b._toArray(a[0]),e=b._toArray(a[1]);a=d.getRowCount();var f=d.getColumnCount(),g=e.getRowCount(),h=e.getColumnCount();if(f!==g)return v.Errors.Value;for(var k=[],l=[],n=[],m=0;m<a;m++){k[m]=[f];for(var q=0;q<f;q++){var r=d.getValue(m,q);if(b.isError(r))return r;
if(!b.isNumber(r))return v.Errors.Value;k[m][q]=b.toDouble(r)}}for(d=0;d<g;d++)for(l[d]=[h],f=0;f<h;f++){m=e.getValue(d,f);if(b.isError(m))return m;if(!b.isNumber(m))return v.Errors.Value;l[d][f]=b.toDouble(m)}for(b=0;b<a;b++)for(n[b]=[h],e=0;e<h;e++){for(f=d=0;f<g;f++)d+=k[b][f]*l[f][e];n[b][e]=d}return new v._ConcreteArray(n)},{minArgs:2,maxArgs:2,acceptsArray:m,acceptsReference:m});N("FACT",function(a){a=parseInt(a[0],10);var b=1;if(isNaN(a))return v.Errors.Value;if(0>a||170<a)return v.Errors.Number;
for(var d=1;d<=a;d++)b*=d;return b},{minArgs:1,maxArgs:1});N("FACTDOUBLE",function(a){var b=parseInt(a[0],10);a=1;if(isNaN(b))return v.Errors.Value;if(0>b||300<b)return v.Errors.Number;for(;1<b;b-=2)a*=b;return a},{minArgs:1,maxArgs:1});N("MULTINOMIAL",function(a){for(var b=0,d=1,e=v.Convert,f=v._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g]))for(var h=0;h<f.getLength(a[g]);h++){var k=f.getValueByIndex(a[g],h);if(e.isError(k))return k;k=e.toInt(k);if(0>
k||170<k)return v.Errors.Number;b+=k;d*=O(k)}else{h=e.toInt(a[g]);if(0>h||170<h)return v.Errors.Number;b+=h;d*=O(h)}}return 0>b||170<b?v.Errors.Number:O(b)/d},{minArgs:1,acceptsArray:m,acceptsReference:m});N("RAND",function(a){a=-1+2*Math.random();return Math.abs(a)},{minArgs:0,maxArgs:0,isVolatile:f});N("RANDBETWEEN",function(a){var b=v.Convert;if(b.isError(a[1]))return a[1];if(b.isError(a[0]))return a[0];var d,e;if(isNaN(d=b.toInt(a[0]))||isNaN(e=b.toInt(a[1])))return v.Errors.Value;if(e<d)return v.Errors.Number;
a=Math.random();return b.toInt(d+a*(e-d+1))},{minArgs:2,maxArgs:2,isVolatile:f});N("COMBIN",function(a){var b=parseFloat(a[0]);a=parseFloat(a[1]);if(isNaN(b)||isNaN(a))return v.Errors.Value;if(0>b||0>a||b<a)return v.Errors.Number;var d=1;a=Math.min(b-a,a);for(var e=1;e<=a;e++)d*=b-e+1,d/=e;return v.Convert.toResult(d)},{minArgs:2,maxArgs:2});N("ROMAN",function(a){var b=v.Convert,d=v._Helper;if(b.isError(a[0]))return a[0];var e=b.toInt(a[0]),f=0;if(d._argumentExists(a,1)){if(b.isError(a[1]))return a[1];
f="boolean"===typeof a[1]?a[1]?0:4:b.toInt(a[1])}a=[];if(0>e||3999<e||0>f||4<f)return v.Errors.Value;b=[];b.push(new r("M",1E3));b.push(new r("D",500));b.push(new r("C",100));b.push(new r("L",50));b.push(new r("X",10));b.push(new r("V",5));b.push(new r("I",1));for(d=0;d<b.length;d+=2){if(2<=d&&b[d-2].Value-b[d].Value<=e){for(var g=d,h=d-2,k=0;k<f&&g+1<b.length&&b[h].Value-b[g+1].Value<=e;k++)g++;a.push(b[g].Key);a.push(b[h].Key);e+=b[g].Value;e-=b[h].Value}1<=d&&b[d-1].Value<=e&&(a.push(b[d-1].Key),
e-=b[d-1].Value);if(1<=d&&b[d-1].Value-b[d].Value<=e){g=d;h=d-1;for(k=0;k<f&&g+1<b.length&&b[h].Value-b[g+1].Value<=e;k++)g++;a.push(b[g].Key);a.push(b[h].Key);e+=b[g].Value;e-=b[h].Value}for(;b[d].Value<=e;)a.push(b[d].Key),e-=b[d].Value}return a.join("")},{minArgs:1,maxArgs:2,acceptsMissingArgument:g});N("AND",function(a){for(var b=!0,d=v.Convert,e=v._ArrayHelper,f=0;f<a.length;f++)for(var g=a[f],h=0;h<e.getLength(g);h++){var k=e.getValueByIndex(g,h);if(void 0!==k&&null!==k){var l;try{l=d.toBool(k)}catch(n){return v.Errors.Value}b&=
l}else return!1}return!!b},{minArgs:1,acceptsReference:m,acceptsArray:m});N("OR",function(a){for(var b=!1,d=v.Convert,e=v._ArrayHelper,f=0;f<a.length;f++)for(var g=a[f],h=0;h<e.getLength(g);h++){var k=e.getValueByIndex(g,h);if(void 0!==k&&null!==k){var l;try{l=d.toBool(k)}catch(n){return v.Errors.Value}b|=l}}return!!b},{minArgs:1,acceptsReference:m,acceptsArray:m});N("NOT",function(a){var b=v.Convert;if(b._isCalcReference(a[0]))return 1<a[0].getRangeCount()?v.Errors.Value:new v._UnaryCompositeConcreteReference(a[0].getSource(),
a[0].getRow(0),a[0].getColumn(0),a[0].getRowCount(0),a[0].getColumnCount(0),H);if(b._isCalcArray(a[0])){for(var b=[],d=a[0].getRowCount(),e=a[0].getColumnCount(),f=0;f<d;f++){b[f]=[e];for(var g=0;g<e;g++)b[f][g]=H(a[0].getValue(f,g))}return new v._ConcreteArray(b)}return H(a[0])},{minArgs:1,maxArgs:1});N("IF",function(a){var b=a[0],d=a[1],e=v._Helper;a=e._argumentExists(a,2)?a[2]:!1;var f=e.tryExtractToSingleValue(b);if(f.success)return b=f.value,C(b,d,a);var f=e.tryExtractToSingleValue(d),d=f.value,
g=f.success,f=e.tryExtractToSingleValue(a);a=f.value;for(var f=f.success,h=b.getRowCount(),k=b.getColumnCount(),l=[],n=0;n<h;n++){l[n]=[k];for(var m=0;m<k;m++)l[n][m]=C(b.getValue(n,m),g?d:e.getArrayValue(d,n,m),f?a:e.getArrayValue(a,n,m))}return new v._ConcreteArray(l)},{minArgs:2,maxArgs:3,acceptsReference:s,acceptsArray:s,acceptsError:s,acceptsMissingArgument:a,isBranch:function(){return!0},findTestArgument:function(){return 0},findBranchArgument:function(a){var b=v.Convert;if(b.isError(a))return-1;
var d=!1;try{d=b.toBool(a)}catch(e){}return d?1:2}});N("IFERROR",function(a){var b=v.Convert,d=b.isError(a[0]);return!d&&b._isCalcReference(a[0])?(b=a[0],1<b.getRangeCount()?v.Errors.Value:new v._BinaryCompositeConcreteReference(b.getSource(),b.getRow(0),b.getColumn(0),b.getRowCount(0),b.getColumnCount(0),G,a[1])):d?void 0!==a[1]&&null!==a[1]?a[1]:0:void 0!==a[0]&&null!==a[0]?a[0]:0},{minArgs:2,maxArgs:2,acceptsReference:q,acceptsError:q});N("TRUE",function(a){return!0},{minArgs:0,maxArgs:0});N("FALSE",
function(a){return!1},{minArgs:0,maxArgs:0});N("DATE",function(a){try{var b=v.Convert,d,e,f;if(isNaN(d=b.toInt(a[0]))||isNaN(e=b.toInt(a[1]))||isNaN(f=b.toInt(a[2])))return v.Errors.Value;if(0>d||9999<d)return v.Errors.Number;1899>=d&&(d+=1900);var g=new Date(d,e-1,f);return g<new Date(1899,11,30)?v.Errors.Number:g}catch(h){return v.Errors.Number}},{minArgs:3,maxArgs:3});N("TIME",function(a){var b,d,e;try{var f=v.Convert;if(isNaN(b=f.toInt(a[0]))||isNaN(d=f.toInt(a[1]))||isNaN(e=f.toInt(a[2])))return v.Errors.Value;
var g=P.UI._DateTimeHelper.fromOADate(0);g.setHours(b);g.setMinutes(d);g.setSeconds(e);g.setMilliseconds(0);return 0>g.getHours()&&0>g.getMinutes()&&0>g.getSeconds()?v.Errors.Number:g}catch(h){return v.Errors.Number}},{minArgs:3,maxArgs:3});N("DATEVALUE",function(a){a=v.Convert.toString(a[0]);if(void 0===a||null===a||""===a)return v.Errors.Value;try{var b=ia._DateTimeHelper.parseLocale(a),d=b.getFullYear();if(1900>d)return v.Errors.Value;var e=b.getMonth(),f=b.getDate(),b=0;for(a=1900;a<d;a++)b=z(a)?
b+366:b+365;for(a=0;a<e;a++)switch(a){case 0:case 2:case 4:case 6:case 7:case 9:case 11:b+=31;break;case 1:b=z(d)?b+29:b+28;break;case 3:case 5:case 8:case 10:b+=30}return b+f}catch(g){return v.Errors.Value}},{minArgs:1,maxArgs:1});N("TIMEVALUE",S,{minArgs:1,maxArgs:1});N("NOW",function(a){return new Date},{minArgs:0,maxArgs:0,isVolatile:f});N("TODAY",function(a){a=new Date;a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return a},{minArgs:0,maxArgs:0,isVolatile:f});N("HOUR",function(a){try{return v.Convert.toDateTime(a[0]).getHours()}catch(b){return v.Errors.Value}},
{minArgs:1,maxArgs:1});N("MINUTE",function(a){try{return v.Convert.toDateTime(a[0]).getMinutes()}catch(b){return v.Errors.Value}},{minArgs:1,maxArgs:1});N("SECOND",function(a){try{return v.Convert.toDateTime(a[0]).getSeconds()}catch(b){return v.Errors.Value}},{minArgs:1,maxArgs:1});N("DAY",function(a){try{return v.Convert.toDateTime(a[0]).getDate()}catch(b){return v.Errors.Value}},{minArgs:1,maxArgs:1});N("MONTH",function(a){try{return v.Convert.toDateTime(a[0]).getMonth()+1}catch(b){return v.Errors.Value}},
{minArgs:1,maxArgs:1});N("YEAR",function(a){try{return v.Convert.toDateTime(a[0]).getFullYear()}catch(b){return v.Errors.Value}},{minArgs:1,maxArgs:1});N("WEEKNUM",function(a){var b,d=v.Convert;try{b=d.toDateTime(a[0])}catch(e){return v.Errors.Value}if(isNaN(a=d.toInt(v._Helper._argumentExists(a,1)?a[1]:1)))return v.Errors.Value;switch(a){case 1:case 2:for(var d=b.getFullYear(),f=b.getMonth(),g=b.getDate(),h=0,k=0;k<f;k++)switch(k){case 0:case 2:case 4:case 6:case 7:case 9:case 11:h+=31;break;case 1:h=
z(d)?h+29:h+28;break;case 3:case 5:case 8:case 10:h+=30}d=h+g;b=(new Date(b.getFullYear(),0,1)).getDay();2===a&&(b-=1,0>b&&(b=6));a=d-1-(6-b);0>a&&(a=0);return 1+v.Convert.toInt(a/7)+(0!==a%7?1:0);default:return v.Errors.Number}},{minArgs:1,maxArgs:2,acceptsMissingArgument:g});N("WEEKDAY",Q,{minArgs:1,maxArgs:2,acceptsMissingArgument:g});N("EDATE",function(a){var b,d=v.Convert;try{b=d.toDateTime(a[0])}catch(e){return v.Errors.Value}if(isNaN(a=d.toInt(a[1])))return v.Errors.Value;b.setMonth(b.getMonth()+
a);return b},{minArgs:2,maxArgs:2});N("EOMONTH",function(a){var b,d=v.Convert;try{b=d.toDateTime(a[0])}catch(e){return v.Errors.Value}if(isNaN(a=d.toInt(a[1])))return v.Errors.Value;b.setMonth(b.getMonth()+a);a:{a=b.getFullYear();switch(b.getMonth()){case 0:case 2:case 4:case 6:case 7:case 9:case 11:a=31;break a;case 1:a=z(a)?29:28;break a;case 3:case 5:case 8:case 10:a=30;break a}a=void 0}b.setDate(a);return b},{minArgs:2,maxArgs:2});N("WORKDAY",function(a){for(var b=v.Convert,d=v._Helper,e=v._ArrayHelper,
f=b.toDateTime(a[0]),g=b.toInt(a[1]),h=d._argumentExists(a,2)?e.getLength(a[2]):0,d=[],k=0;k<h;k++)d.push(b.toDateTime(e.getValueByIndex(a[2],k)));a=[];a[0]=f;a[1]=3;a=Q(a);if(b.isError(a))return a;for(b=b.toInt(a);0>g;++g){try{f.setDate(f.getDate()-1)}catch(l){return v.Errors.Number}0===b?b=6:b--;5===b||6===b?g--:aa(d,f)&&g--}for(;0<g;--g){try{f.setDate(f.getDate()+1)}catch(n){return v.Errors.Number}6===b?b=0:b++;5===b||6===b?g++:aa(d,f)&&g++}return(new P.UI._DateTimeHelper(f)).toOADate()},{minArgs:2,
maxArgs:3,acceptsMissingArgument:a,acceptsArray:a,acceptsReference:a});N("DAYS360",ka,{minArgs:2,maxArgs:3,acceptsMissingArgument:a});N("NETWORKDAYS",function(a){var b=v.Convert,d=ia._DateTimeHelper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toInt((new d(e)).toOADate()),d=b.toInt((new d(f)).toOADate()),b=!1;g>d&&(b=e,e=g,g=d,d=e,e=f,f=b,b=!0);var h=e,e=d-g+1,k=v.Convert,l=ia._DateTimeHelper,f=k.toInt((new l(f)).toOADate()-(new l(h)).toOADate())%7,f=k.toInt(Q([h,2])+f),f=5<f?f-5:0,h=0===h.getDay()?
1:2,e=e-(f>h?h:f),f=k.toInt(2*(e/7)),f=e-f;if(0>=f)return 0;for(var e=v.Convert,k=v._ArrayHelper,h=v._Helper._argumentExists(a,2)?k.getLength(a[2]):0,l=[],n=0;n<h;n++){var m=e.toDateTime(k.getValueByIndex(a[2],n)),q=(new P.UI._DateTimeHelper(m)).toOADate();!aa(l,m)&&6!==m.getDay()&&0!==m.getDay()&&q>=g&&q<=d&&l.push(m)}f-=l.length;return f=b?-f:f},{minArgs:2,maxArgs:3,acceptsMissingArgument:a,acceptsArray:a,acceptsReference:a});N("YEARFRAC",J,{minArgs:2,maxArgs:3,acceptsMissingArgument:a});N("DATEDIF",
function(a){var b=v.Convert,d=b.toDateTime(a[0]),e=b.toDateTime(a[1]),b=b.toString(a[2]).toLocaleUpperCase();if(e<d)return v.Errors.Number;a=K();switch(b){case "Y":b=0;break;case "M":b=1;break;case "D":b=2;break;case "MD":b=3;break;case "YM":b=4;break;case "YD":b=5;break;default:throw"NotSupportException";}if(a=a[b])try{return a(d,e)}catch(f){return v.Errors.Value}return v.Errors.Number},{minArgs:3,maxArgs:3});N("CLEAN",function(a){a=v.Convert.toString(a[0]);for(var b=[],d=0;d<a.length;d++){var e=
a.charCodeAt(d);0<=e&&31>=e||127===e||128<=e&&159>=e||b.push(a[d])}return b.join("")},{minArgs:1,maxArgs:1});N("TRIM",function(a){a=v.Convert.toString(a[0]).trim();for(var b=[],d=!0,e=0;e<a.length;e++){var f=a.charAt(e);(" "!==f&&"\t"!==f&&"\n"!==f||d)&&b.push(f);d=!(" "===f||"\t"===f||"\n"===f)}return b.join("")},{minArgs:1,maxArgs:1});N("DOLLAR",function(a){var b,d=v.Convert,e=v._Helper;if(isNaN(b=d.toDouble(a[0])))return v.Errors.Value;a=e._argumentExists(a,1)?d.toInt(a[1]):2;if(99<a)return v.Errors.Value;
b=d.toDouble(I([b,a]));d=A(b);0>b&&(d=d.substr(1));a=[];a.push("$");a.push(d);0>b&&(a.push(")"),a.unshift("("));return a.join("")},{minArgs:1,maxArgs:2,acceptsMissingArgument:g});N("FIXED",function(a){var b,d=v.Convert,e=v._Helper;if(isNaN(b=d.toDouble(a[0])))return v.Errors.Value;var f=e._argumentExists(a,1)?d.toInt(a[1]):2;a=e._argumentExists(a,2)?d.toBool(a[2]):!1;var e=Array(2),g=0;0>f?(g=d.toInt(Math.pow(10,Math.abs(f))),e[0]=b/g,e[1]=0):(e[0]=b,e[1]=f);b=d.toDouble(I(e));0>f&&(b*=g);return a?
b.toString():A(b)},{minArgs:1,maxArgs:3,acceptsMissingArgument:s});N("TEXT",function(a){var b=a[0],d=v.Convert,e=ia._StandardDateTimeFormatter,f=ia._StandardNumberFormatter;a=v.Convert.toString(a[1]);if(""===a||null===a||void 0===a)return d.toString(b);if(null===b||void 0===b)b=0;d=a;if(-1!==d.indexOf("[")&&-1!==d.indexOf("]")){var g=d.indexOf("[");for(a=d.indexOf("]",g);-1!==g&&-1!==a;)g=d.substring(0,g-1),d=d.substring(a+1),d=g.concat(d),g=d.indexOf("["),a=-1===g?-1:d.indexOf("]",g)}a=d;try{var h=
new e(a);h.EvaluateFormat(a)||(h=new f(a),h.EvaluateFormat(a)||(h=new ia.GeneralFormatter(a)));return h.Format(b)}catch(k){return v.Errors.Value}},{minArgs:2,maxArgs:2});N("VALUE",function(a){var b=v.Convert,d=ia._DateTimeHelper,e=b.toString(a[0]);a=d.parseLocale(e);if(void 0!==a&&null!==a)return d=(new d(a)).toOADate(),b.isError(d)?S([a]):d;var f;return isNaN(f=parseFloat(e))?v.Errors.Value:f},{minArgs:1,maxArgs:1});N("LOWER",function(a){return v.Convert.toString(a[0]).toLowerCase()},{minArgs:1,
maxArgs:1});N("UPPER",function(a){return v.Convert.toString(a[0]).toUpperCase()},{minArgs:1,maxArgs:1});N("CHAR",function(a){a=v.Convert.toInt(a[0]);return 1>a||255<a?v.Errors.Value:String.fromCharCode(a)},{minArgs:1,maxArgs:1});N("CODE",function(a){a=v.Convert.toString(a[0]);if(""===a||void 0===a||null===a)return v.Errors.Value;try{return a[0].charCodeAt(0)}catch(b){return v.Errors.Value}},{minArgs:1,maxArgs:1});N("REPLACE",function(a){var b=v.Convert,d=b.toString(a[0]),e=b.toInt(a[1]),f=b.toInt(a[2]);
a=b.toString(a[3]);if(1>e||0>f)return v.Errors.Value;e=Math.min(e,d.length+1);f=Math.min(f,d.length-e+1);b=d.substring(0,e-1);d=d.substr(e-1+f);return b.concat(a).concat(d)},{minArgs:4,maxArgs:4,acceptsMissingArgument:a});N("SUBSTITUTE",function(a){var b=v.Convert,d=b.toString(a[0]),e=b.toString(a[1]),f=b.toString(a[2]);if(""===e||void 0===e||null===e)return d;if(3<a.length){b=b.toInt(a[3]);a=0;if(1>b)return v.Errors.Value;for(var g=0;g<b;g++){a=d.indexOf(e,a);if(-1===a)return d;a+=e.length}a-=e.length;
b=d.substring(0,a);d=d.substr(a+e.length);f=b.concat(f).concat(d)}else f=d.replace(e,f);return f},{minArgs:3,maxArgs:4,acceptsMissingArgument:b});N("CONCATENATE",function(a){for(var b=[],d=a.length,e=v.Convert,f=v._ArrayHelper,g=0;g<d;g++)for(var h=f.getLength(a[g]),k=0;k<h;k++){var l=f.getValueByIndex(a[g],k);void 0!==l&&null!==l&&b.push(e.toString(l))}return b.join("")},{minArgs:2,acceptsArray:m});N("LEFT",function(a){var b=v.Convert,d=v._Helper,e=b.toString(a[0]);a=d._argumentExists(a,1)?b.toInt(a[1]):
1;return 0>a?v.Errors.Value:a>=e.length?e:e.substr(0,a)},{minArgs:1,maxArgs:2,acceptsMissingArgument:g});N("MID",function(a){var b=v.Convert,d=b.toString(a[0]),e=b.toInt(a[1])-1;a=b.toInt(a[2]);return 0>e||0>a?v.Errors.Value:e>=d.length?"":d.length<e+a?d.substr(e):d.substr(e,a)},{minArgs:3,maxArgs:3});N("RIGHT",function(a){var b=v.Convert,d=v._Helper,e=b.toString(a[0]);a=d._argumentExists(a,1)?b.toInt(a[1]):1;return 0>a?v.Errors.Value:e.length<a?e:e.substr(e.length-a,a)},{minArgs:1,maxArgs:2,acceptsMissingArgument:g});
N("REPT",function(a){var b=v.Convert,d=b.toString(a[0]);a=b.toInt(a[1]);if(0>a||32767<a*d.length)return v.Errors.Value;for(var b=[],e=0;e<a;e++)b.push(d);return b.join("")},{minArgs:2,maxArgs:2});N("LEN",function(a){return v.Convert.toString(a[0]).length},{minArgs:1,maxArgs:1});N("FIND",function(a){var b=v.Convert,d=v._Helper,e=b.toString(a[0]),f=b.toString(a[1]);a=d._argumentExists(a,2)?b.toInt(a[2]):1;if(1>a||f.length<a)return v.Errors.Value;e=f.indexOf(e,a-1);return-1===e?v.Errors.Value:e+1},{minArgs:2,
maxArgs:3,acceptsMissingArgument:a});N("SEARCH",function(a){var b=v.Convert,d=v._Helper,e=b.toString(a[0]),f=b.toString(a[1]),b=d._argumentExists(a,2)?b.toInt(a[2]):1;b--;if(0>b)return v.Errors.Value;a=-1;try{if(-1===e.indexOf("*")&&-1===e.indexOf("?"))a=f.toLowerCase().indexOf(e.toLowerCase(),b);else{var g;if(""===e||void 0===e||null===e)g=e;else{for(var h in R)R.hasOwnProperty(h)&&(e=e.replace(R[h],R[h].source));e=e.replace("~?","{113E2532-EAF5-444c-A5CB-3D7446971C4D}");e=e.replace("~*","{E21523B3-0F1F-458f-B547-23D25713D0EC}");
e=e.replace("?",".");e=e.replace("*","((.|\\n)*)");e=e.replace("{113E2532-EAF5-444c-A5CB-3D7446971C4D}","\\?");e=e.replace("{E21523B3-0F1F-458f-B547-23D25713D0EC}","\\*");g=e.toString()}var k=g.toLowerCase(),l=RegExp(k,"i").exec(f);a=void 0!==l&&null!==l?l.index:-1}}catch(n){}return-1===a?v.Errors.Value:a+1},{minArgs:2,maxArgs:3,acceptsMissingArgument:a});N("EXACT",function(a){var b=v.Convert,d=b.toString(a[0]);a=b.toString(a[1]);return d===a},{minArgs:2,maxArgs:2});N("T",function(a){a=a[0];return"string"===
typeof a?a:""},{minArgs:1,maxArgs:1});N("ISERROR",function(a){w(a);var b={value:!1};v.Convert.isError(a[0])?b.value=!0:t(a[0],L,b);return b.value},{minArgs:1,maxArgs:1,acceptsError:m});N("ISERR",function(a){w(a);var b=v.Convert,d={value:!1};b.isError(a[0])&&a[0]._code!==v.Errors.NotAvailable._code?d.value=!0:b.isError(a[0])&&a[0]._code===v.Errors.NotAvailable._code?d.value=!1:t(a[0],D,d);return d.value},{minArgs:1,maxArgs:1,acceptsError:m});N("ISNA",function(a){w(a);return v.Convert.isError(a[0])?
a[0]._code===v.Errors.NotAvailable._code:!1},{minArgs:1,maxArgs:1,acceptsError:m});N("ERROR.TYPE",function(a){w(a);a=a[0];if(void 0!==a&&null!==a&&v.Convert.isError(a))switch(a._code){case v.Errors.Null._code:return 1;case v.Errors.DivideByZero._code:return 2;case v.Errors.Value._code:return 3;case v.Errors.Reference._code:return 4;case v.Errors.Name._code:return 5;case v.Errors.Number._code:return 6;case v.Errors.NotAvailable._code:return 7}return v.Errors.NotAvailable},{minArgs:1,maxArgs:1,acceptsError:m});
N("ISNUMBER",function(a){w(a);return v.Convert.isNumber(a[0])},{minArgs:1,maxArgs:1,acceptsError:m});N("ISEVEN",function(a){w(a);var b;return isNaN(b=v.Convert.toDouble(a[0]))?v.Errors.Value:0===V._MathHelper.approxFloor(Math.abs(b))%2},{minArgs:1,maxArgs:1});N("ISODD",function(a){w(a);var b;return isNaN(b=v.Convert.toDouble(a[0]))?v.Errors.Value:0!==V._MathHelper.approxFloor(Math.abs(b))%2},{minArgs:1,maxArgs:1});N("N",function(a){w(a);a=a[0];var b=v.Convert;return b.isNumber(a)?b.toDouble(a):"boolean"===
typeof a?a?1:0:b.isError(a)?a:0},{minArgs:1,maxArgs:1});N("ISBLANK",function(a){w(a);return void 0===a[0]||null===a[0]},{minArgs:1,maxArgs:1,acceptsError:m});N("ISLOGICAL",function(a){w(a);return"boolean"===typeof a[0]},{minArgs:1,maxArgs:1,acceptsError:m});N("ISTEXT",function(a){w(a);return typeof a[0]===M},{minArgs:1,maxArgs:1,acceptsError:m});N("ISNONTEXT",function(a){w(a);return typeof a[0]!==M},{minArgs:1,maxArgs:1,acceptsError:m});N("ISREF",function(a){w(a);return v.Convert._isCalcReference(a[0])},
{minArgs:1,maxArgs:1,acceptsError:m,acceptsReference:m});N("TYPE",function(a){w(a);a=a[0];var b=v.Convert;return b.isNumber(a)?1:typeof a===M?2:"boolean"===typeof a?4:b.isError(a)?16:b._isCalcArray(a)?64:v.Errors.Value},{minArgs:1,maxArgs:1,acceptsArray:m,acceptsError:m});N("NA",function(a){return v.Errors.NotAvailable},{minArgs:0,maxArgs:0})})(window,jQuery);
(function(p,l){function m(a,b,d){this.compareType=a;this.expected=b;this.formula=d}function k(a,b,d,e){this.operator=a;this.value1="string"===typeof b?l.trim(b):b;this.value2="string"===typeof d?l.trim(d):d;this.style=e}function g(a,b,d){this.compareType=a;this.expected=b;this.formula="string"===typeof d?l.trim(d).replace("=",""):d}function a(a,b,d){this.compareType=a;this.expected=b;this.formula="string"===typeof d?l.trim(d).replace("=",""):d;this.forceValue2Text=!1;this.useWildCards=!0;this.regex=
null;this.ignoreCase=!1}function d(a,b,d){this.operator=a;this.text=b;this.style=d}function e(a,b){this.compareType=a;this.expected=b}function b(a,b){this.customValueType=a;this.expected=null;var d=b;"string"===typeof d&&(d=l.trim(d),d="="===d[0]?d.substr(1):d);this.formula=d;this.ignoreBlank=!1}function f(a,b){if(a&&"string"!==typeof a)throw Error("ArgumentException");this.formula=a;this.style=b}function s(a,b,d){this.compareType=a;this.expected=b;this.formula="string"===typeof d?l.trim(d).replace("=",
""):d}function q(a){this.ignoreBlank=!1;this.formula=null;this.expected=a;this.expectTypeId=0}function t(a,b){this.type=a;this.style=b}function r(a,b,d){this.compareType=a;this.expected=b;this.formula="string"===typeof d?l.trim(d).replace("=",""):d;this.ignoreBlank=!1}function u(a,b,d){this.expected=b;this.type=a;this.ignoreBlank=this.isPercent=!1;this.ranges=d}function n(a,b,d){this.type=a;this.rank=b;this.style=d}function h(a,b){this.expected=a;this.ranges=b}function I(a){this.style=a}function E(a){this.style=
a}function O(a,b){this.type=a;this.ranges=b}function H(a,b){this.type=a;this.style=b}function C(a,b){this.type=a;this.value=b}function G(a,b,d){this.scales=[a,b,d];this.expected=[];this.highestValueCached=this.lowestValueCached=null;this.cached=!1}function z(a,b,d,e,f,g){a=new C(a,b);e=new C(e,f);G.call(this,a,null,e);this.expected[0]=d;this.expected[2]=g}function S(a,b,d,e,f,g,h,k,l){a=new C(a,b);e=new C(e,f);h=new C(h,k);G.call(this,a,e,h);this.expected[0]=d;this.expected[1]=g;this.expected[2]=
l;this._evaluator=null}function Q(a,b,d,e,f){a=new C(a,b);d=new C(d,e);G.call(this,a,null,d);this._init(f)}function aa(a,b,d){this.isGreaterThanOrEqualTo=a;this.iconValueType=b;this.iconValue=d}function ka(a){this._init(a)}function J(a){this.worksheet=a;this.rules=[]}var K=p.GrapeCity;"undefined"===typeof K&&(K=p.GrapeCity={});"undefined"===typeof K.UI&&(K.UI={});var A=K.UI;"undefined"===typeof K.Calc&&(K.Calc={});var L=K.Calc;A.RelationCompareType={Or:0,And:1};A.ComparisonOperator={EqualsTo:0,NotEqualsTo:1,
GreaterThan:2,GreaterThanOrEqualsTo:3,LessThan:4,LessThanOrEqualsTo:5,Between:6,NotBetween:7};A.GeneralCompareType={EqualsTo:0,NotEqualsTo:1,GreaterThan:2,GreaterThanOrEqualsTo:3,LessThan:4,LessThanOrEqualsTo:5};A.TextComparisonOperator={Contains:0,DoesNotContain:1,BeginsWith:2,EndsWith:3};A.TextCompareType={EqualsTo:0,NotEqualsTo:1,BeginsWith:2,DoesNotBeginWith:3,EndsWith:4,DoesNotEndWith:5,Contains:6,DoesNotContain:7};A.ColorCompareType={BackgroundColor:0,ForegroundColor:1};A.CustomValueType={Empty:0,
NonEmpty:1,Error:2,NonError:3,Formula:4};A.DateCompareType={EqualsTo:0,NotEqualsTo:1,Before:2,BeforeEqualsTo:3,After:4,AfterEqualsTo:5};A.Top10ConditionType={Top:0,Bottom:1};A.DateOccurringType={Today:0,Yesterday:1,Tomorrow:2,Last7Days:3,ThisMonth:4,LastMonth:5,NextMonth:6,ThisWeek:7,LastWeek:8,NextWeek:9};A.QuarterType={Quarter1:0,Quarter2:1,Quarter3:2,Quarter4:3};A.SortState={None:0,Ascending:1,Descending:2};A.AverageConditionType={Above:0,Below:1,EqualOrAbove:2,EqualOrBelow:3,Above1StdDev:4,Below1StdDev:5,
Above2StdDev:6,Below2StdDev:7,Above3StdDev:8,Below3StdDev:9};A.ScaleValueType={Number:0,LowestValue:1,HighestValue:2,Percent:3,Percentile:4,Automin:5,Formula:6,Automax:7};A.BarDirection={LeftToRight:0,RightToLeft:1};A.DataBarAxisPosition={Automatic:0,CellMidPoint:1,None:2};A.IconSetType={ThreeArrowsColored:0,ThreeArrowsGray:1,ThreeTriangles:2,ThreeStars:3,ThreeFlags:4,ThreeTrafficLightsUnrimmed:5,ThreeTrafficLightsRimmed:6,ThreeSigns:7,ThreeSymbolsCircled:8,ThreeSymbolsUncircled:9,FourArrowsColored:10,
FourArrowsGray:11,FourRedToBlack:12,FourRatings:13,FourTrafficLights:14,FiveArrowsColored:15,FiveArrowsGray:16,FiveRatings:17,FiveQuarters:18,FiveBoxes:19};A.IconValueType={Number:1,Percent:4,Formula:7,Percentile:5};A.ConditionType={RelationCondition:0,NumberCondition:1,TextCondition:2,ColorCondition:3,FormulaCondition:4,DateCondition:5,DateExCondition:6,TextLengthCondition:7,Top10Condition:8,UniqueCondition:9,AverageCondition:10,CellValueCondition:11,AreaCondition:12};A.RuleType={ConditionRuleBase:0,
CellValueRule:1,SpecificTextRule:2,FormulaRule:3,DateOccurringRule:4,Top10Rule:5,UniqueRule:6,DuplicateRule:7,AverageRule:8,ScaleRule:9,TwoScaleRule:10,ThreeScaleRule:11,DataBarRule:12,IconSetRule:13};var D=A.RelationCompareType,w=A.ComparisonOperator,M=A.GeneralCompareType,T=A.TextComparisonOperator,P=A.TextCompareType,ia=A.ColorCompareType,v=A.CustomValueType,V=A.DateCompareType,N=A.Top10ConditionType,R=A.DateOccurringType,ga=A.QuarterType,ba=A.AverageConditionType,W=A.ScaleValueType,ja=A.BarDirection,
fa=A.DataBarAxisPosition,la=A.IconSetType,ra=A.IconValueType,da=A.ConditionType,oa=A.RuleType;A.ConditionRuleBase=function(a){this.style=a};A.ConditionRuleBase.prototype={condition:null,ranges:null,style:null,hasNoReference:function(){return!(this.ranges&&0<this.ranges.length)},evaluate:function(a,b,d,e){if(this.contains(b,d)){this.initCondition();var f={baseRow:0,baseCol:0};this.getBaseCoordinate(f);this.condition.adjustOffset(b-f.baseRow,d-f.baseCol);f=null;this.condition.evaluate(a,b,d,e)&&(f=
this.getExpected());this.condition.adjustOffset(0,0);return f}return null},contains:function(a,b){if(this.ranges)for(var d=0;d<this.ranges.length;d++)if(this.ranges[d].contains(a,b))return!0;return!1},createCondition:function(){},initCondition:function(){this.condition||(this.condition=this.createCondition())},getExpected:function(){return this.style},reset:function(){this.style=this.condition=this.ranges=null},intersects:function(a,b,d,e){if(this.ranges)for(var f=0;f<this.ranges.length;f++)if(this.ranges[f].intersect(a,
b,d,e))return!0;return!1},isScaleRule:function(){return!1},getBaseCoordinate:function(a){a.baseRow=Number.MAX_VALUE;a.baseCol=Number.MAX_VALUE;if(this.ranges&&0<this.ranges.length)for(var b=0;b<this.ranges.length;b++){var d=this.ranges[b];a.baseRow=Math.min(d.row,a.baseRow);a.baseCol=Math.min(d.col,a.baseCol)}else a.baseRow=0,a.baseColumn=0},_addRows:function(a,b){if(this.ranges)for(var d=this.ranges.length,e=0;e<d;e++){var f=this.ranges[e];f.row>=a?this.ranges[e]=new A.Range(f.row+b,f.col,f.rowCount,
f.colCount):f.row<a&&a<f.row+f.rowCount&&(this.ranges[e]=new A.Range(f.row,f.col,f.rowCount+b,f.colCount))}},_addColumns:function(a,b){if(this.ranges)for(var d=this.ranges.length,e=0;e<d;e++){var f=this.ranges[e];f.col>=a?this.ranges[e]=new A.Range(f.row,f.col+b,f.rowCount,f.colCount):f.col<a&&a<f.col+f.colCount&&(this.ranges[e]=new A.Range(f.row,f.col,f.rowCount,f.colCount+b))}},_removeRows:function(a,b){if(this.ranges){for(var d=[],e=this.ranges.length,f=0;f<e;f++){var g=this.ranges[f];if(g.row>
a)g.row+g.rowCount<=a+b?d.push(g):this.ranges[f]=new A.Range(g.row-b,g.col,g.rowCount,g.colCount);else if(g.row<=a&&a<g.row+g.rowCount){var h=new A.Range(g.row,g.col,g.rowCount-Math.min(g.row+g.rowCount-a,b),g.colCount);0===h.colCount||0===h.rowCount?d.push(g):this.ranges[f]=h}}e=d.length;for(f=0;f<e;f++)this.ranges.remove(d[f])}},_removeColumns:function(a,b){if(this.ranges){for(var d=[],e=this.ranges.length,f=0;f<e;f++){var g=this.ranges[f];if(g.col>a)g.col+g.colCount<=a+b?d.push(g):this.ranges[f]=
new A.Range(g.row,g.col-b,g.rowCount,g.colCount);else if(g.col<=a&&a<g.col+g.colCount){var h=new A.Range(g.row,g.col,g.rowCount,g.colCount-Math.min(g.col+g.colCount-a,b));0===h.colCount||0===h.rowCount?d.push(g):this.ranges[f]=h}}e=d.length;for(f=0;f<e;f++)this.ranges.remove(d[f])}},toJSON:function(){},fromJSON:function(a){}};var ha=A.ConditionRuleBase;A.RelationCondition=function(a,b,d){this.compareType=a;this.item1=b;this.item2=d};A.RelationCondition.prototype={conditionType:"RelationCondition",
compareType:D.And,item1:null,item2:null,ignoreBlank:!1,adjustOffset:function(a,b){},create:function(a,b,d){return new X(a,b,d)},_getActualValue:function(a,b,d,e,f){a&&b&&"ColorCondition"===b.conditionType&&(a=a.getActualStyle(d,e))&&(b.compareType===ia.BackgroundColor?f=a.backColor:b.compareType===ia.ForegroundColor&&(f=a.foreColor));return f},evaluate:function(a,b,d,e,f){var g,h;this.item1&&(this.item1.ignoreBlank=this.ignoreBlank,g=5>arguments.length?this._getActualValue(a,this.item1,b,d,e):e);
this.item2&&(this.item2.ignoreBlank=this.ignoreBlank,h=5>arguments.length?this._getActualValue(a,this.item2,b,d,e):f);return this.compareType===D.And?(g=void 0===this.item1||null===this.item1?!1:this.item1.evaluate(a,b,d,g),g?h=void 0===this.item2||null===this.item2?!1:this.item2.evaluate(a,b,d,h):!1):this.compareType===D.Or?(g=void 0===this.item1||null===this.item1?!1:this.item1.evaluate(a,b,d,g))?!0:h=void 0===this.item2||null===this.item2?!1:this.item2.evaluate(a,b,d,h):!1},reset:function(){this.ignoreBlank=
!1;this.compareType=D.And;this.item2=this.item1=null},_getConditionTypeDictionary:function(){if(!this._dict){var a={};a[A.ConditionType.RelationCondition]=A.RelationCondition;a[A.ConditionType.NumberCondition]=A.NumberCondition;a[A.ConditionType.TextCondition]=A.TextCondition;a[A.ConditionType.ColorCondition]=A.ColorCondition;a[A.ConditionType.FormulaCondition]=A.FormulaCondition;a[A.ConditionType.DateCondition]=A.DateCondition;a[A.ConditionType.DateExCondition]=A.DateExCondition;a[A.ConditionType.TextLengthCondition]=
A.TextLengthCondition;a[A.ConditionType.Top10Condition]=A.Top10Condition;a[A.ConditionType.UniqueCondition]=A.UniqueCondition;a[A.ConditionType.AverageCondition]=A.AverageCondition;a[A.ConditionType.CellValueCondition]=A.CellValueCondition;a[A.ConditionType.AreaCondition]=A.AreaCondition;this._dict=a}return this._dict},toJSON:function(){return{compareType:this.compareType,item1:this.item1?this.item1.toJSON():null,item2:this.item2?this.item2.toJSON():null,conType:da.RelationCondition,ignoreBlank:this.ignoreBlank}},
fromJSON:function(a){if(a){null!==a.compareType&&void 0!==a.compareType&&(this.compareType=a.compareType);if(null!==a.item1&&void 0!==a.item1){var b=null,d=this._getConditionTypeDictionary();if(d=d[a.item1.conType])b=new d,b.fromJSON(a.item1);this.item1=b}if(null!==a.item2&&void 0!==a.item2){b=null;d=this._getConditionTypeDictionary();if(d=d[a.item2.conType])b=new d,b.fromJSON(a.item2);this.item2=b}null!==a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank)}}};var X=A.RelationCondition;
k.prototype=new ha;k.prototype.createCondition=function(){var a=this.isFormula(this.value1)?this.value1.replace("=",""):null;this.isFormula(this.value1);var b=this.isFormula(this.value2)?this.value2.replace("=",""):null;this.isFormula(this.value2);var d=this.operator,e=null;if(d===w.Between)return a=new m(M.GreaterThanOrEqualsTo,this.value1,a),a.treatNullValueAsZero=!0,b=new m(M.LessThanOrEqualsTo,this.value2,b),b.treatNullValueAsZero=!0,new X(D.And,a,b);if(d===w.NotBetween)return a=new m(M.LessThan,
this.value1,a),a.treatNullValueAsZero=!0,b=new m(M.GreaterThan,this.value2,b),b.treatNullValueAsZero=!0,new X(D.Or,a,b);d===w.EqualsTo?e=M.EqualsTo:d===w.GreaterThan?e=M.GreaterThan:d===w.GreaterThanOrEqualsTo?e=M.GreaterThanOrEqualsTo:d===w.LessThan?e=M.LessThan:d===w.LessThanOrEqualsTo?e=M.LessThanOrEqualsTo:d===w.NotEqualsTo&&(e=M.NotEqualsTo);return null!==e?(b=new m(e,this.value1,a),b.treatNullValueAsZero=!0,b):null};k.prototype.reset=function(){this.operator=w.Between;this.style=this.value2=
this.value1=null};k.prototype.isFormula=function(a){return void 0!==a&&null!==a&&"="===a[0]};k.prototype.toJSON=function(){return{ruleType:oa.CellValueRule,ranges:this.ranges,style:this.style,operator:this.operator,value1:this.value1,value2:this.value2}};k.prototype.fromJSON=function(a){if(a){if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}a.style&&(this.style=new A.Style,this.style.copyFrom(a.style));
null!==a.operator&&void 0!==a.operator&&(this.operator=a.operator);null!==a.value1&&void 0!==a.value1&&(this.value1=a.value1);null!==a.value2&&void 0!==a.value2&&(this.value2=a.value2)}};A.CellValueRule=k;m.prototype={compareType:null,treatNullValueAsZero:!1,adjustOffset:function(a,b){},getExpected:function(a,b,d,e){if(this.formula&&0<this.formula.length){e=a.getCalcService();var f=e.parse(this.formula,b,d);return e.evaluateParsedFormula(a._getSheetSource(),f,b,d)}return this.expected},evaluate:function(a,
b,d,e){a=this.getExpected(a,b,d);return this.checkCondition(a,e)},isSatisfyingCondition:function(a){var b=this.getExpected(null,0,0);return this.checkCondition(b,a)},checkCondition:function(a,b){var d=0,e=!1,f=L.Convert.toDouble;if("boolean"===typeof a)switch(this.compareType){case M.EqualsTo:return b===a;case M.NotEqualsTo:return b!==a;case M.GreaterThan:return 0>this._compareBool(a,b);case M.GreaterThanOrEqualsTo:return 0>=this._compareBool(a,b);case M.LessThan:return 0<this._compareBool(a,b);case M.LessThanOrEqualsTo:return this._compareBool(a,
b)}try{d=f(b),e=!isNaN(d)}catch(g){e=!1}if(!(void 0!==b&&null!==b||void 0!==a&&null!==a))switch(this.compareType){case M.EqualsTo:case M.GreaterThanOrEqualsTo:case M.LessThanOrEqualsTo:return!0;case M.NotEqualsTo:case M.GreaterThan:case M.LessThan:return!1;default:return!1}!this.treatNullValueAsZero||void 0!==b&&null!==b||(e=!0,d=0);if(e){e=0;try{e=f(a)}catch(h){switch(this.compareType){case M.NotEqualsTo:return!0}return!1}switch(this.compareType){case M.EqualsTo:return d===e;case M.NotEqualsTo:return d!==
e;case M.GreaterThan:return d>e;case M.GreaterThanOrEqualsTo:return d>=e;case M.LessThan:return d<e;case M.LessThanOrEqualsTo:return d<=e}}else if("string"===typeof b){d=null;if("string"===typeof a)d=a;else{switch(this.compareType){case M.NotEqualsTo:return!0}return!1}switch(this.compareType){case M.EqualsTo:return b===d;case M.NotEqualsTo:return b!==d;case M.GreaterThan:return d<b;case M.GreaterThanOrEqualsTo:return d<=b;case M.LessThan:return d>b;case M.LessThanOrEqualsTo:return d>=b}}return!1},
_compareBool:function(a,b){return a===b?0:!1===a&&!0===b?-1:1},toJSON:function(){return{compareType:this.compareType,expected:this.expected,formula:this.formula,conType:da.CellValueCondition,treatNullValueAsZero:this.treatNullValueAsZero}},fromJSON:function(a){a&&(null!==a.compareType&&void 0!==a.compareType&&(this.compareType=a.compareType),null!==a.expected&&void 0!==a.expected&&(this.expected=a.expected),null!==a.formula&&void 0!==a.formula&&(this.formula=a.formula),null!==a.treatNullValueAsZero&&
void 0!==a.treatNullValueAsZero&&(this.treatNullValueAsZero=a.treatNullValueAsZero))}};A.CellValueCondition=m;g.prototype={conditionType:"NumberCondition",ignoreBlank:!1,integerValue:!1,compareType:M.EqualsTo,evaluate:function(a,b,d,e){a=this.getExpected(a,b,d);this.integerValue&&(a=isNaN(a)?null:parseInt(a,10));return this.checkCondition(a,e)},checkCondition:function(a,b){if((void 0===b||null===b||""===b)&&this.ignoreBlank)return!0;if(isNaN(b))return!1;if(void 0===a||null===a){if(this.ignoreBlank)return!0;
a=0}var d=0;try{d=parseFloat(b)}catch(e){return!1}if(!0===this.integerValue&&!1===(0===d-Math.floor(d)))return!1;switch(this.compareType){case M.EqualsTo:return d===a;case M.NotEqualsTo:return d!==a;case M.GreaterThan:return d>a;case M.GreaterThanOrEqualsTo:return d>=a;case M.LessThan:return d<a;case M.LessThanOrEqualsTo:return d<=a}return!1},getExpected:function(a,b,d){return this.formula&&0<this.formula.length?a.getCalcService().evaluate(a._getSheetSource(),this.formula,b,d):this.expected},reset:function(){this.expected=
null;this.ignoreBlank=!1;this.compareType=M.EqualsTo;this.integerValue=!1},toJSON:function(){return{compareType:this.compareType,expected:this.expected,formula:this.formula,conType:da.NumberCondition,ignoreBlank:this.ignoreBlank,integerValue:this.integerValue}},fromJSON:function(a){a&&(null!==a.compareType&&void 0!==a.compareType&&(this.compareType=a.compareType),null!==a.expected&&void 0!==a.expected&&(this.expected=a.expected),null!==a.formula&&void 0!==a.formula&&(this.formula=a.formula),null!==
a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank),null!==a.integerValue&&void 0!==a.integerValue&&(this.integerValue=a.integerValue))}};A.NumberCondition=g;d.prototype=new ha;d.prototype.createCondition=function(){var b;switch(this.operator){case T.BeginsWith:b=P.BeginsWith;break;case T.EndsWith:b=P.EndsWith;break;case T.Contains:b=P.Contains;break;case T.DoesNotContain:b=P.DoesNotContain;break;default:b=P.EqualsTo}b=new a(b,this.text,null);b.ignoreCase=!0;return b};d.prototype.reset=
function(){this.operator=P.Contains;this.text="";this.style=null};d.prototype.toJSON=function(){return{ruleType:oa.SpecificTextRule,ranges:this.ranges,style:this.style,operator:this.operator,text:this.text}};d.prototype.fromJSON=function(a){if(a){if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}a.style&&(this.style=new A.Style,this.style.copyFrom(a.style));null!==a.operator&&void 0!==a.operator&&(this.operator=
a.operator);null!==a.text&&void 0!==a.text&&(this.text=a.text)}};A.SpecificTextRule=d;a.prototype={conditionType:"TextCondition",questionMarkWildcard:"?",questionMarkWildcardRegularExpression:".",asteriskWildcard:"*",asteriskWildcardRegularExpression:"[.\n]*",ignoreBlank:!1,adjustOffset:function(a,b){},evaluate:function(a,b,d,e){var f=null;if(!0!==this.forceValue2Text&&"string"!==typeof e&&"number"!==typeof e&&e instanceof Date)return this.compareType===P.BeginsWith||this.compareType===P.EndsWith||
this.compareType===P.Contains?!1:this.compareType===P.DoesNotBeginWith||this.compareType===P.DoesNotEndWith||this.compareType===P.DoesNotContain;f=void 0!==e&&null!==e?e.toString():"";if(this.ignoreBlank&&(void 0===f||null===f||""===f))return!0;a=this.getExpectedString(a,b,d);if(this.hasWildcard(a)&&"number"===typeof e)return this.compareType===P.DoesNotBeginWith||this.compareType===P.DoesNotContain||this.compareType===P.DoesNotEndWith||this.compareType===P.NotEqualsTo;switch(this.compareType){case P.EqualsTo:return this.isEquals(a,
f);case P.NotEqualsTo:return!this.isEquals(a,f);case P.BeginsWith:return this.isStartWith(a,f);case P.DoesNotBeginWith:return!this.isStartWith(a,f);case P.EndsWith:return this.isEndWith(a,f);case P.DoesNotEndWith:return!this.isEndWith(a,f);case P.Contains:return this.isContains(a,f);case P.DoesNotContain:return!this.isContains(a,f)}return!1},getExpectedString:function(a,b,d){a=this.getExpected(a,b,d);return void 0===a||null===a?null:a.toString()},getExpected:function(a,b,d){if(this.formula&&0<this.formula.length){var e=
a.getCalcService(),f=e.parse(this.formula,b,d);return e.evaluateParsedFormula(a._getSheetSource(),f,b,d)}return this.expected},hasWildcard:function(a){return void 0===a||null===a||""===a?!1:-1<a.indexOf(this.asteriskWildcard)||-1<a.indexOf(this.questionMarkWildcard)},isEquals:function(a,b){if(this.useWildCards&&this.hasWildcard(a)){var d=this.createEqualsRegex(a);if(d){var e=void 0===b&&null===b?"":b;d.lastIndex=-1;if(void 0!==e&&null!==e)return-1<e.search(d)}return!1}return void 0!==b&&null!==b&&
""!==b?(d=void 0!==a&&null!==a?a:"",this.ignoreCase?d.toLowerCase()===b.toLowerCase():d===b):void 0===a||null===a||""===a},createEqualsRegex:function(a){if(this.regex)return this.regex;a=this.encodeExpression(a);var b=RegExp("\\"+this.questionMarkWildcard,"g");a=a.replace(b,this.questionMarkWildcardRegularExpression);b=RegExp("\\"+this.asteriskWildcard,"g");a=a.replace(b,this.asteriskWildcardRegularExpression);b=null;try{b=RegExp("^"+a+"$",this.ignoreCase?"ig":"g")}catch(d){return null}return b},
encodeExpression:function(a){if(!a)return null;a=a.replace(/\^/g,"\\^");a=a.replace(/\$/g,"\\$");a=a.replace(/\(/g,"\\(");a=a.replace(/\)/g,"\\)");a=a.replace(/\[/g,"\\[");a=a.replace(/\]/g,"\\]");a=a.replace(/\{/g,"\\{");a=a.replace(/\}/g,"\\}");a=a.replace(/\./g,"\\.");a=a.replace(/\+/g,"\\+");return a=a.replace(/\|/g,"\\|")},isStartWith:function(a,b){var d;if(this.useWildCards&&this.hasWildcard(a)){var e=this.createStartWithRegex(a);return e&&(d=void 0===b||null===b?"":b,e.lastIndex=-1,void 0!==
d&&null!==d)?-1<d.search(e):!1}if(void 0!==b&&null!==b&&""!==b){if(void 0===a||null===a)return!1;e=a;d=b;this.ignoreCase&&(e=e.toLowerCase(),d=d.toLowerCase());d=d.match("^"+e);return void 0!==d&&null!==d&&0<d.length?d[0]===e:!1}return void 0===a||null===a||""===a},createStartWithRegex:function(a){if(this.regex)return this.regex;a=this.encodeExpression(a);var b,d=RegExp("\\"+this.questionMarkWildcard,"g");b=a.replace(d,this.questionMarkWildcardRegularExpression);d=RegExp("\\"+this.asteriskWildcard,
"g");b=b.replace(d,this.asteriskWildcardRegularExpression);d=null;try{var e=this.ignoreCase?"ig":"g",d=a[0]===this.asteriskWildcard?RegExp(b,e):RegExp("^"+b,e)}catch(f){return null}return d},isEndWith:function(a,b){var d;if(this.useWildCards&&this.hasWildcard(a)){var e=this.createEndWithRegex(a);return e&&(d=void 0===b||null===b?"":b,e.lastIndex=-1,void 0!==d&&null!==d)?-1<d.search(e):!1}if(void 0!==b&&null!==b&&""!==b){if(void 0===a||null===a)return!1;e=a;d=b;this.ignoreCase&&(e=e.toLowerCase(),
d=d.toLowerCase());d=d.match(e+"$");return void 0!==d&&null!==d&&0<d.length?d[0]===e:!1}return void 0===a||null===a||""===a},createEndWithRegex:function(a){if(this.regex)return this.regex;a=this.encodeExpression(a);var b,d=RegExp("\\"+this.questionMarkWildcard,"g");b=a.replace(d,this.questionMarkWildcardRegularExpression);d=RegExp("\\"+this.asteriskWildcard,"g");b=b.replace(d,this.asteriskWildcardRegularExpression);d=null;try{var e=this.ignoreCase?"ig":"g",d=a[a.length-1]===this.asteriskWildcard?
RegExp(b,e):RegExp(b+"$",e)}catch(f){return null}return d},isContains:function(a,b){var d;if(this.useWildCards&&this.hasWildcard(a)){var e=this.createContainsRegex(a);return e&&(d=void 0===b||null===b?"":b,e.lastIndex=-1,void 0!==d&&null!==d)?-1<d.search(e):!1}if(void 0!==b&&null!==b&&""!==b){if(void 0===a||null===a)return!1;e=a;d=b;this.ignoreCase&&(e=e.toLowerCase(),d=d.toLowerCase());return-1<d.indexOf(e)}return void 0===a||null===a||""===a},createContainsRegex:function(a){if(this.regex)return this.regex;
a=this.encodeExpression(a);var b=RegExp("\\"+this.questionMarkWildcard,"g");a=a.replace(b,this.questionMarkWildcardRegularExpression);b=RegExp("\\"+this.asteriskWildcard,"g");a=a.replace(b,this.asteriskWildcardRegularExpression);b=null;try{b=RegExp(a,this.ignoreCase?"ig":"g")}catch(d){return null}return b},reset:function(){this.expected=null;this.ignoreBlank=!1;this.compareType=P.EqualsTo;this.useWildCards=!0;this.forceValue2Text=this.ignoreCase=!1},toJSON:function(){return{compareType:this.compareType,
expected:this.expected,formula:this.formula,forceValue2Text:this.forceValue2Text,useWildCards:this.useWildCards,ignoreCase:this.ignoreCase,regex:this.regex,conType:da.TextCondition,ignoreBlank:this.ignoreBlank}},fromJSON:function(a){a&&(null!==a.compareType&&void 0!==a.compareType&&(this.compareType=a.compareType),null!==a.expected&&void 0!==a.expected&&(this.expected=a.expected),null!==a.formula&&void 0!==a.formula&&(this.formula=a.formula),null!==a.forceValue2Text&&void 0!==a.forceValue2Text&&(this.forceValue2Text=
a.forceValue2Text),null!==a.useWildCards&&void 0!==a.useWildCards&&(this.useWildCards=a.useWildCards),null!==a.ignoreCase&&void 0!==a.ignoreCase&&(this.ignoreCase=a.ignoreCase),null!==a.regex&&void 0!==a.regex&&(this.regex=a.regex),null!==a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank))}};A.TextCondition=a;e.prototype={conditionType:"ColorCondition",ignoreBlank:!1,evaluate:function(a,b,d,e){return this.isEqualsColor(a,e)},isEqualsColor:function(a,b){var d=this.getColorFromString(this.expected);
if(void 0!==d&&null!==d&&""!==d){var e=this.getColorFromString(b);if(void 0!==e&&null!==e&&""!==e)return e.a===d.a&&e.r===d.r&&e.g===d.g&&e.b===d.b;var f;this.compareType===ia.BackgroundColor?a&&a.getDefaultStyle&&(f=a.getDefaultStyle().backColor):this.compareType===ia.ForegroundColor&&a&&a.getDefaultStyle&&(f=a.getDefaultStyle().foreColor);if(f)return d.a===f.a&&d.r===f.r&&d.g===f.g&&d.b===f.b}else if(this.ignoreBlank)return!0;return!1},getColorFromString:function(a){return void 0===a||null===a||
""===a?null:A._Color.parse(a)},reset:function(){this.expected=null;this.ignoreBlank=!1;this.compareType=ia.BackgroundColor},toJSON:function(){return{compareType:this.compareType,expected:this.expected,conType:da.ColorCondition,ignoreBlank:this.ignoreBlank}},fromJSON:function(a){a&&(null!==a.compareType&&void 0!==a.compareType&&(this.compareType=a.compareType),null!==a.expected&&void 0!==a.expected&&(this.expected=a.expected),null!==a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank))}};
A.ColorCondition=e;f.prototype=new ha;f.prototype.createCondition=function(){var a=new b(v.Formula,this.formula&&""!==this.formula?this.formula:null);this.ranges&&0<this.ranges.length&&(a._baseRow=this.ranges[0].row,a._baseCol=this.ranges[0].col);return a};f.prototype.reset=function(){this.style=this.formula=null};f.prototype.isFormula=function(a){return a&&"="===a[0]};f.prototype.toJSON=function(){return{ruleType:oa.FormulaRule,ranges:this.ranges,style:this.style,formula:this.formula}};f.prototype.fromJSON=
function(a){if(a){if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}a.style&&(this.style=new A.Style,this.style.copyFrom(a.style));null!==a.formula&&void 0!==a.formula&&(this.formula=a.formula)}};A.FormulaRule=f;b.prototype={conditionType:"FormulaCondition",adjustOffset:function(a,b){},evaluate:function(a,b,d,e){if(this.customValueType===v.Formula){e=this.getExpected(a,b,d);if(this.ignoreBlank&&(void 0===
e||null===e||""===e))return!0;try{return L.Convert.toBool(e)}catch(f){}}else switch(a=L.Convert.isError,this.customValueType){case v.Empty:return void 0===e||null===e||""===e;case v.NonEmpty:return void 0!==e&&null!==e&&""!==e;case v.Error:return a(e);case v.NonError:return!a(e)}return!1},getExpected:function(a,b,d){if(this.formula&&0<this.formula.length){var e=a.getCalcService();this._expr||(void 0!==this._baseRow&&null!==this._baseRow||void 0!==this._baseCol&&null!==this._baseCol||(this._baseRow=
b,this._baseCol=d),this._expr=e.parse(this.formula,this._baseRow,this._baseCol));a=e.evaluateParsedFormula(a._getSheetSource(),this._expr,b,d,!0);var f,g,h,k;if(a instanceof L.Reference){e=a.getRowCount(0);f=a.getColumnCount(0);g=[];for(h=0;h<e;h++)for(g[h]=[],k=0;k<f;k++)g[h][k]=a.getValue(0,h,k);a=g}else if(a instanceof L.Array){e=a.getRowCount();f=a.getColumnCount();g=[];for(h=0;h<e;h++)for(g[h]=[],k=0;k<f;k++)g[h][k]=a.getValue(h,k);a=g}return a instanceof Array?(e=a.length,f=a[0].length,1===
e&&1===f?a[0][0]:b-this._baseRow<e&&d-this._baseCol<f?a[0][0]:L.Errors.NotAvailable):a}return this.expected},reset:function(){this.expected=null;this.ignoreBlank=!1;this.customValueType=v.Empty;this._baseCol=this._baseRow=this._expr=null},toJSON:function(){return{customValueType:this.customValueType,expected:this.expected,formula:this.formula,conType:da.FormulaCondition,ignoreBlank:this.ignoreBlank}},fromJSON:function(a){a&&(null!==a.customValueType&&void 0!==a.customValueType&&(this.customValueType=
a.customValueType),null!==a.expected&&void 0!==a.expected&&(this.expected=a.expected),null!==a.formula&&void 0!==a.formula&&(this.formula=a.formula),null!==a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank))}};A.FormulaCondition=b;s.prototype={conditionType:"DateCondition",ignoreBlank:!1,evaluate:function(a,b,d,e){if((void 0===e||null===e||""===e)&&this.ignoreBlank)return!0;if(!(e instanceof Date))return!1;a=this.getExpectedDateTime(a,b,d);if(void 0===a||null===a)return!!this.ignoreBlank;
switch(this.compareType){case V.EqualsTo:return this.isEquals(a,e);case V.NotEqualsTo:return!this.isEquals(a,e);case V.After:return this.isAfter(a,e);case V.AfterEqualsTo:return this.isAfter(a,e)||this.isEquals(a,e);case V.Before:return this.isBefore(a,e);case V.BeforeEqualsTo:return this.isBefore(a,e)||this.isEquals(a,e)}return!1},getExpectedDateTime:function(a,b,d){a=this.getExpected(a,b,d);return a instanceof Date?a:"string"===typeof a?A._DateTimeHelper.parseLocale(a):null},getExpected:function(a,
b,d){if(this.formula&&0<this.formula.length){var e=a.getCalcService(),f=e.parse(this.formula,b,d);return e.evaluateParsedFormula(a._getSheetSource(),f,b,d)}return this.expected},isEquals:function(a,b){return a.getYear()===b.getYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()},isAfter:function(a,b){var d=this.createDayEnding(a);return b>d},createDayEnding:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999)},isBefore:function(a,b){var d=this.createDayBeginning(a);
return b<d},createDayBeginning:function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)},reset:function(){this.expected=null;this.ignoreBlank=!1;this.compareType=V.EqualsTo},toJSON:function(){return{compareType:this.compareType,expected:this.expected,formula:this.formula,conType:da.DateCondition,ignoreBlank:this.ignoreBlank}},fromJSON:function(a){a&&(null!==a.compareType&&void 0!==a.compareType&&(this.compareType=a.compareType),null!==a.expected&&void 0!==a.expected&&("string"===
l.type(a.expected)?this.expected=new Date(a.expected):this.expected=a.expected),null!==a.formula&&void 0!==a.formula&&(this.formula=a.formula),null!==a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank))}};A.DateCondition=s;t.prototype=new ha;t.prototype.createCondition=function(){return new q(this.type)};t.prototype.reset=function(){this.type=R.Today;this.style=null};t.prototype.toJSON=function(){return{ruleType:oa.DateOccurringRule,ranges:this.ranges,style:this.style,type:this.type}};
t.prototype.fromJSON=function(a){if(a){if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}a.style&&(this.style=new A.Style,this.style.copyFrom(a.style));null!==a.type&&void 0!==a.type&&(this.type=a.type)}};A.DateOccurringRule=t;q.prototype={conditionType:"DateExCondition",adjustOffset:function(a,b){},evaluate:function(a,b,d,e){a=this.getExpectedInt(a,b,d);return void 0!==a&&null!==a?this.checkCondition(a,
e):!1},getExpectedInt:function(a,b,d){a=this.getExpected(a,b,d);a=parseInt(a,10);return isNaN(a)?null:a},getExpected:function(a,b,d){if(this.formula&&0<this.formula.length){var e=a.getCalcService(),f=e.parse(this.formula,b,d);return e.evaluateParsedFormula(a._getSheetSource(),f,b,d)}return this.expected},checkCondition:function(a,b){var d=b;if(this.ignoreBlank&&(void 0===d||null===d||""===d))return!0;try{d=L.Convert.toDateTime(d)}catch(e){return!1}var f;if(0===this.expectTypeId){var g=null;f=null;
var h=new Date,k=new Date(h.getFullYear(),h.getMonth(),h.getDate(),h.getHours(),h.getMinutes(),h.getSeconds(),h.getMilliseconds());switch(a){case R.Last7Days:k.setDate(k.getDate()-6);g=new Date(k.getFullYear(),k.getMonth(),k.getDate(),0,0,0,0);f=new Date(h.getFullYear(),h.getMonth(),h.getDate(),23,59,59,999);break;case R.Yesterday:k.setDate(k.getDate()-1);g=new Date(k.getFullYear(),k.getMonth(),k.getDate(),0,0,0,0);f=new Date(k.getFullYear(),k.getMonth(),k.getDate(),23,59,59,999);break;case R.Today:g=
new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0,0);f=new Date(h.getFullYear(),h.getMonth(),h.getDate(),23,59,59,999);break;case R.Tomorrow:k.setDate(k.getDate()+1);g=new Date(k.getFullYear(),k.getMonth(),k.getDate(),0,0,0,0);f=new Date(k.getFullYear(),k.getMonth(),k.getDate(),23,59,59,999);break;case R.LastWeek:h.setDate(h.getDate()-h.getDay()-7);k.setDate(k.getDate()-k.getDay()-1);g=new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0,0);f=new Date(k.getFullYear(),k.getMonth(),k.getDate(),
23,59,59,999);break;case R.ThisWeek:h.setDate(h.getDate()-h.getDay());k.setDate(k.getDate()-k.getDay()+6);g=new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0,0);f=new Date(k.getFullYear(),k.getMonth(),k.getDate(),23,59,59,999);break;case R.NextWeek:h.setDate(h.getDate()-h.getDay()+7);k.setDate(k.getDate()-k.getDay()+13);g=new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0,0);f=new Date(k.getFullYear(),k.getMonth(),k.getDate(),23,59,59,999);break;case R.LastMonth:h.setDate(1);h.setMonth(h.getMonth()-
1);k.setDate(0);g=new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0,0);f=new Date(k.getFullYear(),k.getMonth(),k.getDate(),23,59,59,999);break;case R.ThisMonth:h.setDate(1);k.setDate(1);k.setMonth(k.getMonth()+1);k.setDate(0);g=new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0,0);f=new Date(k.getFullYear(),k.getMonth(),k.getDate(),23,59,59,999);break;case R.NextMonth:h.setDate(1),h.setMonth(h.getMonth()+1),k.setDate(1),k.setMonth(k.getMonth()+2),k.setDate(0),g=new Date(h.getFullYear(),
h.getMonth(),h.getDate(),0,0,0,0),f=new Date(k.getFullYear(),k.getMonth(),k.getDate(),23,59,59,999)}if(void 0!==g&&null!==g&&void 0!==f&&null!==f)return g=new s(V.AfterEqualsTo,g,null),f=new s(V.BeforeEqualsTo,f,null),(new X(D.And,g,f)).evaluate(null,0,0,d)}else if(1===this.expectTypeId){if(f=this.getExpectedInt(null,0,0),void 0!==f&&null!==f)return this.isEqualsYear(f,d)}else if(2===this.expectTypeId){if(f=this.getExpectedInt(null,0,0),void 0!==f&&null!==f)return this.isEqualsQuarter(f,d)}else if(3===
this.expectTypeId){if(f=this.getExpectedInt(null,0,0),void 0!==f&&null!==f)return this.isEqualsMonth(f,d)}else if(4===this.expectTypeId){if(f=this.getExpectedInt(null,0,0),void 0!==f&&null!==f)return this.isEqualsWeek(f,d)}else if(5===this.expectTypeId&&(f=this.getExpectedInt(null,0,0),void 0!==f&&null!==f))return this.isEqualsDay(f,d);return!1},isEqualsYear:function(a,b){return a===b.getFullYear()},isEqualsQuarter:function(a,b){switch(a){case ga.Quarter1:return 1<=b.getMonth()&&3>=b.getMonth();case ga.Quarter2:return 4<=
b.getMonth()&&6>=b.getMonth();case ga.Quarter3:return 7<=b.getMonth()&&9>=b.getMonth();case ga.Quarter4:return 10<=b.getMonth()&&12>=b.getMonth()}return!1},isEqualsMonth:function(a,b){return a===b.getMonth()},isEqualsWeek:function(a,b){return a===b.getDay()},isEqualsDay:function(a,b){return a===b.getDate()},reset:function(){this.expected=null;this.ignoreBlank=!1;this.expectTypeId=0},toJSON:function(){return{ignoreBlank:this.ignoreBlank,formula:this.formula,expected:this.expected,expectTypeId:this.expectTypeId,
conType:da.DateExCondition}},fromJSON:function(a){a&&(null!==a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank),null!==a.formula&&void 0!==a.formula&&(this.formula=a.formula),null!==a.expected&&void 0!==a.expected&&(this.expected=a.expected),null!==a.expectTypeId&&void 0!==a.expectTypeId&&(this.expectTypeId=a.expectTypeId))}};q.fromDay=function(a){a=new q(a);a.expectTypeId=5;return a};q.fromMonth=function(a){a=new q(a);a.expectTypeId=3;return a};q.fromQuarter=function(a){a=new q(a);
a.expectTypeId=2;return a};q.fromWeek=function(a){a=new q(a);a.expectTypeId=4;return a};q.fromYear=function(a){a=new q(a);a.expectTypeId=1;return a};A.DateExCondition=q;r.prototype={conditionType:"TextLengthCondition",evaluate:function(a,b,d,e){if(void 0===e||null===e||""===e)return this.ignoreBlank;e=void 0===e||null===e?0:e.length;a=this.getExpectedInt(a,b,d);if("number"===typeof a)switch(this.compareType){case M.EqualsTo:return e===a;case M.GreaterThan:return e>a;case M.GreaterThanOrEqualsTo:return e>=
a;case M.LessThan:return e<a;case M.LessThanOrEqualsTo:return e<=a;case M.NotEqualsTo:return e!==a}return!1},getExpectedInt:function(a,b,d){a=this.getExpected(a,b,d);a=parseInt(a,10);return isNaN(a)?null:a},getExpected:function(a,b,d){if(this.formula&&0<this.formula.length){var e=a.getCalcService(),f=e.parse(this.formula,b,d);return e.evaluateParsedFormula(a._getSheetSource(),f,b,d)}return this.expected},reset:function(){this.expected=null;this.ignoreBlank=!1;this.compareType=M.EqualsTo},toJSON:function(){return{compareType:this.compareType,
expected:this.expected,formula:this.formula,conType:da.TextLengthCondition,ignoreBlank:this.ignoreBlank}},fromJSON:function(a){a&&(null!==a.compareType&&void 0!==a.compareType&&(this.compareType=a.compareType),null!==a.expected&&void 0!==a.expected&&(this.expected=a.expected),null!==a.formula&&void 0!==a.formula&&(this.formula=a.formula),null!==a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank))}};A.TextLengthCondition=r;n.prototype=new ha;n.prototype.createCondition=function(){return new u(this.type,
this.rank,this.ranges)};n.prototype.reset=function(){this.type=N.Top;this.rank=10;this.style=null};n.prototype.toJSON=function(){return{ruleType:oa.Top10Rule,ranges:this.ranges,style:this.style,type:this.type,rank:this.rank}};n.prototype.fromJSON=function(a){if(a){if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}a.style&&(this.style=new A.Style,this.style.copyFrom(a.style));null!==a.type&&void 0!==a.type&&
(this.type=a.type);null!==a.rank&&void 0!==a.rank&&(this.rank=a.rank)}};A.Top10Rule=n;u.prototype={conditionType:"Top10Condition",adjustOffset:function(a,b){},evaluate:function(a,b,d,e){if(void 0===e||null===e||""===e)return this.ignoreBlank;d=this.getExpectedInt(a,b,d);if(void 0!==d&&null!==d&&(b=null,this.type===N.Top?b=this.getMaxValues(a,d,this.ranges):this.type===N.Bottom&&(b=this.getMinValues(a,d,this.ranges)),b)){a=0;try{a=this._toDouble(e)}catch(f){return!1}if(b.contains(a))return!0}return!1},
getExpectedInt:function(a,b,d){a=this.getExpected(a,b,d);a=parseInt(a,10);return isNaN(a)||!isFinite(a)?null:a},getExpected:function(a,b,d){if(this.formula&&0<this.formula.length){var e=a.getCalcService(),f=e.parse(this.formula,b,d);return e.evaluateParsedFormula(a._getSheetSource(),f,b,d)}return this.expected},getMaxValues:function(a,b,d){var e=[];if(d)for(var f=Number.MAX_VALUE,g=0,h=0;h<d.length;h++)for(var k=d[h],l=0;l<k.rowCount;l++)for(var n=l+k.row,m=0;m<k.colCount;m++){var q=a.getValue(n,
m+k.col),F=this._toDouble(q);if(void 0!==q&&null!==q&&void 0!==F&&null!==F)try{if(g<b)e.push(F),F<f&&(f=F),g++;else if(F>f&&(e.remove(f),e.push(F),0>e.indexOf(f)))for(f=F,q=0;q<e.length;q++)e[q]<f&&(f=e[q])}catch(Ka){}}return e},getMinValues:function(a,b,d){var e=[];if(d)for(var f=-Number.MAX_VALUE,g=0,h=0;h<d.length;h++)for(var k=d[h],l=0;l<k.rowCount;l++)for(var n=l+k.row,m=0;m<k.colCount;m++){var q=a.getValue(n,m+k.col),F=this._toDouble(q);if(void 0!==q&&null!==q&&void 0!==F&&null!==F)try{if(g<
b)e.push(F),F>f&&(f=F),g++;else if(F<f&&(e.remove(f),e.push(F),0>e.indexOf(f)))for(f=F,q=0;q<e.length;q++)e[q]>f&&(f=e[q])}catch(Ka){}}return e},reset:function(){this.expected=null;this.ignoreBlank=!1;this.type=N.Top;this.isPercent=!1;this.ranges=null},_toDouble:function(a){return"number"===typeof a||a instanceof Date?L.Convert.toDouble(a):null},toJSON:function(){return{expected:this.expected,formula:this.formula,type:this.type,isPercent:this.isPercent,ignoreBlank:this.ignoreBlank,ranges:this.ranges,
conType:da.Top10Condition}},fromJSON:function(a){if(a&&(null!==a.expected&&void 0!==a.expected&&(this.expected=a.expected),null!==a.formula&&void 0!==a.formula&&(this.formula=a.formula),null!==a.type&&void 0!==a.type&&(this.type=a.type),null!==a.isPercent&&void 0!==a.isPercent&&(this.isPercent=a.isPercent),null!==a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank),a.ranges)){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,
d.col,d.rowCount,d.colCount))}}}};A.Top10Condition=u;I.prototype=new ha;I.prototype.createCondition=function(){return new h(!1,this.ranges)};I.prototype.toJSON=function(){return{ruleType:oa.UniqueRule,ranges:this.ranges,style:this.style}};I.prototype.fromJSON=function(a){if(a){if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}a.style&&(this.style=new A.Style,this.style.copyFrom(a.style))}};A.UniqueRule=
I;E.prototype=new ha;E.prototype.createCondition=function(){return new h(!0,this.ranges)};E.prototype.toJSON=function(){return{ruleType:oa.DuplicateRule,ranges:this.ranges,style:this.style}};E.prototype.fromJSON=function(a){if(a){if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}a.style&&(this.style=new A.Style,this.style.copyFrom(a.style))}};A.DuplicateRule=E;h.prototype={conditionType:"UniqueCondition",
ignoreBlank:!1,adjustOffset:function(a,b){},evaluate:function(a,b,d,e){if(void 0===e||null===e||""===e)return this.ignoreBlank;var f=L.Convert;f.isNumber(e)&&(e=f.toDouble(e));b=this.getExpectedBoolean(a,b,d);return void 0!==b&&null!==b?(a=this.getDuplicated(a,this.ranges),void 0!==a&&null!==a&&a.contains(e)?!0===b:!0!==b):!1},getExpectedBoolean:function(a,b,d){a=this.getExpected(a,b,d);try{return L.Convert.toBool(a)}catch(e){return null}},getExpected:function(a,b,d){if(this.formula&&0<this.formula.length){var e=
a.getCalcService(),f=e.parse(this.formula,b,d);return e.evaluateParsedFormula(a._getSheetSource(),f,b,d)}return this.expected},getDuplicated:function(a,b){var d=[],e=[];if(b)for(var f=b.length,g=L.Convert,h=0;h<f;h++)for(var k=b[h],l=0;l<k.rowCount;l++)for(var n=l+k.row,m=0;m<k.colCount;m++){var q=a.getValue(n,m+k.col,3);void 0!==q&&null!==q&&(g.isNumber(q)&&(q=g.toDouble(q)),this._containsKey(d,q)?e.contains(q)||e.push(q):d.push({key:q,value:!1}))}return e},_containsKey:function(a,b){for(var d=a.length,
e=0;e<d;e++)if(a[e].key===b)return!0;return!1},reset:function(){this.expected=null;this.ignoreBlank=!1;this.ranges=null},toJSON:function(){return{expected:this.expected,formula:this.formula,ranges:this.ranges,conType:da.UniqueCondition,ignoreBlank:this.ignoreBlank}},fromJSON:function(a){if(a){null!==a.expected&&void 0!==a.expected&&(this.expected=a.expected);null!==a.formula&&void 0!==a.formula&&(this.formula=a.formula);if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];
this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}null!==a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank)}}};A.UniqueCondition=h;H.prototype=new ha;H.prototype.createCondition=function(){return new O(this.type,this.ranges)};H.prototype.reset=function(){this.type=ba.Above;this.style=null};H.prototype.toJSON=function(){return{ruleType:oa.AverageRule,ranges:this.ranges,style:this.style,type:this.type}};H.prototype.fromJSON=function(a){if(a){if(a.ranges){this.ranges=
[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}a.style&&(this.style=new A.Style,this.style.copyFrom(a.style));null!==a.type&&void 0!==a.type&&(this.type=a.type)}};A.AverageRule=H;O.prototype={conditionType:"AverageCondition",ignoreBlank:!1,adjustOffset:function(a,b){},evaluate:function(a,b,d,e){if(this.ignoreBlank&&(void 0===e||null===e||""===e))return!0;var f=L.Convert,g=f.toDouble;this._rebuildFormula();var h=this.getExpectedDouble(a,
b,d),k=null;a=this._stdevExpr?this._getExpectedByExpression(a,this._stdevExpr,b,d):null;if(void 0!==a&&null!==a)try{k=g(a)}catch(l){k=NaN}if(f.isNumber(e)&&(e=g(e),!isNaN(h)))switch(this.type){case ba.Above:return e>h;case ba.Below:return e<h;case ba.EqualOrAbove:return e>=h;case ba.EqualOrBelow:return e<=h;case ba.Above1StdDev:return isNaN(k)?!1:e>h+k;case ba.Below1StdDev:return isNaN(k)?!1:e<h-k;case ba.Above2StdDev:return isNaN(k)?!1:e>h+2*k;case ba.Below2StdDev:return isNaN(k)?!1:e<h-2*k;case ba.Above3StdDev:return isNaN(k)?
!1:e>h+3*k;case ba.Below3StdDev:return isNaN(k)?!1:e<h-3*k}return!1},_rebuildFormula:function(){this.ranges&&(this._expr=this._createExpression("AVERAGE",this.ranges),this.type===ba.Above1StdDev||this.type===ba.Below1StdDev||this.type===ba.Above2StdDev||this.type===ba.Below2StdDev||this.type===ba.Above3StdDev||this.type===ba.Below3StdDev)&&(this._stdevExpr=this._createExpression("STDEV",this.ranges))},_createExpression:function(a,b){var d=L.Expressions,e=L.Convert,f=L.Functions.findGlobalFunction(a);
if(f){for(var g=[],h=b.length,k=0;k<h;k++){var l=b[k];if(l instanceof d.Expression)g[k]=l;else if(l instanceof A.Range)g[k]=new d.RangeExpression(l.row,l.col,l.row+l.rowCount-1,l.col+l.colCount-1);else if(e.isNumber(l)&&!isNaN(l=e.toDouble(l)))g[k]=new d.DoubleExpression(l,l.toString());else throw"NotSupportedException";}return new d.FunctionExpression(f,g)}return null},getExpectedDouble:function(a,b,d){a=this.getExpected(a,b,d);try{return L.Convert.toDouble(a)}catch(e){return NaN}},getExpected:function(a,
b,d){var e=a.getCalcService(),f=e.unparse(this._expr,b,d);this._expr=e.parse(f,b,d);return e.evaluateParsedFormula(a._getSheetSource(),this._expr,b,d)},_getExpectedByExpression:function(a,b,d,e){var f=a.getCalcService();b=f.unparse(b,d,e);b=f.parse(b,d,e);return f.evaluateParsedFormula(a._getSheetSource(),b,d,e)},reset:function(){this.ignoreBlank=!1;this.type=ba.Above;this._stdevExpr=this._expr=this.ranges=null},toJSON:function(){return{type:this.type,ranges:this.ranges,conType:da.AverageCondition,
ignoreBlank:this.ignoreBlank}},fromJSON:function(a){if(a){null!==a.type&&void 0!==a.type&&(this.type=a.type);if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}null!==a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank)}}};A.AverageCondition=O;A.ScaleValue=C;K=new ha;K.isScaleRule=function(){return!0};K.createCondition=function(){return null};K._calculateLowestValueEx=function(a){return(a=
(new u).getMinValues(a,1,this.ranges))&&0<a.length?a[0]:null};K._calculateHighestValueEx=function(a){return(a=(new u).getMaxValues(a,1,this.ranges))&&0<a.length?a[0]:null};K._cloneRanges=function(a){for(var b=[],d=a.length,e=0;e<d;e++){var f=a[e];b.push(new A.Range(f.row,f.col,f.rowCount,f.colCount))}return b};K._rangesChanged=function(){this._oldRanges||(this._oldRanges=this._cloneRanges(this.ranges));if(this._oldRanges.length!==this.ranges.length)return!0;for(var a=0;a<this._oldRanges.length;a++)if(!this._oldRanges[a].equals(this.ranges[a]))return!0;
return!1};K._tryCache=function(a){this._rangesChanged()&&(this._clearCache(),this._oldRanges=this._cloneRanges(this.ranges));!1===this.cached&&(this.lowestValueCached=this._calculateLowestValueEx(a),this.highestValueCached=this._calculateHighestValueEx(a),this.cached=!0)};K._clearCache=function(){this.highestValueCached=this.lowestValueCached=null;this.cached=!1};K._calculateFormula=function(a,b,d,e){if(e&&0<e.length){var f=a.getCalcService();e=f.parse(e,b,d);return f.evaluateParsedFormula(a._getSheetSource(),
e,b,d)}return null};K._isFormula=function(a){return a&&"="===a[0]};K._trimFormula=function(a){return void 0===a||null===a||""===a?null:"="===a[0]?a.substr(1):a};K._calculateValue=function(a,b,d,e){var f=null;if(this._isFormula(e))f=this._calculateFormula(a,b,d,this._trimFormula(e.toString()));else try{f=L.Convert.toDouble(e)}catch(g){f=NaN}return f};K._getHighestValue=function(a){this._tryCache(a);return this.highestValueCached};K._getLowestValue=function(a){this._tryCache(a);return this.lowestValueCached};
K._calculatePercent=function(a,b,d,e){b=this._calculateValue(a,b,d,e);return!isNaN(b)&&0<=b&&100>=b&&(d=this._getLowestValue(a),a=this._getHighestValue(a),void 0!==d&&null!==d&&void 0!==a&&null!==a)?d+(a-d)*b/100:null};K._calculatePercentile=function(a,b,d,e){e=this._calculateValue(a,b,d,e);if(!isNaN(e)&&0<=e&&100>=e){for(var f=0,g=this.ranges.length,h=0;h<g;h++){var k=this._createExpression("PERCENTILE",[this.ranges[h],e/100]),l=a.getCalcService(),k=l.unparse(k,b,d),k=l.parse(k,b,d),l=l.evaluateParsedFormula(a._getSheetSource(),
k,b,d);try{f+=L.Convert.toDouble(l)}catch(n){}}return f/this.ranges.length}return null};K._getActualValue=function(a,b,d,e){if(e=this.scales[e])switch(e.type){case W.Formula:return this._calculateValue(a,b,d,e.value);case W.HighestValue:return this._getHighestValue(a);case W.LowestValue:return this._getLowestValue(a);case W.Number:return this._calculateValue(a,b,d,e.value);case W.Percent:return this._calculatePercent(a,b,d,e.value);case W.Percentile:return this._calculatePercentile(a,b,d,e.value);
case W.Automax:return a=this._getHighestValue(a),0>a?0:a;case W.Automin:return a=this._getLowestValue(a),0<a?0:a}return null};K._evaluate2Scale=function(a,b,d){return a<=b?0:a>=d?1:(a-b)/(d-b)};K.evaluate=function(a,b,d,e){this._tryCache(a);if(this.contains(b,d)){if(void 0===e||null===e)return null;try{var f=L.Convert.toDouble(e),g=this._getActualValue(a,b,d,0),h=this._getActualValue(a,b,d,1),k=this._getActualValue(a,b,d,2);if(isNaN(h)){if(!isNaN(g)&&!isNaN(k))return g>k?null:this._evaluate2Scale(f,
g,k)}else if(!isNaN(g)&&!isNaN(k)&&!isNaN(h)){if(g>k)return null;if(f<g)return 0;if(f>=k)return 2;this._evaluate2Scale(h,g,k);return g<=f&&f<=h?this._evaluate2Scale(f,g,h):1+this._evaluate2Scale(f,g,k)}}catch(l){}}return null};K._evaluateColor=function(a,b,d){if(0<=a&&1>=a){var e=A._Color;b=e.parse(b);d=e.parse(d);var f=b.r*(1-a)+d.r*a,g=b.g*(1-a)+d.g*a,h=b.b*(1-a)+d.b*a;return(new e(parseFloat((b.a*(1-a)+d.a*a)/255),parseInt(f,10),parseInt(g,10),parseInt(h,10))).toString()}return null};K._createExpression=
O.prototype._createExpression;K._addRows=function(a,b){ha.prototype._addRows.apply(this,arguments);this._clearCache()};K._addColumns=function(a,b){ha.prototype._addColumns.apply(this,arguments);this._clearCache()};K._removeRows=function(a,b){ha.prototype._removeRows.apply(this,arguments);this._clearCache()};K._removeColumns=function(a,b){ha.prototype._removeColumns.apply(this,arguments);this._clearCache()};G.prototype=K;A.ScaleRule=G;K=new G;K.evaluate=function(a,b,d,e){if(void 0!==e&&null!==e){var f=
NaN;try{L.Convert.isNumber(e)&&(f=L.Convert.toDouble(e))}catch(g){return null}if(isNaN(f))return null;e=this._getActualValue(a,b,d,0);a=this._getActualValue(a,b,d,2);if(void 0!==e&&null!==e&&void 0!==a&&null!==a)return f=this._evaluate2Scale(f,e,a),this._evaluateColor(f,this.expected[0],this.expected[2])}return null};K._init=function(){this.scales=Array(3);this.scales[0]=new C(W.LowestValue,null);this.scales[2]=new C(W.HighestValue,null);this.expected=Array(3);var a=A._Color;this.expected[0]=(new a(0,
255,255,255)).toString();this.expected[2]=(new a(255,99,190,123)).toString()};K.reset=function(){this.style=this.condition=this.ranges=null;this._init()};K.getMinimumType=function(){return this.scales&&3===this.scales.length?this.scales[0].type:null};K.setMinimumType=function(a){this.scales&&3===this.scales.length&&(this.scales[0].type=a)};K.getMinimumValue=function(){return this.scales&&3===this.scales.length?this.scales[0].value:null};K.setMinimumValue=function(a){this.scales&&3===this.scales.length&&
(this.scales[0].value=a)};K.getMinimumColor=function(){return this.expected&&3===this.expected.length?this.expected[0]:null};K.setMinimumColor=function(a){this.expected&&3===this.expected.length&&(this.expected[0]=a)};K.getMaximumType=function(){return this.scales&&3===this.scales.length?this.scales[2].type:null};K.setMaximumType=function(a){this.scales&&3===this.scales.length&&(this.scales[2].type=a)};K.getMaximumValue=function(){return this.scales&&3===this.scales.length?this.scales[2].value:null};
K.setMaximumValue=function(a){this.scales&&3===this.scales.length&&(this.scales[2].value=a)};K.getMaximumColor=function(){return this.expected&&3===this.expected.length?this.expected[2]:null};K.setMaximumColor=function(a){this.expected&&3===this.expected.length&&(this.expected[2]=a)};K.toJSON=function(){return{ruleType:oa.TwoScaleRule,ranges:this.ranges,minType:this.getMinimumType(),minValue:this.getMinimumValue(),minColor:this.getMinimumColor(),maxType:this.getMaximumType(),maxValue:this.getMaximumValue(),
maxColor:this.getMaximumColor()}};K.fromJSON=function(a){if(a){if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}null!==a.minType&&void 0!==a.minType&&this.setMinimumType(a.minType);null!==a.minValue&&void 0!==a.minValue&&this.setMinimumValue(a.minValue);null!==a.minColor&&void 0!==a.minColor&&this.setMinimumColor(a.minColor);null!==a.maxType&&void 0!==a.maxType&&this.setMaximumType(a.maxType);null!==
a.maxValue&&void 0!==a.maxValue&&this.setMaximumValue(a.maxValue);null!==a.maxColor&&void 0!==a.maxColor&&this.setMaximumColor(a.maxColor)}};z.prototype=K;A.TwoScaleRule=z;K=new G;K.evaluate=function(a,b,d,e){this._evaluator=a;if(void 0!==e&&null!==e){var f=NaN;try{L.Convert.isNumber(e)&&(f=L.Convert.toDouble(e))}catch(g){return null}if(isNaN(f))return null;e=this._getActualValue(a,b,d,0);var h=this._getActualValue(a,b,d,1);a=this._getActualValue(a,b,d,2);if(void 0!==e&&null!==e&&void 0!==a||null!==
a&&void 0!==h&&null!==h){if(e>a)return null;if(f<e)return this.expected[0];if(f>=a)return this.expected[2];if(e<=f&&f<=h)return f=this._evaluate2Scale(f,e,h),this._evaluateColor(f,this.expected[0],this.expected[1]);f=this._evaluate2Scale(f,h,a);return this._evaluateColor(f,this.expected[1],this.expected[2])}}return null};K._init=function(){this.scales=Array(3);this.scales[0]=new C(W.LowestValue,null);this.scales[1]=new C(W.Percentile,50);this.scales[2]=new C(W.HighestValue,null);this.expected=Array(3);
var a=A._Color;this.expected[0]=(new a(255,248,105,107)).toString();this.expected[1]=(new a(255,255,235,132)).toString();this.expected[2]=(new a(255,99,190,123)).toString()};K.reset=function(){this.style=this.condition=this.ranges=null;this._init();this._evaluator=null};K.getMinimumType=function(){return this.scales&&3===this.scales.length?this.scales[0].type:null};K.setMinimumType=function(a){this.scales&&3===this.scales.length&&(this.scales[0].type=a)};K.getMinimumValue=function(){return this.scales&&
3===this.scales.length?this.scales[0].value:null};K.setMinimumValue=function(a){this.scales&&3===this.scales.length&&(this.scales[0].value=a)};K.getMinimumColor=function(){return this.expected&&3===this.expected.length?this.expected[0]:null};K.setMinimumColor=function(a){this.expected&&3===this.expected.length&&(this.expected[0]=a)};K.getMidpointType=function(){return this.scales&&3===this.scales.length?this.scales[1].type:null};K.setMidpointType=function(a){this.scales&&3===this.scales.length&&(this.scales[1].type=
a)};K.getMidpointValue=function(){if(this.scales&&3===this.scales.length){if(this._evaluator){if(this.scales[1].type===W.HighestValue)return this._getHighestValue(this._evaluator);if(this.scales[1].type===W.LowestValue)return this._getLowestValue(this._evaluator)}return this.scales[1].value}return null};K.setMidpointValue=function(a){this.scales&&3===this.scales.length&&(this.scales[1].value=a)};K.getMidpointColor=function(){return this.expected&&3===this.expected.length?this.expected[1]:null};K.setMidpointColor=
function(a){this.expected&&3===this.expected.length&&(this.expected[1]=a)};K.getMaximumType=function(){return this.scales&&3===this.scales.length?this.scales[2].type:null};K.setMaximumType=function(a){this.scales&&3===this.scales.length&&(this.scales[2].type=a)};K.getMaximumValue=function(){return this.scales&&3===this.scales.length?this.scales[2].value:null};K.setMaximumValue=function(a){this.scales&&3===this.scales.length&&(this.scales[2].value=a)};K.getMaximumColor=function(){return this.expected&&
3===this.expected.length?this.expected[2]:null};K.setMaximumColor=function(a){this.expected&&3===this.expected.length&&(this.expected[2]=a)};K.toJSON=function(){return{ruleType:oa.ThreeScaleRule,ranges:this.ranges,minType:this.getMinimumType(),minValue:this.getMinimumValue(),minColor:this.getMinimumColor(),midType:this.getMidpointType(),midValue:this.getMidpointValue(),midColor:this.getMidpointColor(),maxType:this.getMaximumType(),maxValue:this.getMaximumValue(),maxColor:this.getMaximumColor()}};
K.fromJSON=function(a){if(a){if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}null!==a.minType&&void 0!==a.minType&&this.setMinimumType(a.minType);null!==a.minValue&&void 0!==a.minValue&&this.setMinimumValue(a.minValue);null!==a.minColor&&void 0!==a.minColor&&this.setMinimumColor(a.minColor);null!==a.midType&&void 0!==a.midType&&this.setMidpointType(a.midType);null!==a.midValue&&void 0!==a.midValue&&
this.setMidpointValue(a.midValue);null!==a.midColor&&void 0!==a.midColor&&this.setMidpointColor(a.midColor);null!==a.maxType&&void 0!==a.maxType&&this.setMaximumType(a.maxType);null!==a.maxValue&&void 0!==a.maxValue&&this.setMaximumValue(a.maxValue);null!==a.maxColor&&void 0!==a.maxColor&&this.setMaximumColor(a.maxColor)}};S.prototype=K;A.ThreeScaleRule=S;K=new G;K._init=function(a){this._gradient=!0;this._color=a;this._showBorder=!1;this._borderColor="black";this._dataBarDirection=ja.LeftToRight;
this._negativeFillColor="red";this._useNegativeFillColor=!0;this._negativeBorderColor="black";this._useNegativeBorderColor=!1;this._axisPosition=fa.Automatic;this._axisColor="black";this._showBarOnly=!1};K._calcuteMinValue=function(a,b,d,e,f){var g=this.scales[e];e=null;if(g)if(g.type===W.Formula||g.type===W.Percentile){for(d=0;d<this.ranges.length;d++)if(this.ranges[d].intersect(b,-1,1,-1)){e=this.ranges[d];break}if(e)return this._getActualValue(a,e.row,e.col,0,f)}else return this._getActualValue(a,
b,d,0,f);return null};K._calcuteMaxValue=function(a,b,d,e,f){var g=this.scales[e];e=null;if(g)if(g.type===W.Formula||g.type===W.Percentile){for(d=0;d<this.ranges.length;d++)if(this.ranges[d].intersect(b,-1,1,-1)){e=this.ranges[d];break}if(e)return this._getActualValue(a,e.row,e.col,2,f)}else return this._getActualValue(a,b,d,2,f);return null};K._evaluateNoneScale=function(a,b,d,e){e=0;return d===b?a<b?[0,e]:a>d?[1,e]:[0.5,e]:a>=d?[1,e]:a<=b?[0,e]:[(a-b)/(d-b),e]};K._evaluateMidScale=function(a,b,
d,e){e=0.5;var f=Math.abs(d-b);if(0<d&&0<=b)return d===b?[0.5,e]:a>=d?[0.5,e]:a<=b?[0.5*(b/d),e]:[0.5*Math.abs(a/d),e];if(0<d&&0>b){var g=d>Math.abs(b)?0.5:d/f,f=d>Math.abs(b)?b/f:-0.5;return 0<a?a>=d?[g,e]:[a/d*g,e]:0>a?a<=b?[f,e]:[a/b*f,e]:[0,e]}return 0>=d&&0>b?d===b?[-0.5,e]:a>=d?[0.5*(-d/b),e]:a<=b?[-0.5,e]:[0.5*(-a/b),e]:0===d&&0===b?[0,e]:[-1,-1]};K._evaluateAutoScale=function(a,b,d,e){var f=Math.abs(d-b);return 0<d&&0<=b?(e=0,b===d?a<b?[0,e]:a>d?[1,e]:[0.5,e]:a<=b?[0,e]:a>=d?[1,e]:[(a-b)/
f,e]):0<d&&0>b?(e=Math.abs(b)/f,a>=d?[1-e,e]:a<=b?[-e,e]:0===a?[0,e]:[(a-0)/f,e]):0>=d&&0>b?(e=1,d===b?a<b?[-1,e]:a>d?[0,e]:[-0.5,e]:a>=d?[-0,e]:a<=b?[-1,e]:[(a-d)/f,e]):0===d&&0===b?(e=0.5,0<a?[0.5,e]:0>a?[-0.5,e]:[0,e]):[-1,-1]};K._evaluateScale=function(a,b,d,e){return this._axisPosition===fa.Automatic?this._evaluateAutoScale(a,b,d,e):this._axisPosition===fa.CellMidPoint?this._evaluateMidScale(a,b,d,e):this._evaluateNoneScale(a,b,d,e)};K.evaluate=function(a,b,d,e){if(null!==e&&void 0!==e){var f=
NaN;try{L.Convert.isNumber(e)&&(f=L.Convert.toDouble(e))}catch(g){return null}if(isNaN(f))return null;var h=this._calcuteMinValue(a,b,d,0,e);a=this._calcuteMaxValue(a,b,d,2,e);if(null!==h&&void 0!==h&&null!==a&&void 0!==a){h>a&&(b=a,a=h,h=b);var k;k=this._evaluateScale(f,h,a,k);if(!k||2>k.length)return null;h=k[0];k=k[1];return{fillColor:0>f&&this._useNegativeFillColor?this._negativeFillColor:this._color,borderColor:0>f&&this._useNegativeBorderColor?this._negativeBorderColor:this._borderColor,showBorder:this._showBorder,
axisColor:this._axisColor,isGradient:this._gradient,direction:this._dataBarDirection,axisLocation:k,scale:h,showBarOnly:this._showBarOnly}}}return null};K.minimumType=function(a){if(0===arguments.length)return this.scales&&3===this.scales.length?this.scales[0].type:null;this.scales&&3===this.scales.length&&(this.scales[0].type=a);return this};K.minimumValue=function(a){if(0===arguments.length)return this.scales&&3===this.scales.length?this.scales[0].value:null;this.scales&&3===this.scales.length&&
(this.scales[0].value=a);return this};K.maximumType=function(a){if(0===arguments.length)return this.scales&&3===this.scales.length?this.scales[2].type:null;this.scales&&3===this.scales.length&&(this.scales[2].type=a);return this};K.maximumValue=function(a){if(0===arguments.length)return this.scales&&3===this.scales.length?this.scales[2].value:null;this.scales&&3===this.scales.length&&(this.scales[2].value=a);return this};K.gradient=function(a){if(0===arguments.length)return this._gradient;this._gradient=
a;return this};K.color=function(a){if(0===arguments.length)return this._color;this._color=a;return this};K.showBorder=function(a){if(0===arguments.length)return this._showBorder;this._showBorder=a;return this};K.borderColor=function(a){if(0===arguments.length)return this._borderColor;this._borderColor=a;return this};K.dataBarDirection=function(a){if(0===arguments.length)return this._dataBarDirection;this._dataBarDirection=a;return this};K.negativeFillColor=function(a){if(0===arguments.length)return this._negativeFillColor;
this._negativeFillColor=a;return this};K.useNegativeFillColor=function(a){if(0===arguments.length)return this._useNegativeFillColor;this._useNegativeFillColor=a;return this};K.negativeBorderColor=function(a){if(0===arguments.length)return this._negativeBorderColor;this._negativeBorderColor=a;return this};K.useNegativeBorderColor=function(a){if(0===arguments.length)return this._useNegativeBorderColor;this._useNegativeBorderColor=a;return this};K.axisPosition=function(a){if(0===arguments.length)return this._axisPosition;
this._axisPosition=a;return this};K.axisColor=function(a){if(0===arguments.length)return this._axisColor;this._axisColor=a;return this};K.showBarOnly=function(a){if(0===arguments.length)return this._showBarOnly;this._showBarOnly=a;return this};K.toJSON=function(){return{ruleType:oa.DataBarRule,ranges:this.ranges,minType:this.minimumType(),minValue:this.minimumValue(),maxType:this.maximumType(),maxValue:this.maximumValue(),gradient:this.gradient(),color:this.color(),showBorder:this.showBorder(),borderColor:this.borderColor(),
dataBarDirection:this.dataBarDirection(),negativeFillColor:this.negativeFillColor(),useNegativeFillColor:this.useNegativeFillColor(),negativeBorderColor:this.negativeBorderColor(),useNegativeBorderColor:this.useNegativeBorderColor(),axisPosition:this.axisPosition(),axisColor:this.axisColor(),showBarOnly:this.showBarOnly()}};K.fromJSON=function(a){if(a){if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}null!==
a.minType&&void 0!==a.minType&&this.minimumType(a.minType);null!==a.minValue&&void 0!==a.minValue&&this.minimumValue(a.minValue);null!==a.maxType&&void 0!==a.maxType&&this.maximumType(a.maxType);null!==a.maxValue&&void 0!==a.maxValue&&this.maximumValue(a.maxValue);null!==a.gradient&&void 0!==a.gradient&&this.gradient(a.gradient);null!==a.color&&void 0!==a.color&&this.color(a.color);null!==a.showBorder&&void 0!==a.showBorder&&this.showBorder(a.showBorder);null!==a.borderColor&&void 0!==a.borderColor&&
this.borderColor(a.borderColor);null!==a.dataBarDirection&&void 0!==a.dataBarDirection&&this.dataBarDirection(a.dataBarDirection);null!==a.negativeFillColor&&void 0!==a.negativeFillColor&&this.negativeFillColor(a.negativeFillColor);null!==a.useNegativeFillColor&&void 0!==a.useNegativeFillColor&&this.useNegativeFillColor(a.useNegativeFillColor);null!==a.negativeBorderColor&&void 0!==a.negativeBorderColor&&this.negativeBorderColor(a.negativeBorderColor);null!==a.useNegativeBorderColor&&void 0!==a.useNegativeBorderColor&&
this.useNegativeBorderColor(a.useNegativeBorderColor);null!==a.axisPosition&&void 0!==a.axisPosition&&this.axisPosition(a.axisPosition);null!==a.axisColor&&void 0!==a.axisColor&&this.axisColor(a.axisColor);null!==a.showBarOnly&&void 0!==a.showBarOnly&&this.showBarOnly(a.showBarOnly)}};Q.prototype=K;A.DataBarRule=Q;A.IconCriterion=aa;K=new G;K._initIconSetType=function(a){this._iconSetType=a;this._iconSetType>=la.ThreeArrowsColored&&this._iconSetType<=la.ThreeSymbolsUncircled?(this._iconCriteria=Array(2),
this._iconCriteria[0]=new aa(!0,ra.Percent,33),this._iconCriteria[1]=new aa(!0,ra.Percent,67)):this._iconSetType>=la.FourArrowsColored&&this._iconSetType<=la.FourTrafficLights?(this._iconCriteria=Array(3),this._iconCriteria[0]=new aa(!0,ra.Percent,25),this._iconCriteria[1]=new aa(!0,ra.Percent,50),this._iconCriteria[2]=new aa(!0,ra.Percent,75)):this._iconSetType>=la.FiveArrowsColored&&this._iconSetType<=la.FiveBoxes?(this._iconCriteria=Array(4),this._iconCriteria[0]=new aa(!0,ra.Percent,20),this._iconCriteria[1]=
new aa(!0,ra.Percent,40),this._iconCriteria[2]=new aa(!0,ra.Percent,60),this._iconCriteria[3]=new aa(!0,ra.Percent,80)):this._iconSetType>la.FiveBoxes&&(this._iconCriteria=[])};K._init=function(a){this._reverseIconOrder=this._showIconOnly=!1;this._initIconSetType(a)};K._modifyIconIndex=function(a){var b=this._iconCriteria.length+1;return this._reverseIconOrder&&2<b?b-1-a:a};K._getActualValue=function(a,b,d,e){if(e=this._iconCriteria[e])switch(e.iconValueType){case ra.Formula:return this._calculateValue(a,
b,d,e.iconValue);case ra.Number:return this._calculateValue(a,b,d,e.iconValue);case ra.Percent:return this._calculatePercent(a,b,d,e.iconValue);case ra.Percentile:return this._calculatePercentile(a,b,d,e.iconValue)}return null};K.evaluate=function(a,b,d,e){if(null===e||void 0===e)return null;var f=NaN;try{L.Convert.isNumber(e)&&(f=L.Convert.toDouble(e))}catch(g){return null}if(isNaN(f))return null;var h=0;this._iconSetType>=la.ThreeArrowsColored&&this._iconSetType<=la.ThreeSymbolsUncircled?h=3:this._iconSetType>=
la.FourArrowsColored&&this._iconSetType<=la.FourTrafficLights?h=4:this._iconSetType>=la.FiveArrowsColored&&this._iconSetType<=la.FiveBoxes&&(h=5);if(!this._iconCriteria)return 0;e=Number.MAX_VALUE;for(h-=1;0<h;h--)if(h<this._iconCriteria.length+1){var k=this._iconCriteria[h-1];if(k&&null!==k.iconValue&&void 0!==k.iconValue){var l=this._getActualValue(a,b,d,h-1);if(null!==l&&void 0!==l)if(k.isGreaterThanOrEqualTo){if(f<e&&f>=l)return{iconSetType:this._iconSetType,iconIndex:this._modifyIconIndex(h),
showIconOnly:this._showIconOnly}}else{if(f<e&&f>l)return{iconSetType:this._iconSetType,iconIndex:this._modifyIconIndex(h),showIconOnly:this._showIconOnly}}else break}else break}else break;return{iconSetType:this._iconSetType,iconIndex:this._modifyIconIndex(0),showIconOnly:this._showIconOnly}};K.reset=function(){this.style=this.condition=this.ranges=null;this._reverseIconOrder=this._showIconOnly=!1;this._iconSetType=la.ThreeArrowsColored;this._iconCriteria=null};K.iconSetType=function(a){if(0===arguments.length)return this._iconSetType;
this._initIconSetType(a);return this};K.reverseIconOrder=function(a){if(0===arguments.length)return this._reverseIconOrder;this._reverseIconOrder=a;return this};K.showIconOnly=function(a){if(0===arguments.length)return this._showIconOnly;this._showIconOnly=a;return this};K.iconCriteria=function(){return this._iconCriteria};K.toJSON=function(){return{ruleType:oa.IconSetRule,ranges:this.ranges,iconSetType:this.iconSetType(),iconCriteria:this.iconCriteria(),showIconOnly:this.showIconOnly(),reverseIconOrder:this.reverseIconOrder()}};
K.fromJSON=function(a){if(a){if(a.ranges){this.ranges=[];for(var b=0;b<a.ranges.length;b++){var d=a.ranges[b];this.ranges.push(new A.Range(d.row,d.col,d.rowCount,d.colCount))}}null!==a.iconSetType&&void 0!==a.iconSetType&&this._initIconSetType(a.iconSetType);if(null!==a.iconCriteria&&void 0!==a.iconCriteria)for(d=a.iconCriteria.length,b=0;b<d;b++){var e=a.iconCriteria[b];this._iconCriteria[b]=new aa(e.isGreaterThanOrEqualTo,e.iconValueType,e.iconValue)}null!==a.showIconOnly&&void 0!==a.showIconOnly&&
this.showIconOnly(a.showIconOnly);null!==a.reverseIconOrder&&void 0!==a.reverseIconOrder&&this.reverseIconOrder(a.reverseIconOrder)}};ka.prototype=K;ka._getImageSrc=function(){return"data:image/png;base64,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"};
ka.getIcon=function(a,b){var d=ka._getImageSrc(),e=[["0,160,16,16","0,180,16,16","0,80,16,16",null,null],["0,100,16,16","0,120,16,16","0,140,16,16",null,null],["0,900,16,16","0,920,16,16","0,880,16,16",null,null],["0,820,16,16","0,840,16,16","0,860,16,16",null,null],["0,780,16,16","0,1000,16,16","0,420,16,16",null,null],["0,680,16,16","0,940,16,16","0,400,16,16",null,null],["0,800,16,16","0,1020,16,16","0,440,16,16",null,null],["0,740,16,16","0,1040,16,16","0,400,16,16",null,null],["0,720,16,16",
"0,980,16,16","0,380,16,16",null,null],["0,700,16,16","0,960,16,16","0,360,16,16",null,null],["0,160,16,16","0,40,16,16","0,60,16,16","0,80,16,16",null],["0,100,16,16","0,0,16,16","0,20,16,16","0,140,16,16",null],["0,220,16,16","0,340,16,16","0,460,16,16","0,760,16,16",null],["0,600,16,16","0,620,16,16","0,640,16,16","0,660,16,16",null],["0,200,16,16","0,680,16,16","0,940,16,16","0,400,16,16",null],["0,160,16,16","0,40,16,16","0,180,16,16","0,60,16,16","0,80,16,16"],["0,100,16,16","0,0,16,16","0,120,16,16",
"0,20,16,16","0,140,16,16"],["0,580,16,16","0,600,16,16","0,620,16,16","0,640,16,16","0,660,16,16"],["0,480,16,16","0,500,16,16","0,520,16,16","0,540,16,16","0,560,16,16"],["0,240,16,16","0,260,16,16","0,280,16,16","0,300,16,16","0,320,16,16"]][a][b];return e?(e=e.split(","),{image:d,x:e[0],y:e[1],w:e[2],h:e[3]}):null};A.IconSetRule=ka;J.prototype={rules:null,worksheet:null,getRule:function(a){return this.rules[a]},count:function(){return this.rules.length},_cloneRanges:function(a){for(var b=[],d=
a.length,e=0;e<d;e++)b.push(this.worksheet._getActualRange(a[e]));return b},addSpecificTextRule:function(a,b,e,f){a=new d(a,b,e);a.ranges=f;return this.addRule(a)},addCellValueRule:function(a,b,d,e,f){a=new k(a,b,d,e);a.ranges=f;return this.addRule(a)},addDateOccurringRule:function(a,b,d){a=new t(a,b);a.ranges=d;return this.addRule(a)},addFormulaRule:function(a,b,d){a=new f(a,b);a.ranges=d;return this.addRule(a)},addTop10Rule:function(a,b,d,e){a=new n(a,b,d);a.ranges=e;return this.addRule(a)},addUniqueRule:function(a,
b){var d=new I(a);d.ranges=b;return this.addRule(d)},addDuplicateRule:function(a,b){var d=new E(a);d.ranges=b;return this.addRule(d)},addAverageRule:function(a,b,d){a=new H(a,b);a.ranges=d;return this.addRule(a)},add3ScaleRule:function(a,b,d,e,f,g,h,k,l,n){a=new S(a,b,d,e,f,g,h,k,l);a.ranges=n;return this.addRule(a)},add2ScaleRule:function(a,b,d,e,f,g,h){a=new z(a,b,d,e,f,g);a.ranges=h;return this.addRule(a)},addDataBarRule:function(a,b,d,e,f,g){a=new Q(a,b,d,e,f);a.ranges=g;return this.addRule(a)},
addIconSetRule:function(a,b){var d=new ka(a);d.ranges=b;return this.addRule(d)},addRule:function(a){if(this.worksheet){var b=this;return this.worksheet._bindToAutoRefresh(function(a){if(!a)throw Error("rule");a.ranges=b._cloneRanges(a.ranges);b.rules.push(a);return a})(a)}},removeRule:function(a){if(this.worksheet){var b=this;this.worksheet._bindToAutoRefresh(function(a){a&&b.rules.remove(a)})(a)}},_removeRange:function(a,b,d,e,f){if(!a.intersect(b,d,e,f))return[a];var g=a.row,h=a.row+a.rowCount-
1,k=a.col;a=a.col+a.colCount-1;e=b+e-1;var l=d+f-1;f=[];if(-1!==g&&-1!==k&&-1!==b&&-1!==d){if(0<d-k&&0<b-g){var n=new A.Range(g,k,b-g,d-k);f.push(n)}0<=Math.min(l,a)-Math.max(d,k)&&0<b-g&&(n=new A.Range(g,Math.max(d,k),b-g,Math.min(l,a)-Math.max(d,k)+1),f.push(n));0<a-l&&0<b-g&&(n=new A.Range(g,l+1,b-g,a-l),f.push(n));0<d-k&&0<=Math.min(e,h)-Math.max(b,g)&&(n=new A.Range(Math.max(b,g),k,Math.min(e,h)-Math.max(b,g)+1,d-k),f.push(n));0<a-l&&0<=Math.min(e,h)-Math.max(b,g)&&(b=new A.Range(Math.max(b,
g),l+1,Math.min(e,h)-Math.max(b,g)+1,a-l),f.push(b));0<d-k&&0<h-e&&(b=new A.Range(e+1,k,h-e,d-k),f.push(b));0<=Math.min(l,a)-Math.max(d,k)&&0<h-e&&(d=new A.Range(e+1,Math.max(d,k),h-e,Math.min(l,a)-Math.max(d,k)+1),f.push(d));0<a-l&&0<h-e&&(h=new A.Range(e+1,l+1,h-e,a-l),f.push(h))}return 0<f.length?f:null},removeRuleByRange:function(a,b,d,e){if(this.worksheet){var f=this;this.worksheet._bindToAutoRefresh(function(a,b,d,e){var g=[];if(f.rules)for(var h=0,k=f.rules.length;h<k;h++){var l=f.rules[h];
if(l&&l.ranges&&l.intersects(a,b,d,e)){for(var n=[],m=0,q=l.ranges.length;m<q;m++){var r=f._removeRange(l.ranges[m],a,b,d,e);r&&(n=n.concat(r))}0<n.length?l.ranges=n:g.push(l)}}a=0;for(b=g.length;a<b;a++)f.rules.remove(g[a])})(a,b,d,e)}},clearRule:function(){if(this.worksheet){var a=this;this.worksheet._bindToAutoRefresh(function(){a.rules.length=0})()}},getRules:function(a,b){var d=[];if(this.rules)for(var e=0;e<this.rules.length;e++){var f=this.rules[e];f&&f.intersects(a,b,1,1)&&d.push(f)}return d},
containsRule:function(a,b,d){return a&&this.rules.contains(a)?a.contains(b,d):!1},_clearNullRefRules:function(){if(this.rules)for(var a=this.count()-1;-1<a;a--){var b=this.rules[a];b.hasNoReference()&&this.removeRule(b)}},_addRows:function(a,b){if(this.rules&&this.worksheet)for(var d=this.rules.length,e=0;e<d;e++){var f=this.rules[e];f&&f._addRows(a,b)}},_addColumns:function(a,b){if(this.rules&&this.worksheet)for(var d=this.rules.length,e=0;e<d;e++){var f=this.rules[e];f&&f._addColumns(a,b)}},_removeRows:function(a,
b){if(this.rules&&this.worksheet)for(var d=this.rules.length,e=0;e<d;e++){var f=this.rules[e];f&&f._removeRows(a,b)}},_removeColumns:function(a,b){if(this.rules&&this.worksheet)for(var d=this.rules.length,e=0;e<d;e++){var f=this.rules[e];f&&f._removeColumns(a,b)}},_clearCache:function(){if(null!=this.rules)for(var a=0;a<this.rules.length;a++){var b=this.rules[a];b instanceof G&&b._clearCache()}},toJSON:function(){for(var a=[],b=0;b<this.rules.length;b++){var d=this.rules[b];a.push(d?d.toJSON():null)}return{rules:a}},
fromJSON:function(a){if(a&&a.rules){this.rules=[];for(var b=0;b<a.rules.length;b++){var d=a.rules[b],e=null;if(d){var f=this._getRuleTypes()[d.ruleType];f&&(e=new f,e.fromJSON(d))}e&&this.rules.push(e)}}},_getRuleTypes:function(){if(!this._ruleTypes){var a={};a[oa.ConditionRuleBase]=ha;a[oa.CellValueRule]=k;a[oa.SpecificTextRule]=d;a[oa.FormulaRule]=f;a[oa.DateOccurringRule]=t;a[oa.Top10Rule]=n;a[oa.UniqueRule]=I;a[oa.DuplicateRule]=E;a[oa.AverageRule]=H;a[oa.ScaleValue]=C;a[oa.TwoScaleRule]=z;a[oa.ThreeScaleRule]=
S;a[oa.DataBarRule]=Q;a[oa.IconSetRule]=ka;this._ruleTypes=a}return this._ruleTypes}};A.ConditionalFormats=J})(window,jQuery);
(function(p){function l(a){return 1!==a}function m(a,b){this.criteriaOperator=a;this.criteriaValue=b}function k(a,b,d){this.database=a;this.criteria=d;this.row=0;if(3===arguments.length){this.column=this.columnIndex(a,b);if(2>a.getRowCount()||1>a.getColumnCount())throw"InvalidCastException";if(2>d.getRowCount()||1>d.getColumnCount())throw"InvalidCastException";if(0>this.column||this.database.getColumnCount()<=this.column)throw"InvalidCastException";}else if(2===arguments.length){this.column=-1;if(2>
a.getRowCount()||1>a.getColumnCount())throw"InvalidCastException";if(2>d.getRowCount()||1>d.getColumnCount())throw"InvalidCastException";}else throw"InvalidNullException";}var g=p.GrapeCity;"undefined"===typeof g&&(p.GrapeCity=g={});"undefined"===typeof g.Calc&&(g.Calc={});var a=g.Calc;"undefined"===typeof a.Functions&&(a.Functions={});var d=a.Functions;d._builtInFunctions=d._builtInFunctions||{};"undefined"===typeof d._defineBuildInFunction&&(d._defineBuildInFunction=function(a,b,f){if(!a)throw"Invalid function name";
var g;a=a.toUpperCase();if(d._builtInFunctions.hasOwnProperty(a))if(g=d._builtInFunctions[a],!g)d._builtInFunctions[a]=new d.Function(a,0,255),g=d[a.toUpperCase()];else{if(!f||!f.override)throw"Attempt to override function while override is not allowed";}else g=new d.Function(a,0,255),d._builtInFunctions[a]=g;b&&"function"===typeof b&&(g.evaluate=b);if(f)for(var k in f)f.hasOwnProperty(k)&&"override"!==k&&(g[k]=f[k]);return g});p=d._defineBuildInFunction;m.prototype={evaluate:function(d){d=this.criteriaOperator.evaluate(d,
this.criteriaValue,null);return"boolean"===typeof d?a.Convert.toBool(d):!1}};k.prototype={columnIndex:function(d,b){if("string"===typeof b){for(var f=0;f<d.getColumnCount();f++){var g=a.Convert.toString(d.getValue(0,f));if(g&&this.ignoreCaseEqual(g,b))return f}return-1}return a.Convert.toInt(b)-1},current:function(){if(0>=this.row||this.database.getRowCount()<=this.row)throw"InvalidOperationException";return this.database.getValue(this.row,this.column)},moveNext:function(){for(var a=!1;!a&&this.row<
this.database.getRowCount();)this.row++,this.row<this.database.getRowCount()&&(a=this.rowMeetsCriteria());return a},createEvaluator:function(a){if("string"===typeof a){for(var b=g.Calc.Convert.toString(a),d=new g.UI._StringHelper(b),l=0,q=0;q<k.operators.length;q++)if(d.startsWith(k.operators[q].getName()))return b=b.substring(k.operators[q].getName().length),a=isNaN(l=g.UI._NumberHelper.parseInvariant(b))?this.ignoreCaseEqual("true",b)?!0:this.ignoreCaseEqual("false",b)?!1:b:l,new m(k.operators[q],
a);return new m(g.Calc.Operators.equal,a)}return a?new m(g.Calc.Operators.equal,a):null},rowMeetsCriteria:function(){for(var a=!1,b=1;!a&&b<this.criteria.getRowCount();b++)for(var a=!0,d=0;a&&d<this.criteria.getColumnCount();d++){var g=this.createEvaluator(this.criteria.getValue(b,d));g&&(a=this.columnIndex(this.database,this.criteria.getValue(0,d)),a=this.database.getValue(this.row,a),a=g.evaluate(a))}return a},reset:function(){this.row=0},ignoreCaseEqual:function(a,b){a=a.toLowerCase();b=b.toLowerCase();
return a===b}};k.operators=[g.Calc.Operators.equal,g.Calc.Operators.notEqual,g.Calc.Operators.lessThanOrEqual,g.Calc.Operators.greaterThanOrEqual,g.Calc.Operators.lessThan,g.Calc.Operators.greaterThan];p("DAVERAGE",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";for(var b=a.Convert._toArray(d[0]),f=d[1],l=a.Convert._toArray(d[2]),m=d=0,b=new k(b,f,l);b.moveNext();)if(f=b.current(),g.Calc.Convert.isNumber(f)){if(isNaN(f=a.Convert.toDouble(f)))return a.Convert.Errors.Value;d+=f;m++}else if(a.Convert.isError(f))return f;
return 0===m?a.Errors.DivideByZero:a.Convert.toResult(d/m)},{minArgs:3,maxArgs:3,acceptsReference:l,acceptsArray:l});p("DCOUNT",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";var b=a.Convert._toArray(d[0]),f=d[1],l=a.Convert._toArray(d[2]),m=0,p=null;if(g.Calc._Helper._argumentExists(d,1))for(p=new k(b,f,l);p.moveNext();)d=p.current(),g.Calc.Convert.isNumber(d)&&m++;else for(p=new k(b,l);p.moveNext();)m++;return g.Calc.Convert.toResult(m)},{minArgs:3,maxArgs:3,acceptsReference:l,
acceptsArray:l});p("DCOUNTA",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";var b=a.Convert._toArray(d[0]),f=d[1],l=a.Convert._toArray(d[2]),m=0,p=null;if(g.Calc._Helper._argumentExists(d,1))for(p=new k(b,f,l);p.moveNext();)p.current()&&m++;else for(p=new k(b,l);p.moveNext();)m++;return g.Calc.Convert.toResult(m)},{minArgs:3,maxArgs:3,acceptsReference:l,acceptsArray:l});p("DGET",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";var b=a.Convert._toArray(d[0]),f=d[1],
l=a.Convert._toArray(d[2]);d=null;b=new k(b,f,l);if(b.moveNext()){if(d=b.current(),b.moveNext())return g.Calc.Errors.Number}else return g.Calc.Errors.Value;return d},{minArgs:3,maxArgs:3,acceptsReference:l,acceptsArray:l});p("DMAX",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";var b=a.Convert._toArray(d[0]),f=d[1],l=a.Convert._toArray(d[2]);d=!1;for(var m=-1.79769E308,b=new k(b,f,l);b.moveNext();)if(f=b.current(),g.Calc.Convert.isNumber(f)){if(isNaN(f=a.Convert.toDouble(f)))return g.Calc.Errors.Value;
if(!d||f>m)m=f;d=!0}else if(a.Convert.isError(f))return f;return d?a.Convert.toResult(m):a.Errors.Value},{minArgs:3,maxArgs:3,acceptsReference:l,acceptsArray:l});p("DMIN",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";var b=a.Convert._toArray(d[0]),f=d[1],l=a.Convert._toArray(d[2]);d=!1;for(var m=1.79769E308,b=new k(b,f,l);b.moveNext();)if(f=b.current(),g.Calc.Convert.isNumber(f)){if(isNaN(f=a.Convert.toDouble(f)))return g.Calc.Errors.Value;if(!d||f<m)m=f;d=!0}else if(a.Convert.isError(f))return f;
return d?a.Convert.toResult(m):a.Errors.Value},{minArgs:3,maxArgs:3,acceptsReference:l,acceptsArray:l});p("DPRODUCT",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";var b=a.Convert._toArray(d[0]),f=d[1],l=a.Convert._toArray(d[2]);d=1;for(b=new k(b,f,l);b.moveNext();)if(f=b.current(),g.Calc.Convert.isNumber(f)){if(isNaN(f=a.Convert.toDouble(f)))return a.Convert.Errors.Value;d*=f}else if(a.Convert.isError(f))return f;return g.Calc.Convert.toResult(d)},{minArgs:3,maxArgs:3,acceptsReference:l,
acceptsArray:l});p("DSTDEV",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";for(var b=a.Convert._toArray(d[0]),f=d[1],l=a.Convert._toArray(d[2]),m=d=0,p=0,b=new k(b,f,l);b.moveNext();)if(f=b.current(),g.Calc.Convert.isNumber(f)){if(isNaN(f=a.Convert.toDouble(f)))return a.Convert.Errors.Value;d+=f;m+=f*f;p++}else if(a.Convert.isError(f))return f;return 1>=p?g.Calc.Errors.DivideByZero:g.Calc.Convert.toResult(Math.sqrt(Math.max(0,(p*m-d*d)/(p*(p-1)))))},{minArgs:3,maxArgs:3,acceptsReference:l,
acceptsArray:l});p("DSTDEVP",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";for(var b=a.Convert._toArray(d[0]),f=d[1],l=a.Convert._toArray(d[2]),m=d=0,p=0,b=new k(b,f,l);b.moveNext();)if(f=b.current(),g.Calc.Convert.isNumber(f)){if(isNaN(f=a.Convert.toDouble(f)))return a.Convert.Errors.Value;d+=f;m+=f*f;p++}else if(a.Convert.isError(f))return f;return 0>=p?g.Calc.Errors.DivideByZero:g.Calc.Convert.toResult(Math.sqrt(Math.max(0,(p*m-d*d)/(p*p))))},{minArgs:3,maxArgs:3,acceptsReference:l,
acceptsArray:l});p("DSUM",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";var b=a.Convert._toArray(d[0]),f=d[1],l=a.Convert._toArray(d[2]);d=0;for(b=new k(b,f,l);b.moveNext();)if(f=b.current(),g.Calc.Convert.isNumber(f)){if(isNaN(f=a.Convert.toDouble(f)))return a.Convert.Errors.Value;d+=f}else if(a.Convert.isError(f))return f;return g.Calc.Convert.toResult(d)},{minArgs:3,maxArgs:3,acceptsReference:l,acceptsArray:l});p("DVAR",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";
for(var b=a.Convert._toArray(d[0]),f=d[1],l=a.Convert._toArray(d[2]),m=d=0,p=0,b=new k(b,f,l);b.moveNext();)if(f=b.current(),g.Calc.Convert.isNumber(f)){if(isNaN(f=a.Convert.toDouble(f)))return a.Convert.Errors.Value;d+=f;m+=f*f;p++}else if(a.Convert.isError(f))return f;return 1>=p?g.Calc.Errors.DivideByZero:g.Calc.Convert.toResult(Math.max(0,(p*m-d*d)/(p*(p-1))))},{minArgs:3,maxArgs:3,acceptsReference:l,acceptsArray:l});p("DVARP",function(d){if(!d[0]||!d[1]||!d[2])throw"ArgumentNullException";for(var b=
a.Convert._toArray(d[0]),f=d[1],l=a.Convert._toArray(d[2]),m=d=0,p=0,b=new k(b,f,l);b.moveNext();)if(f=b.current(),g.Calc.Convert.isNumber(f)){if(isNaN(f=a.Convert.toDouble(f)))return a.Convert.Errors.Value;d+=f;m+=f*f;p++}else if(a.Convert.isError(f))return f;return 1>=p?g.Calc.Errors.DivideByZero:g.Calc.Convert.toResult(Math.max(0,(p*m-d*d)/(p*p)))},{minArgs:3,maxArgs:3,acceptsReference:l,acceptsArray:l})})(window);
(function(p){function l(a){return 0!==a}function m(a){return 1===a}function k(a,b,d){var e,f=0;e=parseFloat(b[f++]);do e=e*a+parseFloat(b[f++]);while(0!==--d);return e}function g(a,b,d){var e,f=0;e=a+parseFloat(b[f++]);d-=1;do e=e*a+parseFloat(b[f++]);while(0!==--d);return e}function a(a){var b=[-4.794432209782018E9,1.9561749194655657E12,-2.4924834436096772E14,9708622510473064],d=[499.563147152651,173785.4016763747,4.844096583399621E7,1.1185553704535683E10,2.112775201154892E12,3.1051822985742256E14,
0x710505f9ecba70,0x17be34c7b662cc00],e,f;0>a&&(a=-a);if(5>=a)return e=a*a,1E-5>a?1-e/4:d=(e-5.783185962946784)*(e-30.471262343662087)*k(e,b,3)/g(e,d,8);b=5/a;e=25/(a*a);d=k(e,[7.969367292973471E-4,0.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],6)/k(e,[9.244088105588637E-4,0.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],6);e=k(e,[-0.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,
-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],7)/g(e,[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],7);f=a-0.7853981633974483;d=d*Math.cos(f)-b*e*Math.sin(f);return 0.7978845608028654*d/Math.sqrt(a)}function d(a,b){var d,e,f,g,h,k,l,n,m,q,p,r,s;s=0>a?-a:a;if(31<s||0>=b)return z;if(9.55<b&&(p=d,p=q,q=void 0,!(b>Math.log(z)))){p=s;m=4*p*p;p=1;k=8*b;h=g=n=1;q=z;r=0;do l=m-p*p,g=g*l/(n*k),
e=Math.abs(g),r>=s&&e>q&&(l=b,Math.exp(-l),Math.sqrt(Math.PI/(2*l))),q=e,h+=g,n+=1,p+=2,r+=1;while(Math.abs(g/h)>J)}e=0;k=0.25*b*b;n=1;m=0;p=1;q=2/b;if(0<s){m=-K;for(r=d=1;r<s;r++)m+=1/d,d+=1,n*=d;p=q;if(1===s)e=1/b;else{e=n/s;d=1;h=e;l=-k;for(r=f=1;r<s;r++){e/=s-r;d*=r;f*=l;g=e*f/d;h+=g;if(z-Math.abs(g)<Math.abs(h)||1<q&&z/q<p)return z;p*=q}h*=0.5;g=Math.abs(h);if(1<p&&z/p<g||1<g&&z/g<p)return z;e=h*p}}l=2*Math.log(0.5*b);q=-K;0===s?(m=q,g=1):(m+=1/s,g=1/n);h=(q+m-l)*g;d=1;do g*=k/(d*(d+s)),q+=1/
d,m+=1/(d+s),h+=(q+m-l)*g,d+=1;while(Math.abs(g/h)>J);h=0.5*h/p;0!==(s&1)&&(h=-h);return e+h}function e(a){var b,d,e,f;b=[1.2632047479017804E9,-6.473558763791603E11,1.1450951154182373E14,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80];e=[594.3015923461282,235564.09294306856,7.348119444597217E7,1.8760131610870617E10,3.8823127749623857E12,6.205577271469538E14,0xf41f1e2a3d2440,0x3721e321ece8fe00];if(5>=a){if(0>=a)return-z;d=a*a;b=a*(k(d,b,5)/g(d,e,8));d=aa;var h=[-8.999712257055594E8,4.5222829799819403E11,
-7.274942452218183E13,0xd15a1534be241],l=[620.8364781180543,256987.25675774884,8.351467914319493E7,2.215115954797925E10,4.749141220799914E12,7.843696078762359E14,89522233618462736,0x49de55d9c0a4e400];f=[0.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372];var n=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],m=[7.621256162081731E-4,
0.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],Ka=[5.713231280725487E-4,0.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],q;e=a;0>a&&(e=-a);5>=e?(q=a*a,e=k(q,h,3)/g(q,l,8),e=e*a*(q-14.681970642123893)*(q-49.2184563216946)):(e=5/a,q=e*e,h=k(q,m,6)/k(q,Ka,6),f=k(q,f,7)/g(q,n,7),n=a-2.356194490192345,h=h*Math.cos(n)-e*f*Math.sin(n),e=0.7978845608028654*h/Math.sqrt(a));return b+=d*(e*Math.log(a)-1/a)}b=5/a;d=
b*b;e=k(d,[7.621256162081731E-4,0.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],6)/k(d,[5.713231280725487E-4,0.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],6);d=k(d,[0.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],7)/g(d,[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,
2826.1927851763908,336.0936078106983],7);f=a-Q;e=e*Math.sin(f)+b*d*Math.cos(f);return e*S/Math.sqrt(a)}function b(b){var d,e,f,h;d=[15592.436785523574,-1.466392959039716E7,5.435264770518765E9,-9.821360657179115E11,8.75906394395367E13,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec];f=[1041.2835366425984,626107.330137135,2.6891963339381415E8,8.64002487103935E10,2.0297961275010555E13,3.1715775284297505E15,0x37a4bf79f36ba00];if(5>=b){if(0>=b)return-z;e=b*b;d=k(e,d,7)/g(e,f,7);return d+=aa*Math.log(b)*
a(b)}d=5/b;e=25/(b*b);f=k(e,[7.969367292973471E-4,0.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],6)/k(e,[9.244088105588637E-4,0.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],6);e=k(e,[-0.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],7)/g(e,[64.3178256118178,856.4300259769806,3882.4018360540163,
7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],7);h=b-ka;f=f*Math.sin(h)+d*e*Math.cos(h);return f*S/Math.sqrt(b)}function f(a,d){var f,g,h,k,l,n;0>a?(a=-a,n=0===(a&1)?1:-1):n=1;if(0===a)return n*b(d);if(1===a)return n*e(d);if(0>=d)return-z;h=b(d);g=e(d);l=1;k=2*l;do f=k*g/d-h,h=g,g=f,k+=2,++l;while(l<a);return n*f}function s(a,b,d){if(0>b)return NaN;var e,f,g,h,k,l,n=100;a*=0.5;e=a*a;a=Math.pow(a,parseFloat(b));f=1;for(g=b;1<g;g--)f*=g;h=0;g=1;b=parseFloat(b);k=a/f;l=0.9*
k;if(d)for(;k!==l&&0!==n;)a*=e,h++,f*=h,b++,g*=b,l=k,k+=a/f/g,n--;else for(d=!1;k!==l&&0!==n;)a*=e,h++,f*=h,b++,g*=b,l=k,k=d?k+a/f/g:k-a/f/g,n--,d=!d;return k}function q(a,b){var d=Math.pow(b,10),e=parseInt(a,b);if(isNaN(e))return C.Errors.Number;d/2<=e&&(e-=d);return e}function t(a,b,d){0>a&&(a+=Math.pow(b,10));a=a.toString(b);if(a.length<d)for(d-=a.length,b=0;b<d;b++)a="0"+a;return a.toUpperCase()}function r(a,b){this._real=a;this._imag=b}function u(){}function n(a,b){this.str=a;this.c=b}function h(a){for(var b=
0;qa[b].str;b++)if(0===a.localeCompare(qa[b].str))return!1;return!0}function I(a,b,d){var e;na=0;ca=1;for(e=0;a[e].str;e++)if(0===d.localeCompare(a[e].str))return na=a[e].c,!0;var f=0;if(b)for(e=0;b[e].str;e++){var g=d.substr(0,1).toLowerCase(),k=b[e].str.substr(0,1).toLowerCase();g===k&&h(d)&&(ca=b[e].c,f++)}for(e=0;a[e].str;e++)if(b=d.substr(1,a[e].str.Length),f=a[e].str.substr(0,a[e].str.Length),b===f&&h(d))return na=a[e].c,!0;return!1}function E(a,b,d,e,f){var g,h=I(a,b,d);d=na;g=ca;e=I(a,b,e);
b=ca;a=na;if(h){if(!e||0===d||0===b)return!1;x=f*g/d*a/b;return!0}return!1}function O(a){var b=H.Calc.Convert.toDouble(a[0]);if(isNaN(b))return C.Errors.Value;var d=0;if(H.Calc._Helper._argumentExists(a,1)&&(d=H.Calc.Convert.toDouble(a[1]),isNaN(d)))return C.Errors.Value;if(0>b||0>d||27<b||27<d)return C.Errors.Number;var e=G.StatHelper.normsdist([b*Math.sqrt(2)]);if(typeof e===C.Errors)return NaN;b=2*parseFloat(e)-1;if(H.Calc._Helper._argumentExists(a,1)){e=G.StatHelper.normsdist([d*Math.sqrt(2)]);
if(typeof e===C.Errors)return NaN;b=2*parseFloat(e)-1-b}return b}var H=p.GrapeCity;"undefined"===typeof H&&(p.GrapeCity=H={});"undefined"===typeof H.Calc&&(H.Calc={});var C=H.Calc;"undefined"===typeof C.Functions&&(C.Functions={});var G=C.Functions;G._builtInFunctions=G._builtInFunctions||{};"undefined"===typeof G._defineBuildInFunction&&(G._defineBuildInFunction=function(a,b,d){if(!a)throw"Invalid function name";var e;a=a.toUpperCase();if(G._builtInFunctions.hasOwnProperty(a))if(e=G._builtInFunctions[a],
!e)G._builtInFunctions[a]=new G.Function(a,0,255),e=G[a.toUpperCase()];else{if(!d||!d.override)throw"Attempt to override function while override is not allowed";}else e=new G.Function(a,0,255),G._builtInFunctions[a]=e;b&&"function"===typeof b&&(e.evaluate=b);if(d)for(var f in d)d.hasOwnProperty(f)&&"override"!==f&&(e[f]=d[f]);return e});p=G._defineBuildInFunction;var z=1.7976931348623157E308,S=0.7978845608028654,Q=2.356194490192345,aa=0.6366197723675814,ka=0.7853981633974483,J=1.1102230246251565E-16,
K=0.5772156649015329;r.prototype={real:function(){return this._real},imag:function(){return this._imag},toString:function(a){a||(a="i");var b=new H.UI._StringBuilder;0===this._real&&0!==this._imag||b.append(this._real.toString());-1===this._imag?b.append("-"):0!==this._real&&0<this._imag&&b.append("+");-1!==this._imag&&0!==this._imag&&1!==this._imag&&b.append(this._imag.toString());0!==this._imag&&b.append(a);return b.toString()}};r._parse=function(a){var b=0,d=0,e=!1,f=!1,g=!1,h=0,k=0,l=0;if(!a)throw"Argument Null";
if(0===a.length)throw"Format";for(l<a.length&&("+"===a.charAt(l)||"-"===a.charAt(l))&&l++;l<a.length&&!isNaN(Number(a.charAt(l)));)l++,e=!0;for(l<a.length&&"."===a.charAt(l)&&l++;l<a.length&&!isNaN(Number(a.charAt(l)));)l++,e=!0;if(l<a.length&&("E"===a.charAt(l)||"e"===a.charAt(l)))for(l++,e=!1,l<a.length&&("+"===a.charAt(l)||"-"===a.charAt(l))&&l++;l<a.length&&!isNaN(Number(a.charAt(l)));)l++,e=!0;if(l<a.length&&("+"===a.charAt(l)||"-"===a.charAt(l))){h=l;for(l++;l<a.length&&!isNaN(Number(a.charAt(l)));)l++,
f=!0;for(l<a.length&&"."===a.charAt(l)&&l++;l<a.length&&!isNaN(Number(a.charAt(l)));)l++,f=!0;if(l<a.length&&("E"===a.charAt(l)||"e"===a.charAt(l)))for(l++,f=!1,l<a.length&&("+"===a.charAt(l)||"-"===a.charAt(l))&&l++;l<a.length&&!isNaN(Number(a.charAt(l)));)l++,f=!0;l<a.length&&("i"===a.charAt(l)||"j"===a.charAt(l))&&(l++,g=!0);k=l-h}else l<a.length&&("i"===a.charAt(l)||"j"===a.charAt(l))?(l++,k=l,f=e,g=!0,e=!1):h=l;if(l<a.length)throw"Format";if(0<h)if(e)b=parseInt(a.substr(0,h),10);else throw"Format";
if(0<k){if(!g)throw"Format";if(1===k)d=1;else if(2===k&&"+"===a.charAt(h))d=1;else if(2===k&&"-"===a.charAt(h))d=-1;else if(f)d=parseInt(a.substr(h,k-1),10);else throw"Format";}return new r(b,d)};u._toComplex=function(a){try{if(a){if(a.constructor===Number)return new r(parseFloat(a),0);if(a.constructor===String)return r._parse(a);throw"Invalid Cast";}return new r(0,0)}catch(b){throw"Invalid Cast";}};u._toResult=function(a,b){return isNaN(a.real())||a.real()===Number.POSITIVE_INFINITY||isNaN(a.imag())||
a.imag()===Number.POSITIVE_INFINITY?C.Errors.Number:a.toString(b)};var A=1/1852,L=1E4/254,D=L/12,w=D/3,M=w/1760,T=1/2684523.6,P=1/3600,ia=1/3,v=1/6,V=1/48,N=1/96,R=1/192,ga=1/768,ba=[new n("g",1),new n("sg",6.852205001E-5),new n("lbm",0.002204622915),new n("u",6.02217E23),new n("ozm",0.035273972),new n(null,0)],W=[new n("m",1),new n("mi",M),new n("Nmi",A),new n("in",L),new n("ft",D),new n("yd",w),new n("ang",1E10),new n("Pica",2834.645669),new n("km",0.001),new n(null,0)],ja=[new n("yr",1),new n("day",
365.25),new n("hr",8766),new n("mn",525960),new n("sec",31557600),new n(null,0)],fa=[new n("Pa",1),new n("atm",9.869233E-6),new n("mmHg",0.00750061708),new n("p",1),new n("at",9.869233E-6),new n(null,0)],la=[new n("N",1),new n("dyn",1E5),new n("lbf",0.224808924),new n("dy",1E5),new n(null,0)],ra=[new n("J",1),new n("e",9999995.193),new n("c",0.239006249),new n("cal",0.238846191),new n("eV",62146E14),new n("HPh",T),new n("Wh",P),new n("flb",23.73042222),new n("BTU",9.47815E-4),new n("ev",62146E14),
new n("hh",T),new n("wh",P),new n("btu",9.47815E-4),new n(null,0)],da=[new n("HP",1),new n("W",745.701),new n("h",1),new n("w",745.701),new n(null,0)],oa=[new n("T",1),new n("ga",1E4),new n(null,0)],ha=[new n("tsp",1),new n("tbs",ia),new n("oz",v),new n("cup",V),new n("pt",N),new n("qt",R),new n("gal",ga),new n("l",0.004929994),new n("uk_pt",0.008675585),new n("us_pt",N),new n("lt",0.004929994),new n(null,0)],X=[new n("Y",1E24),new n("Z",1E21),new n("E",1E18),new n("P",1E15),new n("T",1E12),new n("G",
1E9),new n("M",1E6),new n("k",1E3),new n("h",100),new n("e",10),new n("d",0.1),new n("c",0.01),new n("m",0.001),new n("u",1E-6),new n("n",1E-9),new n("p",1E-12),new n("f",1E-15),new n("a",1E-18),new n("z",1E-21),new n("y",1E-24),new n(null,0)],na=0,ca=0,x=0,qa="cup mmHg J sec cel kel hh Wh wh flb BTU".split(" ");p("BESSELI",function(a){var b=H.Calc.Convert.toDouble(a[0]);if(isNaN(b))return C.Errors.Value;a=H.Calc.Convert.toInt(a[1]);return isNaN(a)?C.Errors.Value:0>a?C.Errors.Number:H.Calc.Convert.toResult(s(b,
a,!0))},{minArgs:2,maxArgs:2});p("BESSELJ",function(a){var b=H.Calc.Convert.toDouble(a[0]);if(isNaN(b))return C.Errors.Value;a=H.Calc.Convert.toInt(a[1]);return isNaN(a)?C.Errors.Value:0>a?C.Errors.Number:H.Calc.Convert.toResult(s(b,a,!1))},{minArgs:2,maxArgs:2});p("BESSELK",function(a){var b=H.Calc.Convert.toDouble(a[0]);if(isNaN(b))return C.Errors.Value;a=H.Calc.Convert.toInt(a[1]);return isNaN(a)?C.Errors.Value:0>=b||0>a?C.Errors.Number:H.Calc.Convert.toResult(d(a,b))},{minArgs:2,maxArgs:2});p("BESSELY",
function(a){var b=H.Calc.Convert.toDouble(a[0]);if(isNaN(b))return C.Errors.Value;a=H.Calc.Convert.toInt(a[1]);return isNaN(a)?C.Errors.Value:0>=b||0>a?C.Errors.Number:H.Calc.Convert.toResult(f(a,b))},{minArgs:2,maxArgs:2});p("BIN2DEC",function(a){a=H.Calc.Convert.toString(a[0]);var b;if(10<a.length)return C.Errors.Number;b=q(a,2);return b.length<a.length?C.Errors.Number:b},{minArgs:1,maxArgs:1});p("BIN2HEX",function(a){var b=H.Calc.Convert.toString(a[0]),d=H.Calc._Helper._argumentExists(a,1)?H.Calc.Convert.toInt(a[1]):
1,e;if(10<b.length||1>d||10<d)return C.Errors.Number;e=q(b,2);if(e.length<b.length)return C.Errors.Number;b=t(e,16,d);return d<b.length&&0<=e&&H.Calc._Helper._argumentExists(a,1)?C.Errors.Number:b},{minArgs:1,maxArgs:2,acceptsMissingArgument:m});p("BIN2OCT",function(a){var b=H.Calc.Convert.toString(a[0]),d=H.Calc._Helper._argumentExists(a,1)?H.Calc.Convert.toInt(a[1]):1,e;if(10<b.length||1>d||10<d)return C.Errors.Number;e=q(b,2);if(e.length<b.length)return C.Errors.Number;b=t(e,8,d);return 0<=e&&
d<b.length&&H.Calc._Helper._argumentExists(a,1)?C.Errors.Number:b},{minArgs:1,maxArgs:2,acceptsMissingArgument:m});p("DEC2BIN",function(a){var b=H.Calc.Convert.toDouble(a[0]),d=H.Calc._Helper._argumentExists(a,1)?H.Calc.Convert.toInt(a[1]):1;if(-512>b||511<b||1>d||10<d)return C.Errors.Number;b=t(b,2,d);return 0<=b&&d<b.length&&H.Calc._Helper._argumentExists(a,1)?C.Errors.Number:b},{minArgs:1,maxArgs:2,acceptsMissingArgument:m});p("DEC2HEX",function(a){var b=H.Calc.Convert.toDouble(a[0]),d=H.Calc._Helper._argumentExists(a,
1)?H.Calc.Convert.toInt(a[1]):1;if(-549755813888>b||549755813887<b||1>d||10<d)return C.Errors.Number;b=t(b,16,d);return 0<=b&&d<b.length&&H.Calc._Helper._argumentExists(a,1)?C.Errors.Number:b},{minArgs:1,maxArgs:2,acceptsMissingArgument:m});p("DEC2OCT",function(a){var b=H.Calc.Convert.toDouble(a[0]),d=H.Calc._Helper._argumentExists(a,1)?H.Calc.Convert.toInt(a[1]):1;if(-536870912>b||536870911<b||1>d||10<d)return C.Errors.Number;b=t(b,8,d);return 0<=b&&d<b.length&&H.Calc._Helper._argumentExists(a,1)?
C.Errors.Number:b},{minArgs:1,maxArgs:2,acceptsMissingArgument:m});p("HEX2BIN",function(a){var b=H.Calc.Convert.toString(a[0]),d=H.Calc._Helper._argumentExists(a,1)?H.Calc.Convert.toInt(a[1]):1,e;if(10<b.length||1>d||10<d)return C.Errors.Number;e=q(b.toLowerCase(),16);if(e.length<b.length||-512>e||511<e)return C.Errors.Number;b=t(e,2,d);return 0<=e&&d<b.length&&H.Calc._Helper._argumentExists(a,1)?C.Errors.Number:b},{minArgs:1,maxArgs:2,acceptsMissingArgument:m});p("HEX2DEC",function(a){a=H.Calc.Convert.toString(a[0]);
var b;if(10<a.length)return C.Errors.Number;b=q(a.toLowerCase(),16);return b.length<a.length?C.Errors.Number:H.Calc.Convert.toResult(b)},{minArgs:1,maxArgs:1});p("HEX2OCT",function(a){var b=H.Calc.Convert.toString(a[0]),d=H.Calc._Helper._argumentExists(a,1)?H.Calc.Convert.toInt(a[1]):1,e;if(10<b.length||1>d||10<d)return C.Errors.Number;e=q(b,16);if(e.length<b.length||-536870912>e||536870911<e)return C.Errors.Number;b=t(e,8,d);return 0<=e&&d<b.length&&H.Calc._Helper._argumentExists(a,1)?C.Errors.Number:
b},{minArgs:1,maxArgs:2,acceptsMissingArgument:m});p("OCT2BIN",function(a){var b=H.Calc.Convert.toString(a[0]),d=H.Calc._Helper._argumentExists(a,1)?H.Calc.Convert.toInt(a[1]):1,e;if(10<b.length||1>d||10<d)return C.Errors.Number;e=q(b,8);if(e.length<b.length||-512>e||511<e)return C.Errors.Number;b=t(e,2,d);return 0<=e&&d<b.length&&H.Calc._Helper._argumentExists(a,1)?C.Errors.Number:b},{minArgs:1,maxArgs:2,acceptsMissingArgument:m});p("OCT2DEC",function(a){a=H.Calc.Convert.toString(a[0]);var b;if(10<
a.length)return C.Errors.Number;b=q(a,8);return b.length<a.length?C.Errors.Number:H.Calc.Convert.toResult(b)},{minArgs:1,maxArgs:1});p("OCT2HEX",function(a){var b=H.Calc.Convert.toString(a[0]),d=H.Calc._Helper._argumentExists(a,1)?H.Calc.Convert.toInt(a[1]):1,e;if(10<b.length||1>d||10<d)return C.Errors.Number;e=q(b,8);if(e.length<b.length||-549755813888>e||549755813887<e)return C.Errors.Number;b=t(e,16,d);return 0<=e&&d<b.length&&H.Calc._Helper._argumentExists(a,1)?C.Errors.Number:b},{minArgs:1,maxArgs:2,
acceptsMissingArgument:m});p("ERF",O,{minArgs:1,maxArgs:2,acceptsMissingArgument:m});p("ERFC",function(a){a=H.Calc.Convert.toDouble(a[0]);if(isNaN(a))return C.Errors.Value;if(0>a)return C.Errors.Number;a=O([a]);return typeof a===C.Errors?NaN:1-parseFloat(a)},{minArgs:1,maxArgs:1});p("DELTA",function(a){var b=H.Calc.Convert.toDouble(a[0]);if(isNaN(b))return C.Errors.Value;var d=0;return H.Calc._Helper._argumentExists(a,1)&&(d=H.Calc.Convert.toDouble(a[1]),isNaN(d))?C.Errors.Value:G._MathHelper.approxEqual(b,
d)?1:0},{minArgs:1,maxArgs:2,acceptsMissingArgument:m});p("GESTEP",function(a){var b=H.Calc.Convert.toDouble(a[0]);if(isNaN(b))return C.Errors.Value;var d=0;return H.Calc._Helper._argumentExists(a,1)&&(d=H.Calc.Convert.toDouble(a[1]),isNaN(d))?C.Errors.Value:b>=d?1:0},{minArgs:1,maxArgs:2,acceptsMissingArgument:m});p("COMPLEX",function(a){var b=H.Calc.Convert.toDouble(a[0]),d=H.Calc.Convert.toDouble(a[1]);if(isNaN(b)||isNaN(d))return C.Errors.Value;a=C._Helper._argumentExists(a,2)?C.Convert.toString(a[2]):
"i";return"i"!==a&&"j"!==a?C.Errors.Value:u._toResult(new r(b,d),a)},{minArgs:2,maxArgs:3,acceptsMissingArgument:function(a){return 2===a}});p("IMABS",function(a){var b=u._toComplex(a[0]);a=b.real();b=b.imag();return H.Calc.Convert.toResult(Math.sqrt(a*a+b*b))},{minArgs:1,maxArgs:1});p("IMAGINARY",function(a){a=u._toComplex(a[0]);return H.Calc.Convert.toResult(a.imag())},{minArgs:1,maxArgs:1});p("IMARGUMENT",function(a){var b=u._toComplex(a[0]);a=b.real();b=b.imag();return 0===a&&0===b?C.Errors.DivideByZero:
H.Calc.Convert.toResult(Math.atan2(b,a))},{minArgs:1,maxArgs:1});p("IMCONJUGATE",function(a){var b=u._toComplex(a[0]);a=b.real();b=b.imag();return u._toResult(new r(a,-b))},{minArgs:1,maxArgs:1});p("IMCOS",function(a){var b=u._toComplex(a[0]);a=b.real();b=b.imag();return u._toResult(new r(Math.cos(a)*G._MathHelper.cosh(b),-Math.sin(a)*G._MathHelper.sinh(b)))},{minArgs:1,maxArgs:1});p("IMDIV",function(a){var b=u._toComplex(a[0]),d=u._toComplex(a[1]);a=b.real();var b=b.imag(),e=d.real(),d=d.imag();
return 0===e&&0===d?C.Errors.Number:u._toResult(new r((a*e+b*d)/(e*e+d*d),(b*e-a*d)/(e*e+d*d)))},{minArgs:2,maxArgs:2});p("IMEXP",function(a){var b=u._toComplex(a[0]);a=b.real();b=b.imag();return u._toResult(new r(Math.exp(a)*Math.cos(b),Math.exp(a)*Math.sin(b)))},{minArgs:1,maxArgs:1});p("IMLN",function(a){var b=u._toComplex(a[0]);a=b.real();var d=b.imag();if(0===a&&0===d)return C.Errors.Number;b=Math.sqrt(a*a+d*d);a=Math.atan2(d,a);return u._toResult(new r(Math.log(b),a))},{minArgs:1,maxArgs:1});
p("IMLOG10",function(a){a=u._toComplex(a[0]);var b=a.real(),d=a.imag();if(0===b&&0===d)return C.Errors.Number;a=Math.sqrt(b*b+d*d);b=Math.atan2(d,b);d=G._MathHelper.log10(Math.E);return u._toResult(new r(d*Math.log(a),d*b))},{minArgs:1,maxArgs:1});p("IMLOG2",function(a){a=u._toComplex(a[0]);var b=a.real(),d=a.imag();if(0===b&&0===d)return C.Errors.Number;a=Math.sqrt(b*b+d*d);b=Math.atan2(d,b);d=G._MathHelper.log(Math.E,2);return u._toResult(new r(d*Math.log(a),d*b))},{minArgs:1,maxArgs:1});p("IMPOWER",
function(a){var b=u._toComplex(a[0]);a=parseFloat(a[1]);if(isNaN(a))return C.Errors.Value;var d=b.real(),e=b.imag();if(0===d&&0===e)return 0<a?u._toResult(new r(0,0)):C.Errors.Number;b=Math.sqrt(d*d+e*e);d=Math.atan2(e,d);return u._toResult(new r(Math.pow(b,a)*Math.cos(a*d),Math.pow(b,a)*Math.sin(a*d)))},{minArgs:2,maxArgs:2});p("IMPRODUCT",function(a){for(var b=1,d=0,e,f,g,h=0;h<a.length;h++)if(a[h].constructor===C.Array)for(var k=a[h],l=0;l<k.rowCount;l++)for(var n=0;n<k.columnCount;n++)e=u._toComplex(k.getValue(l,
n)),f=b,g=e.real(),e=e.imag(),b=f*g-d*e,d=f*e+d*g;else e=u._toComplex(a[h]),f=b,g=e.real(),e=e.imag(),b=f*g-d*e,d=f*e+d*g;return u._toResult(new r(b,d))},{minArgs:1,maxArgs:255,acceptsMissingArgument:l});p("IMREAL",function(a){a=u._toComplex(a[0]);return H.Calc.Convert.toResult(a.real())},{minArgs:1,maxArgs:1});p("IMSIN",function(a){var b=u._toComplex(a[0]);a=b.real();b=b.imag();return u._toResult(new r(Math.sin(a)*G._MathHelper.cosh(b),Math.cos(a)*G._MathHelper.sinh(b)))},{minArgs:1,maxArgs:1});
p("IMSQRT",function(a){var b=u._toComplex(a[0]);a=b.real();var d=b.imag();if(0===a&&0===d)return u._toResult(new r(0,0));b=Math.sqrt(a*a+d*d);a=Math.atan2(d,a);return u._toResult(new r(Math.sqrt(b)*Math.cos(a/2),Math.sqrt(b)*Math.sin(a/2)))},{minArgs:1,maxArgs:1});p("IMSUB",function(a){var b=u._toComplex(a[0]),d=u._toComplex(a[1]);a=b.real();var b=b.imag(),e=d.real(),d=d.imag();return u._toResult(new r(a-e,b-d))},{minArgs:2,maxArgs:2});p("IMSUM",function(a){for(var b=0,d=0,e,f,g=0;g<a.length;g++)if(a[g].constructor===
C.Array)for(var h=a[g],k=0;k<h.rowCount;k++)for(var l=0;l<h.columnCount;l++)e=u._toComplex(h.getValue(k,l)),f=e.real(),e=e.imag(),b+=f,d+=e;else e=u._toComplex(a[g]),f=e.real(),e=e.imag(),b+=f,d+=e;return u._toResult(new r(b,d))},{minArgs:1,maxArgs:255,acceptsMissingArgument:l});p("CONVERT",function(a){var b=parseFloat(a[0]);if(isNaN(b))return C.Errors.Value;var d=H.Calc.Convert.toString(a[1]);a=H.Calc.Convert.toString(a[2]);if(d&&""!==d&&a&&""!==a)if((0!==d.localeCompare("C")&&0!==d.localeCompare("cel")||
0!==a.localeCompare("C"))&&0!==a.localeCompare("cel")&&(0!==d.localeCompare("F")&&0!==d.localeCompare("fah")||0!==a.localeCompare("F")&&0!==a.localeCompare("fah")))if(0!==d.localeCompare("K")&&0!==d.localeCompare("kel")||0!==a.localeCompare("K")&&0!==a.localeCompare("kel"))if(0!==d.localeCompare("C")&&0!==d.localeCompare("cel")||0!==a.localeCompare("F")&&0!==a.localeCompare("fah"))if(0!==d.localeCompare("F")&&0!==d.localeCompare("fah")||0!==a.localeCompare("C")&&0!==a.localeCompare("cel"))if(0!==
d.localeCompare("F")&&0!==d.localeCompare("fah")||0!==a.localeCompare("F")&&0!==a.localeCompare("fah"))if(0!==d.localeCompare("F")&&0!==d.localeCompare("fah")||0!==a.localeCompare("K")&&0!==a.localeCompare("kel"))if(0!==d.localeCompare("K")&&0!==d.localeCompare("kel")||0!==a.localeCompare("F")&&0!==a.localeCompare("fah")){if(!(0!==d.localeCompare("C")&&0!==d.localeCompare("cel")||0!==a.localeCompare("K")&&0!==a.localeCompare("kel")))return b+273.15;if(!(0!==d.localeCompare("K")&&0!==d.localeCompare("kel")||
0!==a.localeCompare("C")&&0!==a.localeCompare("cel")))return b-273.15}else return 9*(b-273.15)/5+32;else return 5*(b-32)/9+273.15;else return b;else return 5*(b-32)/9;else return 9*b/5+32;else return b;else return b;else return C.Errors.NotAvailable;return E(ba,X,d,a,b)||E(W,X,d,a,b)||E(ja,null,d,a,b)||E(fa,X,d,a,b)||E(la,X,d,a,b)||E(ra,X,d,a,b)||E(da,X,d,a,b)||E(oa,X,d,a,b)||E(ha,X,d,a,b)||E(oa,X,d,a,b)?x:C.Errors.NotAvailable},{minArgs:3,maxArgs:3})})(window);
(function(p){function l(a){return 0!==a}function m(a){return 1===a}function k(a){return 3===a}function g(a){return 3===a||4===a}function a(a){return 0<a}function d(a){return 4===a}function e(a){return 4===a||5===a}function b(a){return 5===a}function f(a){return 6===a}function s(a){return 8===a}function q(a){return 7===a}function t(a){return 0===a}function r(a){return 2!==a}function u(a){return 0===a%400||0===a%4&&0!==a%100||1900===a}function n(a){return(new Aa.UI._DateTimeHelper(a)).toOADate()}function h(a,
b,d){var e,f,g,h,k,l;g=a.getFullYear();f=a.getMonth();e=a.getDate();l=b.getFullYear();k=b.getMonth();h=b.getDate();e=h-e;f=12*(l-g)+(k-f);u(g);switch(d){case 0:return d=[],d[0]=a,d[1]=b,va._DateTimeHelper.days360(d);case 1:case 2:case 3:return a=n(a),b=n(b),b-a;case 4:return 30*f+e;default:return-1}}function I(a,b){var d;switch(b){case 0:return 360;case 1:return(d=u(a.getFullYear()))?366:365;case 2:return 360;case 3:return 365;case 4:return 360;default:return-1}}function E(a,b,d,e,f){0===a?a=(d+e)/
b:(b=Math.pow(1+a,b),a=0<f?(e*a/(b-1)+d*a/(1-1/b))/(1+a):e*a/(b-1)+d*a/(1-1/b));return-a}function O(a,b,d,e,f){0===a?a=e+d*b:(b=Math.pow(1+a,b),a=0<f?e*b+d*(1+a)*(b-1)/a:e*b+d*(b-1)/a);return-a}function H(a,b,d,e,f){var g;g=Math.pow(1+a,b);g=isNaN(g)||!isFinite(g)?Aa.Calc.Errors.Number:g;0!==a&&(b=(Math.pow(1+a,b)-1)/a,b=isNaN(b)||!isFinite(b)?Aa.Calc.Errors.Number:b);d=-d*g-e;a=(1+a*y.Convert.toDouble(f))*b;a=d/a;return isNaN(a)||!isFinite(a)?Aa.Calc.Errors.Number:a}function C(a,b,d,e){e=Math.pow(1+
d,e);a=-(a*e*d+b*(e-1));return isNaN(a)||!isFinite(a)?Aa.Calc.Errors.Number:a}function G(a,b){switch(b){case 0:case 2:case 4:case 6:case 7:case 9:case 11:return 31;case 1:return u(a)?29:28;case 3:case 5:case 8:case 10:return 30}}function z(a,b,d,e){var f,g,h,k=new Date(1,0,1);k.setFullYear(1);var l=0;h=b.getDate()===G(b.getFullYear(),b.getMonth());f=12/d;g=b.getFullYear()-a.getFullYear();0<g&&(g=(g-1)*d);do k=new Date(b.getFullYear(),b.getMonth(),b.getDate()),g++,k.setMonth(k.getMonth()-g*f),h&&(l=
G(k.getFullYear(),k.getMonth()),k=new Date(k.getFullYear(),k.getMonth(),l));while(0>a-k);e&&(k=new Date(b.getFullYear(),b.getMonth(),b.getDate()),g--,k.setMonth(k.getMonth()-g*f),h&&(l=G(k.getFullYear(),k.getMonth()),k=new Date(k.getFullYear(),k.getMonth(),l)));return k}function S(a,b,d){var e=1;0<a-b&&(e=a,a=b,b=e,e=-1);switch(d){case 1:case 2:case 3:return e*y.Convert.toInt(n(b)-n(a));case 4:d=e;var f=a,e=b,g,h;b=f.getFullYear();a=f.getMonth();f=f.getDate();g=e.getFullYear();h=e.getMonth();e=e.getDate();
31===f&&(f=30);31===e&&(e=30);return d*(360*(g-b)+30*(h-a)+(e-f));case 5:return d=e,f=a,e=b,b=f.getFullYear(),a=f.getMonth(),f=f.getDate(),g=e.getFullYear(),h=e.getMonth(),e=e.getDate(),31===f&&(f=30),31===e&&(e=1,h++),d*(360*(g-b)+30*(h-a)+(e-f));case 6:return d=e,f=a,e=b,b=f.getFullYear(),a=f.getMonth(),f=f.getDate(),g=e.getFullYear(),h=e.getMonth(),e=e.getDate(),2===a&&G(b,a)===f&&(f=30),2===h&&G(g,h)===e&&(e=30),31===e&&30<=f&&(e=30),31===f&&(f=30),d*(360*(g-b)+30*(h-a)+(e-f));default:return d=
e,f=a,e=b,b=f.getFullYear(),a=f.getMonth(),f=f.getDate(),g=e.getFullYear(),h=e.getMonth(),e=e.getDate(),2===a&&G(b,a)===f&&2===h&&G(g,h)===e&&(e=f=30),31===e&&30<=f&&(e=30),31===f&&(f=30),d*(360*(g-b)+30*(h-a)+(e-f))}}function Q(a,b,d,e){b=z(a,b,d,!1);return S(b,a,e)}function aa(a,b,d,e){switch(e){case 0:case 2:case 4:case 5:return 360/d;case 3:return 365/d;default:return e=z(a,b,d,!0),a=z(a,b,d,!1),S(a,e,1)}}function ka(a,b,d,e){b=z(a,b,d,!0);return S(a,b,e)}function J(a,b,d){var e,f=new Date(b.getFullYear(),
b.getMonth(),b.getDate());e=b.getMonth()-a.getMonth()+12*(b.getFullYear()-a.getFullYear());f.setMonth(f.getMonth()-e);if(b.getDate()===G(b.getFullYear(),b.getMonth()))for(;f.getDate()!==G(f.getFullYear(),f.getMonth());)f.setDate(f.getDate()+1);a.getDate()>=f.getDate()&&e--;return parseInt(1+e/(12/d),10)}function K(a,b,d,e,f,g,h){g=a=0;var k=y.Convert;d*=100/k.toDouble(f);e=e/f+1;for(b=1;b<h;b++)a+=b*d/Math.pow(e,b);a+=h*(d+100)/Math.pow(e,h);for(b=1;b<h;b++)g+=d/Math.pow(e,b);g+=(d+100)/Math.pow(e,
h);return a=a/g/k.toDouble(f)}function A(a){a.havexpos=a.havexneg=!1;a.xmin=-1E10;a.xmax=1E10;a.precision=1E-10;return a}function L(a,b,d){if(0<b)return d.havexpos?d.havexneg?Math.abs(a-d.xneg)<Math.abs(d.xpos-d.xneg)&&(d.xpos=a,d.ypos=b):b<d.ypos&&(d.xpos=a,d.ypos=b):(d.xpos=a,d.ypos=b,d.havexpos=!0),[!1,d];if(0>b)return d.havexneg?d.havexpos?Math.abs(a-d.xpos)<Math.abs(d.xpos-d.xneg)&&(d.xneg=a,d.yneg=b):-b<-d.yneg&&(d.xneg=a,d.yneg=b):(d.xneg=a,d.yneg=b,d.havexneg=!0),[!1,d];d.root=a;return[!0,
d]}function D(a,b,d,e,f,g,h){var k,l,n;k=Q(a,b,g,h);l=ka(a,b,g,h);h=aa(a,b,g,h);b=parseInt(J(a,b,g),10);a=0;d=100*d/g;e=1+e/g;g=l/h;for(n=0;n<b;n++)a+=d/Math.pow(e,g+n);return f/Math.pow(e,b-1+l/h)+a-k/h*d}function w(a,b,d,e,f){var g;g=z(a,d,e,!0);d=z(a,d,e,!1);if(0<=g-b)return S(a,b,f)/aa(d,g,e,f);for(a=S(a,g,f)/aa(d,g,e,f);;){d=new Date(g.getFullYear(),g.getMonth(),g.getDate());g.setMonth(g.getMonth()+12/e);if(0<=g-b)return a+=S(d,b,f)/aa(d,g,e,f);a+=1}}function M(a,b,d,e,f,g,h,k,l){var n=S(d,a,
l),m=S(a,e,l),B=S(d,e,l),q=aa(a,b,k,l),p=parseInt(J(a,b,k),10);f=100*f/k;g=1+g/k;if(m>q)switch(l){case 0:case 4:p=S(e,b,l);p=1+parseInt(Math.ceil(p/q),10);break;default:n=new Date(e.getFullYear(),e.getMonth(),e.getDate());for(p=0;32767>p;p++)if(m=new Date(n.getFullYear(),n.getMonth(),n.getDate()),n.setMonth(n.getMonth()+12/k),0<=n-b){p+=parseInt(Math.ceil(S(m,b,l))/aa(m,n,k,l),10)+1;break}n=q*w(d,a,e,k,l);m=q*w(a,e,e,k,l);B=q*w(d,e,e,k,l)}h/=Math.pow(g,p-1+m/q);a=B/q/Math.pow(g,m/q);p=Math.pow(g,
-m/q)*(Math.pow(g,-p)-1/g)/(1/g-1);return h+f*(a+p-n/q)}function T(a,b){var d=a.substr(0,3),e=va._MathHelper.round;switch(a[0]){case "A":if("ATS"===d)return e(13.7603,b);break;case "B":if("BEF"===d)return e(40.3399,b);break;case "D":if("DEM"===d)return e(1.95583,b);break;case "E":if("ESP"===d)return e(166.386,b);if("EUR"===d)return e(1,b);break;case "F":if("FIM"===d)return e(5.94573,b);if("FRF"===d)return e(6.55957,b);break;case "G":if("GRD"===d)return e(340.75,b);break;case "I":if("IEP"===d)return e(0.787564,
b);if("ITL"===d)return e(1936.27,b);break;case "L":if("LUX"===d||"LUF"===d)return e(40.3399,b);break;case "N":if("NLG"===d)return e(2.20371,b);break;case "P":if("PTE"===d)return e(200.482,b)}return-1}function P(a){var b=a.substr(0,3);switch(a[0]){case "A":if("ATS"===b)break;break;case "B":if("BEF"===b)return 0;break;case "D":if("DEM"===b)break;break;case "E":if("ESP"===b)return 0;if("EUR"===b)break;break;case "F":if("FIM"===b)break;else if("FRF"===b)break;break;case "G":if("GRD"===b)break;break;case "I":if("IEP"===
b)break;else if("ITL"===b)return 0;break;case "L":if("LUX"===b||"LUF"===b)return 0;break;case "N":if("NLG"===b)break;break;case "P":if("PTE"===b)return 1}return 2}function ia(a){var b=a.substr(0,3);switch(a[0]){case "A":if("ATS"===b)break;break;case "B":if("BEF"===b)return 0;break;case "D":if("DEM"===b)break;break;case "E":if("ESP"===b)return 0;if("EUR"===b)break;break;case "F":if("FIM"===b)break;else if("FRF"===b)break;break;case "G":if("GRD"===b)break;break;case "I":if("IEP"===b)break;else if("ITL"===
b)return 0;break;case "L":if("LUX"===b||"LUF"===b)return 0}return 2}function v(a,b,d,e,f,g,h,k,l){b=D(d,e,f,a,h,k,l)-g;return[!0,b]}function V(a,b,d,e,f,g,h,k,l,n,m){var B,q,p=0;B=a-d;B<e.xmin&&(B=a);d=a+d;d>e.xmax&&(d=a);if(B===d)return[!1,b,e];q=v(B,0,f,g,h,k,l,n,m);a=q[1];q=q[0];if(!q)return[q,b,e];q=v(d,p,f,g,h,k,l,n,m);p=q[1];return(q=q[0])?[!0,(p-a)/(d-B),e]:[q,b,e]}function N(a,b,d,e,f,g,h,k,l,n,m,B,q,p){switch(p){case 0:m=a.xpos-a.ypos*((a.xneg-a.xpos)/(a.yneg-a.ypos));break;case 1:var r;
m=(a.xpos+a.xneg)/2;r=v(m,B,b,d,e,f,g,h,k);B=r[1];q=r[0];if(!q)return[null,a,n,m,B,p];if(0===B)return a=L(m,B,a)[1],[!0,a,n,m,B,p];r=Math.sqrt(B*B-a.ypos*a.yneg);if(0===r)return[null,a,n,m,B,p];m+=(m-a.xpos)*B/r;break;case 3:m=(a.xpos+a.xneg)/2;break;case 2:var U=r=0,s=0,y=0;if(0.1<l)return N(a,b,d,e,f,g,h,k,l,n,m,B,q,3);switch(n++%4){case 0:r=a.ypos;break;case 2:r=a.xneg;U=a.yneg;break;default:case 3:case 1:if(r=(a.xpos+a.xneg)/2,l=v(r,U,b,d,e,f,g,h,k),U=l[1],q=l[0],!q)return[null,a,n,m,B,p]}s=Math.abs(a.xpos-
a.xneg)/1E6;b=V(r,y,s,a,b,d,e,f,g,h,k);a=b[2];y=b[1];q=b[0];if(!q||0===y)return[null,a,n,m,B,p];m=r-1.01*U/y;if(m<a.xpos&&m<a.xneg||m>a.xpos&&m>a.xneg)return[null,a,n,m,B,p]}return[!1,a,n,m,B,p]}function R(a,b,d,e,f,g,h,k,l,n,m){b=M(d,e,f,g,h,a,l,n,m)-k;return[!0,b]}function ga(a,b,d,e,f,g,h,k,l,n,m,B,q){var p,r,U=0;p=a-d;p<e.xmin&&(p=a);d=a+d;d>e.xmax&&(d=a);if(p===d)return[!1,b,e];r=R(p,0,f,g,h,k,l,n,m,B,q);a=r[1];r=r[0];if(!r)return[r,b,e];r=R(d,U,f,g,h,k,l,n,m,B,q);U=r[1];return(r=r[0])?[!0,(U-
a)/(d-p),e]:[r,b,e]}function ba(a,b,d,e,f,g,h,k,l,n,m,B,q,p,r,U){switch(U){case 0:q=a.xpos-a.ypos*((a.xneg-a.xpos)/(a.yneg-a.ypos));break;case 1:var s;q=(a.xpos+a.xneg)/2;s=R(q,p,b,d,e,f,g,h,k,l,n);p=s[1];r=s[0];if(!r)return[null,a,B,q,p,U];if(0===p)return a=L(q,p,a)[1],[!0,a,B,q,p,U];s=Math.sqrt(p*p-a.ypos*a.yneg);if(0===s)return[null,a,B,q,p,U];q+=(q-a.xpos)*p/s;break;case 3:q=(a.xpos+a.xneg)/2;break;case 2:var y=s=0,t=0,sa=0;if(0.1<m)return ba(a,b,d,e,f,g,h,k,l,n,m,B,q,p,r,3);switch(B++%4){case 0:s=
a.ypos;break;case 2:s=a.xneg;y=a.yneg;break;default:case 3:case 1:if(s=(a.xpos+a.xneg)/2,m=R(s,y,b,d,e,f,g,h,k,l,n),y=m[1],r=m[0],!r)return[null,a,B,q,p,U]}t=Math.abs(a.xpos-a.xneg)/1E6;b=ga(s,sa,t,a,b,d,e,f,g,h,k,l,n);a=b[2];sa=b[1];r=b[0];if(!r||0===sa)return[null,a,B,q,p,U];q=s-1.01*y/sa;if(q<a.xpos&&q<a.xneg||q>a.xpos&&q>a.xneg)return[null,a,B,q,p,U]}return[!1,a,B,q,p,U]}function W(a,b,d){b=d.length;var e=0,f=1;a=1/(a+1);var g;for(g=0;g<b;g++)e+=d[g]*f,f*=a;return[!0,e]}function ja(a,b,d){var e,
f=a.precision/2;for(e=0;20>e;e++){var g,h,k;h=g=0;if(d<a.xmin||d>a.xmax)break;k=W(d,g,b);g=k[1];k=k[0];if(!k)return[k,a];k=L(d,g,a);a=k[1];if(k[0])return[!0,a];h=b.length;k=0;for(var l=1,n=1/(d+1),m=void 0,m=1;m<h;m++)k+=b[m]*-m*l,l*=n;h=k;k=[!0,h];h=k[1];k=k[0];if(!k)return[k,a];if(0===h)break;g=d-1.000001*g/h;if(g===d)return a.root=d,[!0,a];h=Math.abs(g-d)/(Math.abs(d)+Math.abs(g));d=g;if(h<f)return a.root=d,[!0,a]}return[!1,a]}function fa(a,b,d){var e;if(d<a.xmin||d>a.xmax)return[!1,a];e=W(d,0,
b);b=e[1];e=e[0];if(!e)return[e,a];e=L(d,b,a);a=e[1];return e[0]?[!0,a]:[!1,a]}function la(a,b,d,e,f,g,h,k){switch(k){case 0:f=a.xpos-a.ypos*((a.xneg-a.xpos)/(a.yneg-a.ypos));break;case 1:var l;f=(a.xpos+a.xneg)/2;l=W(f,g,b);g=l[1];h=l[0];if(!h)return[null,a,e,f,g,k];if(0===g)return a=L(f,g,a)[1],[!0,a,e,f,g,k];l=Math.sqrt(g*g-a.ypos*a.yneg);if(0===l)return[null,a,e,f,g,k];f+=(f-a.xpos)*g/l;break;case 3:f=(a.xpos+a.xneg)/2;break;case 2:var n,m=l=0;if(0.1<d)return la(a,b,d,e,f,g,h,3);switch(e++%4){case 0:d=
a.ypos;break;case 2:d=a.xneg;l=a.yneg;break;default:case 3:case 1:if(d=(a.xpos+a.xneg)/2,h=W(d,l,b),l=h[1],h=h[0],!h)return[null,a,e,f,g,k]}n=Math.abs(a.xpos-a.xneg)/1E6;var B,q,p=0;h=d-n;h<a.xmin&&(h=d);n=d+n;n>a.xmax&&(n=d);h===n?b=[!1,m,a]:(B=W(h,0,b),q=B[1],(B=B[0])?(B=W(n,p,b),p=B[1],b=(B=B[0])?[!0,(p-q)/(n-h),a]:[B,m,a]):b=[B,m,a]);a=b[2];m=b[1];h=b[0];if(!h||0===m)return[null,a,e,f,g,k];f=d-1.01*l/m;if(f<a.xpos&&f<a.xneg||f>a.xpos&&f>a.xneg)return[null,a,e,f,g,k]}return[!1,a,e,f,g,k]}function ra(a,
b){var d,e,f=0;if(!a.havexpos||!a.havexneg)return[!1,a];e=Math.abs(a.xpos-a.xneg)/(Math.abs(a.xpos)+Math.abs(a.xneg));for(d=0;160>d;d++){var g,h=0,k,l=0,l=0===d%4?1:2===d%4?2:3,l=la(a,b,e,f,g,h,k,l);a=l[1];f=l[2];g=l[3];h=l[4];if(null!==l[0]){if(l[0])return[!0,a];l=W(g,h,b);h=l[1];if(k=l[0]){l=L(g,h,a);a=l[1];if(l[0])return[!0,a];e=Math.abs(a.xpos-a.xneg)/(Math.abs(a.xpos)+Math.abs(a.xneg));if(e<a.precision)return a.yneg<h&&(h=a.yneg,g=a.xneg),a.ypos<h&&(g=a.xpos),a.root=g,[!0,a]}}}return[!1,a]}function da(a,
b,d,e){for(var f=0,g=e.length,h=0;h<g;h++){var k=n(d[h])-n(d[0]);if(0>k)return[!1,b];f+=e[h]/va._MathHelper.pow1p(a,k/365)}isFinite(f)?b=isNaN(f)?4.9E-324:f:f===Number.POSITIVE_INFINITY?b=1.79769E308:f===Number.NEGATIVE_INFINITY&&(b=-1.79769E308);return[!0,b]}function oa(a,b,d,e,f,g){var h,k,l=0;h=a-d;h<e.xmin&&(h=a);d=a+d;d>e.xmax&&(d=a);if(h===d)return[!1,b,e];k=da(h,0,f,g);a=k[1];k=k[0];if(!k)return[k,b,e];k=da(d,l,f,g);l=k[1];return(k=k[0])?[!0,(l-a)/(d-h),e]:[k,b,e]}function ha(a,b,d,e){var f,
g,h=a.precision/2;for(f=0;20>f;f++){var k,l;l=k=0;g=da(e,k,b,d);k=g[1];g=g[0];if(!g)return[g,a];g=L(e,k,a);a=g[1];if(g[0])return[!0,a];g=1E-10>Math.abs(e)?a.havexneg&&a.havexpos?Math.abs(a.xpos-a.xneg)/1E6:(a.xmax-a.xmin)/1E6:Math.abs(e)/1E6;a=oa(e,l,g,a,b,d);g=a[0];l=a[1];a=a[2];if(!g)return[g,a];if(0===l)break;k=e-1.000001*k/l;if(k===e)return a.root=e,[!0,a];l=Math.abs(k-e)/(Math.abs(e)+Math.abs(k));e=k;if(l<h)return a.root=e,[!0,a]}return[!1,a]}function X(a,b,d,e,f){if(b<a.xmin||b>a.xmax)return[!1,
a,d];e=da(b,d,e,f);d=e[1];e=e[0];if(!e)return[e,a,d];e=L(b,0,a);a=e[1];return e[0]?[!0,a,d]:[!1,a,d]}function na(a,b,d,e,f,g,h,k,l){switch(l){case 0:g=a.xpos-a.ypos*((a.xneg-a.xpos)/(a.yneg-a.ypos));break;case 1:var n;g=(a.xpos+a.xneg)/2;n=da(g,h,b,d);h=n[1];k=n[0];if(!k)return[null,a,f,g,h,l];if(0===h)return a=L(g,h,a)[1],[!0,a,f,g,h,l];n=Math.sqrt(h*h-a.ypos*a.yneg);if(0===n)return[null,a,f,g,h,l];g+=(g-a.xpos)*h/n;break;case 3:g=(a.xpos+a.xneg)/2;break;case 2:var m=n=0,B=0,q=0;if(0.1<e)return na(a,
b,d,e,f,g,h,k,3);switch(f++%4){case 0:n=a.ypos;break;case 2:n=a.xneg;m=a.yneg;break;default:case 3:case 1:if(n=(a.xpos+a.xneg)/2,e=da(n,m,b,d),m=e[1],k=e[0],!k)return[null,a,f,g,h,l]}B=Math.abs(a.xpos-a.xneg)/1E6;b=oa(n,q,B,a,b,d);a=b[2];q=b[1];k=b[0];if(!k||0===q)return[null,a,f,g,h,l];g=n-1.01*m/q;if(g<a.xpos&&g<a.xneg||g>a.xpos&&g>a.xneg)return[null,a,f,g,h,l]}return[!1,a,f,g,h,l]}function ca(a,b,d){var e,f,g=0;if(!a.havexpos||!a.havexneg)return[!1,a];f=Math.abs(a.xpos-a.xneg)/(Math.abs(a.xpos)+
Math.abs(a.xneg));for(e=0;108>e;e++){var h=0,k=0,l,n=na(a,b,d,f,g,h,k,l,0===e%4?1:2===e%4?2:3);a=n[1];g=n[2];h=n[3];k=n[4];if(n[0]){if(n[0])return[!0,a];n=da(h,k,b,d);k=n[1];if(l=n[0]){n=L(h,k,a);a=n[1];if(n[0])return[!0,a];f=Math.abs(a.xpos-a.xneg)/(Math.abs(a.xpos)+Math.abs(a.xneg));if(f<a.precision)return a.yneg<k&&(k=a.yneg,h=a.xneg),a.ypos<k&&(h=a.xpos),a.root=h,[!0,a]}}}return[!1,a]}function x(a,b,d,e,f){f/=d;1<=f?(f=1,d=1===e?a:0):d=a*Math.pow(1-f,e-1);a*=Math.pow(1-f,e);b=a<b?d-b:d-a;0>b&&
(b=0);return b}function qa(a,b,d,e,f,g){var h=0,k=Math.ceil(f),l=y.Convert.toInt(k),n,m,B=a-b,q=!1,p,r;m=0;for(r=1;r<=l;r++)q?n=m:(p=x(a,b,d,r,g),m=B/(e-(r-1)),m>p?(n=m,q=!0):(n=p,B-=p)),r===l&&(n*=f+1-k),h+=n;return h}function B(a,b,d){if(-1<a&&0!==a){b=Math.pow(1+a,d.nper);var e=(Math.pow(1+a,d.nper)-1)/a;b=d.pv*b+d.pmt*(1+a*d.type)*e+d.fv;return[!0,b,d]}return[!1,b,d]}function sa(a,b,d){var e,f=a.precision/2;for(e=0;100>e;e++){var g,h,k=g=0;if(d<a.xmin||d>a.xmax)break;h=B(d,g,b);b=h[2];g=h[1];
h=h[0];if(!h)return[h,a,b];h=L(d,g,a);a=h[1];if(h[0])return[!0,a,b];h=d;if(-1<h&&0!==h){var k=b,l=Math.pow(1+h,k.nper-1),n=(Math.pow(1+h,k.nper)-1)/h,k=-k.pmt*n/h+l*k.nper*(k.pv+k.pmt*(k.type+1/h));h=[!0,k,b]}else h=[!1,k,b];b=h[2];k=h[1];h=h[0];if(!h)return[h,a,b];if(0===k)break;g=d-1.000001*g/k;if(g===d)return a.root=d,[!0,a,b];h=Math.abs(g-d)/(Math.abs(d)+Math.abs(g));d=g;if(h<f)return a.root=d,[!0,a,b]}return[!1,a,b]}function U(a,b,d){var e,f;if(d<a.xmin||d>a.xmax)return[!1,a,b];e=B(d,0,b);b=
e[2];f=e[1];e=e[0];if(!e)return[e,a,b];d=L(d,f,a);a=d[1];return d[0]?[!0,a,b]:[!1,a,b]}function Ba(a,b,d,e,f,g,h,k){switch(k){case 0:f=a.xpos-a.ypos*((a.xneg-a.xpos)/(a.yneg-a.ypos));break;case 1:var l;f=(a.xpos+a.xneg)/2;h=B(f,g,b);b=h[2];g=h[1];h=h[0];if(!h)return[null,a,b,e,f,g,k];if(0===g)return a=L(f,g,a)[1],[!0,a,b,e,f,g,k];l=Math.sqrt(g*g-a.ypos*a.yneg);if(0===l)return[null,a,b,e,f,g,k];f+=(f-a.xpos)*g/l;break;case 3:f=(a.xpos+a.xneg)/2;break;case 2:var n,m=l=0;if(0.1<d)return Ba(a,b,d,e,f,
g,h,3);switch(e++%4){case 0:d=a.ypos;break;case 2:d=a.xneg;l=a.yneg;break;default:case 3:case 1:if(d=(a.xpos+a.xneg)/2,h=B(d,l,b),b=h[2],l=h[1],h=h[0],!h)return[null,a,b,e,f,g,k]}n=Math.abs(a.xpos-a.xneg)/1E6;var q,p,r=0;h=d-n;h<a.xmin&&(h=d);n=d+n;n>a.xmax&&(n=d);h===n?h=[!1,m,a,b]:(q=B(h,0,b),b=q[2],p=q[1],(q=q[0])?(q=B(n,r,b),b=q[2],r=q[1],h=(q=q[0])?[!0,(r-p)/(n-h),a,b]:[q,m,a,b]):h=[q,m,a,b]);b=h[3];a=h[2];m=h[1];h=h[0];if(!h||0===m)return[null,a,b,e,f,g,k];f=d-1.01*l/m;if(f<a.xpos&&f<a.xneg||
f>a.xpos&&f>a.xneg)return[null,a,b,e,f,g,k]}return[!1,a,b,e,f,g,k]}function wa(a,b){var d,e,f=0;if(!a.havexpos||!a.havexneg)return[!1,a,b];e=Math.abs(a.xpos-a.xneg)/(Math.abs(a.xpos)+Math.abs(a.xneg));for(d=0;160>d;d++){var g,h=0,k,l=0,l=0===d%4?1:2===d%4?2:3,l=Ba(a,b,e,f,g,h,k,l);a=l[1];b=l[2];f=l[3];g=l[4];h=l[5];if(l[0]){if(l[0])return[!0,a,b];k=B(g,h,b);b=k[2];h=k[1];if(k=k[0]){e=L(g,h,a);a=e[1];if(e[0])return[!0,a,b];e=Math.abs(a.xpos-a.xneg)/(Math.abs(a.xpos)+Math.abs(a.xneg));if(e<a.precision)return a.yneg<
h&&(h=a.yneg,g=a.xneg),a.ypos<h&&(g=a.xpos),a.root=g,[!0,a,b]}}}return[!1,a,b]}var Aa=p.GrapeCity;"undefined"===typeof Aa&&(Aa=p.GrapeCity={});"undefined"===typeof Aa.Calc&&(Aa.Calc={});var y=Aa.Calc;"undefined"===typeof y.Functions&&(y.Functions={});var va=y.Functions;va._builtInFunctions=va._builtInFunctions||{};"undefined"===typeof va._defineBuildInFunction&&(va._defineBuildInFunction=function(a,b,d){if(!a)throw"Invalid function name";var e;a=a.toUpperCase();if(va._builtInFunctions.hasOwnProperty(a))if(e=
va._builtInFunctions[a],!e)va._builtInFunctions[a]=new va.Function(a,0,255),e=va[a.toUpperCase()];else{if(!d||!d.override)throw"Attempt to override function while override is not allowed";}else e=new va.Function(a,0,255),va._builtInFunctions[a]=e;b&&"function"===typeof b&&(e.evaluate=b);if(d)for(var f in d)d.hasOwnProperty(f)&&"override"!==f&&(e[f]=d[f]);return e});p=va._defineBuildInFunction;va._FinancialHelper={days_between_basis:S,annual_year_basis:I};p("FV",function(a){var b=y.Convert,d=y._Helper,
e=b.toDouble(a[0]),f=b.toDouble(a[1]),g=b.toDouble(a[2]),h=d._argumentExists(a,3)?b.toDouble(a[3]):0;a=d._argumentExists(a,4)?b.toDouble(a[4]):0;0!==a&&(a=1);return 0===e?b.toResult(-(g*f+h)):b.toResult(-(h*Math.pow(1+e,f)+g*(1+e*a)*(Math.pow(1+e,f)-1)/e))},{minArgs:3,maxArgs:5,acceptsMissingArgument:g});p("FVSCHEDULE",function(a){for(var b=y.Convert,d=y._ArrayHelper,e=b.toDouble(a[0]),f=0;f<d.getLength(a[1]);f++)var g=b.toDouble(d.getValueByIndex(a[1],f)),e=e*(1+g);return e},{minArgs:2,maxArgs:2,
acceptsArray:m,acceptsReference:m});p("NPV",function(a){for(var b=y.Convert,d=y._ArrayHelper,e=b.toDouble(a[0]),f=0,g=1,h=0,k=1;k<a.length;k++){if(b.isError(a[k]))return a[k];if(d.isArrayOrReference(a[k]))for(var l=0;l<d.getLength(a[k]);l++){h=d.getValueByIndex(a[k],l);if(b.isError(h))return h;if(b.isNumber(h))h=b.toDouble(d.getValueByIndex(a[k],l)),f+=h/Math.pow(1+e,g),g++;else if(b.isError(h))return h}else h=b.toDouble(a[k]),f+=h/Math.pow(1+e,g),g++}return f},{minArgs:2,acceptsArray:a,acceptsReference:a});
p("PV",function(a){var b=y.Convert,d=y._Helper,e=b.toDouble(a[0]),f=b.toDouble(a[1]),g=b.toDouble(a[2]),h=d._argumentExists(a,3)?b.toDouble(a[3]):0;a=d._argumentExists(a,4)?b.toDouble(a[4]):0;0!==a&&(a=1);return 0===e?b.toResult(-(g*f+h)):-1===e?y.Errors.DivideByZero:b.toResult(-(h+g*(1+e*a)*(Math.pow(1+e,f)-1)/e)/Math.pow(1+e,f))},{minArgs:3,maxArgs:5,acceptsMissingArgument:g});p("RECEIVED",function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toDouble(a[2]),k=b.toDouble(a[3]);
a=d._argumentExists(a,4)?b.toInt(a[4]):0;if(0<=e-f||0>=g||0>=k||0>a||4<a)return y.Errors.Number;f=h(e,f,a);e=I(e,a);if(0>=f||0>=e)return y.Errors.Number;k=1-k*f/e;return 0>=k?y.Errors.Number:g/k},{minArgs:4,maxArgs:5,acceptsMissingArgument:d});p("XNPV",function(a){var b=y.Convert,d=y._ArrayHelper,e=d.getLength(a[1]),f=d.getLength(a[2]);if(e!==f)return y.Errors.Number;for(var g=b.toDouble(a[0]),h=Array(e),k=Array(f),l=0,m=0;m<e;m++)h[m]=b.toDouble(d.getValueByIndex(a[1],m));for(m=0;m<f;m++)k[m]=b.toDateTime(d.getValueByIndex(a[2],
m));for(a=0;a<e;a++)l+=h[a]/Math.pow(1+g,(n(k[a])-n(k[0]))/365);return l},{minArgs:3,maxArgs:3,acceptsArray:l,acceptsReference:l});p("CUMIPMT",function(a){var b=y.Convert,d=b.toDouble(a[0]),e=b.toInt(a[1]),f=b.toDouble(a[2]),g=b.toInt(a[3]),h=b.toInt(a[4]);a=b.toInt(a[5]);if(1>g||h<g||0>=d||h>e||0>=e||0>=f||0!==a&&1!==a)return y.Errors.Number;e=E(d,e,f,0,a);b=0;1===g&&(0>=a&&(b=-f),g++);for(;g<=h;g++)b=0<a?b+(O(d,g-2,e,f,1)-e):b+O(d,g-1,e,f,0);return b*d},{minArgs:6,maxArgs:6});p("CUMPRINC",function(a){var b=
y.Convert,d=b.toDouble(a[0]),e=b.toInt(a[1]),f=b.toDouble(a[2]),g=b.toInt(a[3]),h=b.toInt(a[4]);a=b.toInt(a[5]);if(1>g||h<g||0>=d||h>e||0>=e||0>=f||0!==a&&1!==a)return y.Errors.Number;e=E(d,e,f,0,a);b=0;1===g&&(b=0>=a?e+f*d:e,g++);for(;g<=h;g++)b=0<a?b+(e-(O(d,g-2,e,f,1)-e)*d):b+(e-O(d,g-1,e,f,0)*d);return b},{minArgs:6,maxArgs:6});p("IPMT",function(a){var b=y.Convert,d=y._Helper,e=b.toDouble(a[0]),f=b.toDouble(a[1]),g=b.toDouble(a[2]),h=b.toDouble(a[3]),k=d._argumentExists(a,4)?b.toDouble(a[4]):
0;a=d._argumentExists(a,5)?b.toInt(a[5]):0;if(1>f||f>=g+1||1>g)return y.Errors.Number;g=H(e,g,h,k,a);return C(h,g,e,f-1)},{minArgs:4,maxArgs:6,acceptsMissingArgument:e});p("ISPMT",function(a){var b=y.Convert,d=b.toDouble(a[0]),e=b.toInt(a[1]),f=b.toInt(a[2]);a=b.toDouble(a[3]);return 0===f?y.Errors.DivideByZero:b.toResult(a*d*(b.toDouble(e)/b.toDouble(f)-1))},{minArgs:4,maxArgs:4});p("PMT",function(a){var b=y.Convert,d=y._Helper,e=b.toDouble(a[0]),f=b.toDouble(a[1]),g=b.toDouble(a[2]),h=d._argumentExists(a,
3)?b.toDouble(a[3]):0;a=d._argumentExists(a,4)?b.toDouble(a[4]):0;0!==a&&(a=1);return 0===e?0===f?y.Errors.DivideByZero:b.toResult(-(g+h)/f):0===f?y.Errors.DivideByZero:b.toResult(-(g*Math.pow(1+e,f)+h)/((1+e*a)*(Math.pow(1+e,f)-1)/e))},{minArgs:3,maxArgs:5,acceptsMissingArgument:g});p("PPMT",function(a){var b=y.Convert,d=y._Helper,e=b.toDouble(a[0]),f=b.toDouble(a[1]),g=b.toDouble(a[2]),h=b.toDouble(a[3]),k=d._argumentExists(a,4)?b.toDouble(a[4]):0;a=d._argumentExists(a,5)?b.toBool(a[5]):!1;if(1>
f||f>=g+1)return y.Errors.Number;g=H(e,g,h,k,a?1:0);e=C(h,g,e,f-1);return g-e},{minArgs:4,maxArgs:6,acceptsMissingArgument:e});p("COUPDAYBS",function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toInt(a[2]);a=d._argumentExists(a,3)?b.toInt(a[3]):0;b=y.Errors.Number;return 0>a||4<a||1!==g&&2!==g&&4!==g||0<=e-f?b:Q(e,f,g,a)},{minArgs:3,maxArgs:4,acceptsMissingArgument:k});p("COUPDAYS",function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=
b.toInt(a[2]);a=d._argumentExists(a,3)?b.toInt(a[3]):0;b=y.Errors.Number;return 0>a||4<a||1!==g&&2!==g&&4!==g||0<=e-f?b:aa(e,f,g,a)},{minArgs:3,maxArgs:4,acceptsMissingArgument:k});p("COUPDAYSNC",function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toInt(a[2]);a=d._argumentExists(a,3)?b.toInt(a[3]):0;return 0>a||4<a||1!==g&&2!==g&&4!==g||0<=e-f?y.Errors.Number:ka(e,f,g,a)},{minArgs:3,maxArgs:4,acceptsMissingArgument:k});p("COUPNCD",function(a){var b=y.Convert,d=y._Helper,
e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toInt(a[2]);a=d._argumentExists(a,3)?b.toInt(a[3]):0;if(0>a||4<a||1!==g&&2!==g&&4!==g||0<=e-f)return y.Errors.Number;e=z(e,f,g,!0);return n(e)},{minArgs:3,maxArgs:4,acceptsMissingArgument:k});p("COUPNUM",function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toInt(a[2]);a=d._argumentExists(a,3)?b.toInt(a[3]):0;return 0>a||4<a||1!==g&&2!==g&&4!==g||0<=e-f?y.Errors.Number:J(e,f,g)},{minArgs:3,maxArgs:4,acceptsMissingArgument:k});
p("COUPPCD",function(a){var b=y.Convert,d=b.toDateTime(a[0]),e=b.toDateTime(a[1]),f=b.toInt(a[2]);a=Aa.Calc._Helper._argumentExists(a,3)?b.toInt(a[3]):0;if(0>a||4<a||1!==f&&2!==f&&4!==f||0<=d-e)return y.Errors.Number;d=z(d,e,f,!1);return n(d)},{minArgs:3,maxArgs:4,acceptsMissingArgument:k});p("DURATION",function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toDouble(a[2]),h=b.toDouble(a[3]),k=b.toInt(a[4]);a=d._argumentExists(a,5)?b.toInt(a[5]):0;if(0>a||4<a||1!==k&&
2!==k&&4!==k||0<e-f)return y.Errors.Number;b=J(e,f,k);return K(e,f,g,h,k,a,b)},{minArgs:5,maxArgs:6,acceptsMissingArgument:b});p("MDURATION",function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toDouble(a[2]),h=b.toDouble(a[3]),k=b.toInt(a[4]);a=d._argumentExists(a,5)?b.toInt(a[5]):0;if(0>a||4<a||1!==k&&2!==k&&4!==k||0<e-f)return y.Errors.Number;b=J(e,f,k);e=K(e,f,g,h,k,a,b);return e/=1+h/y.Convert.toDouble(k)},{minArgs:5,maxArgs:6,acceptsMissingArgument:b});p("NPER",
function(a){var b=y.Convert,d=y._Helper,e=b.toDouble(a[0]),f=b.toDouble(a[1]),g=b.toDouble(a[2]),h=d._argumentExists(a,3)?b.toDouble(a[3]):0;a=d._argumentExists(a,4)?b.toDouble(a[4]):0;0!==a&&(a=1);return 0===e?0===f?y.Errors.DivideByZero:b.toResult(-(g+h)/f):-1>=e?y.Errors.Number:b.toResult(Math.log((f*(1+e*a)-h*e)/(g*e+f*(1+e*a)))/Math.log(1+e))},{minArgs:3,maxArgs:5,acceptsMissingArgument:g});p("YIELD",function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toDouble(a[2]),
h=b.toDouble(a[3]),k=b.toDouble(a[4]),l=b.toInt(a[5]);a=d._argumentExists(a,6)?b.toInt(a[6]):0;if(0>a||4<a||1!==l&&2!==l&&4!==l||0<e-f||0>g||0>h||0>=k)return y.Errors.Number;if(1>=J(e,f,l)){var n=Q(e,f,l,a),b=ka(e,f,l,a),e=aa(e,f,l,a);return(k/100+g/l-(h/100+n/e*g/l))/(h/100+n/e*g/l)*(l*e/b)}b={};d=0.1;b.xmin=0;b.xmax=0;b.precision=0;b.havexpos=!1;b.xpos=0;b.ypos=0;b.havexneg=!1;b.xneg=0;b.yneg=0;b.root=0;b=A(b);b.xmin=Math.max(b.xmin,0);b.xmax=Math.min(b.xmax,1E3);a:{var m,B,q=b.precision/2;for(m=
0;20>m;m++){var p,r;r=p=0;if(d<b.xmin||d>b.xmax)break;B=v(d,p,e,f,g,h,k,l,a);p=B[1];B=B[0];if(!B){d=[B,b];break a}B=L(d,p,b);b=B[1];if(B[0]){d=[!0,b];break a}B=1E-10>Math.abs(d)?b.havexneg&&b.havexpos?Math.abs(b.xpos-b.xneg)/1E6:(b.xmax-b.xmin)/1E6:Math.abs(d)/1E6;B=V(d,r,B,b,e,f,g,h,k,l,a);b=B[2];r=B[1];B=B[0];if(!B){d=[B,b];break a}if(0===r)break;p=d-1.000001*p/r;if(p===d){b.root=d;d=[!0,b];break a}r=Math.abs(p-d)/(Math.abs(d)+Math.abs(p));d=p;if(r<q){b.root=d;d=[!0,b];break a}}d=[!1,b]}b=d[1];
d=d[0];if(!d){for(d=1E-10;d<b.xmax;d*=2)m=d,p=void 0,q=0,m<b.xmin||m>b.xmax?b=[!1,b]:(p=v(m,q,e,f,g,h,k,l,a),q=p[1],(p=p[0])?(p=L(m,q,b),b=p[1],b=p[0]?[!0,b]:[!1,b]):b=[p,b]),b=b[1];a:{m=0;if(b.havexpos&&b.havexneg)for(r=Math.abs(b.xpos-b.xneg)/(Math.abs(b.xpos)+Math.abs(b.xneg)),d=0;108>d;d++)if(p=q=0,B=N(b,e,f,g,h,k,l,a,r,m,q,p,n,0===d%4?1:2===d%4?2:3),b=B[1],m=B[2],q=B[3],p=B[4],B[0]){if(B[0]){d=[!0,b];break a}n=v(q,p,e,f,g,h,k,l,a);p=n[1];if(n=n[0]){r=L(q,p,b);b=r[1];if(r[0]){d=[!0,b];break a}r=
Math.abs(b.xpos-b.xneg)/(Math.abs(b.xpos)+Math.abs(b.xneg));if(r<b.precision){b.yneg<p&&(p=b.yneg,q=b.xneg);b.ypos<p&&(q=b.xpos);b.root=q;d=[!0,b];break a}}}d=[!1,b]}b=d[1];d=d[0]}return d?b.root:y.Errors.Number},{minArgs:6,maxArgs:7,acceptsMissingArgument:f});p("YIELDDISC",function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toDouble(a[2]),h=b.toDouble(a[3]);a=d._argumentExists(a,4)?b.toInt(a[4]):0;if(0>a||4<a||0>=h||0>=g||0<=e-f)return y.Errors.Number;g=h/g-1;e=
va._DateTimeHelper.yearfrac([e,f,a]);return g/e},{minArgs:4,maxArgs:5,acceptsMissingArgument:d});p("YIELDMAT",function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toDateTime(a[2]),h=b.toDouble(a[3]),k=b.toDouble(a[4]),b=d._argumentExists(a,5)?b.toInt(a[5]):0;if(0>b||4<b||0>h)return y.Errors.Number;d=va._DateTimeHelper.yearfrac;a=d([g,f,b]);g=d([g,e,b]);e=d([e,f,b]);h=(1+a*h)/(k/100+g*h);h--;return h/=e},{minArgs:5,maxArgs:6,acceptsMissingArgument:b});p("ODDFYIELD",
function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toDateTime(a[2]),h=b.toDateTime(a[3]),k=b.toDouble(a[4]),l=b.toDouble(a[5]),n=b.toDouble(a[6]),m=b.toInt(a[7]);a=d._argumentExists(a,8)?b.toInt(a[8]):0;d=0.1;b={};if(0>a||4<a||1!==m&&2!==m&&4!==m||0<g-e||0<e-h||0<h-f||0>k||0>=l||0>=n)return y.Errors.Number;b.xmin=0;b.xmax=0;b.precision=0;b.havexpos=!1;b.xpos=0;b.ypos=0;b.havexneg=!1;b.xneg=0;b.yneg=0;b.root=0;b=A(b);b.xmin=Math.max(b.xmin,0);b.xmax=Math.min(b.xmax,
1E3);a:{var B,q,p=b.precision/2;for(B=0;20>B;B++){var r,U;U=r=0;if(d<b.xmin||d>b.xmax){d=[!1,b];break a}q=R(d,r,e,f,g,h,k,l,n,m,a);r=q[1];q=q[0];if(!q){d=[q,b];break a}q=L(d,r,b);b=q[1];if(q[0]){d=[!0,b];break a}q=1E-10>Math.abs(d)?b.havexneg&&b.havexpos?Math.abs(b.xpos-b.xneg)/1E6:(b.xmax-b.xmin)/1E6:Math.abs(d)/1E6;q=ga(d,U,q,b,e,f,g,h,k,l,n,m,a);b=q[2];U=q[1];q=q[0];if(!q){d=[q,b];break a}if(0===U){d=[!1,b];break a}r=d-1.000001*r/U;if(r===d){b.root=d;d=[!0,b];break a}U=Math.abs(r-d)/(Math.abs(d)+
Math.abs(r));d=r;if(U<p){b.root=d;d=[!0,b];break a}}d=[!1,b]}b=d[1];if(d=d[0]){for(d=1E-10;d<b.xmax;d*=2)B=d,r=void 0,p=0,B<b.xmin||B>b.xmax?b=[!1,b]:(r=R(B,p,e,f,g,h,k,l,n,m,a),p=r[1],(r=r[0])?(r=L(B,p,b),b=r[1],b=r[0]?[!0,b]:[!1,b]):b=[r,b]),b=b[1];a:{B=0;if(b.havexpos&&b.havexneg)for(U=Math.abs(b.xpos-b.xneg)/(Math.abs(b.xpos)+Math.abs(b.xneg)),d=0;108>d;d++){r=p=0;var s;q=ba(b,e,f,g,h,k,l,n,m,a,U,B,p,r,s,0===d%4?1:2===d%4?2:3);b=q[1];B=q[2];p=q[3];r=q[4];if(void 0!==q[0]&&null!==q[0]){if(q[0]){d=
[!0,b];break a}s=R(p,r,e,f,g,h,k,l,n,m,a);r=s[1];if(s=s[0]){U=L(p,r,b);b=U[1];if(U[0]){d=[!0,b];break a}U=Math.abs(b.xpos-b.xneg)/(Math.abs(b.xpos)+Math.abs(b.xneg));if(U<b.precision){b.yneg<r&&(r=b.yneg,p=b.xneg);b.ypos<r&&(p=b.xpos);b.root=p;d=[!0,b];break a}}}}d=[!1,b]}b=d[1];d=d[0]}return d?b.root:y.Errors.Number},{minArgs:8,maxArgs:9,acceptsMissingArgument:s});p("ODDLYIELD",function(a){var b=y.Convert,d=y._Helper,e=b.toDateTime(a[0]),f=b.toDateTime(a[1]),g=b.toDateTime(a[2]),h=b.toDouble(a[3]),
k=b.toDouble(a[4]),l=b.toDouble(a[5]),n=b.toInt(a[6]),b=d._argumentExists(a,7)?b.toInt(a[7]):0;if(0>b||4<b||1!==n&&2!==n&&4!==n||0<e-f||0<g-e||0>h||0>k||0>=l)return y.Errors.Number;d=new Date(g.getFullYear(),g.getMonth(),g.getDate());do d.setMonth(d.getMonth()+12/n);while(0>d-f);a=w(g,e,d,n,b);g=w(g,f,d,n,b);e=w(e,f,d,n,b);return(n*(l-k)+100*h*(g-a))/(e*k+100*h*a*e/n)},{minArgs:7,maxArgs:8,acceptsMissingArgument:q});p("TBILLEQ",function(a){var b=y.Convert,d=b.toDateTime(a[0]),e=b.toDateTime(a[1]);
a=b.toDouble(a[2]);if(0<=d-e||0>=a)return y.Errors.Number;d=n(e)-n(d);if(365<d)return y.Errors.Number;d=360-a*d;return 0===d?y.Errors.DivideByZero:0>d?y.Errors.Number:b.toResult(365*a/d)},{minArgs:3,maxArgs:3});p("TBILLYIELD",function(a){var b=y.Convert,d=b.toDateTime(a[0]),e=b.toDateTime(a[1]);a=b.toDouble(a[2]);if(0<=d-e||0>=a)return y.Errors.Number;d=n(e)-n(d);return 365<d?y.Errors.Number:(100-a)/a*(360/d)},{minArgs:3,maxArgs:3});p("IRR",function(a){var b={xmin:0,xmax:0,precision:0,havexpos:!1,
xpos:0,ypos:0,havexneg:!1,xneg:0,yneg:0,root:0},b=A(b),d=a[0],e=y.Convert,f=y._ArrayHelper;a=y._Helper._argumentExists(a,1)?e.toDouble(a[1]):0.1;1<Math.abs(a)&&(a=0.1);var g=f.getLength(d);if(!f.isArrayOrReference(d)||2>g)return y.Errors.Number;var h=Array(g);b.xmin=-1;b.xmax=Math.min(b.xmax,Math.pow(1.79769E308/1E10,1/g)-1);for(var k=!1,l=!1,n=0;n<g;n++){var m=f.getValueByIndex(d,n);if(e.isNumber(m))m=e.toDouble(m),h[n]=m,0<m&&(k=!0),0>m&&(l=!0);else if(e.isError(m))return m}if(!k||!l)return y.Errors.Number;
d=ja(b,h,a);b=d[1];d=d[0];if(!d){for(d=2;(!b.havexneg||!b.havexpos)&&100>d;d*=2)b=fa(b,h,a*d)[1],b=fa(b,h,a/d)[1];d=ra(b,h);b=d[1];d=d[0]}return d?b.root:y.Errors.Number},{minArgs:1,maxArgs:2,acceptsMissingArgument:m,acceptsArray:t,acceptsReference:t});p("MIRR",function(a){var b=y.Convert,d=y._ArrayHelper,e=b.toDouble(a[1]),f=b.toDouble(a[2]),g=0,h=0,k=0,l=0,n=0,m=d.getLength(a[0]),m=Array(m);if(!d.isArrayOrReference(a[0]))return y.Errors.DivideByZero;for(var k=d.getLength(a[0]),B=0;B<k;B++){var q=
d.getValueByIndex(a[0],B);if(b.isNumber(q))q=b.toDouble(q),m[B]=q,0<=q?g++:h++;else if(b.isError(q))return q}k=h+g;for(a=0;a<k;a++)b=m[a],0<=b?l+=b/Math.pow(1+f,a):n+=b/Math.pow(1+e,a);return 0===n||0===l||-1>=f?y.Errors.DivideByZero:Math.pow(-l*Math.pow(1+f,k)/(n*(1+f)),1/(k-1))-1},{minArgs:3,maxArgs:3,acceptsArray:t,acceptsReference:t});p("XIRR",function(a){var b=y._ArrayHelper.getLength(a[0]),d=y._ArrayHelper.getLength(a[1]),e=Array(b),f=Array(d),g=y._Helper._argumentExists(a,2)?y.Convert.toDouble(a[2]):
0.1;if(b!==d)return y.Errors.Number;for(var h=0;h<b;h++)e[h]=y.Convert.toDouble(y._ArrayHelper.getValueByIndex(a[0],h));for(h=0;h<d;h++)f[h]=y.Convert.toDateTime(y._ArrayHelper.getValueByIndex(a[1],h));a={xmin:0,xmax:0,precision:0,havexpos:!1,xpos:0,ypos:0,havexneg:!1,xneg:0,yneg:0,root:0};a=A(a);a.xmin=-1;a.xmax=Math.min(1E3,a.xmax);b=ha(a,f,e,g);a=b[1];if(b[0])return a.root;for(b=1;1024>=b;b+=b)if(d=y.Convert.toDouble(b),h=9/(d+9),a=X(a,g,h,f,e),a=a[1],h=d,a=X(a,g,h,f,e),a=a[1],d=ca(a,f,e),a=d[1],
d=d[0])return a.root;return y.Errors.Number},{minArgs:2,maxArgs:3,acceptsMissingArgument:function(a){return 2===a},acceptsArray:r,acceptsReference:r});p("AMORDEGRC",function(a){var b=y.Convert.toDouble(a[0]),d=y.Convert.toDateTime(a[1]),e=y.Convert.toDateTime(a[2]),f=y.Convert.toDouble(a[3]),g=y.Convert.toInt(a[4]),h=y.Convert.toDouble(a[5]);a=y._Helper._argumentExists(a,6)?y.Convert.toInt(a[6]):0;var k=1/h;if(0<k&&1>k||1<k&&2>k||2<k&&3>k||4<k&&5>k||0<d-e||0>a||4<a||0>=h||2===a)return y.Errors.Number;
a:if(k=1/h,h*=3>k?1:5>k?1.5:6>=k?2:2.5,d=va._DateTimeHelper.yearfrac([d,e,a]),y.Convert.isError(d))g=0;else{d=Math.floor(d*h*b+0.5);b-=d;e=b-f;for(f=0;f<g;f++){d=Math.floor(h*b+0.5);e-=d;if(0>e)switch(g-f){case 0:case 1:g=Math.floor(0.5*b+0.5);break a;default:g=0;break a}b-=d}g=d}return g},{minArgs:6,maxArgs:7,acceptsMissingArgument:f});p("AMORLINC",function(a){var b=y.Convert.toDouble(a[0]),d=y.Convert.toDateTime(a[1]),e=y.Convert.toDateTime(a[2]),f=y.Convert.toDouble(a[3]),g=y.Convert.toInt(a[4]),
h=y.Convert.toDouble(a[5]),k=y._Helper._argumentExists(a,6)?y.Convert.toInt(a[6]):0;if(0<d-e||0>k||4<k||0>=h||2===k)return y.Errors.Number;a=b*h;var l=b-f,d=va._DateTimeHelper.yearfrac([d,e,k]);y.Convert.isError(d)?g=0:(h=d*h*b,d=(b-f-h)/a,b=y.Convert.toInt((b-f-h)/a),g=0===g?h:g<=b?a*(1>d?d:1):g===b+1?l-a*b-h:0);return g},{minArgs:6,maxArgs:7,acceptsMissingArgument:f});p("DB",function(a){var b=y.Convert.toDouble(a[0]),d=y.Convert.toDouble(a[1]),e=y.Convert.toInt(a[2]),f=y.Convert.toInt(a[3]);a=y._Helper._argumentExists(a,
4)?y.Convert.toInt(a[4]):12;if(0>b||1>e||1>f||e+(12>a?1:0)<f||1>a||12<a)return y.Errors.Number;if(0===b)return 0;for(var d=va._MathHelper.round(1-Math.pow(d/b,1/e),3),g=0,h=0,k=1;k<=f;k++)h=1===k?b*d*a/12:k===e+1?(b-g)*d*(12-a)/12:(b-g)*d,g+=h;return h},{minArgs:4,maxArgs:5,acceptsMissingArgument:d});p("DDB",function(a){var b=y.Convert.toDouble(a[0]),d=y.Convert.toDouble(a[1]),e=y.Convert.toInt(a[2]),f=y.Convert.toInt(a[3]);a=y._Helper._argumentExists(a,4)?y.Convert.toDouble(a[4]):2;var g=0,h=0;if(0>=
e||0>b||e<f||0>=a||0>=f)return y.Errors.Number;if(b<=d)return 0;for(var k=1;k<=f;k++)h=(b-g)*(a/e),h=Math.min(h,b-g-d),g+=h;return h},{minArgs:4,maxArgs:5,acceptsMissingArgument:d});p("SLN",function(a){var b=y.Convert.toDouble(a[0]),d=y.Convert.toDouble(a[1]);a=y.Convert.toInt(a[2]);return 0===a?y.Errors.DivideByZero:(b-d)/a},{minArgs:3,maxArgs:3});p("SYD",function(a){var b=y.Convert.toDouble(a[0]),d=y.Convert.toDouble(a[1]),e=y.Convert.toInt(a[2]);a=y.Convert.toInt(a[3]);return 0>d||1>e||0>=a||a>
e?y.Errors.Number:2*(b-d)*(e-a+1)/(e*(e+1))},{minArgs:4,maxArgs:4});p("VDB",function(a){var b=y.Convert.toDouble(a[0]),d=y.Convert.toDouble(a[1]),e=y.Convert.toInt(a[2]),f=y.Convert.toDouble(a[3]),g=y.Convert.toDouble(a[4]),h=y._Helper._argumentExists(a,5)?y.Convert.toDouble(a[5]):2;a=y._Helper._argumentExists(a,6)?y.Convert.toBool(a[6]):!1;if(0>b||0>d||0>e||0>f||0>g||g<f)return y.Errors.Number;if(b<d&&0===f&&1===g)return b-d;var k,l=Math.floor(f),n=Math.ceil(g),m=y.Convert.toInt(l),B=y.Convert.toInt(n);
k=0;if(a)for(a=m+1;a<=B;a++){var q;q=x(b,d,e,a,h);a===m+1?q*=Math.min(g,l+1)-f:a===B&&(q*=g+1-n);k+=q}else a=e,f!==Math.floor(f)&&1<h&&f>=e/2&&(k=f-e/2,f=e/2,g-=k,a+=1),b-=qa(b,d,e,a,f,h),k=qa(b,d,e,e-f,g-f,h);return k},{minArgs:5,maxArgs:7,acceptsMissingArgument:function(a){return 5===a||6===a}});p("ACCRINT",function(a){var b=y.Convert.toDateTime(a[0]);y.Convert.toDateTime(a[1]);var d=y.Convert.toDateTime(a[2]),e=y.Convert.toDouble(a[3]),f=y._Helper._argumentExists(a,4)?y.Convert.toDouble(a[4]):
1E3,g=y.Convert.toInt(a[5]),k=y._Helper._argumentExists(a,6)?y.Convert.toInt(a[6]):0;y._Helper._argumentExists(a,7)&&y.Convert.toBool(a[7]);if(0>=e||0>=f||0>k||4<k||1!==g&&2!==g&&4!==g||0<=b-d)return y.Errors.Number;a=h(b,d,k);b=I(b,k);if(0>a||0>=b)return y.Errors.Number;e=f*e/y.Convert.toDouble(g);f=a/b;return e*y.Convert.toDouble(g)*f},{minArgs:6,maxArgs:8,acceptsMissingArgument:function(a){return 4===a||6===a||7===a}});p("ACCRINTM",function(a){var b=y.Convert.toDateTime(a[0]),d=y.Convert.toDateTime(a[1]),
e=y.Convert.toDouble(a[2]),f=y._Helper._argumentExists(a,3)?y.Convert.toDouble(a[3]):1E3;a=y._Helper._argumentExists(a,4)?y.Convert.toInt(a[4]):0;if(0>=e||0>=f||0>a||4<a||0<b-d)return y.Errors.Number;d=h(b,d,a);b=I(b,a);return 0>d||0>=b?y.Errors.Number:f*e*d/b},{minArgs:3,maxArgs:5,acceptsMissingArgument:g});p("DISC",function(a){var b=y.Convert.toDateTime(a[0]),d=y.Convert.toDateTime(a[1]),e=y.Convert.toDouble(a[2]),f=y.Convert.toDouble(a[3]),g=y._Helper._argumentExists(a,4)?y.Convert.toInt(a[4]):
0;if(0<=b-d||0>=e||0>=f||0>g||4<g)return y.Errors.Number;a=I(b,g);b=h(b,d,g);return 0>=b||0>=a?y.Errors.Number:(f-e)/f*(a/b)},{minArgs:4,maxArgs:5,acceptsMissingArgument:d});p("EFFECT",function(a){var b=y.Convert.toDouble(a[0]);a=y.Convert.toInt(a[1]);return 0>=b||1>a?y.Errors.Number:Math.pow(1+b/a,a)-1},{minArgs:2,maxArgs:2});p("INTRATE",function(a){var b=y.Convert.toDateTime(a[0]),d=y.Convert.toDateTime(a[1]),e=y.Convert.toDouble(a[2]),f=y.Convert.toDouble(a[3]);a=y._Helper._argumentExists(a,4)?
y.Convert.toInt(a[4]):0;if(0<=b-d||0>=e||0>=f||0>a||4<a)return y.Errors.Number;d=h(b,d,a);b=I(b,a);return 0>=d||0>=b?y.Errors.Number:(f-e)/e*(b/d)},{minArgs:4,maxArgs:5,acceptsMissingArgument:d});p("NOMINAL",function(a){var b=y.Convert.toDouble(a[0]);a=y.Convert.toInt(a[1]);return 0>=b||1>a?y.Errors.Number:a*(Math.pow(1+b,1/a)-1)},{minArgs:2,maxArgs:2});p("RATE",function(a){var b={},d=y.Convert.toDouble(a[0]),e=y.Convert.toDouble(a[1]),f=y.Convert.toDouble(a[2]),g=y._Helper._argumentExists(a,3)?y.Convert.toDouble(a[3]):
0,h=y._Helper._argumentExists(a,4)?y.Convert.toInt(a[4]):0;a=y._Helper._argumentExists(a,5)?y.Convert.toDouble(a[5]):0.1;if(0>=d)return y.Errors.Number;if(0>h)return y.Errors.Value;1<h&&(h=1);b.xmin=0;b.xmax=0;b.precision=0;b.havexpos=!1;b.xpos=0;b.ypos=0;b.havexneg=!1;b.xneg=0;b.yneg=0;b.root=0;b=A(b);b.xmin=Math.max(b.xmin,-Math.pow(1.7976931348623157E308/1E10,1/d)+1);b.xmax=Math.min(b.xmax,Math.pow(1.7976931348623157E308/1E10,1/d)-1);var k={};k.nper=d;k.pmt=e;k.pv=f;k.fv=g;k.type=y.Convert.toInt(h);
d=sa(b,k,a);k=d[2];b=d[1];d=d[0];if(!d){for(e=2;(!b.havexneg||!b.havexpos)&&100>e;e*=2)d=U(b,k,a*e),k=d[2],b=d[1],d=U(b,k,a/e),k=d[2],b=d[1];d=wa(b,k);b=d[1];d=d[0]}return d?b.root:y.Errors.Number},{minArgs:3,maxArgs:6,acceptsMissingArgument:function(a){return 3===a||4===a||5===a}});p("DOLLARDE",function(a){var b=y.Convert.toDouble(a[0]);a=y.Convert.toInt(a[1]);if(0===a)return y.Errors.DivideByZero;if(0>a)return y.Errors.Number;var d=0>b?Math.ceil(b):Math.floor(b),b=b-d,e=Math.pow(10,Math.ceil(va._MathHelper.log10(a)));
return y.Convert.toResult(d+b*e/a)},{minArgs:2,maxArgs:2});p("DOLLARFR",function(a){var b=y.Convert.toDouble(a[0]);a=y.Convert.toInt(a[1]);if(0===a)return y.Errors.DivideByZero;if(0>a)return y.Errors.Number;var d=0>b?Math.ceil(b):Math.floor(b),b=b-d,e=Math.pow(10,Math.ceil(va._MathHelper.log10(a)));return y.Convert.toResult(d+b*a/e)},{minArgs:2,maxArgs:2});p("PRICE",function(a){var b=y.Convert.toDateTime(a[0]),d=y.Convert.toDateTime(a[1]),e=y.Convert.toDouble(a[2]),f=y.Convert.toDouble(a[3]),g=y.Convert.toDouble(a[4]),
h=y.Convert.toInt(a[5]);a=y._Helper._argumentExists(a,6)?y.Convert.toInt(a[6]):0;return 0>f||0>e||0===g||0>a||4<a||1!==h&&2!==h&&4!==h||0<b-d?y.Errors.Number:D(b,d,e,f,g,h,a)},{minArgs:6,maxArgs:7,acceptsMissingArgument:f});p("PRICEDISC",function(a){var b=y.Convert.toDateTime(a[0]),d=y.Convert.toDateTime(a[1]),e=y.Convert.toDouble(a[2]),f=y.Convert.toDouble(a[3]);a=y._Helper._argumentExists(a,4)?y.Convert.toInt(a[4]):0;if(0<=b-d||0>=e||0>=f||0>a||4<a)return y.Errors.Number;d=h(b,d,a);b=I(b,a);return 0>=
d||0>=b?y.Errors.Number:f-e*f*d/b},{minArgs:4,maxArgs:5,acceptsMissingArgument:d});p("PRICEMAT",function(a){var b=y.Convert.toDateTime(a[0]),d=y.Convert.toDateTime(a[1]),e=y.Convert.toDateTime(a[2]),f=y.Convert.toDouble(a[3]),g=y.Convert.toDouble(a[4]),k=y._Helper._argumentExists(a,5)?y.Convert.toInt(a[5]):0;if(0<=b-d||0>f||0>g||0>k||4<k)return y.Errors.Number;a=h(b,d,k);d=h(e,d,k);e=h(e,b,k);b=I(b,k);if(0>=e||0>=b||0>=a||0>=d)return y.Errors.Number;g=1+a/b*g;return 0===g?y.Errors.Number:(100+100*
(d/b)*f)/g-100*(e/b)*f},{minArgs:5,maxArgs:6,acceptsMissingArgument:b});p("ODDFPRICE",function(a){var b=y.Convert.toDateTime(a[0]),d=y.Convert.toDateTime(a[1]),e=y.Convert.toDateTime(a[2]),f=y.Convert.toDateTime(a[3]),g=y.Convert.toDouble(a[4]),h=y.Convert.toDouble(a[5]),k=y.Convert.toDouble(a[6]),l=y.Convert.toInt(a[7]);a=y._Helper._argumentExists(a,8)?y.Convert.toInt(a[8]):0;return 0>a||4<a||1!==l&&2!==l&&4!==l||0<e-b||0<b-f||0<f-d||0>g||0>h||0>=k?y.Errors.Number:M(b,d,e,f,g,h,k,l,a)},{minArgs:8,
maxArgs:9,acceptsMissingArgument:s});p("ODDLPRICE",function(a){var b=y.Convert.toDateTime(a[0]),d=y.Convert.toDateTime(a[1]),e=y.Convert.toDateTime(a[2]),f=y.Convert.toDouble(a[3]),g=y.Convert.toDouble(a[4]),h=y.Convert.toDouble(a[5]),k=y.Convert.toInt(a[6]),l=y._Helper._argumentExists(a,7)?y.Convert.toInt(a[7]):0;if(0>l||4<l||1!==k&&2!==k&&4!==k||0<b-d||0<e-b||0>f||0>g||0>=h)return y.Errors.Number;var n=new Date(e.getFullYear(),e.getMonth(),e.getDate());do n.setMonth(n.getMonth()+12/k);while(0>n-
d);a=w(e,b,n,k,l);e=w(e,d,n,k,l);b=w(b,d,n,k,l);return(h*k+100*f*(e-a*(1+g*b/k)))/(g*b+k)},{minArgs:7,maxArgs:8,acceptsMissingArgument:q});p("TBILLPRICE",function(a){var b=y.Convert.toDateTime(a[0]),d=y.Convert.toDateTime(a[1]);a=y.Convert.toDouble(a[2]);if(0<=b-d||0>=a)return y.Errors.Number;b=n(d)-n(b);return 365<b?y.Errors.Number:100*(1-a*b/360)},{minArgs:3,maxArgs:3});p("EURO",function(a){a=y.Convert.toString(a[0]);a=T(a,2);return 0<=a?a:y.Errors.Number},{minArgs:1,maxArgs:1});p("EUROCONVERT",
function(a){var b=y.Convert.toDouble(a[0]),d=y.Convert.toString(a[1]),e=y.Convert.toString(a[2]),f=y._Helper._argumentExists(a,3)?y.Convert.toBool(a[3]):!1,g=y._Helper._argumentExists(a,4)?y.Convert.toInt(a[4]):3,h=0;if(3>g)return y.Errors.Value;f||(h=ia(e));y._Helper._argumentExists(a,4)||(g=P(d));a=0;d=T(d,g);e=T(e,g);if(0<=d&&0<=e)a=b*e/d;else return y.Errors.Value;f||(a=va._MathHelper.round(a,h));return a},{minArgs:3,maxArgs:5,acceptsMissingArgument:g})})(window);
(function(p,l){function m(a,b,d){if(!a)return null;if(z._ArrayHelper.isArrayOrReference(a)){if(b>z._ArrayHelper.getColumnCount(a)){var e=b;b=d;d=e}b=d*z._ArrayHelper.getColumnCount(a)+b;return z._ArrayHelper.getValueByIndex(a,b,0)}return a}function k(a,b){return b?z.Convert.isNumber(a)&&z.Convert.isNumber(b)||"bool"===typeof a&&"bool"===typeof b||"string"===typeof a&&"string"===typeof b?!0:!1:!1}function g(a,b,d,e,f){if(0>a||0>b||b<a||d<a||d>b)return-1;if(f)return aa=a,ka=b,K=J=d,L=A=e,J;if(A)if(J++,
J>ka&&A===L)J=K-1,A=!1;else{if(J>ka&&A!==L)return-1}else if(J--,J<aa&&A===L)J=K+1,A=!0;else if(J<aa&&A!==L)return-1;return J}function a(a,b,d){if(a===b)return 0;var e=null;if("string"===typeof a){if(b||0!==a.toString().length){if(z.Convert.isNumber(b))return 1;if("bool"===typeof b)return 2;if("string"===typeof b)return b=d?a.toString().localeCompare(b.toString()):a.toLowerCase().localeCompare(b.toLowerCase()),0===b?0:0<b?1:2;if(b instanceof Date){e=G.UI._DateTimeHelper._parseDate(a);if(!isNaN(e)){if(e===
b)return 0;if(!(e>b))return 2}return 1}return-1}return 0}if("string"===typeof b){if(a||0!==b.toString().length){if(z.Convert.isNumber(a))return 2;if("bool"===typeof a)return 1;if(a instanceof Date){e=G.UI._DateTimeHelper._parseDate(a);if(!isNaN(e)){if(e===b)return 0;if(e>b)return 1}return 2}return-1}return 0}if("bool"===typeof a&&z.Convert.isNumber(b))return 1;if("bool"===typeof b&&z.Convert.isNumber(a))return 2;a=z.Convert.toDouble(a);b=z.Convert.toDouble(b);return a===b?0:a<b?2:1}function d(a,b,
d){return(a=m(a,b,d))?a:0}function e(b,e,f,h){var l=-1,n,q=0,p=-1,r=-1;n=h?z._ArrayHelper.getRowCount(e):z._ArrayHelper.getColumnCount(e);n--;if(n<q)return-1;for(;q<=n;){var s=null,t;1<=f!==(2===l)&&(p=r);r=z.Convert.toInt((q+n)/2);t=r=g(q,n,r,0<=f,!0);var u=b;for(b instanceof z.Array?u=b.getValue(0,0):b instanceof z._SheetRangeReference?u=b.getValue(0,0,0,0):b instanceof z.Reference&&(u=b.getValue(0,0,0));!k(u,s)&&-1!==r;){s=h?m(e,0,r):m(e,r,0);if(k(u,s))break;r=g(0,0,0,!1,!1);0<=f&&r<t?n=r:0>f&&
r>t&&(q=r)}if(-1===r&&1<=f!==(2===l))return p;if(-1===r)return-1;l=a(u,s,!1);if(1<=f&&1===l)q=r+1;else if(1<=f&&2===l)n=r-1;else if(-1>=f&&1===l)n=r-1;else if(-1>=f&&2===l)q=r+1;else if(0===l){for(;-1>=f&&r>q||0<=f&&r<n;){b=0;b=0<=f?r+1:r-1;s=h?d(e,0,b):d(e,b,0);if(!s)return-1;if(!k(u,s))break;l=a(u,s,!1);if(0!==l)break;r=b}return r}}return 1<=f!==(2===l)?r:p}function b(b,e,f,g){var h=null,l,n,m,q=-1;n=g?z._ArrayHelper.getRowCount(e):z._ArrayHelper.getColumnCount(e);for(m=0;m<n;m++){var p;p=g?d(e,
0,m):d(e,m,0);if(!p)return-1;l=b;b instanceof z.Array?l=b.getValue(0,0):b instanceof z.Reference&&(l=b.getValue(0,0,0));if(k(l,p))if(l=a(l,p,!1),1<=f&&1===l){if(l=-1,0<=q&&(l=a(p,h,!1)),0>q||0<=q&&1===l)q=m,h=p}else if(-1>=f&&2===l){if(l=-1,0<=q&&(l=a(p,h,!1)),0>q||0<=q&&2===l)q=m,h=p}else if(0===l)return m}return q}function f(a){return!0}function s(a){return 0!==a}function q(a){return 1===a}function t(a){return 3===a}function r(a){return 0===a}function u(){return!0}function n(a){if(!a)throw"Invalid arguments";
if(1>a.length||1<a.length)throw"Invalid arguments";}function h(a,b,d,e,f,g){this._source=a;this._ranges=[new G.UI.Range(b,d,e,f)];this._row=b;this._column=d;this._rowCount=e;this._columnCount=f;this._type=g}function I(a){this._array=a}function E(a){var f=a[1],g=z.Convert.toInt(a[2]),h=z._Helper._argumentExists(a,3)?z.Convert.toBool(a[3]):!0,k=-1;if(0>=g)return z.Errors.Value;if(g>z._ArrayHelper.getRowCount(f))return z.Errors.Reference;k=h?e(a[0],a[1],1,!1):b(a[0],a[1],0,!1);return 0<=k?d(a[1],k,g-
1):z.Errors.NotAvailable}function O(a){var f=a[1],g=z.Convert.toInt(a[2]),h=z._Helper._argumentExists(a,3)?z.Convert.toBool(a[3]):!0,k=-1;if(0>=g)return z.Errors.Value;if(g>z._ArrayHelper.getColumnCount(f))return z.Errors.Reference;k=h?e(a[0],a[1],1,!0):b(a[0],a[1],0,!0);return 0<=k?d(a[1],g-1,k):z.Errors.NotAvailable}function H(b,d){for(var e=z._ArrayHelper.getLength(b),f=0;f<e;f++)if(0<f){var g=z._ArrayHelper.getValue(b,f-1),h=z._ArrayHelper.getValue(b,f);if(2===a(g,h,!1)&&!d)return!1}return!0}
function C(a,b,d,e){a.append(b);e?0!==d&&(a.append("["),a.append(d.toString()),a.append("]")):a.append(d)}var G=p.GrapeCity;"undefined"===typeof G&&(p.GrapeCity=G={});"undefined"===typeof G.Calc&&(G.Calc={});var z=G.Calc;"undefined"===typeof z.Functions&&(z.Functions={});var S=z.Functions;S._builtInFunctions=S._builtInFunctions||{};"undefined"===typeof S._defineBuildInFunction&&(S._defineBuildInFunction=function(a,b,d){if(!a)throw"Invalid function name";var e,f;a=a.toUpperCase();if(S._builtInFunctions.hasOwnProperty(a))if(e=
S._builtInFunctions[a],!e)S._builtInFunctions[a]=new S.Function(a,0,255),e=S[a.toUpperCase()];else{if(!d||!d.override)throw"Attempt to override function while override is not allowed";}else e=new S.Function(a,0,255),S._builtInFunctions[a]=e;b&&"function"===typeof b&&(e.evaluate=b);if(d)for(f in d)d.hasOwnProperty(f)&&"override"!==f&&(e[f]=d[f]);return e});var Q=S._defineBuildInFunction,aa,ka,J,K,A,L;h.prototype=new z._ConcreteReference;h.prototype.type=function(){return this._type};h.prototype.getValue=
function(a,b,d){switch(this._type){case 0:return this.getRow(0)+1+b;case 1:return this.getColumn(0)+1+d;default:return this.getActualValue(a,b,d)}};I.prototype=new z.Array;I.prototype.rowCount=function(){return z._ArrayHelper.getColumnCount(this._array)};I.prototype.columnCount=function(){return z._ArrayHelper.getRowCount(this._array)};I.prototype.getValue=function(a,b){return z._ArrayHelper.getValue(this._array,b,a)};Q("ADDRESS",function(a){var b=z.Convert.toInt(a[0]),d=z.Convert.toInt(a[1]),e=z._Helper._argumentExists(a,
2)?z.Convert.toInt(a[2]):1,f=z._Helper._argumentExists(a,3)?z.Convert.toBool(a[3]):!0,g=z._Helper._argumentExists(a,4)?z.Convert.toString(a[4]):"";a=3===e||4===e||7===e||8===e;var h=2===e||4===e||6===e||8===e,k=new G.UI._StringBuilder;if(1>b&&(f||!a)||b>z.Parser.maxRowCount||1>d&&(f||!h)||d>z.Parser.maxColumnCount||1>e||8<e)return z.Errors.Value;if(g&&0<g.length){for(var e=!G.Calc.Parser._isLetter(g[0])&&"_"!==g[0],l=1;!e&&l<g.length;l++)e=!G.Calc.Parser._isLetterOrDigit(g[l])&&"_"!==g[l];e?(k.append("'"),
k.append(g.replace("'","''")),k.append("'")):k.append(g);k.append("!")}if(f){h||k.append("$");for(f=k.toString().length;0.1<d;d=(d-1)/26)k.insert(String.fromCharCode(65+(d-1)%26),f);a||k.append("$");k.append(b)}else C(k,"R",b,a),C(k,"C",d,h);return k.toString()},{minArgs:2,maxArgs:5,acceptsMissingArgument:function(a){return 2===a||3===a||4===a}});Q("INDEX",function(a){var b=a[0],d=z._ArrayHelper.getRowCount(b),e=z._ArrayHelper.getColumnCount(b);if(2===a.length){var f=z._Helper._argumentExists(a,1)?
z.Convert.toInt(a[1]):0;return 1!==d&&1!==e?z.Errors.Reference:0>f?z.Errors.Value:d*e<f?z.Errors.Reference:0===f?new z._SliceArray(b,0,0,d,e):z._ArrayHelper.getValue(b,f-1)}var f=z._Helper._argumentExists(a,1)?z.Convert.toInt(a[1]):0,g=z._Helper._argumentExists(a,2)?z.Convert.toInt(a[2]):0;a=z._Helper._argumentExists(a,3)?z.Convert.toInt(a[3]):1;return 0>f||0>g||1>a?z.Errors.Value:d<f||e<g||1<a?z.Errors.Reference:0===f&&0===g?new z._SliceArray(b,0,0,d,e):0===f?new z._SliceArray(b,0,g-1,d,1):0===g?
new z._SliceArray(b,f-1,0,1,e):z._ArrayHelper.getValue(b,f-1,g-1)},{minArgs:2,maxArgs:4,acceptsReference:r,acceptsArray:r,acceptsMissingArgument:function(a){return 1===a||2===a||3===a}});Q("OFFSET",function(a){var b=a[0];if(!b||1!==b.getRangeCount())return z.Errors.Value;var d=z.Convert.toInt(a[1]),e=z.Convert.toInt(a[2]),f=z._Helper._argumentExists(a,3)?z.Convert.toInt(a[3]):b.getRowCount(0);a=z._Helper._argumentExists(a,4)?z.Convert.toInt(a[4]):b.getColumnCount(0);var g=b.getSource(),d=b.getRow(0)+
d,b=b.getColumn(0)+e;return 0>=f||0>=a||d<g.getRow(0)||g.getRow(0)+g.getRowCount(0)<d+f||b<g.getColumn(0)||g.getColumn(0)+g.getColumnCount(0)<b+a?z.Errors.Reference:new z._ConcreteReference(g,[{row:d,column:b,rowCount:f,columnCount:a}])},{minArgs:3,maxArgs:5,acceptsMissingArgument:function(a){return 3===a||4===a},acceptsReference:r,acceptsArray:r,isVolatile:function(){return!0}});Q("ROW",function(a,b){n([a]);if(!b)return z.Errors.value;var d=b.arrayFormulaMode,e=z._Helper._argumentExists(a,0)?a[0]:
b.getReference(b.source,b.row,b.column,b.rowCount,b.columnCount);return e&&1===e.getRangeCount()?d?new h(e.getSource(),e.getRow(0),e.getColumn(0),e.getRowCount(0),e.getColumnCount(0),0):e.getRow(0)+1:z.Errors.value},{minArgs:0,maxArgs:1,acceptsReference:f,isContextSensitive:u});Q("COLUMN",function(a,b){n([a]);if(!b)return z.Errors.value;var d=b.arrayFormulaMode,e=z._Helper._argumentExists(a,0)?a[0]:b.getReference(b.source,b.row,b.column,b.rowCount,b.columnCount);return e&&1===e.getRangeCount()?d?
new h(e.getSource(),e.getRow(0),e.getColumn(0),e.getRowCount(0),e.getColumnCount(0),1):e.getColumn(0)+1:z.Errors.value},{minArgs:0,maxArgs:1,acceptsMissingArgument:r,acceptsReference:f,isContextSensitive:u});Q("ROWS",function(a){n([a]);return z._ArrayHelper.getRowCount(a[0])},{minArgs:1,maxArgs:1,acceptsReference:f,acceptsArray:f});Q("COLUMNS",function(a){n([a]);return z._ArrayHelper.getColumnCount(a[0])},{minArgs:1,maxArgs:1,acceptsReference:f,acceptsArray:f});Q("TRANSPOSE",function(a){n([a]);return new I(a[0])},
{minArgs:1,maxArgs:1,acceptsReference:f,acceptsArray:f});Q("LOOKUP",function(a){var b=-1,f,g=z._ArrayHelper.getColumnCount(a[1]),h=z._ArrayHelper.getRowCount(a[1]);if(2<a.length)f=a[2];else return f=null,f=g>h?E([a[0],a[1],h]):O([a[0],a[1],g]),f instanceof z.Error?z.Errors.NotAvailable:f;if(f){var b=z._ArrayHelper.getColumnCount(f),k=z._ArrayHelper.getRowCount(f);if(1<b&&1<k)return z.Errors.NotAvailable}else f=a[1];b=e(a[0],a[1],1,g>h?!1:!0);return 0<=b?(a=null,g=z._ArrayHelper.getColumnCount(f),
h=z._ArrayHelper.getRowCount(f),a=g>h?d(f,b,h-1):d(f,g-1,b)):z.Errors.NotAvailable},{minArgs:2,maxArgs:3,acceptsArray:s,acceptsReference:s});Q("HLOOKUP",E,{minArgs:3,maxArgs:4,acceptsMissingArgument:t,acceptsArray:q,acceptsReference:q});Q("VLOOKUP",O,{minArgs:3,maxArgs:4,acceptsMissingArgument:t,acceptsArray:q,acceptsReference:q});Q("CHOOSE",function(a){var b=z.Convert.toInt(a[0]);return 1>b||a.length<=b?z.Errors.Value:a[b]?a[b]:0},{minArgs:2,maxArgs:255,acceptsError:function(a){return 1<=a},isBranch:function(){return!0},
findTestArgument:function(){return 0},findBranchArgument:function(a){if(G.Calc.Convert.isError(a))return-1;try{return G.Calc.Convert.toInt(a)}catch(b){}return-1}});Q("MATCH",function(a){var d=z._ArrayHelper.getColumnCount(a[1]),f=z._ArrayHelper.getRowCount(a[1]),g=z._Helper._argumentExists(a,2)?z.Convert.toInt(a[2]):1;if(1<d&&1<f||1===g&&!H(a[1],!0)||-1===g&&!H(a[1],!1))return z.Errors.NotAvailable;d=-1;1===g?d=e(a[0],a[1],1,1<f):0===g?d=b(a[0],a[1],0,1<f):-1===g&&(d=e(a[0],a[1],-1,1<f));return-1===
d?z.Errors.NotAvailable:d+1},{minArgs:2,maxArgs:3,acceptsMissingArgument:function(a){return 2===a},acceptsReference:q,acceptsArray:q})})(window,jQuery);
(function(p){function l(a){return!0}function m(a){return 0<a}function k(a){return 1===a}function g(a){return 1===a||2===a||3===a}function a(a){return 2===a}function d(a){return 0===a||2===a}function e(a){return 0===a||1===a}function b(a){return 0===a||1===a%2}function f(a){return 0===a}function s(a){return 0===a||1===a||2===a}function q(a){return 0===a%2}function t(a){return 3!==a}function r(a){return 3===a||4===a}function u(a,b){for(var d=!1,e=0,f=x.Convert,g=x._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];
if(g.isArrayOrReference(a[h]))for(var k=0;k<g.getLength(a[h]);k++){if(b||!g.isSubtotalByIndex(a[h],k)){var l=g.getValueByIndex(a[h],k);if(f.isNumber(l)){l=f.toDouble(l);if(!d||l>e)e=l;d=!0}else if(f.isError(l))return l}}else{k=f.toDouble(a[h]);if(isNaN(k))return x.Errors.Value;if(!d||k>e)e=k;d=!0}}return e}function n(a,b){for(var d=!1,e=0,f,g=x.Convert,h=x._ArrayHelper,k=0;k<a.length;k++){if(g.isError(a[k]))return a[k];if(h.isArrayOrReference(a[k]))for(var l=0;l<h.getLength(a[k]);l++){if(b||!h.isSubtotalByIndex(a[k],
l))if(f=h.getValueByIndex(a[k],l),g.isNumber(f)){f=g.toDouble(f);if(!d||f<e)e=f;d=!0}else if(g.isError(f))return f}else{if(isNaN(f=g.toDouble(a[k])))return x.Errors.Value;if(!d||f<e)e=f;d=!0}}return e}function h(a,b){for(var d=0,e=0,f=x.Convert,g=x._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];if(g.isArrayOrReference(a[h]))for(var k=0;k<g.getRangeCount(a[h]);k++)for(var l=0;l<g.getLength(a[h],k);l++){if(b||!g.isSubtotal(a[h],l,k)){var n=g.getValueByIndex(a[h],l,k);if(f.isNumber(n))d+=
f.toDouble(n),e++;else if(f.isError(n))return n}}else{if(isNaN(k=f.toDouble(a[h])))return x.Errors.Value;d+=k;e++}}return 0===e?x.Errors.DivideByZero:f.toResult(d/e)}function I(a,b,d){var e=0,f=0;b=qa._MathHelper.parseCriteria(b);var g=x.Convert,h=x._ArrayHelper;if(h.getRowCount(a)!==h.getRowCount(d)||h.getColumnCount(a)!==h.getColumnCount(d))return x.Errors.Value;for(var k=0;k<h.getLength(a);k++){var l=h.getValueByIndex(a,k);if(b&&b(l))if(l=h.getValueByIndex(d,k),g.isNumber(l))e+=g.toDouble(l),f++;
else if(g.isError(l))return l}return 0===f?x.Errors.DivideByZero:g.toResult(e/f)}function E(a){var b,d=x.Convert,e=x._ArrayHelper;if(isNaN(b=d.toDouble(a[1])))return x.Errors.Value;var f=[],g;if(d.isError(a[0]))return a[0];if(e.isArrayOrReference(a[0]))for(var h=0;h<e.getLength(a[0]);h++)if(g=e.getValueByIndex(a[0],h),d.isNumber(g))g=d.toDouble(g),f.push(g);else{if(d.isError(g))return g}else{if(isNaN(g=d.toDouble(a[0])))return x.Errors.Value;f.push(g)}f.sort(function(a,b){return a-b});if(0===f.length||
0>b||1<b)return x.Errors.Number;a=b*(f.length-1);b=a%1;a=parseInt(a,10);return 0===b?f[a]:d.toDouble(f[a])+b*(d.toDouble(f[a+1])-d.toDouble(f[a]))}function O(a,b){for(var d=0,e=x.Convert,f,g,h,k,l=0;l<a.length;l++)if(e._isCalcArray(a[l]))for(g=a[l].getColumnCount(),f=a[l].getRowCount(),k=0;k<g;k++)for(h=0;h<f;h++)e.isNumber(a[l].getValue(h,k))&&d++;else if(e._isCalcReference(a[l]))for(var n=a[l].getRangeCount(),m=0;m<n;m++)for(g=a[l].getColumnCount(m),k=0;k<g;k++)for(f=a[l].getRowCount(m),h=0;h<f;h++){var q;
if(a[l]instanceof x._SheetRangeReference)for(var p=0;p<a[l].getSheetCount();p++){if(b||!a[l].isSubtotal(p,m,h,k))q=a[l].getValue(p,m,h,k)}else if(b||!a[l].isSubtotal(m,h,k))q=a[l].getValue(m,h,k);e.isNumber(q)&&d++}else e.isNumber(a[l])&&d++;return e.toResult(d)}function H(a,b){for(var d=0,e=x.Convert,f=x._ArrayHelper,g=0;g<a.length;g++)if(f.isArrayOrReference(a[g]))for(var h=0;h<f.getRangeCount(a[g]);h++)for(var k=0;k<f.getLength(a[g],h);k++){if(b||!f.isSubtotal(a[g],k,h)){var l=f.getValue(a[g],
k,h);void 0!==l&&null!==l&&d++}}else void 0!==a[g]&&null!==a[g]&&d++;return e.toResult(d)}function C(a,b){for(var d=0,e=qa._MathHelper.parseCriteria(b),f=x.Convert,g=x._ArrayHelper,h=0;h<g.getRangeCount(a);h++)for(var k=0;k<g.getLength(a,h);k++){var l=g.getValue(a,k,h);e&&e(l)&&d++}return f.toResult(d)}function G(a,b,d){for(var e=x.Convert,f=x._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g]))for(var h=0;h<f.getLength(a[g]);h++){if(d||!f.isSubtotalByIndex(a[g],
h)){var k=f.getValueByIndex(a[g],h);if(e.isNumber(k))k=e.toDouble(k),b.sumx+=k,b.sumx2+=k*k,b.n++;else if(e.isError(k))return k}}else{if(isNaN(h=e.toDouble(a[g])))return x.Errors.Value;b.sumx+=h;b.sumx2+=h*h;b.n++}}}function z(a,b){for(var d=x.Convert,e=x._ArrayHelper,f,g=0;g<a.length;g++){if(d.isError(a[g]))return a[g];if(e.isArrayOrReference(a[g]))for(var h=0;h<e.getLength(a[g]);h++)if(f=e.getValueByIndex(a[g],h),d.isNumber(f)||typeof f===X)f=d.toDouble(f),b.sumx+=f,b.sumx2+=f*f,b.n++;else if(typeof f===
na)f=0,b.sumx+=f,b.sumx2+=f*f,b.n++;else{if(d.isError(f))return f}else{if(isNaN(f=d.toDouble(a[g])))return x.Errors.Value;b.sumx+=f;b.sumx2+=f*f;b.n++}}}function S(a,b){var d={sumx:0,sumx2:0,n:0},e=G(a,d,b),f=x.Convert;return f.isError(e)?e:1>=d.n?x.Errors.DivideByZero:f.toResult(Math.sqrt(Math.max(0,(d.n*d.sumx2-d.sumx*d.sumx)/(d.n*(d.n-1)))))}function Q(a,b){var d={sumx:0,sumx2:0,n:0},e=G(a,d,b),f=x.Convert;return f.isError(e)?e:0>=d.n?x.Errors.DivideByZero:f.toResult(Math.sqrt(Math.max(0,(d.n*
d.sumx2-d.sumx*d.sumx)/(d.n*d.n))))}function aa(a,b){var d={sumx:0,sumx2:0,n:0},e=G(a,d,b),f=x.Convert;return f.isError(e)?e:1>=d.n?x.Errors.DivideByZero:f.toResult(Math.max(0,(d.n*d.sumx2-d.sumx*d.sumx)/(d.n*(d.n-1))))}function ka(a,b){var d={sumx:0,sumx2:0,n:0},e=G(a,d,b),f=x.Convert;return f.isError(e)?e:0>=d.n?x.Errors.DivideByZero:f.toResult(Math.max(0,(d.n*d.sumx2-d.sumx*d.sumx)/(d.n*d.n)))}function J(a){if(isNaN(a=x.Convert.toDouble(a[0])))return x.Errors.Value;var b,d;0===a?b=0:(b=0.5*Math.abs(a),
3<=b?b=1:1>b?(d=b*b,b*=2*((((((((1.24818987E-4*d-0.001075204047)*d+0.005198775019)*d-0.019198292004)*d+0.059054035642)*d-0.151968751364)*d+0.319152932694)*d-0.5319230073)*d+0.797884560593)):(b-=2,b=(((((((((((((-4.5255659E-5*b+1.5252929E-4)*b-1.9538132E-5)*b-6.76904986E-4)*b+0.001390604284)*b-7.9462082E-4)*b-0.002034254874)*b+0.006549791214)*b-0.010557625006)*b+0.011630447319)*b-0.009279453341)*b+0.005353579108)*b-0.002141268741)*b+5.35310849E-4)*b+0.999936657524));return 0<a?0.5*(b+1):0.5*(1-b)}
function K(a){var b,d,e,f=x.Convert;return isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2]))||isNaN(a=f.toBool(a[3]))?x.Errors.Value:0>=e?x.Errors.Number:a?(f=[],f[0]=(b-d)/e,J(f)):f.toResult(Math.exp(-((b-d)*(b-d))/(2*e*e))/(Math.sqrt(2*Math.PI)*e))}function A(a){var b,d,e,f=x.Convert;if(isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return x.Errors.Value;var g,h;if(0>b||1<b||0>=e)return x.Errors.Number;g=b-0.5;if(0.42>=Math.abs(g))h=
g*g,a=g*(((-25.44106049637*h+41.39119773534)*h-18.61500062529)*h+2.50662823884)/((((3.13082909833*h-21.06224101826)*h+23.08336743743)*h+-8.4735109309)*h+1);else if(h=b,0<g&&(h=1-b),2.220446049250313E-16<h)h=Math.sqrt(-Math.log(h)),a=(((2.32121276858*h+4.85014127135)*h-2.29796479134)*h-2.78718931138)/((1.63706781897*h+3.54388924762)*h+1),0>g&&(a=-a);else return 1E-300<h?(a=-2*Math.log(b),h=Math.log(6.283185307179586*a),a=Math.sqrt(a*(1-(h/a+(2-h)/(a*a)+(-14+6*h-h*h)/(2*a*a*a)))),0>g&&(a=-a),a):0>g?
-1.79769E308:1.79769E308;g=(a-0)/1;g=0.3989422804014327*Math.exp(-0.5*g*g)/1;h=K([a,0,1,!0]);return f.isError(h)?h:d+e*(a-(h-b)/g)}function L(a){var b;return isNaN(b=x.Convert.toDouble(a[0]))?x.Errors.Value:0>b||1<b?x.Errors.Number:A([b,0,1])}function D(a){var b,d;b=a+5.5;b-=(a+0.5)*Math.log(b);d=1.000000000190015+76.18009172947146/(a+1)-86.50532032941678/(a+2);d+=24.01409824083091/(a+3);d-=1.231739572450155/(a+4);d+=0.001208650973866179/(a+5);d-=5.395239384953E-6/(a+6);return Math.log(2.506628274631001*
d/a)-b}function w(a,b,d){var e,f,g,h,k,l,n,m,q;n=a+b;q=a+1;m=a-1;k=1;l=1-n*d/q;1E-50>Math.abs(l)&&(l=1E-50);g=l=1/l;for(e=1;300>=e&&!(f=e+e,h=(b-e)*e*d/((m+f)*(a+f)),l=1+h*l,1E-50>Math.abs(l)&&(l=1E-50),k=1+h/k,1E-50>Math.abs(k)&&(k=1E-50),l=1/l,g=g*l*k,h=0-(a+e)*(n+e)*d/((a+f)*(q+f)),l=1+h*l,1E-50>Math.abs(l)&&(l=1E-50),k=1+h/k,1E-50>Math.abs(k)&&(k=1E-50),l=1/l,f=l*k,g*=f,1E-20>Math.abs(f-1));e++);return g}function M(a){for(var b=x.Convert,d=x._Helper,e=0;e<a.length;e++)if(b.isError(a[e]))return a[e];
var f,g;if(isNaN(e=b.toDouble(a[0]))||isNaN(f=b.toDouble(a[1]))||isNaN(g=b.toDouble(a[2])))return x.Errors.Value;var h=0;if(d._argumentExists(a,3)&&isNaN(h=b.toDouble(a[3])))return x.Errors.Value;var k=1;if(d._argumentExists(a,4)&&isNaN(k=b.toDouble(a[4])))return x.Errors.Value;if(0>=f||0>=g||e<h||k<e||h===k)return x.Errors.Number;a=(e-h)/(k-h);var d=D(f+g),e=D(f),h=D(g),k=Math.log(a),l=Math.log(1-a),d=Math.exp(d-e-h+f*k+g*l);f=a<(f+1)/(f+g+2)?d*w(g,f,1-a)/g:1-d*w(g,f,1-a)/g;return b.toResult(f)}
function T(a){var b=[2];switch(a){case 1:return 2.2250738585072014E-308;case 2:return 1.7976931348623157E308;case 3:return Math.pow(2,-53);case 4:return Math.pow(2,-52);case 5:return qa._MathHelper.log10(b);default:return 0}}function P(a,b,d){var e,f,g;if(1>b)return 0;e=g=0;var h=x.Convert;for(f=1;f<=b&&!(e=b-f,g+=Math.abs(h.toDouble(a[e])),g>d);f++);return e}function ia(a,b,d){var e,f,g,h;if(1>d||1E3<d||-1.1>a||1.1<a)return 0/0;g=2*a;a=f=e=0;var k=x.Convert;for(h=1;h<=d;h++)f=e,e=a,a=g*e-f+k.toDouble(b[d-
h]);return 0.5*(a-f)}function v(a){var b=[0.16663894804518634,-1.384948176067564E-5,9.81082564692473E-9,-1.809129475572494E-11,6.221098041892606E-14,-3.399615005417722E-16,2.683181998482699E-18,-2.868042435334643E-20,3.9628370610464347E-22,-6.831888753985767E-24,1.4292273559424982E-25,-3.5475981581010704E-27,1.025680058010471E-28,-3.401102254316749E-30,1.276642195630063E-31],d=0,e=0,f=0;0===d&&(d=P(b,15,T(3)),e=1/Math.sqrt(T(3)),f=Math.exp(Math.min(Math.log(T(2)/12),-Math.log(12*T(1)))));return 10>
a?0/0:a>=f?4.930380657631324E-32:a<e?(e=10/a,ia(2*e*e-1,b,d)/a):1/(12*a)}function V(a){var b=[1.037869356274377,-0.13364301504908918,0.019408249135520562,-0.0030107551127535777,4.869461479715485E-4,-8.105488189317536E-5,1.3778847799559525E-5,-2.380221089435897E-6,4.1640416213865184E-7,-7.359582837807599E-8,1.3117611876241675E-8,-2.3546709317742423E-9,4.2522773276035E-10,-7.71908941348408E-11,1.407574648135907E-11,-2.5769072058024682E-12,4.734240666629442E-13,-8.724901267474264E-14,1.612461490274055E-14,
-2.9875652015665774E-15,5.548070120908289E-16,-1.0324619158271569E-16,1.9250239203049852E-17,-3.595507346526515E-18,6.726454253787686E-19,-1.260262416873522E-19,2.364488440860621E-20,-4.4419377050807936E-21,8.354659446403425E-22,-1.5731559416479563E-22,2.9653128740247425E-23,-5.594958348181595E-24,1.056635426883568E-24,-1.9972483680670205E-25,3.778297781883936E-26,-7.153158688908174E-27,1.3552488463674214E-27,-2.5694673048487566E-28,4.8747756066216946E-29,-9.254211253084972E-30,1.757859784176024E-30,
-3.341002667773101E-31,6.353393618023618E-32],d=0;0===d&&(d=P(b,43,0.1*T(3)),Math.sqrt(T(4)));return-1>=a?0/0:0.375>=Math.abs(a)?a*(1-a*ia(a/0.375,b,d)):Math.log(a+1)}function N(a){var b,d,e,f;b=1;var g=[1,0.5772156649015329,-0.6558780715202538,-0.0420026350340952,0.1665386113822915,-0.0421977345555443,-0.009621971527877,0.007218943246663,-0.0011651675918591,-2.152416741149E-4,1.280502823882E-4,-2.01348547807E-5,-1.2504934821E-6,1.133027232E-6,-2.056338417E-7,6.116095E-9,5.0020075E-9,-1.1812746E-9,
1.043427E-10,7.7823E-12,-3.6968E-12,5.1E-13,-2.06E-14,-5.4E-15,1.4E-15];if(171<a)return 1E308;d=x.Convert;if(a===d.toInt(a))if(0<a)for(f=1,b=2;b<a;b++)f*=b;else f=1E308;else{if(1<Math.abs(a)){f=Math.abs(a);e=d.toInt(f);for(d=b=1;d<=e;d++)b*=f-d;f-=e}else f=a;e=g[24];for(d=23;0<=d;d--)e=e*f+g[d];f=1/(e*f);1<Math.abs(a)&&(f*=b,0>a&&(f=-Math.PI/(a*f*Math.sin(Math.PI*a))))}return f}function R(a){if(isNaN(a=x.Convert.toDouble(a[0])))return x.Errors.Value;if(0>=a)return x.Errors.Number;var b,d,e,f,g,h,
k=0;f=[0.08333333333333333,-0.002777777777777778,7.936507936507937E-4,-5.952380952380952E-4,8.417508417508418E-4,-0.001917526917526918,0.00641025641025641,-0.02955065359477124,0.1796443723688307,-1.3924322169059];b=a;h=x.Convert;if(0>=a)a=1E308;else if(1===a||2===a)a=0;else{7>=a&&(k=h.toInt(7-a),b=a+k);d=1/(b*b);e=2*Math.PI;g=f[9];for(h=8;0<=h;h--)g=g*d+f[h];f=g/b+0.5*Math.log(e)+(b-0.5)*Math.log(b)-b;if(7>=a)for(h=1;h<=k;h++)f-=Math.log(b-1),b-=1;a=f}return a}function ga(a,b){var d,e,f;e=f=a;b<e&&
(e=b);b>f&&(f=b);if(0>e)return 0/0;if(0===e)return 1.79769E308;if(10<=e)return d=v(e)+v(f)-v(e+f),-0.5*Math.log(f)+0.9189385332046728+d+(e-0.5)*Math.log(e/(e+f))+f*V(-e/(e+f));if(10<=f){d=v(f)-v(e+f);var g=[];g[0]=e;var g=R(g),h=x.Convert;return h.isError(g)?0/0:h.toDouble(g)+d+e-e*Math.log(e+f)+(f-0.5)*V(-e/(e+f))}d=N(e);g=N(f);e=N(e+f);return Math.log(d*(g/e))}function ba(a){for(var b=x.Convert,d=x._Helper,e=0;e<a.length;e++)if(b.isError(a[e]))return a[e];var f,g,h;if(isNaN(f=b.toDouble(a[0]))||
isNaN(g=b.toDouble(a[1]))||isNaN(h=b.toDouble(a[2])))return x.Errors.Value;e=0;if(d._argumentExists(a,3)&&isNaN(e=b.toDouble(a[3])))return x.Errors.Value;var k=1;if(d._argumentExists(a,4)&&isNaN(k=b.toDouble(a[4])))return x.Errors.Value;if(0>=f||1<=f||0>=g||0>=h)return x.Errors.Number;var l=1-2.22E-16,n,m,q,p,r,s,t,u,v,w;if(0>g||0>h||0>f||1<f)return 0/0;if(0===f||1===f)return f;a=ga(g,h);0.5>=f?(d=g,g=0):(f=1-f,d=h,h=g,g=1);r=Math.sqrt(-Math.log(f*f));v=r-(2.30753+0.27061*r)/(1+(0.99229+0.04481*r)*
r);1<d&&1<h?(r=(v*v-3)/6,s=1/(d+d-1),t=1/(h+h-1),m=2/(s+t),r=v*Math.sqrt(m+r)/m-(t-s)*(r+5/6-2/(3*m)),s=d/(d+h*Math.exp(r+r))):(r=h+h,t=1/(9*h),t=r*Math.pow(1-t+v*Math.sqrt(t),3),0>=t?s=1-Math.exp((Math.log((1-f)*h)+a)/h):(t=(4*d+r-2)/t,s=1>=t?Math.exp((Math.log(f*d)+a)/d):1-2/(t+1)));r=1-d;t=1-h;n=0;m=1;3E-308>s?s=3E-308:s>l&&(s=l);w=Math.max(1E-300,Math.pow(10,-13-2.5/(d*d)-0.5/(f*f)));for(l=u=p=0;1E3>l;l++){v=s;q=d;var A=h,z=void 0,C=void 0,E=void 0,D=void 0,G=void 0,H=void 0,I=void 0,J=void 0,
K=J=void 0,L=void 0,M=void 0,N=void 0,G=void 0,O=0,P=K=0,C=0;0===O&&(O=T(3),K=Math.log(O),P=T(1),C=Math.log(P));L=v;D=q;I=A;D/(D+I)<v&&(L=1-L,D=A,I=q);if((D+I)*L/(D+1)<O){if(z=0,J=D*Math.log(Math.max(L,P))-Math.log(D)-ga(D,I),J>C&&0!==L&&(z=Math.exp(J)),L!==v||D!==q)z=1-z}else{G=I-Math.floor(I);0===G&&(G=1);J=D*Math.log(L)-ga(G,D)-Math.log(D);z=0;A=x.Convert;if(J>=C&&(z=Math.exp(J),J=z*D,1!==G))for(M=A.toInt(Math.max(K/Math.log(L),4)),N=1;N<=M;N++)K=N,J=J*(K-G)*L/K,z+=J/(D+K);if(1<I){J=D*Math.log(L)+
I*Math.log(1-L)-ga(D,I)-Math.log(I);G=A.toInt(Math.max(J/C,0));J=Math.exp(J-G*C);C=1/(1-L);H=I*C/(D+I-1);E=0;M=A.toInt(I);I===M&&(M-=1);for(N=1;N<=M&&!(1>=H&&J/O<=E);N++)K=N,J=(I-K+1)*C*J/(D+I-K),1<J&&(G-=1,J*=P),0===G&&(E+=J);z+=E}if(L!==v||D!==q)z=1-z;z=Math.max(Math.min(z,1),0)}v=z;v=(v-f)*Math.exp(a+r*Math.log(s)+t*Math.log(1-s));0>=v*n&&(p=Math.max(Math.abs(m),3E-308));q=1;for(n=0;1E3>n;n++){m=q*v;if(Math.abs(m)<p&&(u=s-m,0<=u&&1>=u)){if(p<=w||Math.abs(v)<=w)return 0!==g&&(s=1-s),b.toResult((k-
e)*s+e);if(0!==u&&1!==u)break}q/=3}if(u===s)return 0!==g&&(s=1-s),b.toResult((k-e)*s+e);s=u;n=v}0!==g&&(s=1-s);return b.toResult((k-e)*s+e)}function W(a){for(var b=x.Convert,d=0;d<a.length;d++)if(b.isError(a[d]))return a[d];var e;if(isNaN(d=b.toDouble(a[0]))||isNaN(e=b.toDouble(a[1])))return x.Errors.Value;if(0>d||1>e||e>Math.pow(10,10))return x.Errors.Number;var f=Math.log(Math.sqrt(Math.PI)),g=1/Math.sqrt(Math.PI);a=0;var h=d,d=0.5*h,k=0===e%2;1<e&&(a=Math.exp(-d));var l=[];l[0]=-Math.sqrt(h);h=
J(l);if(b.isError(h))return h;b=b.toDouble(h);b=k?a:2*b;if(2<e){h=0.5*(e-1);e=k?1:0.5;if(20<d){f=k?0:f;for(g=Math.log(d);e<=h;)f=Math.log(e)+f,b+=Math.exp(g*e-d-f),e+=1;return b}f=k?1:g/Math.sqrt(d);for(g=0;e<=h;)f*=d/e,g+=f,e+=1;return g*a+b}return b}function ja(a){var b,d,e,f=x.Convert;if(isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2]))||isNaN(a=f.toBool(a[3])))return x.Errors.Value;if(0>b||0>=d||0>=e)return x.Errors.Number;if(!1===a){f=Math.pow(e,d);if(isNaN(f)||
!isFinite(f))return x.Errors.DivideByZero;f=1/(f*N(d));d=Math.pow(b,d-1);b=Math.exp(-(b/e));return f*d*b}var g,h,k,l,n,m;a=1/3;b/=e;if(0>=b)return x.Errors.Number;if(1E3<d)return d=3*Math.sqrt(d)*(Math.pow(b/d,a)+1/(9*d)-1),e=K([d,0,1,!0]),f.isError(e)?e:f.toDouble(e);if(1E8<b)return 1;if(1>=b||b<d){e=[];e[0]=d+1;e=R(e);if(f.isError(e))return e;f=d*Math.log(b)-b-f.toDouble(e);a=e=1;n=d;do n+=1,e=e*b/n,a+=e;while(2.220446049250313E-16<e);f+=Math.log(a);a=0;-88<=f&&(a=Math.exp(f))}else{e=[];e[0]=d;
e=R(e);if(f.isError(e))return e;f=d*Math.log(b)-b-f.toDouble(e);n=1-d;m=n+b+1;e=0;d=1;g=b;h=b+1;b*=m;for(a=h/b;;){n+=1;m+=2;e+=1;l=n*e;k=m*h-l*d;l=m*b-l*g;if(0<Math.abs(l)){d=k/l;if(Math.abs(a-d)<=Math.min(2.220446049250313E-16,2.220446049250313E-16*d))break;a=d}d=h;g=b;h=k;b=l;1E37<=Math.abs(k)&&(d/=1E37,g/=1E37,h/=1E37,b/=1E37)}f+=Math.log(a);a=1;-88<=f&&(a=1-Math.exp(f))}return a}function fa(a){var b,d,e,f=x.Convert;if(isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return x.Errors.Value;
var g,h,k,l,n,m,q,p,r,s,t,u;if(0>b||1<b||0>=d||0>=e)return x.Errors.Number;if(2E-6>b)return 0;if(0.999998<b)return 1.79769E308;n=2*d;a=d-1;l=[];l[0]=d;t=R(l);if(f.isError(t))return t;l=f.toDouble(t);if(n<-1.24*Math.log(b)){if(k=Math.pow(b*d*Math.exp(l+0.6931471805599453*d),1/d),5E-7>k)return 0/0}else if(0.32<n){t=A([b,0,1]);if(f.isError(t))return t;k=f.toDouble(t);h=0.222222/n;k=n*Math.pow(k*Math.sqrt(h)+1-h,3);k>2.2*n+6&&(k=-2*(Math.log(1-b)-a*Math.log(0.5*k)+l))}else{k=0.4;g=Math.log(1-b)+l+0.6931471805599453*
a;do n=k,h=1+k*(4.67+k),m=k*(6.73+k*(6.66+k)),t=-0.5+(4.67+2*k)/h-(6.73+k*(13.32+3*k))/m,k-=(1-Math.exp(g+0.5*k)*m/h)/t;while(0.01<Math.abs(n/k-1))}for(u=1;20>=u;u++){n=k;h=0.5*k;t=ja([h,d,1,!0]);if(f.isError(t))return t;m=b-f.toDouble(t);t=m*Math.exp(0.6931471805599453*d+l+h-a*Math.log(k));h=t/k;g=0.5*t-h*a;m=(210+g*(140+g*(105+g*(84+g*(70+60*g)))))/420;q=(420+g*(735+g*(966+g*(1141+1278*g))))/2520;p=(210+g*(462+g*(707+932*g)))/2520;r=(252+g*(672+1182*g)+a*(294+g*(889+1740*g)))/5040;g=(84+2264*g+
a*(1175+606*g))/2520;s=(120+a*(346+127*a))/5040;k+=t*(1+0.5*t*m-h*a*(m-h*(q-h*(p-h*(r-h*(g-h*s))))));if(5E-7<Math.abs(n/k-1))break}return 0.5*e*k}function la(a){var b,d,e,f=x.Convert;if(isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return x.Errors.Value;if(0>b||1>d||d>=Math.pow(10,10)||1>e||e>=Math.pow(10,10))return x.Errors.Number;a=M([d*b/(d*b+e),0.5*d,0.5*e]);return f.isError(a)?a:1-f.toDouble(a)}function ra(a,b){var d,e,f,g=x.Convert,h=x._ArrayHelper;h.getLength(b);
for(var k=0;k<h.getLength(b);k++)d=h.getValueByIndex(b,k),g.isNumber(d)&&(d=g.toDouble(h.getValueByIndex(b,k)),e=d-a.M,f=e/(a.N+1),a.M+=f,a.Q+=a.N*e*f,a.N++,a.sum+=d)}function da(a){for(var b=1;1<a;a--)b*=a;return b}function oa(a,b){for(var d,e,f,g=x.Convert,h=x._ArrayHelper,k=h.getLength(b),l=0;l<k;l++)d=g.toDouble(h.getValueByIndex(b,l)),e=d-a.M,f=e/(a.N+1),a.M+=f,a.Q+=a.N*e*f,a.N++,a.sum+=d}function ha(a){for(var b=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,0.001208650973866179,
-5.395239384953E-6],d=a,e=a+5.5,e=e-(a+0.5)*Math.log(e),f=1.000000000190015,g=0;5>=g;g++)f+=b[g]/++d;return-e+Math.log(2.5066282746310007*f/a)}var X="boolean",na="string",ca=p.GrapeCity;"undefined"===typeof ca&&(ca=p.GrapeCity={});"undefined"===typeof ca.Calc&&(ca.Calc={});var x=ca.Calc;"undefined"===typeof x.Functions&&(x.Functions={});var qa=x.Functions;qa._builtInFunctions=qa._builtInFunctions||{};"undefined"===typeof qa._defineBuildInFunction&&(qa._defineBuildInFunction=function(a,b,d){if(void 0===
a||null===a)throw"Invalid function name";var e;a=a.toUpperCase();if(qa._builtInFunctions.hasOwnProperty(a))if(e=qa._builtInFunctions[a],!e)qa._builtInFunctions[a]=new qa.Function(a,0,255),e=qa[a.toUpperCase()];else{if(!d||!d.override)throw"Attempt to override function while override is not allowed";}else e=new qa.Function(a,0,255),qa._builtInFunctions[a]=e;b&&"function"===typeof b&&(e.evaluate=b);if(d)for(var f in d)d.hasOwnProperty(f)&&"override"!==f&&(e[f]=d[f]);return e});p=qa._defineBuildInFunction;
qa.StatHelper={normsdist:J,__averageIncludeSubtotals:h,__countIncludeSubtotals:O,__countaIncludeSubtotals:H,__maxIncludeSubtotals:u,__minIncludeSubtotals:n,__stdevIncludeSubtotals:S,__stdevpIncludeSubtotals:Q,__varrIncludeSubtotals:aa,__varpIncludeSubtotals:ka};p("MAX",function(a){return u(a,!0)},{minArgs:1,acceptsArray:l,acceptsReference:l});p("MAXA",function(a){for(var b=!1,d=0,e,f=x.Convert,g=x._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];if(g.isArrayOrReference(a[h]))for(var k=
0;k<g.getLength(a[h]);k++)if(e=g.getValueByIndex(a[h],k),f.isNumber(e)||typeof e===X){e=f.toDouble(e);if(!b||e>d)d=e;b=!0}else if(typeof e===na){e=0;if(!b||e>d)d=e;b=!0}else{if(f.isError(e))return e}else{if(isNaN(e=f.toDouble(a[h])))return x.Errors.Value;if(!b||e>d)d=e;b=!0}}return d},{minArgs:1,acceptsArray:l,acceptsReference:l});p("MIN",function(a){return n(a,!0)},{minArgs:1,acceptsArray:l,acceptsReference:l});p("MINA",function(a){for(var b=!1,d=0,e,f=x.Convert,g=x._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];
if(g.isArrayOrReference(a[h]))for(var k=0;k<g.getLength(a[h]);k++)if(e=g.getValueByIndex(a[h],k),f.isNumber(e)||typeof e===X){e=f.toDouble(e);if(!b||e<d)d=e;b=!0}else if(typeof e===na){e=0;if(!b||e<d)d=e;b=!0}else{if(f.isError(e))return e}else{if(isNaN(e=f.toDouble(a[h])))return x.Errors.Value;if(!b||e<d)d=e;b=!0}}return d},{minArgs:1,acceptsArray:l,acceptsReference:l});p("LARGE",function(a){var b=x.Convert,d=x._ArrayHelper;if(b.isError(a[0]))return a[0];if(b.isError(a[1]))return a[1];var e=b.toInt(a[1]),
f=[],g;if(d.isArrayOrReference(a[0]))for(var h=0;h<d.getLength(a[0]);h++)if(g=d.getValueByIndex(a[0],h),b.isNumber(g))g=b.toDouble(g),f.push(g);else{if(b.isError(g))return g}else{if(isNaN(g=b.toDouble(a[0])))return x.Errors.Value;f.push(g)}f.sort(function(a,b){return a-b});return 0>=e||f.length<e?x.Errors.Number:f[f.length-e]},{minArgs:2,maxArgs:2,acceptsArray:f,acceptsReference:f});p("SMALL",function(a){var b=x.Convert,d=x._ArrayHelper;if(b.isError(a[0]))return a[0];if(b.isError(a[1]))return a[1];
var e;if(isNaN(e=b.toInt(a[1])))return x.Errors.Value;var f=[],g;if(d.isArrayOrReference(a[0]))for(var h=0;h<d.getLength(a[0]);h++)if(g=d.getValueByIndex(a[0],h),b.isNumber(g))g=b.toDouble(g),f.push(g);else{if(b.isError(g))return g}else{if(isNaN(g=b.toDouble(a[0])))return x.Errors.Value;f.push(g)}f.sort(function(a,b){return a-b});return 0>=e||f.length<e?x.Errors.Number:f[e-1]},{minArgs:2,maxArgs:2,acceptsArray:f,acceptsReference:f});p("AVERAGE",function(a){return h(a,!0)},{minArgs:1,acceptsArray:l,
acceptsReference:l});p("AVERAGEA",function(a){for(var b=0,d=0,e=x.Convert,f=x._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g]))for(var h=0;h<f.getLength(a[g]);h++){var k=f.getValueByIndex(a[g],h);if(e.isNumber(k)||typeof k===X)b+=e.toDouble(k),d++;else if(typeof k===na)b+=0,d++;else if(e.isError(k))return k}else{if(isNaN(h=e.toDouble(a[g])))return x.Errors.Value;b+=h;d++}}return 0===d?x.Errors.DivideByZero:e.toResult(b/d)},{minArgs:1,acceptsArray:l,acceptsReference:l});
p("AVERAGEIF",function(a){var b=a[0],d=a[1],e=x._Helper._argumentExists(a,2)?a[2]:a[0],f=x.Convert,g=a[1],h,k;if(f._isCalcReference(g)){d=g.getRowCount(0);f=g.getColumnCount(0);a=[];for(h=0;h<d;h++)for(a[h]=Array(f),k=0;k<f;k++)a[h][k]=I(b,g.getValue(0,h,k),e);return new x._ConcreteArray(a)}g=a[1];if(f._isCalcArray(g)){d=g.getRowCount();f=g.getColumnCount();a=[];for(h=0;h<d;h++)for(a[h]=Array(f),k=0;k<f;k++)a[h][k]=I(b,g.getValue(h,k),e);return new x._ConcreteArray(a)}return I(b,d,e)},{minArgs:2,
maxArgs:3,acceptsMissingArgument:a,acceptsArray:d,acceptsReference:d});p("AVERAGEIFS",function(a){for(var b=0,d=0,e=a[0],f=x.Convert,g=x._ArrayHelper,h=g.getLength(a[0]),k,l=0;l<h;l++){for(var n=!0,m=1;m<a.length&&(k=a[m],n=qa._MathHelper.parseCriteria(a[m+1]),k=g.getValueByIndex(k,l),n=n(k),n);m+=2);if(n)if(k=g.getValueByIndex(e,l),f.isNumber(k))b+=f.toDouble(k),d++;else if(f.isError(k))return k}return 0===d?x.Errors.DivideByZero:f.toResult(b/d)},{minArgs:3,acceptsArray:b,acceptsReference:b});p("MEDIAN",
function(a){for(var b=[],d,e=x.Convert,f=x._ArrayHelper,g=0;g<a.length;g++){if(e.isError(a[g]))return a[g];if(f.isArrayOrReference(a[g]))for(var h=0;h<f.getLength(a[g]);h++)if(d=f.getValueByIndex(a[g],h),e.isNumber(d))d=e.toDouble(d),b.push(d);else{if(e.isError(d))return d}else{if(isNaN(d=e.toDouble(a[g])))return x.Errors.Value;b.push(d)}}b.sort(function(a,b){return a-b});return 0===b.length?x.Errors.Number:0===b.length%2?(e.toDouble(b[b.length/2-1])+e.toDouble(b[b.length/2]))/2:b[parseInt(b.length/
2,10)]},{minArgs:1,acceptsArray:l,acceptsReference:l});p("MODE",function(a){var b=null,d=0,e=[],f=x.Convert,g=x._ArrayHelper,h,k,l;for(h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];if(g.isArrayOrReference(a[h]))for(k=0;k<g.getLength(a[h]);k++)if(l=g.getValueByIndex(a[h],k),f.isNumber(l))l=f.toDouble(l),e.push(l);else{if(f.isError(l))return l}else{if(isNaN(l=f.toDouble(a[h])))return x.Errors.Value;e.push(l)}}for(h=0;h<e.length;h++){for(k=a=0;k<e.length;k++)k!==h&&f.toDouble(e[k])===f.toDouble(e[h])&&
a++;a>d&&(d=a,b=e[h])}return 0===d?x.Errors.NotAvailable:b},{minArgs:1,acceptsArray:l,acceptsReference:l});p("GEOMEAN",function(a){for(var b,d=1,e=0,f=x.Convert,g=x._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];if(g.isArrayOrReference(a[h]))for(var k=0;k<g.getLength(a[h]);k++)if(b=g.getValueByIndex(a[h],k),f.isNumber(b)){b=f.toDouble(b);if(0>=b)return x.Errors.Number;d*=b;e++}else{if(f.isError(b))return b}else{if(isNaN(b=f.toDouble(a[h])))return x.Errors.Value;if(0>=b)return x.Errors.Number;
d*=b;e++}}return 0>=e?x.Errors.DivideByZero:f.toResult(Math.pow(d,1/e))},{minArgs:1,acceptsArray:l,acceptsReference:l});p("HARMEAN",function(a){for(var b,d=0,e=0,f=x.Convert,g=x._ArrayHelper,h=0;h<a.length;h++){if(f.isError(a[h]))return a[h];if(g.isArrayOrReference(a[h]))for(var k=0;k<g.getLength(a[h]);k++)if(b=g.getValueByIndex(a[h],k),f.isNumber(b)){b=f.toDouble(b);if(0>=b)return x.Errors.Number;d+=1/b;e++}else{if(f.isError(b))return b}else{if(isNaN(b=f.toDouble(a[h])))return x.Errors.Value;if(0>=
b)return x.Errors.Number;d+=1/b;e++}}return 0===d?x.Errors.DivideByZero:f.toResult(e/d)},{minArgs:1,acceptsArray:l,acceptsReference:l});p("TRIMMEAN",function(a){var b,d=x.Convert,e=x._ArrayHelper;if(isNaN(b=d.toDouble(a[1])))return x.Errors.Value;var f=0,g=[],h,k;if(0>b||1<=b)return x.Errors.Number;if(d.isError(a[0]))return a[0];if(e.isArrayOrReference(a[0]))for(h=0;h<e.getLength(a[0]);h++)if(k=e.getValueByIndex(a[0],h),d.isNumber(k))k=d.toDouble(k),g.push(k);else{if(d.isError(k))return k}else{if(isNaN(k=
d.toDouble(a[0])))return x.Errors.Value;g.push(k)}g.sort(function(a,b){return a-b});for(h=a=parseInt(g.length*b/2,10);h<g.length-a;h++)f+=d.toDouble(g[h]);return f/(g.length-2*a)},{minArgs:2,maxArgs:2,acceptsArray:f,acceptsReference:f});p("FREQUENCY",function(a){var b=x.Convert,d=b._toArray(a[0]),e=b._toArray(a[1]);a=0;var f,g,h,k=e.getRowCount(),l=e.getColumnCount();for(f=0;f<k;f++)for(g=0;g<l;g++){h=e.getValue(f,g);if(b.isError(h))return h;b.isNumber(h)&&a++}var n=d.getRowCount(),m=d.getColumnCount();
for(f=0;f<n;f++)for(g=0;g<m;g++)if(h=d.getValue(f,g),b.isError(h))return h;var q=Array(a),p=Array(a+1);for(f=a=0;f<k;f++)for(g=0;g<l;g++)h=e.getValue(f,g),b.isNumber(h)&&(q[a++]=b.toDouble(h));q.sort(function(a,b){return a-b});g=p.length;for(f=0;f<g;f++)p[f]=0;for(f=0;f<n;f++)for(g=0;g<m;g++)if(h=d.getValue(f,g),b.isNumber(h)){e=b.toDouble(h);h=!1;for(k=0;!h&&k<a;k++)e<=q[k]&&(p[k]++,h=!0);h||p[a]++}return new x._OneDimensionalArray(p)},{minArgs:2,maxArgs:2,acceptsArray:l,acceptsReference:l});p("RANK",
function(a){var b=x.Convert,d=x._ArrayHelper,e;if(isNaN(e=b.toDouble(a[0])))return x.Errors.Value;var f=a[1],g=0;if(x._Helper._argumentExists(a,2)&&isNaN(g=b.toDouble(a[2])))return x.Errors.Value;for(var h=0,k=0,l=0,n=0;n<d.getLength(f);n++){var m=d.getValueByIndex(a[1],n);b.isNumber(m)&&(m=b.toDouble(m),m<e?h++:e<m?l++:k++)}return 0===k?x.Errors.NotAvailable:0===g?l+1:h+1},{minArgs:2,maxArgs:3,acceptsMissingArgument:a,acceptsArray:k,acceptsReference:k});p("KURT",function(a){var b,d=0,e=0,f=0,g,h=
0,k=x.Convert,l=x._ArrayHelper,n,m;for(n=0;n<a.length;n++)if(l.isArrayOrReference(a[n]))for(m=0;m<l.getLength(a[n]);m++)if(b=l.getValueByIndex(a[n],m),k.isNumber(b))b=k.toDouble(b),d+=b,e+=b*b,h++;else{if(k.isError(b))return b}else{if(isNaN(b=k.toDouble(a[n])))return x.Errors.Value;d+=b;e+=b*b;h++}if(3>=h)return x.Errors.DivideByZero;g=d/h;d=Math.sqrt((h*e-d*d)/(h*(h-1)));if(0===d)return x.Errors.DivideByZero;for(n=0;n<a.length;n++)if(l.isArrayOrReference(a[n]))for(m=0;m<l.getLength(a[n]);m++)if(b=
l.getValueByIndex(a[n],m),k.isNumber(b))b=k.toDouble(b),f+=Math.pow((b-g)/d,4);else{if(k.isError(b))return b}else{if(isNaN(b=k.toDouble(a[n])))return x.Errors.Value;f+=Math.pow((b-g)/d,4)}return k.toResult(h*(h+1)*f/((h-1)*(h-2)*(h-3))-3*(h-1)*(h-1)/((h-2)*(h-3)))},{minArgs:1,acceptsArray:l,acceptsReference:l});p("PERCENTILE",E,{minArgs:2,maxArgs:2,acceptsArray:f,acceptsReference:f});p("PERCENTRANK",function(a){var b=a[0],d,e=x.Convert,f=x._ArrayHelper;if(isNaN(d=e.toDouble(a[1])))return x.Errors.Value;
var g=3;if(x._Helper._argumentExists(a,2)&&isNaN(g=e.toInt(a[2])))return x.Errors.Value;var h=a=0,k=0,l=d,n=d;if(1>g)return x.Errors.Number;for(var m=0;m<f.getLength(b);m++){var q=f.getValueByIndex(b,m);if(void 0!==q&&null!==q){if(isNaN(q=e.toDouble(q)))return x.Errors.Value;if(q<d){if(a++,l===d||l<q)l=q}else if(q>d){if(h++,n===d||n>q)n=q}else k++}}if(0===a+k||0===h+k)return x.Errors.NotAvailable;if(0===h&&0===a&&0!==k)return 1;a=e.toDouble(a);h=e.toDouble(h);k=e.toDouble(k);return qa._MathHelper.round(1===
k?a/(a+h):0===k?(a+(d-l)/(n-l)-1)/(h+a-1):(a+0.5*k)/(a+k+h),15<g?15:g)},{minArgs:2,maxArgs:3,acceptsMissingArgument:a,acceptsArray:f,acceptsReference:f});p("QUARTILE",function(a){var b=a[0],d=0;switch(x.Convert.toInt(a[1])){case 0:d=0;break;case 1:d=0.25;break;case 2:d=0.5;break;case 3:d=0.75;break;case 4:d=1;break;default:return x.Errors.Number}return E([b,d])},{minArgs:2,maxArgs:2,acceptsArray:f,acceptsReference:f});p("COUNT",function(a){return O(a,!0)},{minArgs:1,acceptsError:l,acceptsArray:l,
acceptsReference:l});p("COUNTA",function(a){return H(a,!0)},{minArgs:1,acceptsError:l,acceptsArray:l,acceptsReference:l});p("COUNTBLANK",function(a){for(var b=0,d=x.Convert,e=x._ArrayHelper,f=0;f<e.getRangeCount(a[0]);f++)for(var g=0;g<e.getLength(a[0],f);g++)null===e.getValue(a[0],g,f)&&b++;return d.toDouble(b)},{minArgs:1,maxArgs:1,acceptsArray:l,acceptsReference:l});p("COUNTIF",function(a){var b=a[0],d=a[1],e=x.Convert,f=x._ArrayHelper,g;if(f.isArrayOrReference(d)){var h=f.getRowCount(d),k=f.getColumnCount(d),
l=[];for(a=0;a<h;a++)for(l[a]=[k],g=0;g<k;g++){var n=C(b,f.getValue(d,a,g));if(e.isError(n))return n;if(isNaN(n=e.toDouble(n)))return x.Errors.Value;l[a][g]=n}for(a=b=0;a<h;a++)for(g=0;g<k;g++)b+=l[a][g];return b}return C(b,d)},{minArgs:2,maxArgs:2,acceptsArray:f,acceptsReference:f});p("COUNTIFS",function(a){for(var b=0,d=x.Convert,e=x._ArrayHelper,f=e.getLength(a[0]),g=0;g<f;g++){for(var h=!0,k=0;k<a.length;k+=2){var l=a[k],h=qa._MathHelper.parseCriteria(a[k+1]),l=e.getValueByIndex(l,g),h=h&&h(l);
if(!h)break}h&&b++}return d.toResult(b)},{minArgs:2,acceptsArray:q,acceptsReference:q});p("AVEDEV",function(a){var b,d,e=d=0,f=0,g,h,k=x.Convert,l=x._ArrayHelper;for(g=0;g<a.length;g++){if(k.isError(a[g]))return a[g];if(l.isArrayOrReference(a[g]))for(h=0;h<l.getLength(a[g]);h++)if(b=l.getValueByIndex(a[g],h),k.isNumber(b))b=k.toDouble(b),d+=b,f++;else{if(k.isError(b))return b}else{if(isNaN(b=k.toDouble(a[g])))return x.Errors.Value;d+=b;f++}}d/=f;for(g=0;g<a.length;g++){if(k.isError(a[g]))return a[g];
if(l.isArrayOrReference(a[g]))for(h=0;h<l.getLength(a[g]);h++)if(b=l.getValueByIndex(a[g],h),k.isNumber(b))b=k.toDouble(b),e+=Math.abs(b-d);else{if(k.isError(b))return b}else{if(isNaN(b=k.toDouble(a[g])))return x.Errors.Value;e+=Math.abs(b-d)}}return 0===f?x.Errors.DivideByZero:k.toResult(e/f)},{minArgs:1,acceptsArray:l,acceptsReference:l});p("STDEV",function(a){return S(a,!0)},{minArgs:1,acceptsArray:l,acceptsReference:l});p("STDEVA",function(a){var b={sumx:0,sumx2:0,n:0};a=z(a,b);var d=x.Convert;
return d.isError(a)?a:1>=b.n?x.Errors.DivideByZero:d.toResult(Math.sqrt(Math.max(0,(b.n*b.sumx2-b.sumx*b.sumx)/(b.n*(b.n-1)))))},{minArgs:1,acceptsArray:l,acceptsReference:l});p("STDEVP",function(a){return Q(a,!0)},{minArgs:1,acceptsArray:l,acceptsReference:l});p("STDEVPA",function(a){var b={sumx:0,sumx2:0,n:0};a=z(a,b);var d=x.Convert;return d.isError(a)?a:0>=b.n?x.Errors.DivideByZero:d.toResult(Math.sqrt(Math.max(0,(b.n*b.sumx2-b.sumx*b.sumx)/(b.n*b.n))))},{minArgs:1,acceptsArray:l,acceptsReference:l});
p("VAR",function(a){return aa(a,!0)},{minArgs:1,acceptsArray:l,acceptsReference:l});p("VARA",function(a){var b={sumx:0,sumx2:0,n:0};a=z(a,b);var d=x.Convert;return d.isError(a)?a:1>=b.n?x.Errors.DivideByZero:d.toResult(Math.max(0,(b.n*b.sumx2-b.sumx*b.sumx)/(b.n*(b.n-1))))},{minArgs:1,acceptsArray:l,acceptsReference:l});p("VARP",function(a){return ka(a,!0)},{minArgs:1,acceptsArray:l,acceptsReference:l});p("VARPA",function(a){var b={sumx:0,sumx2:0,n:0};a=z(a,b);var d=x.Convert;return d.isError(a)?
a:0>=b.n?x.Errors.DivideByZero:d.toResult(Math.max(0,(b.n*b.sumx2-b.sumx*b.sumx)/(b.n*b.n)))},{minArgs:1,acceptsArray:l,acceptsReference:l});p("COVAR",function(a){var b,d,e,f,g=f=e=0,h=x.Convert,k=x._ArrayHelper,l=k.getLength(a[0]);if(0===l)return x.Errors.DivideByZero;if(l!==k.getLength(a[1]))return x.Errors.NotAvailable;var n=0,m,q;if(k.isArrayOrReference(a[0]))for(m=0;m<l;m++)if(b=k.getValueByIndex(a[0],m),q=k.getValueByIndex(a[1],m),h.isNumber(b)&&h.isNumber(q))b=h.toDouble(b),d=h.toDouble(q),
e+=b,f+=d,n++;else{if(h.isError(b))return b;if(h.isError(q))return q}else{if(isNaN(b=h.toDouble(a[0]))||isNaN(d=h.toDouble(a[1])))return x.Errors.Value;e+=b;f+=d;n++}e/=n;f/=n;if(k.isArrayOrReference(a[0]))for(m=0;m<l;m++)if(b=k.getValueByIndex(a[0],m),q=k.getValueByIndex(a[1],m),h.isNumber(b)&&h.isNumber(q))b=h.toDouble(b),d=h.toDouble(q),g+=(b-e)*(d-f);else{if(h.isError(b))return b;if(h.isError(q))return q}else{if(isNaN(b=h.toDouble(a[0]))||isNaN(d=h.toDouble(a[1])))return x.Errors.Value;g+=(b-
e)*(d-f)}return 1>=n?x.Errors.DivideByZero:h.toResult(g/n)},{minArgs:2,maxArgs:2,acceptsArray:l,acceptsReference:l});p("DEVSQ",function(a){var b,d,e=d=0,f=0,g,h,k=x.Convert,l=x._ArrayHelper;for(g=0;g<a.length;g++){if(k.isError(a[g]))return a[g];if(l.isArrayOrReference(a[g]))for(h=0;h<l.getLength(a[g]);h++)if(b=l.getValueByIndex(a[g],h),k.isNumber(b))b=k.toDouble(l.getValueByIndex(a[g],h)),d+=b,f++;else{if(k.isError(b))return b}else{if(isNaN(b=k.toDouble(a[g])))return x.Errors.Value;d+=b;f++}}d/=f;
for(g=0;g<a.length;g++)if(l.isArrayOrReference(a[g]))for(h=0;h<l.getLength(a[g]);h++)if(b=l.getValueByIndex(a[g],h),k.isNumber(b))b=k.toDouble(l.getValueByIndex(a[g],h)),e+=(b-d)*(b-d);else{if(k.isError(b))return b}else{if(isNaN(b=k.toDouble(a[g])))return x.Errors.Value;e+=(b-d)*(b-d)}return k.toResult(e)},{minArgs:1,acceptsArray:l,acceptsReference:l});p("CONFIDENCE",function(a){var b,d,e=x.Convert;if(isNaN(b=e.toDouble(a[0]))||isNaN(d=e.toDouble(a[1])))return x.Errors.Value;a=e.toInt(a[2]);if(0>=
b||1<=b||0>=d||1>a)return x.Errors.Number;var f=[];f[0]=b/2;b=L(f);if(e.isError(b))return b;b=e.toDouble(b);return-b*(d/Math.sqrt(a))},{minArgs:3,maxArgs:3});p("FORECAST",function(a){var b,d=x.Convert,e=x._ArrayHelper;if(isNaN(b=d.toDouble(a[0])))return x.Errors.Value;var f,g,h=0,k=0,l=0,n=0,m=e.getLength(a[1]);if(m!==e.getLength(a[2]))return x.Errors.NotAvailable;for(var q=0,p=0;p<m;p++)if(f=e.getValueByIndex(a[1],p),g=e.getValueByIndex(a[2],p),d.isNumber(f)&&d.isNumber(g))f=d.toDouble(f),g=d.toDouble(g),
h+=f,k+=g,l+=g*g,n+=g*f,q++;else{if(d.isError(f))return f;if(d.isError(g))return g}if(0===q||0===q*l-k*k)return x.Errors.DivideByZero;a=(q*n-k*h)/(q*l-k*k);return d.toResult(h/q-a*(k/q)+a*b)},{minArgs:3,maxArgs:3,acceptsArray:m,acceptsReference:m});p("INTERCEPT",function(a){var b,d,e=0,f=0,g=0,h=0,k=x.Convert,l=x._ArrayHelper,n=l.getLength(a[0]);if(n!==l.getLength(a[1]))return x.Errors.NotAvailable;for(var m=0,q=0;q<n;q++)if(b=l.getValueByIndex(a[0],q),d=l.getValueByIndex(a[1],q),k.isNumber(b)&&k.isNumber(d))b=
k.toDouble(b),d=k.toDouble(d),e+=b,f+=d,g+=d*d,h+=d*b,m++;else{if(k.isError(b))return b;if(k.isError(d))return d}return 0===m||0===m*g-f*f?x.Errors.DivideByZero:k.toResult(e/m-(m*h-f*e)/(m*g-f*f)*(f/m))},{minArgs:2,maxArgs:2,acceptsArray:l,acceptsReference:l});p("LINEST",function(a){var b=x.Convert,d=x._Helper,e=b._toArray(a[0]),f=new x.Array,f=d._argumentExists(a,1)?b._toArray(a[1]):e,g=d._argumentExists(a,2)?b.toBool(a[2]):!0,h=d._argumentExists(a,3)?b.toBool(a[3]):!1,k,l,n,m,q,p;for(l=0;l<e.getRowCount();l++)for(n=
0;n<e.getColumnCount();n++){if(b.isError(e.getValue(l,n)))return e.getValue(l,n);if(!b.isNumber(e.getValue(l,n)))return x.Errors.Value}for(l=0;l<f.getRowCount();l++)for(n=0;n<f.getColumnCount();n++){if(b.isError(f.getValue(l,n)))return f.getValue(l,n);if(!b.isNumber(f.getValue(l,n)))return x.Errors.Value}if(e.getRowCount()===f.getRowCount()&&e.getColumnCount()===f.getColumnCount()&&(g||!h)){a=b.toDouble(f.getRowCount()*f.getColumnCount());var r=0,s=k=0,t=0;for(l=m=0;l<f.getRowCount();l++)for(n=0;n<
f.getColumnCount();n++){if(isNaN(q=b.toDouble(f.getValue(l,n)))||isNaN(p=b.toDouble(e.getValue(l,n))))return x.Errors.Value;r+=q;k+=q*q;s+=p;t+=p*p;m+=q*p}g?(d=(a*m-r*s)/(a*k-r*r),l=(s*k-r*m)/(a*k-r*r)):(d=m/k,l=0);p=[[]];p[0][0]=d;p[0][1]=l;h&&(p[1]=[],p[2]=[],p[3]=[],p[4]=[],b=a*k-r*r,g=a*t-s*s,h=a*m-r*s,d=t-l*s-d*m,l=h*h/(b*g),3>a?(p[1][0]=x.Errors.Number,p[1][1]=x.Errors.Number,p[2][1]=x.Errors.Number,p[3][0]=x.Errors.Number):(p[1][0]=Math.sqrt(d*a/(b*(a-2))),p[1][1]=Math.sqrt(d*k/(b*(a-2))),
p[2][1]=Math.sqrt((g-h*h/b)/(a*(a-2))),p[3][0]=1===l?x.Errors.Number:l*(a-2)/(1-l)),p[2][0]=l,p[3][1]=a-2,p[4][0]=g/a-d,p[4][1]=d);return p}if(1===e.getColumnCount()&&e.getRowCount()===f.getRowCount()||1===e.getRowCount()&&e.getColumnCount()===f.getColumnCount()){p=[];q=[];if(1===e.getColumnCount()){a=f.getRowCount();d=f.getColumnCount();for(l=0;l<a;l++){if(isNaN(k=b.toDouble(e.getValue(l,0))))return x.Errors.Value;p[l]=k}for(l=0;l<a;l++)for(q[l]=[],n=0;n<d;n++){if(isNaN(k=b.toDouble(f.getValue(l,
n))))return x.Errors.Value;q[l][n]=k}}else{a=f.getColumnCount();d=f.getRowCount();q=[];p=[];for(l=0;l<a;l++){if(isNaN(k=b.toDouble(e.getValue(0,l))))return x.Errors.Value;p[l]=k}for(l=0;l<a;l++)for(q[l]=[],n=0;n<d;n++){if(isNaN(k=b.toDouble(f.getValue(n,l))))return x.Errors.Value;q[l][n]=k}}s=[];for(m=0;m<d+1;m++)s[m]=[];for(l=0;l<d+1;l++)for(n=0;n<d+2;n++)s[l][n]=0;t=[];for(l=0;l<d+2;l++)t[l]=0;k=h?[]:null;for(m=0;m<a;m++)for(t[d+1]+=p[m]*p[m],s[0][d+1]+=p[m],t[0]=s[0][d+1],l=0;l<d;l++)for(s[0][l+
1]+=q[m][l],s[l+1][0]=s[0][l+1],s[l+1][d+1]+=q[m][l]*p[m],t[l+1]=s[l+1][d+1],n=l;n<d;n++)s[n+1][l+1]+=q[m][l]*q[m][n],s[l+1][n+1]=s[n+1][l+1];s[0][0]=a;if(h){for(l=0;l<d+1;l++)for(k[l]=[],n=0;n<d+1;n++)k[l][n]=0;for(l=0;l<d+1;l++)k[l][l]=1}if(g)for(l=0;l<d+1;l++){if(0===s[l][l]){p=!1;for(n=l+1;!p&&n<d+1;n++)if(0!==s[n][l]){for(m=0;m<d+2;m++)p=s[l][m],s[l][m]=s[n][m],s[n][m]=p;if(h)for(m=0;m<d+1;m++)p=k[l][m],k[l][m]=k[n][m],k[n][m]=p;p=!0}if(!p)return x.Errors.Number}p=1/s[l][l];for(m=0;m<d+2;m++)s[l][m]*=
p;if(h)for(m=0;m<d+1;m++)k[l][m]*=p;for(n=0;n<d+1;n++)if(n!==l){p=-s[n][l];for(m=0;m<d+2;m++)s[n][m]+=p*s[l][m];if(h)for(m=0;m<d+1;m++)k[n][m]+=p*k[l][m]}}else for(l=1;l<d+1;l++){if(0===s[l][l]){p=!1;for(n=l+1;!p&&n<d+1;n++)if(0!==s[n][l]){for(m=0;m<d+2;m++)p=s[l][m],s[l][m]=s[n][m],s[n][m]=p;if(h)for(m=0;m<d+1;m++)p=k[l][m],k[l][m]=k[n][m],k[n][m]=p;p=!0}if(!p)return x.Errors.Number}p=1/s[l][l];for(m=1;m<d+2;m++)s[l][m]*=p;if(h)for(m=1;m<d+1;m++)k[l][m]*=p;for(n=1;n<d+1;n++)if(n!==l){p=-s[n][l];
for(m=1;m<d+2;m++)s[n][m]+=p*s[l][m];if(h)for(m=1;m<d+1;m++)k[n][m]+=p*k[l][m]}s[0][d+1]=0}p=[h?5:1,d+1];p[0]=[];for(l=0;l<d+1;l++)p[0][l]=s[d-l][d+1];if(h){for(l=1;5>l;l++)for(p[l]=[],n=0;n<d+1;n++)p[l][n]=0;n=t[d+1]-t[0]*t[0]/a;h=t[d+1];for(l=0;l<d+1;l++)h-=s[l][d+1]*t[l];q=n-h;p[2][0]=0===n?x.Errors.Number:q/n;p[4][0]=q;p[4][1]=h;if(g){if(0===a-d-1)for(p[2][1]=x.Errors.Number,l=0;l<d+1;l++)p[1][l]=x.Errors.Number;else{g=h/(a-d-1);for(l=0;l<d+1;l++)p[1][d-l]=Math.sqrt(g*k[l][l]);p[2][1]=Math.sqrt(g)}p[3][0]=
0===h?x.Errors.Number:b.toDouble(a-d-1)*q/(h*b.toDouble(d));p[3][1]=b.toDouble(a-d-1)}else{if(0===a-d){for(l=0;l<d+1;l++)p[1][l]=x.Errors.Number;p[2][1]=x.Errors.Number}else{g=h/b.toDouble(a-d);p[1][d]=x.Errors.NotAvailable;for(l=1;l<d+1;l++)p[1][d-l]=Math.sqrt(g*k[l][l]);p[2][1]=Math.sqrt(g)}p[3][0]=0===h?x.Errors.Number:b.toDouble(a-d)*q/(h*b.toDouble(d));p[3][1]=b.toDouble(a-d)}for(l=2;5>l;l++)for(n=2;n<d+1;n++)p[l][n]=x.Errors.NotAvailable}return p}return x.Errors.Number},{minArgs:1,maxArgs:4,
acceptsReference:e,acceptsArray:e,acceptsMissingArgument:g});p("SLOPE",function(a){var b=a[0],d=a[1],e=0,f=0,g=0,h=0,k=0,l=x.Convert,n=x._ArrayHelper,m=n.getLength(a[0]);if(m!==n.getLength(a[1]))return x.Errors.NotAvailable;for(a=0;a<m;a++){var q=n.getValueByIndex(b,a),p=n.getValueByIndex(d,a);l.isNumber(q)&&l.isNumber(p)&&(q=l.toDouble(q),p=l.toDouble(p),e+=q,f+=p,g+=p*p,h+=p*q,k++)}return 0===k*g-f*f?x.Errors.DivideByZero:l.toResult((k*h-f*e)/(k*g-f*f))},{minArgs:2,maxArgs:2,acceptsArray:l,acceptsReference:l});
p("TREND",function(a){for(var b=x.Convert,d=x._Helper,e=b._toArray(a[0]),f=new x.Array,f=d._argumentExists(a,1)?b._toArray(a[1]):e,g=d._argumentExists(a,2)?b._toArray(a[2]):f,h=d._argumentExists(a,3)?b.toBool(a[3]):!0,k,d=0;d<e.getRowCount();d++)for(k=0;k<e.getColumnCount();k++)if(!b.isNumber(e.getValue(d,k)))return x.Errors.Value;for(d=0;d<f.getRowCount();d++)for(k=0;k<f.getColumnCount();k++)if(!b.isNumber(f.getValue(d,k)))return x.Errors.Value;for(d=0;d<g.getRowCount();d++)for(k=0;k<g.getColumnCount();k++)if(!b.isNumber(g.getValue(d,
k)))return x.Errors.Value;var l,n,m,q;if(e.getRowCount()===f.getRowCount()&&e.getColumnCount()===f.getColumnCount()){n=f.getRowCount()*f.getColumnCount();for(var p=l=0,r=0,s=0,d=0;d<f.getRowCount();d++)for(k=0;k<f.getColumnCount();k++){if(isNaN(m=b.toDouble(f.getValue(d,k)))||isNaN(q=b.toDouble(e.getValue(d,k))))return x.Errors.Value;l+=m;p+=m*m;r+=q;s+=m*q}h?(a=(n*s-l*r)/(n*p-l*l),q=(r*p-l*s)/(n*p-l*l)):(a=s/p,q=0);e=[];for(d=0;d<g.getRowCount();d++)for(e[d]=[],k=0;k<g.getColumnCount();k++){if(isNaN(m=
b.toDouble(g.getValue(d,k))))return x.Errors.Value;e[d][k]=a*m+q}return e}if(1===e.getColumnCount()&&e.getRowCount()===f.getRowCount()||1===e.getRowCount()&&e.getColumnCount()===f.getColumnCount()){q=[];m=[];if(1===e.getColumnCount()){n=f.getRowCount();a=f.getColumnCount();for(d=0;d<n;d++){if(isNaN(l=b.toDouble(e.getValue(d,0))))return x.Errors.Value;q[d]=l}for(d=0;d<n;d++)for(m[d]=[],k=0;k<a;k++){if(isNaN(l=b.toDouble(f.getValue(d,k))))return x.Errors.Value;m[d][k]=l}}else{n=f.getColumnCount();a=
f.getRowCount();m=[];q=[];for(d=0;d<n;d++){if(isNaN(l=b.toDouble(e.getValue(0,d))))return x.Errors.Value;q[d]=l}for(d=0;d<n;d++)for(m[d]=[],k=0;k<a;k++){if(isNaN(l=b.toDouble(f.getValue(k,d))))return x.Errors.Value;m[d][k]=l}}f=[];for(l=0;l<a+1;l++)f[l]=[];for(d=0;d<a+1;d++)for(k=0;k<a+2;k++)f[d][k]=0;for(l=0;l<n;l++)for(f[0][a+1]+=q[l],d=0;d<a;d++)for(f[0][d+1]+=m[l][d],f[d+1][0]=f[0][d+1],f[d+1][a+1]+=m[l][d]*q[l],k=d;k<a;k++)f[k+1][d+1]+=m[l][d]*m[l][k],f[d+1][k+1]=f[k+1][d+1];f[0][0]=n;if(h)for(d=
0;d<a+1;d++){if(0===f[d][d]){m=!1;for(k=d+1;!m&&k<a+1;k++)if(0!==f[k][d]){for(l=0;l<a+2;l++)m=f[d][l],f[d][l]=f[k][l],f[k][l]=m;m=!0}if(!m)return x.Errors.NotAvailable}m=1/f[d][d];for(l=0;l<a+2;l++)f[d][l]*=m;for(k=0;k<a+1;k++)if(k!==d)for(m=-f[k][d],l=0;l<a+2;l++)f[k][l]+=m*f[d][l]}else for(d=1;d<a+1;d++){if(0===f[d][d]){m=!1;for(k=d+1;!m&&k<a+1;k++)if(0!==f[k][d]){for(l=0;l<a+2;l++)m=f[d][l],f[d][l]=f[k][l],f[k][l]=m;m=!0}if(!m)return x.Errors.NotAvailable}m=1/f[d][d];for(l=1;l<a+2;l++)f[d][l]*=
m;for(k=1;k<a+1;k++)if(k!==d)for(m=-f[k][d],l=1;l<a+2;l++)f[k][l]+=m*f[d][l];f[0][a+1]=0}if(1===e.getColumnCount())for(e=[],d=0;d<g.getRowCount();d++){e[d]=[];m=f[0][a+1];for(k=0;k<a;k++){if(isNaN(l=b.toDouble(g.getValue(d,k))))return x.Errors.Value;m+=f[k+1][a+1]*l}e[d][0]=m}else for(e=[[]],d=0;d<g.getColumnCount;d++){m=f[0][a+1];for(k=0;k<a;k++){if(isNaN(l=b.toDouble(g.getValue(k,d))))return x.Errors.Value;m+=f[k+1][a+1]*l}e[0][d]=m}return e}return x.Errors.NotAvailable},{minArgs:1,maxArgs:4,acceptsReference:s,
acceptsArray:s,acceptsMissingArgument:g});p("GROWTH",function(a){for(var b=x.Convert,d=x._Helper,e=b._toArray(a[0]),f=[],f=d._argumentExists(a,1)?b._toArray(a[1]):e,g=d._argumentExists(a,2)?b._toArray(a[2]):f,h=d._argumentExists(a,3)?b.toBool(a[3]):!0,k,l,n,m,q,d=0;d<e.getRowCount();d++)for(l=0;l<e.getColumnCount();l++){m=e.getValue(d,l);if(b.isError(m))return m;if(!b.isNumber(m))return x.Errors.Value;if(0>=b.toDouble(m))return x.Errors.Number}for(d=0;d<f.getRowCount();d++)for(l=0;l<f.getColumnCount();l++){m=
f.getValue(d,l);if(b.isError(m))return m;if(!b.isNumber(m))return x.Errors.Value}for(d=0;d<g.getRowCount();d++)for(l=0;l<g.getColumnCount();l++){m=g.getValue(d,l);if(b.isError(m))return m;if(!b.isNumber(m))return x.Errors.Value}if(e.getRowCount()===f.getRowCount()&&e.getColumnCount()===f.getColumnCount()){n=f.getRowCount()*f.getColumnCount();for(var p=k=0,r=0,s=0,d=0;d<f.getRowCount();d++)for(l=0;l<f.getColumnCount();l++){if(isNaN(m=b.toDouble(f.getValue(d,l)))||isNaN(q=b.toDouble(e.getValue(d,l))))return x.Errors.Value;
q=Math.log(q);k+=m;p+=m*m;r+=q;s+=m*q}h?(a=(n*s-k*r)/(n*p-k*k),q=(r*p-k*s)/(n*p-k*k)):(a=s/p,q=0);e=[];for(d=0;d<g.getRowCount();d++)for(e[d]=[],l=0;l<g.getColumnCount();l++){if(isNaN(m=b.toDouble(g.getValue(d,l))))return x.Errors.Value;e[d][l]=Math.exp(a*m+q)}return e}if(1===e.getColumnCount()&&e.getRowCount()===f.getRowCount()||1===e.getRowCount()&&e.getColumnCount()===f.getColumnCount()){q=[];m=[];if(1===e.getColumnCount()){n=f.getRowCount();a=f.getColumnCount();for(d=0;d<n;d++){if(isNaN(k=b.toDouble(e.getValue(d,
0))))return x.Errors.Value;q[d]=Math.log(k)}for(d=0;d<n;d++)for(m[d]=[],l=0;l<a;l++){if(isNaN(k=b.toDouble(f.getValue(d,l))))return x.Errors.Value;m[d][l]=k}}else{n=f.getColumnCount();a=f.getRowCount();m=[];q=[];for(d=0;d<n;d++){if(isNaN(k=b.toDouble(e.getValue(0,d))))return x.Errors.Value;q[d]=k}for(d=0;d<n;d++)for(m[d]=[],l=0;l<a;l++){if(isNaN(k=b.toDouble(f.getValue(l,d))))return x.Errors.Value;m[d][l]=k}}f=[];for(d=0;d<a+1;d++)for(f[d]=[],l=0;l<a+2;l++)f[d][l]=0;for(d=0;d<a+2;d++);for(k=0;k<n;k++)for(f[0][a+
1]+=q[k],d=0;d<a;d++)for(f[0][d+1]+=m[k][d],f[d+1][0]=f[0][d+1],f[d+1][a+1]+=m[k][d]*q[k],l=d;l<a;l++)f[l+1][d+1]+=m[k][d]*m[k][l],f[d+1][l+1]=f[l+1][d+1];f[0][0]=n;if(h)for(q=0;q<a+1;q++){for(d=q;d<a+1&&0===f[d][q];)d++;if(d>=a+1)return x.Errors.NotAvailable;for(h=0;h<a+2;h++)m=f[q][h],f[q][h]=f[d][h],f[d][h]=m;m=1/f[q][q];for(h=0;h<a+2;h++)f[q][h]*=m;for(d=0;d<a+1;d++)if(d!==q)for(m=-f[d][q],h=0;h<a+2;h++)f[d][h]+=m*f[q][h]}else for(q=1;q<a+1;q++){for(d=q;d<a+1&&0===f[d][q];)d++;if(d>=a+1)return x.Errors.NotAvailable;
for(h=1;h<a+2;h++)m=f[q][h],f[q][h]=f[d][h],f[d][h]=m;m=1/f[q][q];f[q][h]*=m;for(d=1;d<a+1;d++)d!==q&&(m=-f[d][q],f[d][h]+=m*f[q][h]);f[0][a+1]=0}if(1===e.getColumnCount())for(e=[],d=0;d<g.getRowCount();d++){e[d]=[];m=f[0][a+1];for(l=0;l<a;l++){if(isNaN(k=b.toDouble(g.getValue(d,l))))return x.Errors.Value;m+=f[l+1][a+1]*k}e[d][0]=Math.exp(m)}else for(e=[[]],d=0;d<g.getColumnCount();d++){m=f[0][a+1];for(l=0;l<a;l++){if(isNaN(k=b.toDouble(g.getValue(l,d))))return x.Errors.Value;m+=f[l+1][a+1]*k}e[0][d]=
Math.exp(m)}return e}return x.Errors.NotAvailable},{minArgs:1,maxArgs:4,acceptsReference:t,acceptsArray:t,acceptsMissingArgument:g});p("LOGEST",function(a){var b=x.Convert,d=x._Helper,e=b._toArray(a[0]),f=d._argumentExists(a,1)?b._toArray(a[1]):e,g=d._argumentExists(a,2)?b.toBool(a[2]):!0,h=d._argumentExists(a,3)?b.toBool(a[3]):!1,k,l;for(k=0;k<e.getRowCount();k++)for(l=0;l<e.getColumnCount();l++){if(b.isError(e.getValue(k,l)))return e.getValue(k,l);if(!b.isNumber(e.getValue(k,l)))return x.Errors.Value}for(k=
0;k<f.getRowCount();k++)for(l=0;l<f.getColumnCount();l++){if(b.isError(f.getValue(k,l)))return f.getValue(k,l);if(!b.isNumber(f.getValue(k,l)))return x.Errors.Value}var n,m,q,p;if(e.getRowCount()===f.getRowCount()&&e.getColumnCount()===f.getColumnCount()&&(g||!h)){a=f.getRowCount()*f.getColumnCount();var r=0,s=n=0,t=0;for(k=m=0;k<f.getRowCount();k++)for(l=0;l<f.getColumnCount();l++){if(isNaN(q=b.toDouble(f.getValue(k,l)))||isNaN(p=b.toDouble(e.getValue(k,l))))return x.Errors.Value;p=Math.log(p);r+=
q;n+=q*q;s+=p;t+=p*p;m+=q*p}g?(d=(a*m-r*s)/(a*n-r*r),k=(s*n-r*m)/(a*n-r*r)):(d=m/n,k=0);p=[[]];p[0][0]=Math.exp(d);p[0][1]=Math.exp(k);h&&(p[1]=[],p[2]=[],p[3]=[],p[4]=[],b=a*n-r*r,g=a*t-s*s,h=a*m-r*s,d=t-k*s-d*m,k=h*h/(b*g),3>a?(p[1][0]=x.Errors.Number,p[1][1]=x.Errors.Number,p[2][1]=x.Errors.Number,p[3][0]=x.Errors.Number):(p[1][0]=Math.sqrt(d*a/(b*(a-2))),p[1][1]=Math.sqrt(d*n/(b*(a-2))),p[2][1]=Math.sqrt((g-h*h/b)/(a*(a-2))),p[3][0]=1===k?x.Errors.Number:k*(a-2)/(1-k)),p[2][0]=k,p[3][1]=a-2,p[4][0]=
g/a-d,p[4][1]=d);return p}if(1===e.getColumnCount()&&e.getRowCount()===f.getRowCount()||1===e.getRowCount()&&e.getColumnCount()===f.getColumnCount()){p=[];q=[];if(1===e.getColumnCount()){a=f.getRowCount();d=f.getColumnCount();for(k=0;k<a;k++){if(isNaN(n=b.toDouble(e.getValue(k,0))))return x.Errors.Value;p[k]=Math.log(n)}for(k=0;k<a;k++)for(q[k]=[],l=0;l<d;l++){if(isNaN(n=b.toDouble(f.getValue(k,l))))return x.Errors.Value;q[k][l]=n}}else{a=f.getColumnCount();d=f.getRowCount();q=[];p=[];for(k=0;k<a;k++){if(isNaN(n=
b.toDouble(e.getValue(0,k))))return x.Errors.Value;p[k]=Math.log(n)}for(k=0;k<a;k++)for(q[k]=[],l=0;l<d;l++){if(isNaN(n=b.toDouble(f.getValue(l,k))))return x.Errors.Value;q[k][l]=n}}s=[];for(k=0;k<d+1;k++)for(s[k]=[],l=0;l<d+2;l++)s[k][l]=0;t=[];for(k=0;k<d+2;k++)t[k]=0;n=h?[]:null;for(m=0;m<a;m++)for(t[d+1]+=p[m]*p[m],s[0][d+1]+=p[m],t[0]=s[0][d+1],k=0;k<d;k++)for(s[0][k+1]+=q[m][k],s[k+1][0]=s[0][k+1],s[k+1][d+1]+=q[m][k]*p[m],t[k+1]=s[k+1][d+1],l=k;l<d;l++)s[l+1][k+1]+=q[m][k]*q[m][l],s[k+1][l+
1]=s[l+1][k+1];s[0][0]=a;if(h){for(k=0;k<d+1;k++)for(n[k]=[],l=0;l<d+1;l++)n[k][l]=0;for(k=0;k<d+1;k++)n[k][k]=1}if(g)for(k=0;k<d+1;k++){if(0===s[k][k]){p=!1;for(l=k+1;!p&&l<d+1;l++)if(0!==s[l][k]){for(m=0;m<d+2;m++)p=s[k][m],s[k][m]=s[l][m],s[l][m]=p;if(h)for(m=0;m<d+1;m++)p=n[k][m],n[k][m]=n[l][m],n[l][m]=p;p=!0}if(!p)return x.Errors.Number}p=1/s[k][k];for(m=0;m<d+2;m++)s[k][m]*=p;if(h)for(m=0;m<d+1;m++)n[k][m]*=p;for(l=0;l<d+1;l++)if(l!==k){p=-s[l][k];for(m=0;m<d+2;m++)s[l][m]+=p*s[k][m];if(h)for(m=
0;m<d+1;m++)n[l][m]+=p*n[k][m]}}else for(k=1;k<d+1;k++){if(0===s[k][k]){p=!1;for(l=k+1;!p&&l<d+1;l++)if(0!==s[l][k]){for(m=0;m<d+2;m++)p=s[k][m],s[k][m]=s[l][m],s[l][m]=p;if(h)for(m=0;m<d+1;m++)p=n[k][m],n[k][m]=n[l][m],n[l][m]=p;p=!0}if(!p)return x.Errors.Number}p=1/s[k][k];for(m=1;m<d+2;m++)s[k][m]*=p;if(h)for(m=1;m<d+1;m++)n[k][m]*=p;for(l=1;l<d+1;l++)if(l!==k){p=-s[l][k];for(m=1;m<d+2;m++)s[l][m]+=p*s[k][m];if(h)for(m=1;m<d+1;m++)n[l][m]+=p*n[k][m]}s[0][d+1]=0}p=[[]];for(k=0;k<d+1;k++)p[0][k]=
Math.exp(s[d-k][d+1]);if(h){p[1]=[];p[2]=[];p[3]=[];p[4]=[];l=t[d+1]-t[0]*t[0]/a;h=t[d+1];for(k=0;k<d+1;k++)h-=s[k][d+1]*t[k];q=l-h;p[2][0]=0===l?x.Errors.Number:q/l;p[4][0]=q;p[4][1]=h;if(g){if(0===a-d-1)for(p[2][1]=x.Errors.Number,k=0;k<d+1;k++)p[1][k]=x.Errors.Number;else{g=h/(a-d-1);for(k=0;k<d+1;k++)p[1][d-k]=Math.sqrt(g*n[k][k]);p[2][1]=Math.sqrt(g)}p[3][0]=0===h?x.Errors.Number:b.toDouble(a-d-1)*q/(h*b.toDouble(d));p[3][1]=b.toDouble(a-d-1)}else{if(0===a-d){for(k=0;k<d+1;k++)p[1][k]=x.Errors.Number;
p[2][1]=x.Errors.Number}else{g=h/b.toDouble(a-d);p[1][d]=x.Errors.NotAvailable;for(k=1;k<d+1;k++)p[1][d-k]=Math.sqrt(g*n[k][k]);p[2][1]=Math.sqrt(g)}p[3][0]=0===h?x.Errors.Number:b.toDouble(a-d)*q/(h*b.toDouble(d));p[3][1]=b.toDouble(a-d)}for(k=2;5>k;k++)for(l=2;l<d+1;l++)p[k][l]=x.Errors.NotAvailable}return p}return x.Errors.Number},{minArgs:1,maxArgs:4,acceptsReference:e,acceptsArray:e,acceptsMissingArgument:g});p("STEYX",function(a){var b,d,e=0,f=0,g=0,h=0,k=0,l=0,n=x.Convert,m=x._ArrayHelper,
q=m.getLength(a[0]);if(q!==m.getLength(a[1]))return x.Errors.NotAvailable;for(var p=0;p<q;p++)if(d=m.getValueByIndex(a[0],p),b=m.getValueByIndex(a[1],p),n.isNumber(d)&&n.isNumber(b))d=n.toDouble(d),b=n.toDouble(b),e+=d,f+=d*d,g+=b,h+=b*b,k+=b*d,l++;else{if(n.isError(d))return d;if(n.isError(b))return b}return 0===l*(l-2)||0===l*h-g*g?x.Errors.DivideByZero:Math.sqrt((l*f-e*e-(l*k-g*e)*(l*k-g*e)/(l*h-g*g))/(l*(l-2)))},{minArgs:2,maxArgs:2,acceptsArray:l,acceptsReference:l});p("BETADIST",M,{minArgs:3,
maxArgs:5,acceptsMissingArgument:r});p("BETAINV",ba,{minArgs:3,maxArgs:5,acceptsMissingArgument:r});p("BINOMDIST",function(a){var b,d,e=x.Convert;if(isNaN(b=e.toInt(a[0]))||isNaN(d=e.toInt(a[1])))return x.Errors.Value;var f;if(isNaN(f=e.toDouble(a[2]))||isNaN(a=e.toBool(a[3])))return x.Errors.Value;if(0>b||0>d||d<b||0>f||1<f)return x.Errors.Number;var g,h;if(a){if(d===b)return 1;a=1-f;g=Math.pow(a,d);var k;if(0===g){g=Math.pow(f,d);if(0===g)return x.Errors.Number;k=1-g;for(h=0;h<d-b&&0<g;h++)g*=e.toDouble(d-
h)/e.toDouble((h+1)*a/f),k-=g;return 0>k?0:k}k=g;for(h=0;h<b&&0<g;h++)g*=e.toDouble(d-h)/e.toDouble((h+1)*f/a),k+=g;return k}a=1-f;g=Math.pow(a,d);if(0===g){g=Math.pow(f,d);if(0===g)return x.Errors.Number;for(h=0;h<d-b&&0<g;h++)g*=e.toDouble(d-h)/e.toDouble((h+1)*a/f);return g}for(h=0;h<b&&0<g;h++)g*=e.toDouble(d-h)/e.toDouble((h+1)*f/a);return g},{minArgs:4,maxArgs:4});p("NEGBINOMDIST",function(a){var b,d,e=x.Convert;if(isNaN(b=e.toInt(a[0]))||isNaN(d=e.toInt(a[1]))||isNaN(a=e.toDouble(a[2])))return x.Errors.Value;
if(0>a||1<=a||0>=b+d-1)return x.Errors.Number;var f=qa._MathHelper.combin(b+d-1,d-1);if(e.isError(f))return f;f=e.toDouble(f);d=Math.pow(a,d);b=Math.pow(1-a,b);return e.toResult(f*d*b)},{minArgs:3,maxArgs:3});p("CRITBINOM",function(a){var b,d=x.Convert;if(isNaN(b=d.toInt(a[0])))return x.Errors.Value;var e,f;if(isNaN(e=d.toDouble(a[1]))||isNaN(f=d.toDouble(a[2])))return x.Errors.Value;if(0>b||0>e||1<e||0>=f||1<=f)return x.Errors.Number;a=1-e;var g=Math.pow(a,b),h,k;if(0===g){g=Math.pow(e,b);if(0===
g)return x.Errors.Number;h=1-g;for(k=0;k<b&&h>=f;k++)g*=d.toDouble(b-k)/d.toDouble((k+1)*a/e),h-=g;return d.toDouble(b-k)}h=g;for(k=0;k<b&&h<f;k++)g*=d.toDouble(b-k)/d.toDouble((k+1)*e/a),h+=g;return d.toDouble(k)},{minArgs:3,maxArgs:3});p("CHIDIST",W,{minArgs:2,maxArgs:2});p("CHIINV",function(a){for(var b=x.Convert,d=0;d<a.length;d++)if(b.isError(a[d]))return a[d];if(isNaN(d=b.toDouble(a[0]))||isNaN(a=b.toInt(a[1])))return x.Errors.Value;if(0>d||1<d||1>a||a>Math.pow(10,10))return x.Errors.Number;
a=fa([1-d,0.5*a,2]);return b.toDouble(a)},{minArgs:2,maxArgs:2});p("CHITEST",function(a){var b=0,d,e=x.Convert,f=x._ArrayHelper,g=f.getRowCount(a[0]),h=f.getColumnCount(a[0]);if(g!==f.getRowCount(a[1])||h!==f.getColumnCount(a[1]))return x.Errors.NotAvailable;if(1<g&&1<h)d=(g-1)*(h-1);else if(1<g&&1===h)d=g-1;else if(1===g&&1<h)d=h-1;else return x.Errors.NotAvailable;for(var k=0;k<g;k++)for(var l=0;l<h;l++){var n=f.getValue(a[0],k,l);if(e.isError(n))return n;var m=f.getValue(a[1],k,l);if(e.isError(m))return m;
var q;if(isNaN(n=e.toDouble(n))||isNaN(q=e.toDouble(m)))return x.Errors.Value;if(0===q)return x.Errors.DivideByZero;b+=(n-q)*(n-q)/q}return W([b,d])},{minArgs:2,maxArgs:2,acceptsReference:l,acceptsArray:l});p("CORREL",function(a){var b=0,d=0,e=0,f=0,g=0,h,k,l=x.Convert,n=x._ArrayHelper,m=n.getLength(a[0]);if(m!==n.getLength(a[1]))return x.Errors.NotAvailable;var q=0,p,r,s;for(p=0;p<m;p++)if(r=n.getValueByIndex(a[0],p),s=n.getValueByIndex(a[1],p),l.isNumber(r)&&l.isNumber(s))r=l.toDouble(r),s=l.toDouble(s),
b+=r,d+=s,e+=r*r,f+=s*s,q++;else{if(l.isError(r))return r;if(l.isError(s))return s}if(1>=q)return x.Errors.DivideByZero;h=b/q;k=d/q;b=Math.sqrt((q*e-b*b)/(q*(q-1)));d=Math.sqrt((q*f-d*d)/(q*(q-1)));if(0===b||0===d)return x.Errors.DivideByZero;for(p=0;p<m;p++)r=n.getValueByIndex(a[0],p),s=n.getValueByIndex(a[1],p),l.isNumber(r)&&l.isNumber(s)&&(r=l.toDouble(r),s=l.toDouble(s),g+=(r-h)*(s-k));return l.toResult(g/l.toDouble((q-1)*b*d))},{minArgs:2,maxArgs:2,acceptsReference:l,acceptsArray:l});p("EXPONDIST",
function(a){for(var b=x.Convert,d=0;d<a.length;d++)if(b.isError(a[d]))return a[d];var e;if(isNaN(d=b.toDouble(a[0]))||isNaN(e=b.toDouble(a[1]))||isNaN(a=b.toDouble(a[2])))return x.Errors.Value;if(0>d||0>=e)return x.Errors.Number;d=Math.exp(-e*d);return b.toResult(a?1-d:e*d)},{minArgs:3,maxArgs:3});p("FDIST",la,{minArgs:3,maxArgs:3});p("FINV",function(a){var b,d,e,f=x.Convert;if(isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return x.Errors.Value;if(0>b||1<b||1>d||
d>=Math.pow(10,10)||1>e||e>=Math.pow(10,10))return x.Errors.Number;a=ba([1-(1-b),e/2,d/2]);return f.isError(a)?a:(1/f.toDouble(a)-1)*(e/d)},{minArgs:3,maxArgs:3});p("FISHER",function(a){var b;return isNaN(b=x.Convert.toDouble(a[0]))?x.Errors.Value:-1>=b||1<=b?x.Errors.Number:Math.log((1+b)/(1-b))/2},{minArgs:1,maxArgs:1});p("FISHERINV",function(a){var b;if(isNaN(b=x.Convert.toDouble(a[0])))return x.Errors.Value;a=Math.exp(2*b)-1;b=Math.exp(2*b)+1;return!isFinite(a)&&0<a&&!isFinite(b)&&0<b?1:a/b},
{minArgs:1,maxArgs:1});p("FTEST",function(a){var b=a[0],d=a[1];a=x.Convert;var e=x._ArrayHelper,f,g;for(f=0;f<e.getLength(b);f++)if(g=e.getValueByIndex(b,f),a.isError(g))return g;for(f=0;f<e.getLength(d);f++)if(g=e.getValueByIndex(d,f),a.isError(g))return g;e={N:0,M:0,Q:0,afun_flag:!1,sum:0};ra(e,b);f=e.N-1;if(1===e.N)return x.Errors.DivideByZero;b=e.Q/(e.N-1);if(0===b)return x.Errors.DivideByZero;e.N=0;e.M=0;e.Q=0;e.afun_flag=!1;e.sum=0;ra(e,d);d=e.N-1;if(1===e.N)return x.Errors.DivideByZero;e=e.Q/
(e.N-1);if(0===e)return x.Errors.DivideByZero;d=la([b/e,f,d]);if(a.isError(d))return d;a=2*(1-a.toDouble(d));1<a&&(a=2-a);return a},{minArgs:2,maxArgs:2,acceptsArray:l,acceptsReference:l});p("GAMMADIST",ja,{minArgs:4,maxArgs:4});p("GAMMAINV",fa,{minArgs:3,maxArgs:3});p("GAMMALN",R,{minArgs:1,maxArgs:1});p("HYPGEOMDIST",function(a){var b=x.Convert,d=b.toInt(a[0]),e=b.toInt(a[1]),f=b.toInt(a[2]),g=b.toInt(a[3]);if(0>d||d>Math.min(e,f)||d<Math.max(0,e-g+f)||0>e||e>g||0>f||f>g||0>g)return x.Errors.Number;
var h=qa._MathHelper.combin(f,d);if(b.isError(h))return h;a=b.toDouble(h);h=qa._MathHelper.combin(g-f,e-d);if(b.isError(h))return h;d=b.toDouble(h);h=qa._MathHelper.combin(g,e);if(b.isError(h))return h;e=b.toDouble(h);return b.toResult(a*d/e)},{minArgs:4,maxArgs:4});p("LOGNORMDIST",function(a){var b,d,e,f=x.Convert;if(isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return x.Errors.Value;if(0>=b||0>=e)return x.Errors.Number;a=[];a[0]=(Math.log(b)-d)/e;return J(a)},{minArgs:3,
maxArgs:3});p("LOGINV",function(a){var b,d,e,f=x.Convert;if(isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return x.Errors.Value;if(0>=e||0>b||1<b)return x.Errors.Number;a=[];a[0]=b;b=L(a);if(f.isError(b))return b;b=f.toDouble(b);return f.toResult(Math.exp(d+e*b))},{minArgs:3,maxArgs:3});p("NORMDIST",K,{minArgs:4,maxArgs:4});p("NORMINV",A,{minArgs:3,maxArgs:3});p("NORMSDIST",J,{minArgs:1,maxArgs:1});p("NORMSINV",L,{minArgs:1,maxArgs:1});p("PEARSON",function(a){var b=
0,d=0,e=0,f=0,g=0,h=x.Convert,k=x._ArrayHelper,l=k.getLength(a[0]);if(l!==k.getLength(a[1]))return x.Errors.NotAvailable;for(var n=0,m=0;m<l;m++){var q=k.getValueByIndex(a[0],m),p=k.getValueByIndex(a[1],m);h.isNumber(q)&&h.isNumber(p)&&(q=h.toDouble(q),p=h.toDouble(p),b+=q,d+=p,e+=q*q,f+=p*p,g+=q*p,n++)}return 0===n*e-b*b||0===n*f-d*d?x.Errors.DivideByZero:(n*g-b*d)/Math.sqrt((n*e-b*b)*(n*f-d*d))},{minArgs:2,maxArgs:2,acceptsReference:l,acceptsArray:l});p("RSQ",function(a){var b=a[0],d=a[1],e=0,f=
0,g=0,h=0,k=0,l=0;a=x.Convert;var n=x._ArrayHelper,m=n.getLength(d);if(m!==n.getLength(b))return x.Errors.NotAvailable;for(var q=0;q<m;q++){var p=n.getValueByIndex(d,q),r=n.getValueByIndex(b,q);a.isNumber(p)&&a.isNumber(r)&&(p=a.toDouble(p),r=a.toDouble(r),e+=p,f+=r,g+=p*p,h+=r*r,k+=p*r,l++)}b=Math.sqrt((l*g-e*e)*(l*h-f*f));if(0===b)return x.Errors.DivideByZero;b=(l*k-e*f)/b;return a.toResult(b*b)},{minArgs:2,maxArgs:2,acceptsReference:e,acceptsArray:e});p("POISSON",function(a){var b,d=x.Convert;
if(isNaN(b=d.toInt(a[0])))return x.Errors.Value;var e;if(isNaN(e=d.toDouble(a[1])))return x.Errors.Value;var f;if(isNaN(f=d.toBool(a[2])))return x.Errors.Value;a=0;if(0>=b||0>=e)return x.Errors.Number;if(f)for(f=0;f<=b;f++)a+=Math.exp(-e)*Math.pow(e,f)/da(f);else a=Math.exp(-e)*Math.pow(e,b)/da(b);return d.toResult(a)},{minArgs:3,maxArgs:3});p("PROB",function(a){var b,d=x.Convert,e=x._ArrayHelper;if(isNaN(b=d.toDouble(a[2])))return x.Errors.Value;var f=b;if(x._Helper._argumentExists(a,3)&&isNaN(f=
d.toDouble(a[3])))return x.Errors.Value;var g=0,h=0,k=e.getLength(a[0]);if(k!==e.getLength(a[1]))return x.Errors.NotAvailable;for(var l=0;l<k;l++)if(null!==e.getValueByIndex(a[0],l)&&null!==e.getValueByIndex(a[1],l)){var n,m;if(isNaN(n=d.toDouble(e.getValueByIndex(a[0],l)))||isNaN(m=d.toDouble(e.getValueByIndex(a[1],l))))return x.Errors.Value;if(0>=m||1<m)return x.Errors.Number;b<=n&&n<=f&&(g+=m);h+=m}return 1!==h?x.Errors.Number:g},{minArgs:3,maxArgs:4,acceptsMissingArgument:function(a){return 3===
a},acceptsReference:e,acceptsArray:e});p("SKEW",function(a){if(void 0===a[0]||null===a[0])throw"Invalid arguments";var b=0,d=0,e=0,f,g=0,h,k,l,n=x.Convert,m=x._ArrayHelper;for(h=0;h<a.length;h++)if(m.isArrayOrReference(a[h]))for(k=0;k<m.getLength(a[h]);k++)if(l=m.getValueByIndex(a[h],k),n.isNumber(l))l=n.toDouble(l),b+=l,d+=l*l,g++;else{if(n.isError(l))return l}else{if(n.isError(a[h]))return a[h];if(isNaN(f=n.toDouble(a[h])))return x.Errors.Value;b+=f;d+=f*f;g++}if(2>=g)return x.Errors.DivideByZero;
f=b/g;b=Math.sqrt((g*d-b*b)/(g*(g-1)));if(0===b)return x.Errors.DivideByZero;for(h=0;h<a.length;h++)if(m.isArrayOrReference(a[h]))for(k=0;k<m.getLength(a[h]);k++)if(l=m.getValueByIndex(a[h],k),n.isNumber(l))l=n.toDouble(l),e+=Math.pow((l-f)/b,3);else{if(n.isError(l))return l}else{if(isNaN(l=n.toDouble(a[h])))return x.Errors.Value;e+=Math.pow((l-f)/b,3)}return n.toResult(g*e/((g-1)*(g-2)))},{minArgs:1,acceptsArray:l,acceptsReference:l});p("STANDARDIZE",function(a){var b,d,e,f=x.Convert;return isNaN(b=
f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2]))?x.Errors.Value:0>=e?x.Errors.Number:(b-d)/e},{minArgs:3,maxArgs:3});p("TDIST",function(a){var b,d=x.Convert;if(isNaN(b=d.toDouble(a[0])))return x.Errors.Value;var e,f;if(isNaN(e=d.toInt(a[1]))||isNaN(f=d.toInt(a[2])))return x.Errors.Value;if(1>e||1!==f&&2!==f||0>b)return x.Errors.Number;a=e;var g=b/Math.sqrt(a);b=a/(a+b*b);var h=a-2,k=a%2,l=1,n=1;a=1;var m=2+k,q=m;if(2<=h)for(d=d.toInt(m);d<=h;d+=2){n=n*b*(q-1)/q;l+=n;if(l===
a)break;a=l;q+=2}if(1!==k)return f*(1-(0.5+0.5*g*Math.sqrt(b)*l));1===e&&(l=0);return f*(1-(0.5+0.3183098862*(g*b*l+Math.atan(g))))},{minArgs:3,maxArgs:3});p("TINV",function(a){var b,d=x.Convert;if(isNaN(b=d.toDouble(a[0]))||isNaN(a=d.toInt(a[1])))return x.Errors.Value;if(0>b||1<b||1>a||a>Math.pow(10,10))return x.Errors.Number;var e,f,g,h,k,l;e=b/2;if(1E20<a)return d=[],d[0]=e,L(d);0.5>e?(b=0,k=2*e):(b=1,k=2*(1-e));if(1E-12>Math.abs(a-2))a=0<k?Math.sqrt(2/(k*(2-k))-2):1.79769E308;else if(d.toDouble(a)<
1+1E-12)a=0<k?-Math.tan(1.5707963267948966*(k+1)):1.79769E308;else{e=1/(a-0.5);f=48/(e*e);g=((20700*e/f-98)*e-16)*e+96.36;h=((94.5/(f+g)-3)/f+1)*Math.sqrt(1.5707963267948966*e)*a;l=Math.pow(h*k,2/a);if(l>0.05+e){l=[];l[0]=0.5*k;k=L(l);if(d.isError(k))return k;k=d.toDouble(k);l=k*k;5>a&&(g+=0.3*(a-4.5)*(k+0.6));l=(((((0.4*l+6.3)*l+36)*l+94.5)/((((0.05*h*k-5)*k-7)*k-2)*k+f+g)-l-3)/f+1)*k;l*=e*l;l=0.002<l?Math.exp(l)-1:0.5*l*l+l}else l=((1/(3*((a+6)/(a*l)-0.089*h-0.822)*(a+2))+0.5/(a+4))*l-1)*(a+1)/
(a+2)+1/l;a=Math.sqrt(a*l)}0!==b&&(a=-a);return d.toResult(a)},{minArgs:2,maxArgs:2});p("TTEST",function(a){var b=a[0],d=a[1],e=a[2],f=a[3];a=x.Convert;if(!a.isNumber(e)||!a.isNumber(f))return x.Errors.Value;var e=a.toInt(e),f=a.toInt(f),g,h,k={N:0,M:0,Q:0,sum:0,afun_flag:!1},l;if(1!==e&&2!==e||1>f||3<f)return x.Errors.Number;if(1===f){a:if(f=x.Convert,l=x._ArrayHelper,h=l.getLength(b),k=l.getLength(d),h!==k)b=x.Errors.NotAvailable;else{for(var k=Array(h),n=0;n<h;n++){var m;if(isNaN(m=f.toDouble(l.getValueByIndex(b,
n)))||isNaN(g=f.toDouble(l.getValueByIndex(d,n)))){b=x.Errors.Value;break a}k[n]=m-g}b=k}if(a.isError(b))return b;h=k=d=g=0;n=b.length;for(m=0;m<n;m++){var q;if(isNaN(q=a.toDouble(b[m])))return x.Errors.Value;f=q-h;l=f/(d+1);h+=l;k+=d*f*l;d++;g+=q}if(0===d-1||0===d)return x.Errors.DivideByZero;b=Math.sqrt(k/(d-1));if(isNaN(b)||!isFinite(b))return x.Errors.Number;g=g/d/(b/Math.sqrt(d));f=d-1}else k.N=0,k.M=0,k.Q=0,k.afun_flag=!1,k.sum=0,oa(k,b),g=k.Q/(k.N-1),b=k.sum/k.N,l=k.N,k.N=0,k.M=0,k.Q=0,k.afun_flag=
!1,k.sum=0,oa(k,d),h=k.Q/(k.N-1),d=k.sum/k.N,k=k.N,2!==f?(f=g/l/(g/l+h/k),f=1/(f*f/a.toDouble(l-1)+(1-f)*(1-f)/a.toDouble(k-1))):f=a.toDouble(l+k-2),g=(b-d)/Math.sqrt(g/a.toDouble(l)+h/a.toDouble(k));g=Math.abs(g);a:{d=0.5*f;b=0.5;f/=f+g*g;l=0===f||1===f?0:Math.exp(ha(d+b)-ha(d)-ha(b)+d*Math.log(f)+b*Math.log(1-f));if(g=f<(d+1)/(d+b+2))h=d,d=b,b=h,f=1-f;h=d+b;k=d+1;n=d-1;m=1;q=1-h*f/k;4.450147717014403E-308>Math.abs(q)&&(q=4.450147717014403E-308);for(var p=q=1/q,r=x.Convert,s=1,t=2;100>=s;s++,t+=
2){var u=s*(b-s)*f/((n+t)*(d+t));q=1+u*q;4.450147717014403E-308>Math.abs(q)&&(q=4.450147717014403E-308);m=1+u/m;4.450147717014403E-308>Math.abs(m)&&(m=4.450147717014403E-308);q=1/q;p=p*q*m;u=-(d+s)*(h+s)*f/((d+t)*(k+t));q=1+u*q;4.450147717014403E-308>Math.abs(q)&&(q=4.450147717014403E-308);m=1+u/m;4.450147717014403E-308>Math.abs(m)&&(m=4.450147717014403E-308);q=1/q;u=q*m;p*=u;if(4.9E-324>Math.abs(r.toDouble(u-1))){d=l*p/d;d=g?1-d:d;break a}}d=x.Errors.Number}return a.isError(d)?d:0.5*e*a.toDouble(d)},
{minArgs:4,maxArgs:4,acceptsReference:e,acceptsArray:e});p("WEIBULL",function(a){var b,d,e,f=x.Convert;if(isNaN(b=f.toDouble(a[0]))||isNaN(d=f.toDouble(a[1]))||isNaN(e=f.toDouble(a[2])))return x.Errors.Value;var g;return isNaN(g=f.toBool(a[3]))?x.Errors.Value:0>b||0>=d||0>=e?x.Errors.Number:g?f.toResult(1-Math.exp(-Math.pow(b/e,d))):f.toResult(d/Math.pow(e,d)*Math.pow(b,d-1)*Math.exp(-Math.pow(b/e,d)))},{minArgs:4,maxArgs:4});p("ZTEST",function(a){var b,d=x.Convert,e=x._ArrayHelper;if(isNaN(b=d.toDouble(a[1])))return x.Errors.Value;
var f=0;if(x._Helper._argumentExists(a,2)&&isNaN(f=d.toDouble(a[2])))return x.Errors.Value;var g=0,h=0,k=0,l;if(e.isArrayOrReference(a[0]))for(var n=0;n<e.getLength(a[0]);n++)if(l=e.getValueByIndex(a[0],n),d.isNumber(l))l=d.toDouble(l),g+=l,h+=l*l,k++;else{if(d.isError(l))return l}else{if(isNaN(l=d.toDouble(a[0])))return x.Errors.Value;g+=l;h+=l*l;k++}if(0===k)return x.Errors.NotAvailable;if(1===k)return x.Errors.DivideByZero;e=g/k;a=x._Helper._argumentExists(a,2)?f:Math.sqrt((k*h-g*g)/(k*(k-1)));
if(0===a)return x.Errors.DivideByZero;f=[];f[0]=(e-b)/(a/Math.sqrt(k));b=J(f);return d.isError(b)?b:d.toResult(1-d.toDouble(b))},{minArgs:2,maxArgs:3,acceptsReference:f,acceptsArray:f,acceptsMissingArgument:a});p("PERMUT",function(a){var b=x.Convert,d=b.toDouble(b.toInt(a[0])),e=b.toDouble(b.toInt(a[1]));a=1;if(0>d||0>e||d<e)return x.Errors.Number;for(e=d-e+1;e<=d;e++)a*=e;return b.toResult(a)},{minArgs:2,maxArgs:2})})(window);
(function(p,l){function m(a){if(void 0===a||null===a)return 0;if("number"===typeof a)return a;if("string"===typeof a){var b=parseFloat(a);if(!isNaN(b)&&b.toString()===a.toString())return b}return null}function k(a,b){this.expected=a;this.formula="string"===typeof b?l.trim(b).replace("=",""):b}function g(a){this._init();if(this.condition=a)this.condition.ignoreBlank=this.ignoreBlank;this.type=e.AnyValue}var a=p.GrapeCity;"undefined"===typeof a&&(a=p.GrapeCity={});"undefined"===typeof a.UI&&(a.UI={});
var d=a.UI;d.CriteriaType={AnyValue:0,WholeNumber:1,DecimalValues:2,List:3,Date:4,Time:5,TextLength:6,Custom:7};d.DataValidationResult={ForceApply:0,Discard:1,Retry:2};d.ErrorStyle={Stop:0,Warning:1,Information:2};var e=d.CriteriaType,b=d.ErrorStyle;k.prototype={ignoreBlank:!1,_concatArray:function(a,b){var d,e;if(1===b.length)if(d=b[0],d instanceof Array)for(e=0;e<d.length;e++)a.push(d[e]);else a.push(d);else for(e=0;e<b.length;e++)d=b[e],d instanceof Array?0<d.length&&a.push(d[0]):a.push(d)},getValidList:function(a,
b,e){var g=[];if(this.formula&&0<this.formula.length)a=this.getExpected(a,b,e),a instanceof Array?this._concatArray(g,a):g.push(a);else if(this.expected&&0<this.expected.length&&(a=this.expected.split(",")))for(b=new d.GeneralFormatter,e=0;e<a.length;e++){var k=a[e];if(void 0!==k&&null!==k&&""!==k&&(k=l.trim(k),void 0!==k&&null!==k&&""!==k))try{g.push(b.Parse(k))}catch(m){g.push(k)}}return g},_equals:function(a,b){return a instanceof Date&&b instanceof Date?a.valueOf()===b.valueOf():a===b},evaluate:function(a,
b,d,e){if(void 0===e||null===e||""===e)return!0===this.ignoreBlank;if(a=this.getValidList(a,b,d))for(b=0;b<a.length;b++)if(d=a[b],!(void 0!==d&&null!==d||void 0!==e&&null!==e)||void 0!==d&&null!==d&&this._equals(d,e))return!0;return!1},getExpected:function(b,d,e){if(this.formula){var g,k=[];g=b.getCalcService();var l=g.parse(this.formula,d,e),l=g.evaluateParsedFormula(b._getSheetSource(),l,d,e,!0);if(l instanceof a.Calc.Reference)for(b=l.getRowCount(0),d=l.getColumnCount(0),e=0;e<b;e++)for(k[e]=[],
g=0;g<d;g++)k[e][g]=l.getValue(0,e,g);else if(l instanceof a.Calc.Array)for(b=l.getRowCount(),d=l.getColumnCount(),e=0;e<b;e++)for(k[e]=[],g=0;g<d;g++)k[e][g]=l.getValue(e,g);return k}return this.expected},toJSON:function(){return{expected:this.expected,formula:this.formula,conType:d.ConditionType.AreaCondition,ignoreBlank:this.ignoreBlank}},fromJSON:function(a){a&&(null!==a.expected&&void 0!==a.expected&&(this.expected=a.expected),null!==a.formula&&void 0!==a.formula&&(this.formula=a.formula),null!==
a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank))}};k.fromSource=function(a){return new k(a,null)};k.fromFormula=function(a){return new k("",a)};d.AreaCondition=k;g.prototype={condition:null,type:null,errorStyle:null,ignoreBlank:!0,inCellDropdown:!0,showInputMessage:!0,showErrorMessage:!0,inputTitle:"",errorTitle:"",inputMessage:"",errorMessage:"",comparisonOperator:null,IgnoreBlank:function(a){if(0>=arguments.length)return this.ignoreBlank;this.ignoreBlank=a;this.condition&&
(this.condition.ignoreBlank=a);return this},_init:function(){this.errorStyle=b.Stop;this.showErrorMessage=this.showInputMessage=this.inCellDropdown=this.ignoreBlank=!0;this.errorMessage=this.inputMessage=this.errorTitle=this.inputTitle="";this.comparisonOperator=d.ComparisonOperator.Between},value1:function(){var a=this.condition&&this.condition.item1?this.condition.item1:this.condition;return a?a.formula&&0<a.formula.length?"="+a.formula.toString().toUpperCase():a.expected:null},value2:function(){var a=
this.condition&&this.condition.item2?this.condition.item2:this.condition;return a?a.formula&&0<a.formula.length?"="+a.formula.toString().toUpperCase():a.expected:null},isValid:function(a,b,d,g){if(this.condition){this.IgnoreBlank(this.ignoreBlank);if(this.condition.ignoreBlank&&(void 0===g||null===g||""===g))return!0;var k=g;if(void 0!==g&&null!==g)switch(this.type){case e.AnyValue:return!0;case e.DecimalValues:case e.WholeNumber:g=m(g);void 0!==g&&null!==g&&(k=g);break;case e.Date:case e.Time:g=
g instanceof Date?g:"string"===typeof g?new Date(g):null,void 0!==g&&null!==g&&(k=g)}return this.condition.evaluate(a,b,d,k,k)}return!0},reset:function(){this._init();this.type=e.AnyValue;this.condition=null},getValidList:function(a,b,d){return null!=this.condition&&this.type===e.List&&this.condition instanceof k?this.condition.getValidList(a,b,d):null},toJSON:function(){return{errorStyle:this.errorStyle,ignoreBlank:this.ignoreBlank,inCellDropdown:this.inCellDropdown,showInputMessage:this.showInputMessage,
showErrorMessage:this.showErrorMessage,inputTitle:this.inputTitle,errorTitle:this.errorTitle,inputMessage:this.inputMessage,errorMessage:this.errorMessage,comparisonOperator:this.comparisonOperator,type:this.type,condition:this.condition}},fromJSON:function(a){if(a){if(null!==a.condition&&void 0!==a.condition){var b=null,d=this._getConditionTypes()[a.condition.conType];d&&(b=new d,b.fromJSON(a.condition));this.condition=b}null!==a.type&&void 0!==a.type&&(this.type=a.type);null!==a.comparisonOperator&&
void 0!==a.comparisonOperator&&(this.comparisonOperator=a.comparisonOperator);null!==a.errorStyle&&void 0!==a.errorStyle&&(this.errorStyle=a.errorStyle);null!==a.ignoreBlank&&void 0!==a.ignoreBlank&&(this.ignoreBlank=a.ignoreBlank);null!==a.inCellDropdown&&void 0!==a.inCellDropdown&&(this.inCellDropdown=a.inCellDropdown);null!==a.showInputMessage&&void 0!==a.showInputMessage&&(this.showInputMessage=a.showInputMessage);null!==a.showErrorMessage&&void 0!==a.showErrorMessage&&(this.showErrorMessage=
a.showErrorMessage);null!==a.inputTitle&&void 0!==a.inputTitle&&(this.inputTitle=a.inputTitle);null!==a.errorTitle&&void 0!==a.errorTitle&&(this.errorTitle=a.errorTitle);null!==a.inputMessage&&void 0!==a.inputMessage&&(this.inputMessage=a.inputMessage);null!==a.errorMessage&&void 0!==a.errorMessage&&(this.errorMessage=a.errorMessage)}},_getConditionTypes:function(){if(!this._dict){var a={};a[d.ConditionType.RelationCondition]=d.RelationCondition;a[d.ConditionType.NumberCondition]=d.NumberCondition;
a[d.ConditionType.TextCondition]=d.TextCondition;a[d.ConditionType.ColorCondition]=d.ColorCondition;a[d.ConditionType.FormulaCondition]=d.FormulaCondition;a[d.ConditionType.DateCondition]=d.DateCondition;a[d.ConditionType.DateExCondition]=d.DateExCondition;a[d.ConditionType.TextLengthCondition]=d.TextLengthCondition;a[d.ConditionType.Top10Condition]=d.Top10Condition;a[d.ConditionType.UniqueCondition]=d.UniqueCondition;a[d.ConditionType.AverageCondition]=d.AverageCondition;a[d.ConditionType.CellValueCondition]=
d.CellValueCondition;a[d.ConditionType.AreaCondition]=d.AreaCondition;this._dict=a}return this._dict}};d.DefaultDataValidator=g;g.isFormula=function(a){return a&&"="===a[0]};d.DefaultDataValidator.createNumberValidator=function(a,b,k,l){var m=g.isFormula(b)?b.replace("=",""):null,p=g.isFormula(b)?null:b;b=g.isFormula(k)?k.replace("=",""):null;var n=g.isFormula(k)?null:k,h=null,I=d.ComparisonOperator,E=d.GeneralCompareType;k=d.RelationCompareType;var O=d.NumberCondition,H=d.RelationCondition;switch(a){case I.Between:m=
new O(E.GreaterThanOrEqualsTo,p,m);m.integerValue=l;b=new O(E.LessThanOrEqualsTo,n,b);b.integerValue=l;h=new H(k.And,m,b);break;case I.NotBetween:m=new O(E.LessThan,p,m);m.integerValue=l;b=new O(E.GreaterThan,n,b);b.integerValue=l;h=new H(k.Or,m,b);break;case I.EqualsTo:h=new O(E.EqualsTo,p,m);h.integerValue=l;break;case I.NotEqualsTo:h=new O(E.NotEqualsTo,p,m);h.integerValue=l;break;case I.GreaterThan:h=new O(E.GreaterThan,p,m);h.integerValue=l;break;case I.GreaterThanOrEqualsTo:h=new O(E.GreaterThanOrEqualsTo,
p,m);h.integerValue=l;break;case I.LessThan:h=new O(E.LessThan,p,m);h.integerValue=l;break;case I.LessThanOrEqualsTo:h=new O(E.LessThanOrEqualsTo,p,m),h.integerValue=l}m=new g(h);m.type=l?e.WholeNumber:e.DecimalValues;m.comparisonOperator=a;return m};d.DefaultDataValidator.createDateValidator=function(a,b,k){var l=g.isFormula(b)?b.replace("=",""):null,m=g.isFormula(b)?null:b;b=g.isFormula(k)?k.replace("=",""):null;var p=g.isFormula(k)?null:k,n=null,h=d.ComparisonOperator,I=d.DateCompareType;k=d.RelationCompareType;
var E=d.DateCondition,O=d.RelationCondition;switch(a){case h.Between:l=new E(I.AfterEqualsTo,m,l);b=new E(I.BeforeEqualsTo,p,b);n=new O(k.And,l,b);break;case h.NotBetween:l=new E(I.Before,m,l);b=new E(I.After,p,b);n=new O(k.Or,l,b);break;case h.EqualsTo:n=new E(I.EqualsTo,m,l);break;case h.NotEqualsTo:n=new E(I.NotEqualsTo,m,l);break;case h.GreaterThan:n=new E(I.After,m,l);break;case h.GreaterThanOrEqualsTo:n=new E(I.AfterEqualsTo,m,l);break;case h.LessThan:n=new E(I.Before,m,l);break;case h.LessThanOrEqualsTo:n=
new E(I.BeforeEqualsTo,m,l)}l=new g(n);l.type=e.Date;l.comparisonOperator=a;return l};d.DefaultDataValidator.createTextLengthValidator=function(a,b,k){var l=g.isFormula(b)?b.replace("=",""):null,m=g.isFormula(b)?null:b;b=g.isFormula(k)?k.replace("=",""):null;var p=g.isFormula(k)?null:k,n=null,h=d.ComparisonOperator,I=d.GeneralCompareType;k=d.RelationCompareType;var E=d.TextLengthCondition,O=d.RelationCondition;switch(a){case h.Between:l=new E(I.GreaterThanOrEqualsTo,m,l);b=new E(I.LessThanOrEqualsTo,
p,b);n=new O(k.And,l,b);break;case h.NotBetween:l=new E(I.LessThan,m,l);b=new E(I.GreaterThan,p,b);n=new O(k.Or,l,b);break;case h.EqualsTo:n=new E(I.EqualsTo,m,l);break;case h.NotEqualsTo:n=new E(I.NotEqualsTo,m,l);break;case h.GreaterThan:n=new E(I.GreaterThan,m,l);break;case h.GreaterThanOrEqualsTo:n=new E(I.GreaterThanOrEqualsTo,m,l);break;case h.LessThan:n=new E(I.LessThan,m,l);break;case h.LessThanOrEqualsTo:n=new E(I.LessThanOrEqualsTo,m,l)}l=new g(n);l.type=e.TextLength;l.comparisonOperator=
a;return l};d.DefaultDataValidator.createFormulaValidator=function(a){a&&"="===a.charAt(0)&&(a=a.substr(1));a=new g(new d.FormulaCondition(d.CustomValueType.Formula,a));a.type=e.Custom;return a};d.DefaultDataValidator.createFormulaListValidator=function(a){a=new g(k.fromFormula(a));a.type=e.List;return a};d.DefaultDataValidator.createListValidator=function(a){a=new g(k.fromSource(a));a.type=e.List;return a}})(window,jQuery);
(function(p,l,m){m=p.GrapeCity;"undefined"===typeof m&&(m=p.GrapeCity={});"undefined"===typeof m.UI&&(m.UI={});"undefined"===typeof m.Calc&&(m.Calc={});p=l.wijmo.wijspread;l=m.UI;p.Spread=l.GcSpread;p.Key=l.Key;p.KeyMap=l.KeyMap;p.Direction=l.Direction;p.HorizontalAlign=l.HorizontalAlign;p.VerticalAlign=l.VerticalAlign;p.HorizontalPosition=l.HorizontalPosition;p.VerticalPosition=l.VerticalPosition;p.HeaderAutoText=l.HeaderAutoText;p.ClipboardPasteOptions=l.ClipboardPasteOptions;p.TextFileOpenFlags=
l.TextFileOpenFlags;p.VisualState=l.VisualState;p.ReferenceStyle=l.ReferenceStyle;p.LineStyle=l.LineStyle;p.LineBorder=l.LineBorder;p.SpreadActions=l.SpreadActions;p.UndoRedo=l.UndoRedo;p.Sheet=l.GcSheet;p.Cell=l.Cell;p.Row=l.Row;p.Column=l.Col;p.Range=l.Range;p.Rect=l.Rect;p.SheetArea=l.SheetArea;p.StorageType=l.StorageType;p.Style=l.Style;p.CopyToOption=l.CopyToOption;p.Events=l.Events;p.DataContext=l.DataContext;p.FontFactory=l.FontFactory;p.SelectionPolicy=l.SelectionPolicy;p.SelectionUnit=l.SelectionUnit;
p.EditorStatus=l.EditorStatus;p.NameInfo=l.NameInfo;p.ThemeColor=l.ThemeColor;p.ThemeColors=l.ThemeColors;p.SpreadTheme=l.SpreadTheme;p.SpreadThemes=l.SpreadThemes;p.CellsEnumerator=l.CellsEnumerator;p.SearchFlags=l.SearchFlags;p.SearchOrder=l.SearchOrder;p.SearchFoundFlags=l.SearchFoundFlags;p.SearchCondition=l.SearchCondition;p.SearchResult=l.SearchResult;p.AutoFillType=l.AutoFillType;p.FillDirection=l.FillDirection;p.FillSeries=l.FillSeries;p.FillType=l.FillType;p.FillDateUnit=l.FillDateUnit;p.DragFillDirection=
l.DragFillDirection;p.FormatMode=l.FormatMode;p.NumberFormatType=l.NumberFormatType;p.FormatConverter=l.FormatConverter;p.GeneralFormatter=l.GeneralFormatter;p.AutoFormatter=l.AutoFormatter;p.RowFilterBase=l.RowFilterBase;p.HideRowFilter=l.HideRowFilter;p.RangeGroup=l.RangeGroup;p.RangeGroupItemInfo=l.RangeGroupItemInfo;p.GroupedItemIndexEnumerator=l.GroupedItemIndexEnumerator;p.GroupState=l.GroupState;p.RangeGroupDirection=l.RangeGroupDirection;p.RangeGroupInfo=l.RangeGroupInfo;p.EmptyValueStyle=
l.EmptyValueStyle;p.SparklineAxisMinMax=l.SparklineAxisMinMax;p.SparklineType=l.SparklineType;p.DataOrientation=l.DataOrientation;p.SparklineSetting=l.SparklineSetting;p.SparklineGroup=l.SparklineGroup;p.Sparkline=l.Sparkline;p.CriteriaType=l.CriteriaType;p.DataValidationResult=l.DataValidationResult;p.ErrorStyle=l.ErrorStyle;p.DefaultDataValidator=l.DefaultDataValidator;p.RelationCompareType=l.RelationCompareType;p.ComparisonOperator=l.ComparisonOperator;p.GeneralCompareType=l.GeneralCompareType;
p.TextComparisonOperator=l.TextComparisonOperator;p.TextCompareType=l.TextCompareType;p.ColorCompareType=l.ColorCompareType;p.CustomValueType=l.CustomValueType;p.DateCompareType=l.DateCompareType;p.Top10ConditionType=l.Top10ConditionType;p.DateOccurringType=l.DateOccurringType;p.QuarterType=l.QuarterType;p.SortState=l.SortState;p.AverageConditionType=l.AverageConditionType;p.ScaleValueType=l.ScaleValueType;p.ConditionalFormats=l.ConditionalFormats;p.ConditionRuleBase=l.ConditionRuleBase;p.CellValueRule=
l.CellValueRule;p.RelationCondition=l.RelationCondition;p.NumberCondition=l.NumberCondition;p.SpecificTextRule=l.SpecificTextRule;p.TextCondition=l.TextCondition;p.ColorCondition=l.ColorCondition;p.FormulaRule=l.FormulaRule;p.FormulaCondition=l.FormulaCondition;p.DateCondition=l.DateCondition;p.DateOccurringRule=l.DateOccurringRule;p.DateExCondition=l.DateExCondition;p.TextLengthCondition=l.TextLengthCondition;p.Top10Rule=l.Top10Rule;p.Top10Condition=l.Top10Condition;p.UniqueRule=l.UniqueRule;p.DuplicateRule=
l.DuplicateRule;p.UniqueCondition=l.UniqueCondition;p.AverageRule=l.AverageRule;p.AverageCondition=l.AverageCondition;p.ScaleValue=l.ScaleValue;p.TwoScaleRule=l.TwoScaleRule;p.ThreeScaleRule=l.ThreeScaleRule;p.BarDirection=l.BarDirection;p.DataBarAxisPosition=l.DataBarAxisPosition;p.DataBarRule=l.DataBarRule;p.IconSetType=l.IconSetType;p.IconValueType=l.IconValueType;p.IconSetRule=l.IconSetRule;p.IconCriterion=l.IconCriterion;p.Calc=m.Calc;p.CellBindingSource=l.CellBindingSource;p.BaseCellType=l.BaseCellType;
p.TextCellType=l.TextCellType;p.ColumnHeaderCellType=l.ColumnHeaderCellType;p.RowHeaderCellType=l.RowHeaderCellType;p.CornerCellType=l.CornerCellType;p.CheckBoxCellType=l.CheckBoxCellType;p.CheckBoxTextAlign=l.CheckBoxTextAlign;p.ButtonCellType=l.ButtonCellType;p.EditorValueType=l.EditorValueType;p.ComboBoxCellType=l.ComboBoxCellType;p.HyperLinkCellType=l.HyperLinkCellType;p.CustomCellType=l.CustomCellType})(this,jQuery);
